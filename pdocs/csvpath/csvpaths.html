<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 15.0.1"/>
    <title>csvpath.csvpaths API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>




            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#CsvPathsPublic">CsvPathsPublic</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#CsvPathsPublic.csvpath">csvpath</a>
                        </li>
                        <li>
                                <a class="function" href="#CsvPathsPublic.collect_paths">collect_paths</a>
                        </li>
                        <li>
                                <a class="function" href="#CsvPathsPublic.fast_forward_paths">fast_forward_paths</a>
                        </li>
                        <li>
                                <a class="function" href="#CsvPathsPublic.next_paths">next_paths</a>
                        </li>
                        <li>
                                <a class="function" href="#CsvPathsPublic.collect_by_line">collect_by_line</a>
                        </li>
                        <li>
                                <a class="function" href="#CsvPathsPublic.fast_forward_by_line">fast_forward_by_line</a>
                        </li>
                        <li>
                                <a class="function" href="#CsvPathsPublic.next_by_line">next_by_line</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#CsvPaths">CsvPaths</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#CsvPaths.__init__">CsvPaths</a>
                        </li>
                        <li>
                                <a class="variable" href="#CsvPaths.print_default">print_default</a>
                        </li>
                        <li>
                                <a class="variable" href="#CsvPaths.delimiter">delimiter</a>
                        </li>
                        <li>
                                <a class="variable" href="#CsvPaths.quotechar">quotechar</a>
                        </li>
                        <li>
                                <a class="variable" href="#CsvPaths.skip_blank_lines">skip_blank_lines</a>
                        </li>
                        <li>
                                <a class="variable" href="#CsvPaths.current_matcher">current_matcher</a>
                        </li>
                        <li>
                                <a class="variable" href="#CsvPaths.logger">logger</a>
                        </li>
                        <li>
                                <a class="variable" href="#CsvPaths.named_paths_name">named_paths_name</a>
                        </li>
                        <li>
                                <a class="variable" href="#CsvPaths.named_file_name">named_file_name</a>
                        </li>
                        <li>
                                <a class="variable" href="#CsvPaths.metrics">metrics</a>
                        </li>
                        <li>
                                <a class="variable" href="#CsvPaths.error_manager">error_manager</a>
                        </li>
                        <li>
                                <a class="function" href="#CsvPaths.run_time_str">run_time_str</a>
                        </li>
                        <li>
                                <a class="variable" href="#CsvPaths.current_run_time">current_run_time</a>
                        </li>
                        <li>
                                <a class="function" href="#CsvPaths.clear_run_coordination">clear_run_coordination</a>
                        </li>
                        <li>
                                <a class="function" href="#CsvPaths.csvpath">csvpath</a>
                        </li>
                        <li>
                                <a class="variable" href="#CsvPaths.errors">errors</a>
                        </li>
                        <li>
                                <a class="function" href="#CsvPaths.collect_error">collect_error</a>
                        </li>
                        <li>
                                <a class="function" href="#CsvPaths.has_errors">has_errors</a>
                        </li>
                        <li>
                                <a class="variable" href="#CsvPaths.config">config</a>
                        </li>
                        <li>
                                <a class="function" href="#CsvPaths.add_to_config">add_to_config</a>
                        </li>
                        <li>
                                <a class="function" href="#CsvPaths.clean">clean</a>
                        </li>
                        <li>
                                <a class="function" href="#CsvPaths.collect_paths">collect_paths</a>
                        </li>
                        <li>
                                <a class="function" href="#CsvPaths.fast_forward_paths">fast_forward_paths</a>
                        </li>
                        <li>
                                <a class="function" href="#CsvPaths.next_paths">next_paths</a>
                        </li>
                        <li>
                                <a class="function" href="#CsvPaths.collect_by_line">collect_by_line</a>
                        </li>
                        <li>
                                <a class="function" href="#CsvPaths.fast_forward_by_line">fast_forward_by_line</a>
                        </li>
                        <li>
                                <a class="function" href="#CsvPaths.next_by_line">next_by_line</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
csvpath<wbr>.csvpaths    </h1>

                        <div class="docstring"><p>CsvPaths' intent is to help you manage and automate your use
of the CsvPath library. it makes it easier to scale your CSV quality control.</p>
</div>

                        <input id="mod-csvpaths-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-csvpaths-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">   1</span></a><span class="sd">&quot;&quot;&quot; CsvPaths&#39; intent is to help you manage and automate your use</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">   2</span></a><span class="sd">    of the CsvPath library. it makes it easier to scale your CSV quality control. &quot;&quot;&quot;</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">   3</span></a>
</span><span id="L-4"><a href="#L-4"><span class="linenos">   4</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">abc</span><span class="w"> </span><span class="kn">import</span> <span class="n">ABC</span><span class="p">,</span> <span class="n">abstractmethod</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">   5</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Any</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">   6</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">traceback</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">   7</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timezone</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">   8</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.managers.errors.error</span><span class="w"> </span><span class="kn">import</span> <span class="n">Error</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">   9</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.managers.errors.error_comms</span><span class="w"> </span><span class="kn">import</span> <span class="n">ErrorCommunications</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos">  10</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.managers.errors.error_manager</span><span class="w"> </span><span class="kn">import</span> <span class="n">ErrorManager</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos">  11</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.managers.errors.error_collector</span><span class="w"> </span><span class="kn">import</span> <span class="n">ErrorCollector</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos">  12</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.util.config</span><span class="w"> </span><span class="kn">import</span> <span class="n">Config</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos">  13</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.util.log_utility</span><span class="w"> </span><span class="kn">import</span> <span class="n">LogUtility</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos">  14</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.util.metadata_parser</span><span class="w"> </span><span class="kn">import</span> <span class="n">MetadataParser</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos">  15</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.util.exceptions</span><span class="w"> </span><span class="kn">import</span> <span class="n">InputException</span><span class="p">,</span> <span class="n">CsvPathsException</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos">  16</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.managers.paths.paths_manager</span><span class="w"> </span><span class="kn">import</span> <span class="n">PathsManager</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos">  17</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.managers.files.file_manager</span><span class="w"> </span><span class="kn">import</span> <span class="n">FileManager</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos">  18</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.managers.results.results_manager</span><span class="w"> </span><span class="kn">import</span> <span class="n">ResultsManager</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos">  19</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.managers.results.result</span><span class="w"> </span><span class="kn">import</span> <span class="n">Result</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos">  20</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">CsvPath</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos">  21</span></a>
</span><span id="L-22"><a href="#L-22"><span class="linenos">  22</span></a>
</span><span id="L-23"><a href="#L-23"><span class="linenos">  23</span></a><span class="k">class</span><span class="w"> </span><span class="nc">CsvPathsPublic</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos">  24</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;this abstract class is the public interface for CsvPaths.</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos">  25</span></a>
</span><span id="L-26"><a href="#L-26"><span class="linenos">  26</span></a><span class="sd">    a CsvPaths instance manages applying any number of csvpaths</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos">  27</span></a><span class="sd">    to any number of files. CsvPaths applies sets of csvpaths</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos">  28</span></a><span class="sd">    to a given file, on demand. Think of CsvPaths as a session</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos">  29</span></a><span class="sd">    object. It gives you a way to manage files, csvpaths, and</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos">  30</span></a><span class="sd">    the results generated by applying paths to files. It is not</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos">  31</span></a><span class="sd">    intended for concurrent use. If you need multiple threads,</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos">  32</span></a><span class="sd">    create multiple CsvPaths instances.</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos">  33</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos">  34</span></a>
</span><span id="L-35"><a href="#L-35"><span class="linenos">  35</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos">  36</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">csvpath</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CsvPath</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos">  37</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets a CsvPath object primed with a reference to this CsvPaths&quot;&quot;&quot;</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos">  38</span></a>
</span><span id="L-39"><a href="#L-39"><span class="linenos">  39</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos">  40</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">collect_paths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos">  41</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos">  42</span></a><span class="sd">        Sequentially does a CsvPath.collect() on filename for every named path. lines are collected into results.&quot;&quot;&quot;</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos">  43</span></a>
</span><span id="L-44"><a href="#L-44"><span class="linenos">  44</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos">  45</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fast_forward_paths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos">  46</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Sequentially does a CsvPath.fast_forward() on filename for every named path&quot;&quot;&quot;</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos">  47</span></a>
</span><span id="L-48"><a href="#L-48"><span class="linenos">  48</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos">  49</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">next_paths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos">  50</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Does a CsvPath.next() on filename for every line against every named path in sequence&quot;&quot;&quot;</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos">  51</span></a>
</span><span id="L-52"><a href="#L-52"><span class="linenos">  52</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos">  53</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">collect_by_line</span><span class="p">(</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos">  54</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">if_all_agree</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">collect_when_not_matched</span><span class="o">=</span><span class="kc">False</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos">  55</span></a>    <span class="p">):</span>  <span class="c1"># pragma: no cover</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos">  56</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Does a CsvPath.collect() on filename where each row is considered</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos">  57</span></a><span class="sd">        by every named path before the next row starts</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos">  58</span></a>
</span><span id="L-59"><a href="#L-59"><span class="linenos">  59</span></a><span class="sd">        next_by_line for if_all_agree and collect_when_not_matched.</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos">  60</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos">  61</span></a>
</span><span id="L-62"><a href="#L-62"><span class="linenos">  62</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos">  63</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fast_forward_by_line</span><span class="p">(</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos">  64</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">if_all_agree</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">collect_when_not_matched</span><span class="o">=</span><span class="kc">False</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos">  65</span></a>    <span class="p">):</span>  <span class="c1"># pragma: no cover</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos">  66</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Does a CsvPath.fast_forward() on filename where each row is</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos">  67</span></a><span class="sd">        considered by every named path before the next row starts</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos">  68</span></a>
</span><span id="L-69"><a href="#L-69"><span class="linenos">  69</span></a><span class="sd">        next_by_line for if_all_agree and collect_when_not_matched.</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos">  70</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos">  71</span></a>
</span><span id="L-72"><a href="#L-72"><span class="linenos">  72</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos">  73</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">next_by_line</span><span class="p">(</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos">  74</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos">  75</span></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos">  76</span></a>        <span class="n">pathsname</span><span class="p">,</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos">  77</span></a>        <span class="n">filename</span><span class="p">,</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos">  78</span></a>        <span class="n">collect</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos">  79</span></a>        <span class="n">if_all_agree</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos">  80</span></a>        <span class="n">collect_when_not_matched</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos">  81</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>  <span class="c1"># pragma: no cover</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos">  82</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Does a CsvPath.next() on filename where each row is considered</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos">  83</span></a><span class="sd">        by every named path before the next row starts.</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos">  84</span></a>
</span><span id="L-85"><a href="#L-85"><span class="linenos">  85</span></a><span class="sd">        if_all_agree=True means all the CsvPath instances must match for</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos">  86</span></a><span class="sd">        the line to be kept. However, every CsvPath instance will keep its</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos">  87</span></a><span class="sd">        own matches in its results regardless of if every line kept was</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos">  88</span></a><span class="sd">        returned to the caller by CsvPaths.</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos">  89</span></a>
</span><span id="L-90"><a href="#L-90"><span class="linenos">  90</span></a><span class="sd">        collect_when_not_matched=True inverts the match so that lines</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos">  91</span></a><span class="sd">        which did not match are returned, rather than the default behavior.</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos">  92</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos">  93</span></a>
</span><span id="L-94"><a href="#L-94"><span class="linenos">  94</span></a>
</span><span id="L-95"><a href="#L-95"><span class="linenos">  95</span></a><span class="k">class</span><span class="w"> </span><span class="nc">CsvPathsCoordinator</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos">  96</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos">  97</span></a><span class="sd">        @private</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos">  98</span></a><span class="sd">    This abstract class defines callbacks for CsvPath instances to</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos">  99</span></a><span class="sd">    broadcast state to their siblings through CsvPaths. A CsvPath</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos"> 100</span></a><span class="sd">    instance might stop the entire run, rather than each CsvPath</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos"> 101</span></a><span class="sd">    instance needing to contain the same logic that stops their</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos"> 102</span></a><span class="sd">    participation in a run.</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos"> 103</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos"> 104</span></a>
</span><span id="L-105"><a href="#L-105"><span class="linenos"> 105</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos"> 106</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">stop_all</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos"> 107</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos"> 108</span></a><span class="sd">        @private</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos"> 109</span></a><span class="sd">        Stops every CsvPath instance in a run&quot;&quot;&quot;</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos"> 110</span></a>
</span><span id="L-111"><a href="#L-111"><span class="linenos"> 111</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos"> 112</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fail_all</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos"> 113</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos"> 114</span></a><span class="sd">        @private</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos"> 115</span></a><span class="sd">        Fails every CsvPath instance in a run&quot;&quot;&quot;</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos"> 116</span></a>
</span><span id="L-117"><a href="#L-117"><span class="linenos"> 117</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos"> 118</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">skip_all</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos"> 119</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos"> 120</span></a><span class="sd">        @private</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos"> 121</span></a><span class="sd">        skips the line for every CsvPath instance in a run&quot;&quot;&quot;</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos"> 122</span></a>
</span><span id="L-123"><a href="#L-123"><span class="linenos"> 123</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos"> 124</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">advance_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lines</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos"> 125</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos"> 126</span></a><span class="sd">        @private</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos"> 127</span></a><span class="sd">        advances every CsvPath instance in a run&quot;&quot;&quot;</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos"> 128</span></a>
</span><span id="L-129"><a href="#L-129"><span class="linenos"> 129</span></a>
</span><span id="L-130"><a href="#L-130"><span class="linenos"> 130</span></a><span class="k">class</span><span class="w"> </span><span class="nc">CsvPaths</span><span class="p">(</span><span class="n">CsvPathsPublic</span><span class="p">,</span> <span class="n">CsvPathsCoordinator</span><span class="p">,</span> <span class="n">ErrorCollector</span><span class="p">):</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos"> 131</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Manages the application of csvpaths to files. Csvpaths must be grouped and named.</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos"> 132</span></a><span class="sd">    Files must be named. Results are held by the results_manager.</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos"> 133</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos"> 134</span></a>
</span><span id="L-135"><a href="#L-135"><span class="linenos"> 135</span></a>    <span class="c1"># pylint: disable=too-many-instance-attributes</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos"> 136</span></a>
</span><span id="L-137"><a href="#L-137"><span class="linenos"> 137</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos"> 138</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos"> 139</span></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos"> 140</span></a>        <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos"> 141</span></a>        <span class="n">quotechar</span><span class="o">=</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos"> 142</span></a>        <span class="n">skip_blank_lines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos"> 143</span></a>        <span class="n">print_default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos"> 144</span></a>        <span class="n">config</span><span class="p">:</span> <span class="n">Config</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos"> 145</span></a>    <span class="p">):</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos"> 146</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">()</span> <span class="k">if</span> <span class="n">config</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">config</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos"> 147</span></a>        <span class="c1">#</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos"> 148</span></a>        <span class="c1"># managers centralize activities, offer async potential, and</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos"> 149</span></a>        <span class="c1"># are where integrations hook in. ErrorManager functionality</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos"> 150</span></a>        <span class="c1"># must be available in CsvPath too. The others are CsvPaths</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos"> 151</span></a>        <span class="c1"># only.</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos"> 152</span></a>        <span class="c1">#</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos"> 153</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_managers</span><span class="p">()</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos"> 154</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos"> 155</span></a><span class="sd">        self.paths_manager = PathsManager(csvpaths=self)</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos"> 156</span></a><span class="sd">        self.file_manager = FileManager(csvpaths=self)</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos"> 157</span></a><span class="sd">        self.results_manager = ResultsManager(csvpaths=self)</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos"> 158</span></a><span class="sd">        self.ecoms = ErrorCommunications(csvpaths=self)</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos"> 159</span></a><span class="sd">        self._error_manager = ErrorManager(csvpaths=self)</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos"> 160</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos"> 161</span></a>        <span class="c1">#</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos"> 162</span></a>        <span class="c1"># TODO:</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos"> 163</span></a>        <span class="c1"># self.print_manager = ... &lt;&lt;&lt;=== should we do this?</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos"> 164</span></a>        <span class="c1">#</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos"> 165</span></a>        <span class="c1">#</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos"> 166</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">print_default</span> <span class="o">=</span> <span class="n">print_default</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos"> 167</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span> <span class="o">=</span> <span class="n">delimiter</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos"> 168</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">quotechar</span> <span class="o">=</span> <span class="n">quotechar</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos"> 169</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">skip_blank_lines</span> <span class="o">=</span> <span class="n">skip_blank_lines</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos"> 170</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="p">:</span> <span class="n">CsvPath</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos"> 171</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">LogUtility</span><span class="o">.</span><span class="n">logger</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos"> 172</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos"> 173</span></a>        <span class="c1"># coordinator attributes</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos"> 174</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_stop_all</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos"> 175</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_fail_all</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos"> 176</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_skip_all</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos"> 177</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_advance_all</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos"> 178</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_current_run_time</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos"> 179</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_run_time_str</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos"> 180</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">named_paths_name</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos"> 181</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">named_file_name</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos"> 182</span></a>
</span><span id="L-183"><a href="#L-183"><span class="linenos"> 183</span></a>        <span class="c1">#</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos"> 184</span></a>        <span class="c1"># metrics is for OTLP OpenTelemetry. it should only</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos"> 185</span></a>        <span class="c1"># be used by the OTLP listener. it is here because</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos"> 186</span></a>        <span class="c1"># the integration may need a long-lived presence. if</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos"> 187</span></a>        <span class="c1"># needed, the first OTLP listener will set it up</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos"> 188</span></a>        <span class="c1"># before spinning up a thread. any other OTLP</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos"> 189</span></a>        <span class="c1"># listener threads that need to use a long-lived metric</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos"> 190</span></a>        <span class="c1"># will work with this property.</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos"> 191</span></a>        <span class="c1">#</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos"> 192</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos"> 193</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;initialized CsvPaths&quot;</span><span class="p">)</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos"> 194</span></a>
</span><span id="L-195"><a href="#L-195"><span class="linenos"> 195</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_set_managers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos"> 196</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">paths_manager</span> <span class="o">=</span> <span class="n">PathsManager</span><span class="p">(</span><span class="n">csvpaths</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos"> 197</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">file_manager</span> <span class="o">=</span> <span class="n">FileManager</span><span class="p">(</span><span class="n">csvpaths</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos"> 198</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span> <span class="o">=</span> <span class="n">ResultsManager</span><span class="p">(</span><span class="n">csvpaths</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos"> 199</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ecoms</span> <span class="o">=</span> <span class="n">ErrorCommunications</span><span class="p">(</span><span class="n">csvpaths</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos"> 200</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_error_manager</span> <span class="o">=</span> <span class="n">ErrorManager</span><span class="p">(</span><span class="n">csvpaths</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos"> 201</span></a>
</span><span id="L-202"><a href="#L-202"><span class="linenos"> 202</span></a>    <span class="nd">@property</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos"> 203</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">error_manager</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ErrorManager</span><span class="p">:</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos"> 204</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_error_manager</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos"> 205</span></a>
</span><span id="L-206"><a href="#L-206"><span class="linenos"> 206</span></a>    <span class="nd">@error_manager</span><span class="o">.</span><span class="n">setter</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos"> 207</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">error_manager</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">em</span><span class="p">:</span> <span class="n">ErrorManager</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos"> 208</span></a>        <span class="k">if</span> <span class="n">em</span><span class="o">.</span><span class="n">csvpaths</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos"> 209</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;CsvPaths cannot be None&quot;</span><span class="p">)</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos"> 210</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_error_manager</span> <span class="o">=</span> <span class="n">em</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos"> 211</span></a>
</span><span id="L-212"><a href="#L-212"><span class="linenos"> 212</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">run_time_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pathsname</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos"> 213</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;adds the stringified current run time to the named-paths</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos"> 214</span></a><span class="sd">        group home_dir to create the run_dir&quot;&quot;&quot;</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos"> 215</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_time_str</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">pathsname</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos"> 216</span></a>            <span class="k">raise</span> <span class="n">CsvPathsException</span><span class="p">(</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos"> 217</span></a>                <span class="s2">&quot;Cannot have None in both run_time_str and pathsname&quot;</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos"> 218</span></a>            <span class="p">)</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos"> 219</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_time_str</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos"> 220</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_run_time_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">get_run_time_str</span><span class="p">(</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos"> 221</span></a>                <span class="n">pathsname</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_run_time</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos"> 222</span></a>            <span class="p">)</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos"> 223</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_time_str</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos"> 224</span></a>
</span><span id="L-225"><a href="#L-225"><span class="linenos"> 225</span></a>    <span class="nd">@property</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos"> 226</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">current_run_time</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datetime</span><span class="p">:</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos"> 227</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;gets the time marking the start of the run. used to create the run home directory.&quot;&quot;&quot;</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos"> 228</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_run_time</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos"> 229</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_current_run_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos"> 230</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_run_time</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos"> 231</span></a>
</span><span id="L-232"><a href="#L-232"><span class="linenos"> 232</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">clear_run_coordination</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos"> 233</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;run coordination is the set of signals that csvpaths send to affect</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos"> 234</span></a><span class="sd">        one another through the CsvPaths instance&quot;&quot;&quot;</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos"> 235</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_stop_all</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos"> 236</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_fail_all</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos"> 237</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_skip_all</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos"> 238</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_advance_all</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos"> 239</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_current_run_time</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos"> 240</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_run_time_str</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos"> 241</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Cleared run coordination&quot;</span><span class="p">)</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos"> 242</span></a>
</span><span id="L-243"><a href="#L-243"><span class="linenos"> 243</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">csvpath</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CsvPath</span><span class="p">:</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos"> 244</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="n">CsvPath</span><span class="p">(</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos"> 245</span></a>            <span class="n">csvpaths</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos"> 246</span></a>            <span class="n">delimiter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">,</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos"> 247</span></a>            <span class="n">quotechar</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">quotechar</span><span class="p">,</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos"> 248</span></a>            <span class="n">skip_blank_lines</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">skip_blank_lines</span><span class="p">,</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos"> 249</span></a>            <span class="c1">#</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos"> 250</span></a>            <span class="c1"># in the usual case we don&#39;t want csvpaths and its csvpath children</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos"> 251</span></a>            <span class="c1"># to share the same config. sharing doesn&#39;t offer much. the flexibility</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos"> 252</span></a>            <span class="c1"># of having separate configs is valuable.</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos"> 253</span></a>            <span class="c1">#</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos"> 254</span></a>            <span class="n">config</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos"> 255</span></a>            <span class="n">print_default</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">print_default</span><span class="p">,</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos"> 256</span></a>            <span class="n">error_manager</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">error_manager</span><span class="p">,</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos"> 257</span></a>        <span class="p">)</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos"> 258</span></a>        <span class="k">return</span> <span class="n">path</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos"> 259</span></a>
</span><span id="L-260"><a href="#L-260"><span class="linenos"> 260</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">stop_all</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos"> 261</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_stop_all</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos"> 262</span></a>
</span><span id="L-263"><a href="#L-263"><span class="linenos"> 263</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fail_all</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos"> 264</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_fail_all</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos"> 265</span></a>
</span><span id="L-266"><a href="#L-266"><span class="linenos"> 266</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">skip_all</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos"> 267</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_skip_all</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos"> 268</span></a>
</span><span id="L-269"><a href="#L-269"><span class="linenos"> 269</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">advance_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lines</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos"> 270</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_advance_all</span> <span class="o">=</span> <span class="n">lines</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos"> 271</span></a>
</span><span id="L-272"><a href="#L-272"><span class="linenos"> 272</span></a>    <span class="nd">@property</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos"> 273</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">errors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Error</span><span class="p">]:</span>  <span class="c1"># pylint: disable=C0116</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos"> 274</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos"> 275</span></a>
</span><span id="L-276"><a href="#L-276"><span class="linenos"> 276</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">collect_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">error</span><span class="p">:</span> <span class="n">Error</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pylint: disable=C0116</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos"> 277</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos"> 278</span></a>
</span><span id="L-279"><a href="#L-279"><span class="linenos"> 279</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">has_errors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>  <span class="c1"># pylint: disable=C0116</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos"> 280</span></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_errors</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos"> 281</span></a>
</span><span id="L-282"><a href="#L-282"><span class="linenos"> 282</span></a>    <span class="nd">@property</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos"> 283</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Config</span><span class="p">:</span>  <span class="c1"># pylint: disable=C0116</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos"> 284</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">:</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos"> 285</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">()</span>  <span class="c1"># pragma: no cover</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos"> 286</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos"> 287</span></a>
</span><span id="L-288"><a href="#L-288"><span class="linenos"> 288</span></a>    <span class="c1">#</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos"> 289</span></a>    <span class="c1"># this is the preferred way to update config. it is preferred because</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos"> 290</span></a>    <span class="c1"># csvpath and csvpaths work off the same config file, even though they,</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos"> 291</span></a>    <span class="c1"># in some cases, have separate keys. if you update the config directly</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos"> 292</span></a>    <span class="c1"># before a run starts using the CsvPaths&#39;s Config you have to remember</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos"> 293</span></a>    <span class="c1"># to save and reload for it to effect both CsvPaths and CsvPath. this</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos"> 294</span></a>    <span class="c1"># method does the save and reload every time.</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos"> 295</span></a>    <span class="c1">#</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos"> 296</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">add_to_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">section</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos"> 297</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">add_to_config</span><span class="p">(</span><span class="n">section</span><span class="o">=</span><span class="n">section</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos"> 298</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">save_config</span><span class="p">()</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos"> 299</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">reload</span><span class="p">()</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos"> 300</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_managers</span><span class="p">()</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos"> 301</span></a>
</span><span id="L-302"><a href="#L-302"><span class="linenos"> 302</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">clean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">paths</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos"> 303</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;at this time we do not recommend reusing CsvPaths, but it is doable</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos"> 304</span></a><span class="sd">        you should clean before reuse unless you want to accumulate results.&quot;&quot;&quot;</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos"> 305</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">clean_named_results</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos"> 306</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clear_run_coordination</span><span class="p">()</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos"> 307</span></a>        <span class="c1"># self.error_manager.reset()</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos"> 308</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos"> 309</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">named_paths_name</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos"> 310</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">named_file_name</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos"> 311</span></a>
</span><span id="L-312"><a href="#L-312"><span class="linenos"> 312</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">collect_paths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos"> 313</span></a>        <span class="n">paths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">paths_manager</span><span class="o">.</span><span class="n">get_named_paths</span><span class="p">(</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos"> 314</span></a>        <span class="k">if</span> <span class="n">paths</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos"> 315</span></a>            <span class="k">raise</span> <span class="n">InputException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No named-paths found for </span><span class="si">{</span><span class="n">pathsname</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos"> 316</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos"> 317</span></a>            <span class="k">raise</span> <span class="n">InputException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Named-paths group </span><span class="si">{</span><span class="n">pathsname</span><span class="si">}</span><span class="s2"> is empty&quot;</span><span class="p">)</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos"> 318</span></a>        <span class="k">if</span> <span class="s2">&quot;&quot;</span> <span class="ow">in</span> <span class="n">paths</span><span class="p">:</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos"> 319</span></a>            <span class="k">raise</span> <span class="n">InputException</span><span class="p">(</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos"> 320</span></a>                <span class="sa">f</span><span class="s2">&quot;Named-paths group </span><span class="si">{</span><span class="n">pathsname</span><span class="si">}</span><span class="s2"> has one or more empty csvpaths&quot;</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos"> 321</span></a>            <span class="p">)</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos"> 322</span></a>        <span class="n">file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_manager</span><span class="o">.</span><span class="n">get_named_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos"> 323</span></a>        <span class="k">if</span> <span class="n">file</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos"> 324</span></a>            <span class="k">raise</span> <span class="n">InputException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No named-file found for </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos"> 325</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Prepping </span><span class="si">%s</span><span class="s2"> and </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">)</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos"> 326</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clean</span><span class="p">(</span><span class="n">paths</span><span class="o">=</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos"> 327</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos"> 328</span></a>            <span class="s2">&quot;Beginning collect_paths </span><span class="si">%s</span><span class="s2"> with </span><span class="si">%s</span><span class="s2"> paths&quot;</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos"> 329</span></a>        <span class="p">)</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos"> 330</span></a>        <span class="n">crt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_time_str</span><span class="p">(</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos"> 331</span></a>        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos"> 332</span></a>        <span class="c1">#</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos"> 333</span></a>        <span class="c1"># run starts here</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos"> 334</span></a>        <span class="c1">#</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos"> 335</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">start_run</span><span class="p">(</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos"> 336</span></a>            <span class="n">run_dir</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span> <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos"> 337</span></a>        <span class="p">)</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos"> 338</span></a>        <span class="c1">#</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos"> 339</span></a>        <span class="c1">#</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos"> 340</span></a>        <span class="c1">#</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos"> 341</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">path</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">paths</span><span class="p">):</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos"> 342</span></a>            <span class="n">csvpath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">csvpath</span><span class="p">()</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos"> 343</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">csvpath</span><span class="o">.</span><span class="n">will_run</span><span class="p">:</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos"> 344</span></a>                <span class="k">continue</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos"> 345</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">Result</span><span class="p">(</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos"> 346</span></a>                <span class="n">csvpath</span><span class="o">=</span><span class="n">csvpath</span><span class="p">,</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos"> 347</span></a>                <span class="n">file_name</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos"> 348</span></a>                <span class="n">paths_name</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos"> 349</span></a>                <span class="n">run_index</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos"> 350</span></a>                <span class="n">run_time</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_run_time</span><span class="p">,</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos"> 351</span></a>                <span class="n">run_dir</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos"> 352</span></a>            <span class="p">)</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos"> 353</span></a>            <span class="c1"># casting a broad net because if &quot;raise&quot; not in the error policy we</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos"> 354</span></a>            <span class="c1"># want to never fail during a run</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos"> 355</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos"> 356</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_load_csvpath</span><span class="p">(</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos"> 357</span></a>                    <span class="n">csvpath</span><span class="o">=</span><span class="n">csvpath</span><span class="p">,</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos"> 358</span></a>                    <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos"> 359</span></a>                    <span class="n">file</span><span class="o">=</span><span class="n">file</span><span class="p">,</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos"> 360</span></a>                    <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos"> 361</span></a>                    <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos"> 362</span></a>                    <span class="n">crt</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos"> 363</span></a>                <span class="p">)</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos"> 364</span></a>                <span class="c1">#</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos"> 365</span></a>                <span class="c1"># if run-mode: no-run we skip ahead without saving results</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos"> 366</span></a>                <span class="c1">#</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos"> 367</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">csvpath</span><span class="o">.</span><span class="n">will_run</span><span class="p">:</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos"> 368</span></a>                    <span class="k">continue</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos"> 369</span></a>                <span class="c1">#</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos"> 370</span></a>                <span class="c1"># the add has to come after _load_csvpath because we need the identity or index</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos"> 371</span></a>                <span class="c1"># to be stable and the identity is found in load, if it exists.</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos"> 372</span></a>                <span class="c1">#</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos"> 373</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">add_named_result</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos"> 374</span></a>                <span class="n">lines</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">lines</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos"> 375</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Collecting lines using a </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">lines</span><span class="p">))</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos"> 376</span></a>                <span class="n">csvpath</span><span class="o">.</span><span class="n">collect</span><span class="p">(</span><span class="n">lines</span><span class="o">=</span><span class="n">lines</span><span class="p">)</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos"> 377</span></a>                <span class="k">if</span> <span class="n">lines</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos"> 378</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>  <span class="c1"># pragma: no cover</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos"> 379</span></a>                        <span class="s2">&quot;Unexpected None for lines after collect_paths: file: </span><span class="si">%s</span><span class="s2">, match: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos"> 380</span></a>                        <span class="n">file</span><span class="p">,</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos"> 381</span></a>                        <span class="n">csvpath</span><span class="o">.</span><span class="n">match</span><span class="p">,</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos"> 382</span></a>                    <span class="p">)</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos"> 383</span></a>                <span class="c1">#</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos"> 384</span></a>                <span class="c1"># this is obviously not a good idea for very large files!</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos"> 385</span></a>                <span class="c1">#</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos"> 386</span></a>                <span class="n">result</span><span class="o">.</span><span class="n">unmatched</span> <span class="o">=</span> <span class="n">csvpath</span><span class="o">.</span><span class="n">unmatched</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos"> 387</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>  <span class="c1"># pylint: disable=W0718</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos"> 388</span></a>                <span class="c1"># ex.trace = traceback.format_exc()</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos"> 389</span></a>                <span class="c1"># ex.source = self</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos"> 390</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">error_manager</span><span class="o">.</span><span class="n">csvpaths</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos"> 391</span></a>                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;ErrorManager&#39;s CsvPaths cannot be None&quot;</span><span class="p">)</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos"> 392</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">error_manager</span><span class="o">.</span><span class="n">handle_error</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos"> 393</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ecoms</span><span class="o">.</span><span class="n">do_i_raise</span><span class="p">():</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos"> 394</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos"> 395</span></a>                    <span class="k">raise</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos"> 396</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos"> 397</span></a>            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos"> 398</span></a>        <span class="c1">#</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos"> 399</span></a>        <span class="c1"># run ends here</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos"> 400</span></a>        <span class="c1">#</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos"> 401</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">complete_run</span><span class="p">(</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos"> 402</span></a>            <span class="n">run_dir</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span> <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos"> 403</span></a>        <span class="p">)</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos"> 404</span></a>        <span class="c1">#</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos"> 405</span></a>        <span class="c1"># update/write run manifests here</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos"> 406</span></a>        <span class="c1">#  - validity (are all paths valid)</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos"> 407</span></a>        <span class="c1">#  - paths-completeness (did they all run and complete)</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos"> 408</span></a>        <span class="c1">#  - method (collect, fast_forward, next)</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos"> 409</span></a>        <span class="c1">#  - timestamp</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos"> 410</span></a>        <span class="c1">#</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos"> 411</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clear_run_coordination</span><span class="p">()</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos"> 412</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos"> 413</span></a>            <span class="s2">&quot;Completed collect_paths </span><span class="si">%s</span><span class="s2"> with </span><span class="si">%s</span><span class="s2"> paths&quot;</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos"> 414</span></a>        <span class="p">)</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos"> 415</span></a>
</span><span id="L-416"><a href="#L-416"><span class="linenos"> 416</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_load_csvpath</span><span class="p">(</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos"> 417</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos"> 418</span></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos"> 419</span></a>        <span class="n">csvpath</span><span class="p">:</span> <span class="n">CsvPath</span><span class="p">,</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos"> 420</span></a>        <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos"> 421</span></a>        <span class="n">file</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos"> 422</span></a>        <span class="n">pathsname</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos"> 423</span></a>        <span class="n">filename</span><span class="p">,</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos"> 424</span></a>        <span class="n">by_line</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos"> 425</span></a>        <span class="n">crt</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos"> 426</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos"> 427</span></a>        <span class="c1"># file is the physical file (+/- if preceding mode) filename is the named-file name</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos"> 428</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Beginning to load csvpath </span><span class="si">%s</span><span class="s2"> with file </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos"> 429</span></a>        <span class="n">csvpath</span><span class="o">.</span><span class="n">named_paths_name</span> <span class="o">=</span> <span class="n">pathsname</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos"> 430</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">named_paths_name</span> <span class="o">=</span> <span class="n">pathsname</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos"> 431</span></a>        <span class="n">csvpath</span><span class="o">.</span><span class="n">named_file_name</span> <span class="o">=</span> <span class="n">filename</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos"> 432</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">named_file_name</span> <span class="o">=</span> <span class="n">filename</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos"> 433</span></a>        <span class="c1">#</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos"> 434</span></a>        <span class="c1"># by_line==True means we are starting a run that is breadth-first ultimately using</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos"> 435</span></a>        <span class="c1"># next_by_line(). by_line runs cannot be source-mode preceding and have different</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos"> 436</span></a>        <span class="c1"># semantics around csvpaths influencing one another.</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos"> 437</span></a>        <span class="c1">#</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos"> 438</span></a>        <span class="c1"># we strip comments from above the path so we need to extract them first</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos"> 439</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="n">MetadataParser</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">extract_metadata</span><span class="p">(</span><span class="n">instance</span><span class="o">=</span><span class="n">csvpath</span><span class="p">,</span> <span class="n">csvpath</span><span class="o">=</span><span class="n">path</span><span class="p">)</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos"> 440</span></a>        <span class="n">identity</span> <span class="o">=</span> <span class="n">csvpath</span><span class="o">.</span><span class="n">identity</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos"> 441</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Csvpath </span><span class="si">%s</span><span class="s2"> after metadata extract: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">identity</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos"> 442</span></a>        <span class="c1"># update the settings using the metadata fields we just collected</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos"> 443</span></a>        <span class="n">csvpath</span><span class="o">.</span><span class="n">update_settings_from_metadata</span><span class="p">()</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos"> 444</span></a>        <span class="c1">#</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos"> 445</span></a>        <span class="c1"># if we have a reference, resolve it. we may not actually use the file</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos"> 446</span></a>        <span class="c1"># if we&#39;re in source-mode: preceding, but that doesn&#39;t matter from the</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos"> 447</span></a>        <span class="c1"># pov of the reference.</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos"> 448</span></a>        <span class="c1">#</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos"> 449</span></a>        <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;$&quot;</span><span class="p">):</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos"> 450</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos"> 451</span></a>                <span class="s2">&quot;File name is a reference: </span><span class="si">%s</span><span class="s2">. Replacing the path passed in with the reffed data file path.&quot;</span><span class="p">,</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos"> 452</span></a>                <span class="n">filename</span><span class="p">,</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos"> 453</span></a>            <span class="p">)</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos"> 454</span></a>            <span class="n">file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">data_file_for_reference</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">not_name</span><span class="o">=</span><span class="n">crt</span><span class="p">)</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos"> 455</span></a>        <span class="c1">#</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos"> 456</span></a>        <span class="c1">#</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos"> 457</span></a>        <span class="c1">#</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos"> 458</span></a>        <span class="k">if</span> <span class="n">csvpath</span><span class="o">.</span><span class="n">data_from_preceding</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos"> 459</span></a>            <span class="k">if</span> <span class="n">by_line</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos"> 460</span></a>                <span class="k">raise</span> <span class="n">CsvPathsException</span><span class="p">(</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos"> 461</span></a>                    <span class="s2">&quot;Breadth-first runs do not support source-mode preceding because each line of data flows through each csvpath in order already&quot;</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos"> 462</span></a>                <span class="p">)</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos"> 463</span></a>            <span class="c1">#</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos"> 464</span></a>            <span class="c1"># we are in source-mode: preceding</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos"> 465</span></a>            <span class="c1"># that means we ignore the original data file path and</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos"> 466</span></a>            <span class="c1"># instead use the data.csv from the preceding csvpath. that is,</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos"> 467</span></a>            <span class="c1"># assuming there is a preceding csvpath and it created and</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos"> 468</span></a>            <span class="c1"># saved data.</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos"> 469</span></a>            <span class="c1">#</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos"> 470</span></a>            <span class="c1"># find the preceding csvpath in the named-paths</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos"> 471</span></a>            <span class="c1">#</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos"> 472</span></a>            <span class="c1"># we may be in a file reference like: $sourcemode.csvpaths.source2:from. if so</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos"> 473</span></a>            <span class="c1"># we just need the named-paths name.</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos"> 474</span></a>            <span class="c1">#</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos"> 475</span></a>            <span class="k">if</span> <span class="n">pathsname</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;$&quot;</span><span class="p">):</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos"> 476</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos"> 477</span></a>                    <span class="s2">&quot;Named-paths name is a reference: </span><span class="si">%s</span><span class="s2">. Stripping it down to just the actual named-paths name.&quot;</span><span class="p">,</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos"> 478</span></a>                    <span class="n">pathsname</span><span class="p">,</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos"> 479</span></a>                <span class="p">)</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos"> 480</span></a>                <span class="n">pathsname</span> <span class="o">=</span> <span class="n">pathsname</span><span class="p">[</span><span class="mi">1</span> <span class="p">:</span> <span class="n">pathsname</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)]</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos"> 481</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">get_last_named_result</span><span class="p">(</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos"> 482</span></a>                <span class="n">name</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span> <span class="n">before</span><span class="o">=</span><span class="n">csvpath</span><span class="o">.</span><span class="n">identity</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos"> 483</span></a>            <span class="p">)</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos"> 484</span></a>            <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos"> 485</span></a>                <span class="c1"># get its data.csv path for this present run</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos"> 486</span></a>                <span class="c1"># swap in that path for the regular origin path</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos"> 487</span></a>                <span class="n">file</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">data_file_path</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos"> 488</span></a>                <span class="n">csvpath</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;source-mode-source&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">file</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos"> 489</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos"> 490</span></a>                    <span class="s2">&quot;Csvpath identified as </span><span class="si">%s</span><span class="s2"> uses last csvpath&#39;s data.csv at </span><span class="si">%s</span><span class="s2"> as source&quot;</span><span class="p">,</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos"> 491</span></a>                    <span class="n">csvpath</span><span class="o">.</span><span class="n">identity</span><span class="p">,</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos"> 492</span></a>                    <span class="n">file</span><span class="p">,</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos"> 493</span></a>                <span class="p">)</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos"> 494</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos"> 495</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos"> 496</span></a>                    <span class="s2">&quot;Cannot find a preceding data file to use for csvpath identified as </span><span class="si">%s</span><span class="s2"> running in source-mode&quot;</span><span class="p">,</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos"> 497</span></a>                    <span class="n">csvpath</span><span class="o">.</span><span class="n">identity</span><span class="p">,</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos"> 498</span></a>                <span class="p">)</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos"> 499</span></a>        <span class="n">f</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">)</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos"> 500</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Csvpath matching part starts at char # </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos"> 501</span></a>        <span class="n">apath</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;$</span><span class="si">{</span><span class="n">file</span><span class="si">}{</span><span class="n">path</span><span class="p">[</span><span class="n">f</span><span class="p">:]</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos"> 502</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Parsing csvpath </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">apath</span><span class="p">)</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos"> 503</span></a>        <span class="n">csvpath</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">apath</span><span class="p">)</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos"> 504</span></a>        <span class="c1">#</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos"> 505</span></a>        <span class="c1"># ready to run. time to register the run. this is separate from</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos"> 506</span></a>        <span class="c1"># the run_register.py (ResultsRegister) event</span>
</span><span id="L-507"><a href="#L-507"><span class="linenos"> 507</span></a>        <span class="c1">#</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos"> 508</span></a>        <span class="c1"># crt = self.run_time_str(pathsname)</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos"> 509</span></a>        <span class="c1"># fingerprint = self.file_manager.get_fingerprint_for_name(filename)</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos"> 510</span></a>        <span class="c1">#</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos"> 511</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Done loading csvpath&quot;</span><span class="p">)</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos"> 512</span></a>
</span><span id="L-513"><a href="#L-513"><span class="linenos"> 513</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fast_forward_paths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos"> 514</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;runs the named-paths group named without collecting matches.&quot;&quot;&quot;</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos"> 515</span></a>        <span class="n">paths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">paths_manager</span><span class="o">.</span><span class="n">get_named_paths</span><span class="p">(</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos"> 516</span></a>        <span class="n">file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_manager</span><span class="o">.</span><span class="n">get_named_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos"> 517</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Prepping </span><span class="si">%s</span><span class="s2"> and </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">)</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos"> 518</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clean</span><span class="p">(</span><span class="n">paths</span><span class="o">=</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos"> 519</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos"> 520</span></a>            <span class="s2">&quot;Beginning FF </span><span class="si">%s</span><span class="s2"> with </span><span class="si">%s</span><span class="s2"> paths against file </span><span class="si">%s</span><span class="s2">. No match results will be held.&quot;</span><span class="p">,</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos"> 521</span></a>            <span class="n">pathsname</span><span class="p">,</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos"> 522</span></a>            <span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">),</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos"> 523</span></a>            <span class="n">filename</span><span class="p">,</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos"> 524</span></a>        <span class="p">)</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos"> 525</span></a>        <span class="n">crt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_time_str</span><span class="p">(</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos"> 526</span></a>        <span class="c1">#</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos"> 527</span></a>        <span class="c1"># run starts here</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos"> 528</span></a>        <span class="c1">#</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos"> 529</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">start_run</span><span class="p">(</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos"> 530</span></a>            <span class="n">run_dir</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span> <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos"> 531</span></a>        <span class="p">)</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos"> 532</span></a>        <span class="c1">#</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos"> 533</span></a>        <span class="c1">#</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos"> 534</span></a>        <span class="c1">#</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos"> 535</span></a>        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos"> 536</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">path</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">paths</span><span class="p">):</span>
</span><span id="L-537"><a href="#L-537"><span class="linenos"> 537</span></a>            <span class="n">csvpath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">csvpath</span><span class="p">()</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos"> 538</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Beginning to FF CsvPath instance: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">csvpath</span><span class="p">)</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos"> 539</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">Result</span><span class="p">(</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos"> 540</span></a>                <span class="n">csvpath</span><span class="o">=</span><span class="n">csvpath</span><span class="p">,</span>
</span><span id="L-541"><a href="#L-541"><span class="linenos"> 541</span></a>                <span class="n">file_name</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos"> 542</span></a>                <span class="n">paths_name</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos"> 543</span></a>                <span class="n">run_index</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos"> 544</span></a>                <span class="n">run_time</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_run_time</span><span class="p">,</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos"> 545</span></a>                <span class="n">run_dir</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos"> 546</span></a>            <span class="p">)</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos"> 547</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos"> 548</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_load_csvpath</span><span class="p">(</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos"> 549</span></a>                    <span class="n">csvpath</span><span class="o">=</span><span class="n">csvpath</span><span class="p">,</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos"> 550</span></a>                    <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos"> 551</span></a>                    <span class="n">file</span><span class="o">=</span><span class="n">file</span><span class="p">,</span>
</span><span id="L-552"><a href="#L-552"><span class="linenos"> 552</span></a>                    <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos"> 553</span></a>                    <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos"> 554</span></a>                    <span class="n">crt</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span>
</span><span id="L-555"><a href="#L-555"><span class="linenos"> 555</span></a>                <span class="p">)</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos"> 556</span></a>                <span class="c1">#</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos"> 557</span></a>                <span class="c1"># if run-mode: no-run we skip ahead without saving results</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos"> 558</span></a>                <span class="c1">#</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos"> 559</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">csvpath</span><span class="o">.</span><span class="n">will_run</span><span class="p">:</span>
</span><span id="L-560"><a href="#L-560"><span class="linenos"> 560</span></a>                    <span class="k">continue</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos"> 561</span></a>                <span class="c1">#</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos"> 562</span></a>                <span class="c1"># the add has to come after _load_csvpath because we need the identity or index</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos"> 563</span></a>                <span class="c1"># to be stable and the identity is found in load, if it exists.</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos"> 564</span></a>                <span class="c1">#</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos"> 565</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">add_named_result</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos"> 566</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos"> 567</span></a>                    <span class="s2">&quot;Parsed csvpath </span><span class="si">%s</span><span class="s2"> pointed at </span><span class="si">%s</span><span class="s2"> and starting to fast-forward&quot;</span><span class="p">,</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos"> 568</span></a>                    <span class="n">i</span><span class="p">,</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos"> 569</span></a>                    <span class="n">file</span><span class="p">,</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos"> 570</span></a>                <span class="p">)</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos"> 571</span></a>                <span class="n">csvpath</span><span class="o">.</span><span class="n">fast_forward</span><span class="p">()</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos"> 572</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="L-573"><a href="#L-573"><span class="linenos"> 573</span></a>                    <span class="s2">&quot;Completed fast forward of csvpath </span><span class="si">%s</span><span class="s2"> against </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">file</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos"> 574</span></a>                <span class="p">)</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos"> 575</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>  <span class="c1"># pylint: disable=W0718</span>
</span><span id="L-576"><a href="#L-576"><span class="linenos"> 576</span></a>                <span class="c1"># ex.trace = traceback.format_exc()</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos"> 577</span></a>                <span class="c1"># ex.source = self</span>
</span><span id="L-578"><a href="#L-578"><span class="linenos"> 578</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">error_manager</span><span class="o">.</span><span class="n">handle_error</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos"> 579</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ecoms</span><span class="o">.</span><span class="n">do_i_raise</span><span class="p">():</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos"> 580</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos"> 581</span></a>                    <span class="k">raise</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos"> 582</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="L-583"><a href="#L-583"><span class="linenos"> 583</span></a>            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos"> 584</span></a>        <span class="c1">#</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos"> 585</span></a>        <span class="c1"># run ends here</span>
</span><span id="L-586"><a href="#L-586"><span class="linenos"> 586</span></a>        <span class="c1">#</span>
</span><span id="L-587"><a href="#L-587"><span class="linenos"> 587</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">complete_run</span><span class="p">(</span>
</span><span id="L-588"><a href="#L-588"><span class="linenos"> 588</span></a>            <span class="n">run_dir</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span> <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span>
</span><span id="L-589"><a href="#L-589"><span class="linenos"> 589</span></a>        <span class="p">)</span>
</span><span id="L-590"><a href="#L-590"><span class="linenos"> 590</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clear_run_coordination</span><span class="p">()</span>
</span><span id="L-591"><a href="#L-591"><span class="linenos"> 591</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="L-592"><a href="#L-592"><span class="linenos"> 592</span></a>            <span class="s2">&quot;Completed fast_forward_paths </span><span class="si">%s</span><span class="s2"> with </span><span class="si">%s</span><span class="s2"> paths&quot;</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos"> 593</span></a>        <span class="p">)</span>
</span><span id="L-594"><a href="#L-594"><span class="linenos"> 594</span></a>
</span><span id="L-595"><a href="#L-595"><span class="linenos"> 595</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">next_paths</span><span class="p">(</span>
</span><span id="L-596"><a href="#L-596"><span class="linenos"> 596</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">collect</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-597"><a href="#L-597"><span class="linenos"> 597</span></a>    <span class="p">):</span>  <span class="c1"># pylint: disable=R0914</span>
</span><span id="L-598"><a href="#L-598"><span class="linenos"> 598</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;appends the Result for each CsvPath to the end of</span>
</span><span id="L-599"><a href="#L-599"><span class="linenos"> 599</span></a><span class="sd">        each line it produces. this is so that the caller can easily</span>
</span><span id="L-600"><a href="#L-600"><span class="linenos"> 600</span></a><span class="sd">        interrogate the CsvPath for its path parts, file, etc.&quot;&quot;&quot;</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos"> 601</span></a>        <span class="n">paths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">paths_manager</span><span class="o">.</span><span class="n">get_named_paths</span><span class="p">(</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="L-602"><a href="#L-602"><span class="linenos"> 602</span></a>        <span class="n">file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_manager</span><span class="o">.</span><span class="n">get_named_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span><span id="L-603"><a href="#L-603"><span class="linenos"> 603</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Prepping </span><span class="si">%s</span><span class="s2"> and </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">)</span>
</span><span id="L-604"><a href="#L-604"><span class="linenos"> 604</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clean</span><span class="p">(</span><span class="n">paths</span><span class="o">=</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="L-605"><a href="#L-605"><span class="linenos"> 605</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Beginning next_paths with </span><span class="si">%s</span><span class="s2"> paths&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">))</span>
</span><span id="L-606"><a href="#L-606"><span class="linenos"> 606</span></a>        <span class="n">crt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_time_str</span><span class="p">(</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="L-607"><a href="#L-607"><span class="linenos"> 607</span></a>        <span class="c1">#</span>
</span><span id="L-608"><a href="#L-608"><span class="linenos"> 608</span></a>        <span class="c1"># run starts here</span>
</span><span id="L-609"><a href="#L-609"><span class="linenos"> 609</span></a>        <span class="c1">#</span>
</span><span id="L-610"><a href="#L-610"><span class="linenos"> 610</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">start_run</span><span class="p">(</span>
</span><span id="L-611"><a href="#L-611"><span class="linenos"> 611</span></a>            <span class="n">run_dir</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span> <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span>
</span><span id="L-612"><a href="#L-612"><span class="linenos"> 612</span></a>        <span class="p">)</span>
</span><span id="L-613"><a href="#L-613"><span class="linenos"> 613</span></a>        <span class="c1">#</span>
</span><span id="L-614"><a href="#L-614"><span class="linenos"> 614</span></a>        <span class="c1">#</span>
</span><span id="L-615"><a href="#L-615"><span class="linenos"> 615</span></a>        <span class="c1">#</span>
</span><span id="L-616"><a href="#L-616"><span class="linenos"> 616</span></a>        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-617"><a href="#L-617"><span class="linenos"> 617</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">path</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">paths</span><span class="p">):</span>
</span><span id="L-618"><a href="#L-618"><span class="linenos"> 618</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_skip_all</span><span class="p">:</span>
</span><span id="L-619"><a href="#L-619"><span class="linenos"> 619</span></a>                <span class="n">skip_err</span> <span class="o">=</span> <span class="s2">&quot;Found the skip-all signal set. skip_all() is&quot;</span>
</span><span id="L-620"><a href="#L-620"><span class="linenos"> 620</span></a>                <span class="n">skip_err</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">skip_err</span><span class="si">}</span><span class="s2"> only for breadth-first runs using the&quot;</span>
</span><span id="L-621"><a href="#L-621"><span class="linenos"> 621</span></a>                <span class="n">skip_err</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">skip_err</span><span class="si">}</span><span class="s2"> &#39;_by_line&#39; methods. It has the same&quot;</span>
</span><span id="L-622"><a href="#L-622"><span class="linenos"> 622</span></a>                <span class="n">skip_err</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">skip_err</span><span class="si">}</span><span class="s2"> effect as skip() in a&quot;</span>
</span><span id="L-623"><a href="#L-623"><span class="linenos"> 623</span></a>                <span class="n">skip_err</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">skip_err</span><span class="si">}</span><span class="s2"> serial run like this one.&quot;</span>
</span><span id="L-624"><a href="#L-624"><span class="linenos"> 624</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">skip_err</span><span class="p">)</span>
</span><span id="L-625"><a href="#L-625"><span class="linenos"> 625</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stop_all</span><span class="p">:</span>
</span><span id="L-626"><a href="#L-626"><span class="linenos"> 626</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Stop-all set. Shutting down run.&quot;</span><span class="p">)</span>
</span><span id="L-627"><a href="#L-627"><span class="linenos"> 627</span></a>                <span class="k">break</span>
</span><span id="L-628"><a href="#L-628"><span class="linenos"> 628</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_advance_all</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-629"><a href="#L-629"><span class="linenos"> 629</span></a>                <span class="n">advance_err</span> <span class="o">=</span> <span class="s2">&quot;Found the advance-all signal set. advance_all() is&quot;</span>
</span><span id="L-630"><a href="#L-630"><span class="linenos"> 630</span></a>                <span class="n">advance_err</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">advance_err</span><span class="si">}</span><span class="s2"> only for breadth-first runs using the&quot;</span>
</span><span id="L-631"><a href="#L-631"><span class="linenos"> 631</span></a>                <span class="n">advance_err</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">advance_err</span><span class="si">}</span><span class="s2"> &#39;_by_line&#39; methods. It has the same&quot;</span>
</span><span id="L-632"><a href="#L-632"><span class="linenos"> 632</span></a>                <span class="n">advance_err</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">advance_err</span><span class="si">}</span><span class="s2"> effect as advance() in a&quot;</span>
</span><span id="L-633"><a href="#L-633"><span class="linenos"> 633</span></a>                <span class="n">advance_err</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">advance_err</span><span class="si">}</span><span class="s2"> serial run like this one.&quot;</span>
</span><span id="L-634"><a href="#L-634"><span class="linenos"> 634</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">advance_err</span><span class="p">)</span>
</span><span id="L-635"><a href="#L-635"><span class="linenos"> 635</span></a>            <span class="n">csvpath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">csvpath</span><span class="p">()</span>
</span><span id="L-636"><a href="#L-636"><span class="linenos"> 636</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">Result</span><span class="p">(</span>
</span><span id="L-637"><a href="#L-637"><span class="linenos"> 637</span></a>                <span class="n">csvpath</span><span class="o">=</span><span class="n">csvpath</span><span class="p">,</span>
</span><span id="L-638"><a href="#L-638"><span class="linenos"> 638</span></a>                <span class="n">file_name</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="L-639"><a href="#L-639"><span class="linenos"> 639</span></a>                <span class="n">paths_name</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="L-640"><a href="#L-640"><span class="linenos"> 640</span></a>                <span class="n">run_index</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>
</span><span id="L-641"><a href="#L-641"><span class="linenos"> 641</span></a>                <span class="n">run_time</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_run_time</span><span class="p">,</span>
</span><span id="L-642"><a href="#L-642"><span class="linenos"> 642</span></a>                <span class="n">run_dir</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span>
</span><span id="L-643"><a href="#L-643"><span class="linenos"> 643</span></a>            <span class="p">)</span>
</span><span id="L-644"><a href="#L-644"><span class="linenos"> 644</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fail_all</span><span class="p">:</span>
</span><span id="L-645"><a href="#L-645"><span class="linenos"> 645</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="L-646"><a href="#L-646"><span class="linenos"> 646</span></a>                    <span class="s2">&quot;Fail-all set. Failing all remaining CsvPath instances in the run.&quot;</span>
</span><span id="L-647"><a href="#L-647"><span class="linenos"> 647</span></a>                <span class="p">)</span>
</span><span id="L-648"><a href="#L-648"><span class="linenos"> 648</span></a>                <span class="n">csvpath</span><span class="o">.</span><span class="n">is_valid</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-649"><a href="#L-649"><span class="linenos"> 649</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="L-650"><a href="#L-650"><span class="linenos"> 650</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_load_csvpath</span><span class="p">(</span>
</span><span id="L-651"><a href="#L-651"><span class="linenos"> 651</span></a>                    <span class="n">csvpath</span><span class="o">=</span><span class="n">csvpath</span><span class="p">,</span>
</span><span id="L-652"><a href="#L-652"><span class="linenos"> 652</span></a>                    <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>
</span><span id="L-653"><a href="#L-653"><span class="linenos"> 653</span></a>                    <span class="n">file</span><span class="o">=</span><span class="n">file</span><span class="p">,</span>
</span><span id="L-654"><a href="#L-654"><span class="linenos"> 654</span></a>                    <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="L-655"><a href="#L-655"><span class="linenos"> 655</span></a>                    <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="L-656"><a href="#L-656"><span class="linenos"> 656</span></a>                    <span class="n">crt</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span>
</span><span id="L-657"><a href="#L-657"><span class="linenos"> 657</span></a>                <span class="p">)</span>
</span><span id="L-658"><a href="#L-658"><span class="linenos"> 658</span></a>                <span class="c1">#</span>
</span><span id="L-659"><a href="#L-659"><span class="linenos"> 659</span></a>                <span class="c1"># if run-mode: no-run we skip ahead without saving results</span>
</span><span id="L-660"><a href="#L-660"><span class="linenos"> 660</span></a>                <span class="c1">#</span>
</span><span id="L-661"><a href="#L-661"><span class="linenos"> 661</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">csvpath</span><span class="o">.</span><span class="n">will_run</span><span class="p">:</span>
</span><span id="L-662"><a href="#L-662"><span class="linenos"> 662</span></a>                    <span class="k">continue</span>
</span><span id="L-663"><a href="#L-663"><span class="linenos"> 663</span></a>                <span class="c1">#</span>
</span><span id="L-664"><a href="#L-664"><span class="linenos"> 664</span></a>                <span class="c1"># the add has to come after _load_csvpath because we need the identity or index</span>
</span><span id="L-665"><a href="#L-665"><span class="linenos"> 665</span></a>                <span class="c1"># to be stable and the identity is found in load, if it exists.</span>
</span><span id="L-666"><a href="#L-666"><span class="linenos"> 666</span></a>                <span class="c1">#</span>
</span><span id="L-667"><a href="#L-667"><span class="linenos"> 667</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">add_named_result</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="L-668"><a href="#L-668"><span class="linenos"> 668</span></a>                <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">csvpath</span><span class="o">.</span><span class="n">next</span><span class="p">():</span>
</span><span id="L-669"><a href="#L-669"><span class="linenos"> 669</span></a>                    <span class="c1">#</span>
</span><span id="L-670"><a href="#L-670"><span class="linenos"> 670</span></a>                    <span class="c1"># removed dec 1. why was this? it doesn&#39;t seem to make sense and</span>
</span><span id="L-671"><a href="#L-671"><span class="linenos"> 671</span></a>                    <span class="c1"># removing it doesn&#39;t break any unit tests. was it a mistake?</span>
</span><span id="L-672"><a href="#L-672"><span class="linenos"> 672</span></a>                    <span class="c1">#</span>
</span><span id="L-673"><a href="#L-673"><span class="linenos"> 673</span></a>                    <span class="c1"># line.append(result)</span>
</span><span id="L-674"><a href="#L-674"><span class="linenos"> 674</span></a>                    <span class="k">if</span> <span class="n">collect</span><span class="p">:</span>
</span><span id="L-675"><a href="#L-675"><span class="linenos"> 675</span></a>                        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="L-676"><a href="#L-676"><span class="linenos"> 676</span></a>                        <span class="n">result</span><span class="o">.</span><span class="n">unmatched</span> <span class="o">=</span> <span class="n">csvpath</span><span class="o">.</span><span class="n">unmatched</span>
</span><span id="L-677"><a href="#L-677"><span class="linenos"> 677</span></a>                    <span class="k">yield</span> <span class="n">line</span>
</span><span id="L-678"><a href="#L-678"><span class="linenos"> 678</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>  <span class="c1"># pylint: disable=W0718</span>
</span><span id="L-679"><a href="#L-679"><span class="linenos"> 679</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">error_manager</span><span class="o">.</span><span class="n">handle_error</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-680"><a href="#L-680"><span class="linenos"> 680</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ecoms</span><span class="o">.</span><span class="n">do_i_raise</span><span class="p">():</span>
</span><span id="L-681"><a href="#L-681"><span class="linenos"> 681</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="L-682"><a href="#L-682"><span class="linenos"> 682</span></a>                    <span class="k">raise</span>
</span><span id="L-683"><a href="#L-683"><span class="linenos"> 683</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="L-684"><a href="#L-684"><span class="linenos"> 684</span></a>            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="L-685"><a href="#L-685"><span class="linenos"> 685</span></a>        <span class="c1">#</span>
</span><span id="L-686"><a href="#L-686"><span class="linenos"> 686</span></a>        <span class="c1"># run ends here</span>
</span><span id="L-687"><a href="#L-687"><span class="linenos"> 687</span></a>        <span class="c1">#</span>
</span><span id="L-688"><a href="#L-688"><span class="linenos"> 688</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">complete_run</span><span class="p">(</span>
</span><span id="L-689"><a href="#L-689"><span class="linenos"> 689</span></a>            <span class="n">run_dir</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span> <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span>
</span><span id="L-690"><a href="#L-690"><span class="linenos"> 690</span></a>        <span class="p">)</span>
</span><span id="L-691"><a href="#L-691"><span class="linenos"> 691</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clear_run_coordination</span><span class="p">()</span>
</span><span id="L-692"><a href="#L-692"><span class="linenos"> 692</span></a>
</span><span id="L-693"><a href="#L-693"><span class="linenos"> 693</span></a>    <span class="c1"># =============== breadth first processing ================</span>
</span><span id="L-694"><a href="#L-694"><span class="linenos"> 694</span></a>
</span><span id="L-695"><a href="#L-695"><span class="linenos"> 695</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">collect_by_line</span><span class="p">(</span>
</span><span id="L-696"><a href="#L-696"><span class="linenos"> 696</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">if_all_agree</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">collect_when_not_matched</span><span class="o">=</span><span class="kc">False</span>
</span><span id="L-697"><a href="#L-697"><span class="linenos"> 697</span></a>    <span class="p">):</span>
</span><span id="L-698"><a href="#L-698"><span class="linenos"> 698</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="L-699"><a href="#L-699"><span class="linenos"> 699</span></a>            <span class="s2">&quot;Starting collect_by_line for paths: </span><span class="si">%s</span><span class="s2"> and file: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span>
</span><span id="L-700"><a href="#L-700"><span class="linenos"> 700</span></a>        <span class="p">)</span>
</span><span id="L-701"><a href="#L-701"><span class="linenos"> 701</span></a>        <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-702"><a href="#L-702"><span class="linenos"> 702</span></a>        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">next_by_line</span><span class="p">(</span>  <span class="c1"># pylint: disable=W0612</span>
</span><span id="L-703"><a href="#L-703"><span class="linenos"> 703</span></a>            <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="L-704"><a href="#L-704"><span class="linenos"> 704</span></a>            <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="L-705"><a href="#L-705"><span class="linenos"> 705</span></a>            <span class="n">collect</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-706"><a href="#L-706"><span class="linenos"> 706</span></a>            <span class="n">if_all_agree</span><span class="o">=</span><span class="n">if_all_agree</span><span class="p">,</span>
</span><span id="L-707"><a href="#L-707"><span class="linenos"> 707</span></a>            <span class="n">collect_when_not_matched</span><span class="o">=</span><span class="n">collect_when_not_matched</span><span class="p">,</span>
</span><span id="L-708"><a href="#L-708"><span class="linenos"> 708</span></a>        <span class="p">):</span>
</span><span id="L-709"><a href="#L-709"><span class="linenos"> 709</span></a>            <span class="c1"># re: W0612: we need &#39;line&#39; in order to do the iteration. we have to iterate.</span>
</span><span id="L-710"><a href="#L-710"><span class="linenos"> 710</span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="L-711"><a href="#L-711"><span class="linenos"> 711</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="L-712"><a href="#L-712"><span class="linenos"> 712</span></a>            <span class="s2">&quot;Completed collect_by_line for paths: </span><span class="si">%s</span><span class="s2"> and file: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span>
</span><span id="L-713"><a href="#L-713"><span class="linenos"> 713</span></a>        <span class="p">)</span>
</span><span id="L-714"><a href="#L-714"><span class="linenos"> 714</span></a>        <span class="c1">#</span>
</span><span id="L-715"><a href="#L-715"><span class="linenos"> 715</span></a>        <span class="c1"># the results have all the lines according to what CsvPath captured them, but</span>
</span><span id="L-716"><a href="#L-716"><span class="linenos"> 716</span></a>        <span class="c1"># since we&#39;re doing if_all_agree T/F we should return the union here. for some</span>
</span><span id="L-717"><a href="#L-717"><span class="linenos"> 717</span></a>        <span class="c1"># files this obviously makes the data in memory problem even bigger, but it&#39;s</span>
</span><span id="L-718"><a href="#L-718"><span class="linenos"> 718</span></a>        <span class="c1"># operator&#39;s responsibility to know if that will be a problem for their use</span>
</span><span id="L-719"><a href="#L-719"><span class="linenos"> 719</span></a>        <span class="c1"># case.</span>
</span><span id="L-720"><a href="#L-720"><span class="linenos"> 720</span></a>        <span class="c1">#</span>
</span><span id="L-721"><a href="#L-721"><span class="linenos"> 721</span></a>        <span class="k">return</span> <span class="n">lines</span>
</span><span id="L-722"><a href="#L-722"><span class="linenos"> 722</span></a>
</span><span id="L-723"><a href="#L-723"><span class="linenos"> 723</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fast_forward_by_line</span><span class="p">(</span>
</span><span id="L-724"><a href="#L-724"><span class="linenos"> 724</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">if_all_agree</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">collect_when_not_matched</span><span class="o">=</span><span class="kc">False</span>
</span><span id="L-725"><a href="#L-725"><span class="linenos"> 725</span></a>    <span class="p">):</span>
</span><span id="L-726"><a href="#L-726"><span class="linenos"> 726</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="L-727"><a href="#L-727"><span class="linenos"> 727</span></a>            <span class="s2">&quot;Starting fast_forward_by_line for paths: </span><span class="si">%s</span><span class="s2"> and file: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="L-728"><a href="#L-728"><span class="linenos"> 728</span></a>            <span class="n">pathsname</span><span class="p">,</span>
</span><span id="L-729"><a href="#L-729"><span class="linenos"> 729</span></a>            <span class="n">filename</span><span class="p">,</span>
</span><span id="L-730"><a href="#L-730"><span class="linenos"> 730</span></a>        <span class="p">)</span>
</span><span id="L-731"><a href="#L-731"><span class="linenos"> 731</span></a>        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">next_by_line</span><span class="p">(</span>  <span class="c1"># pylint: disable=W0612</span>
</span><span id="L-732"><a href="#L-732"><span class="linenos"> 732</span></a>            <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="L-733"><a href="#L-733"><span class="linenos"> 733</span></a>            <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="L-734"><a href="#L-734"><span class="linenos"> 734</span></a>            <span class="n">collect</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-735"><a href="#L-735"><span class="linenos"> 735</span></a>            <span class="n">if_all_agree</span><span class="o">=</span><span class="n">if_all_agree</span><span class="p">,</span>
</span><span id="L-736"><a href="#L-736"><span class="linenos"> 736</span></a>            <span class="n">collect_when_not_matched</span><span class="o">=</span><span class="n">collect_when_not_matched</span><span class="p">,</span>
</span><span id="L-737"><a href="#L-737"><span class="linenos"> 737</span></a>        <span class="p">):</span>
</span><span id="L-738"><a href="#L-738"><span class="linenos"> 738</span></a>            <span class="c1"># re: W0612: we need &#39;line&#39; in order to do the iteration. we have to iterate.</span>
</span><span id="L-739"><a href="#L-739"><span class="linenos"> 739</span></a>            <span class="k">pass</span>
</span><span id="L-740"><a href="#L-740"><span class="linenos"> 740</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="L-741"><a href="#L-741"><span class="linenos"> 741</span></a>            <span class="s2">&quot;Completed fast_forward_by_line for paths: </span><span class="si">%s</span><span class="s2"> and file: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="L-742"><a href="#L-742"><span class="linenos"> 742</span></a>            <span class="n">pathsname</span><span class="p">,</span>
</span><span id="L-743"><a href="#L-743"><span class="linenos"> 743</span></a>            <span class="n">filename</span><span class="p">,</span>
</span><span id="L-744"><a href="#L-744"><span class="linenos"> 744</span></a>        <span class="p">)</span>
</span><span id="L-745"><a href="#L-745"><span class="linenos"> 745</span></a>
</span><span id="L-746"><a href="#L-746"><span class="linenos"> 746</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">next_by_line</span><span class="p">(</span>  <span class="c1"># pylint: disable=R0912,R0915,R0914</span>
</span><span id="L-747"><a href="#L-747"><span class="linenos"> 747</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-748"><a href="#L-748"><span class="linenos"> 748</span></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="L-749"><a href="#L-749"><span class="linenos"> 749</span></a>        <span class="n">pathsname</span><span class="p">,</span>
</span><span id="L-750"><a href="#L-750"><span class="linenos"> 750</span></a>        <span class="n">filename</span><span class="p">,</span>
</span><span id="L-751"><a href="#L-751"><span class="linenos"> 751</span></a>        <span class="n">collect</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-752"><a href="#L-752"><span class="linenos"> 752</span></a>        <span class="n">if_all_agree</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-753"><a href="#L-753"><span class="linenos"> 753</span></a>        <span class="n">collect_when_not_matched</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-754"><a href="#L-754"><span class="linenos"> 754</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
</span><span id="L-755"><a href="#L-755"><span class="linenos"> 755</span></a>        <span class="c1"># re: R0912 -- absolutely. plan to refactor.</span>
</span><span id="L-756"><a href="#L-756"><span class="linenos"> 756</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Prepping </span><span class="si">%s</span><span class="s2"> and </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">)</span>
</span><span id="L-757"><a href="#L-757"><span class="linenos"> 757</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clean</span><span class="p">(</span><span class="n">paths</span><span class="o">=</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="L-758"><a href="#L-758"><span class="linenos"> 758</span></a>        <span class="n">fn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_manager</span><span class="o">.</span><span class="n">get_named_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span><span id="L-759"><a href="#L-759"><span class="linenos"> 759</span></a>        <span class="n">paths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">paths_manager</span><span class="o">.</span><span class="n">get_named_paths</span><span class="p">(</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="L-760"><a href="#L-760"><span class="linenos"> 760</span></a>        <span class="k">if</span> <span class="p">(</span>
</span><span id="L-761"><a href="#L-761"><span class="linenos"> 761</span></a>            <span class="n">paths</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">paths</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
</span><span id="L-762"><a href="#L-762"><span class="linenos"> 762</span></a>        <span class="p">):</span>  <span class="c1"># pragma: no cover</span>
</span><span id="L-763"><a href="#L-763"><span class="linenos"> 763</span></a>            <span class="k">raise</span> <span class="n">InputException</span><span class="p">(</span>
</span><span id="L-764"><a href="#L-764"><span class="linenos"> 764</span></a>                <span class="sa">f</span><span class="s2">&quot;Pathsname &#39;</span><span class="si">{</span><span class="n">pathsname</span><span class="si">}</span><span class="s2">&#39; must name a list of csvpaths&quot;</span>
</span><span id="L-765"><a href="#L-765"><span class="linenos"> 765</span></a>            <span class="p">)</span>
</span><span id="L-766"><a href="#L-766"><span class="linenos"> 766</span></a>        <span class="c1">#</span>
</span><span id="L-767"><a href="#L-767"><span class="linenos"> 767</span></a>        <span class="c1"># experiment!</span>
</span><span id="L-768"><a href="#L-768"><span class="linenos"> 768</span></a>        <span class="c1">#</span>
</span><span id="L-769"><a href="#L-769"><span class="linenos"> 769</span></a>        <span class="n">crt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_time_str</span><span class="p">(</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="L-770"><a href="#L-770"><span class="linenos"> 770</span></a>        <span class="c1">#</span>
</span><span id="L-771"><a href="#L-771"><span class="linenos"> 771</span></a>        <span class="c1"># also use of crt below</span>
</span><span id="L-772"><a href="#L-772"><span class="linenos"> 772</span></a>        <span class="c1">#</span>
</span><span id="L-773"><a href="#L-773"><span class="linenos"> 773</span></a>        <span class="n">csvpath_objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_csvpath_objects</span><span class="p">(</span>
</span><span id="L-774"><a href="#L-774"><span class="linenos"> 774</span></a>            <span class="n">paths</span><span class="o">=</span><span class="n">paths</span><span class="p">,</span>
</span><span id="L-775"><a href="#L-775"><span class="linenos"> 775</span></a>            <span class="n">named_file</span><span class="o">=</span><span class="n">fn</span><span class="p">,</span>
</span><span id="L-776"><a href="#L-776"><span class="linenos"> 776</span></a>            <span class="n">collect_when_not_matched</span><span class="o">=</span><span class="n">collect_when_not_matched</span><span class="p">,</span>
</span><span id="L-777"><a href="#L-777"><span class="linenos"> 777</span></a>            <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="L-778"><a href="#L-778"><span class="linenos"> 778</span></a>            <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="L-779"><a href="#L-779"><span class="linenos"> 779</span></a>            <span class="n">crt</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span>
</span><span id="L-780"><a href="#L-780"><span class="linenos"> 780</span></a>        <span class="p">)</span>
</span><span id="L-781"><a href="#L-781"><span class="linenos"> 781</span></a>        <span class="c1">#</span>
</span><span id="L-782"><a href="#L-782"><span class="linenos"> 782</span></a>        <span class="c1"># prep has to come after _load_csvpath_objects because we need the identity or</span>
</span><span id="L-783"><a href="#L-783"><span class="linenos"> 783</span></a>        <span class="c1"># indexes to be stable and the identity is found in the load, if it exists.</span>
</span><span id="L-784"><a href="#L-784"><span class="linenos"> 784</span></a>        <span class="c1">#</span>
</span><span id="L-785"><a href="#L-785"><span class="linenos"> 785</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_prep_csvpath_results</span><span class="p">(</span>
</span><span id="L-786"><a href="#L-786"><span class="linenos"> 786</span></a>            <span class="n">csvpath_objects</span><span class="o">=</span><span class="n">csvpath_objects</span><span class="p">,</span>
</span><span id="L-787"><a href="#L-787"><span class="linenos"> 787</span></a>            <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="L-788"><a href="#L-788"><span class="linenos"> 788</span></a>            <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="L-789"><a href="#L-789"><span class="linenos"> 789</span></a>            <span class="n">crt</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span>
</span><span id="L-790"><a href="#L-790"><span class="linenos"> 790</span></a>        <span class="p">)</span>
</span><span id="L-791"><a href="#L-791"><span class="linenos"> 791</span></a>        <span class="c1">#</span>
</span><span id="L-792"><a href="#L-792"><span class="linenos"> 792</span></a>        <span class="c1"># setting fn into the csvpath is less obviously useful at CsvPaths</span>
</span><span id="L-793"><a href="#L-793"><span class="linenos"> 793</span></a>        <span class="c1"># but we&#39;ll do it for consistency.</span>
</span><span id="L-794"><a href="#L-794"><span class="linenos"> 794</span></a>        <span class="c1">#</span>
</span><span id="L-795"><a href="#L-795"><span class="linenos"> 795</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Beginning next_by_line with </span><span class="si">%s</span><span class="s2"> paths&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">csvpath_objects</span><span class="p">))</span>
</span><span id="L-796"><a href="#L-796"><span class="linenos"> 796</span></a>        <span class="n">reader</span> <span class="o">=</span> <span class="n">FileManager</span><span class="o">.</span><span class="n">get_reader</span><span class="p">(</span>
</span><span id="L-797"><a href="#L-797"><span class="linenos"> 797</span></a>            <span class="n">fn</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">,</span> <span class="n">quotechar</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">quotechar</span>
</span><span id="L-798"><a href="#L-798"><span class="linenos"> 798</span></a>        <span class="p">)</span>
</span><span id="L-799"><a href="#L-799"><span class="linenos"> 799</span></a>        <span class="n">stopped_count</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-800"><a href="#L-800"><span class="linenos"> 800</span></a>        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">reader</span><span class="o">.</span><span class="n">next</span><span class="p">():</span>
</span><span id="L-801"><a href="#L-801"><span class="linenos"> 801</span></a>            <span class="c1"># for line in reader:  # pylint: disable=R1702</span>
</span><span id="L-802"><a href="#L-802"><span class="linenos"> 802</span></a>            <span class="c1"># question to self: should this default be in a central place</span>
</span><span id="L-803"><a href="#L-803"><span class="linenos"> 803</span></a>            <span class="c1"># so that we can switch to OR, in part by changing the default?</span>
</span><span id="L-804"><a href="#L-804"><span class="linenos"> 804</span></a>            <span class="n">keep</span> <span class="o">=</span> <span class="n">if_all_agree</span>
</span><span id="L-805"><a href="#L-805"><span class="linenos"> 805</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_skip_all</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-806"><a href="#L-806"><span class="linenos"> 806</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_advance_all</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-807"><a href="#L-807"><span class="linenos"> 807</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="L-808"><a href="#L-808"><span class="linenos"> 808</span></a>                <span class="c1"># p is a (CsvPath, List[List[str]]) where the second item is</span>
</span><span id="L-809"><a href="#L-809"><span class="linenos"> 809</span></a>                <span class="c1"># the line-by-line results of the first item&#39;s matching</span>
</span><span id="L-810"><a href="#L-810"><span class="linenos"> 810</span></a>                <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">csvpath_objects</span><span class="p">:</span>
</span><span id="L-811"><a href="#L-811"><span class="linenos"> 811</span></a>                    <span class="c1">#</span>
</span><span id="L-812"><a href="#L-812"><span class="linenos"> 812</span></a>                    <span class="c1"># if run-mode: no-run we skip ahead without saving results</span>
</span><span id="L-813"><a href="#L-813"><span class="linenos"> 813</span></a>                    <span class="c1">#</span>
</span><span id="L-814"><a href="#L-814"><span class="linenos"> 814</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">will_run</span><span class="p">:</span>
</span><span id="L-815"><a href="#L-815"><span class="linenos"> 815</span></a>                        <span class="k">continue</span>
</span><span id="L-816"><a href="#L-816"><span class="linenos"> 816</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-817"><a href="#L-817"><span class="linenos"> 817</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fail_all</span><span class="p">:</span>
</span><span id="L-818"><a href="#L-818"><span class="linenos"> 818</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="L-819"><a href="#L-819"><span class="linenos"> 819</span></a>                            <span class="s2">&quot;Fail-all set. Setting CsvPath is_valid to False.&quot;</span>
</span><span id="L-820"><a href="#L-820"><span class="linenos"> 820</span></a>                        <span class="p">)</span>
</span><span id="L-821"><a href="#L-821"><span class="linenos"> 821</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">is_valid</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-822"><a href="#L-822"><span class="linenos"> 822</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stop_all</span><span class="p">:</span>
</span><span id="L-823"><a href="#L-823"><span class="linenos"> 823</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Stop-all set. Shutting down run.&quot;</span><span class="p">)</span>
</span><span id="L-824"><a href="#L-824"><span class="linenos"> 824</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">stopped</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-825"><a href="#L-825"><span class="linenos"> 825</span></a>                        <span class="k">continue</span>
</span><span id="L-826"><a href="#L-826"><span class="linenos"> 826</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_skip_all</span><span class="p">:</span>
</span><span id="L-827"><a href="#L-827"><span class="linenos"> 827</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Skip-all set. Continuing to next.&quot;</span><span class="p">)</span>
</span><span id="L-828"><a href="#L-828"><span class="linenos"> 828</span></a>                        <span class="c1">#</span>
</span><span id="L-829"><a href="#L-829"><span class="linenos"> 829</span></a>                        <span class="c1"># all following CsvPaths must have their</span>
</span><span id="L-830"><a href="#L-830"><span class="linenos"> 830</span></a>                        <span class="c1"># line_monitors incremented</span>
</span><span id="L-831"><a href="#L-831"><span class="linenos"> 831</span></a>                        <span class="c1">#</span>
</span><span id="L-832"><a href="#L-832"><span class="linenos"> 832</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">track_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="L-833"><a href="#L-833"><span class="linenos"> 833</span></a>                        <span class="k">continue</span>
</span><span id="L-834"><a href="#L-834"><span class="linenos"> 834</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_advance_all</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-835"><a href="#L-835"><span class="linenos"> 835</span></a>                        <span class="n">logtxt</span> <span class="o">=</span> <span class="s2">&quot;Advance-all set. Setting advance. &quot;</span>
</span><span id="L-836"><a href="#L-836"><span class="linenos"> 836</span></a>                        <span class="n">logtxt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">logtxt</span><span class="si">}</span><span class="s2">CsvPath and its Matcher will handle the advancing.&quot;</span>
</span><span id="L-837"><a href="#L-837"><span class="linenos"> 837</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">logtxt</span><span class="p">)</span>
</span><span id="L-838"><a href="#L-838"><span class="linenos"> 838</span></a>                        <span class="c1">#</span>
</span><span id="L-839"><a href="#L-839"><span class="linenos"> 839</span></a>                        <span class="c1"># CsvPath will handle advancing so we don&#39;t need to do</span>
</span><span id="L-840"><a href="#L-840"><span class="linenos"> 840</span></a>                        <span class="c1"># anything, including track_line(line). we just need to</span>
</span><span id="L-841"><a href="#L-841"><span class="linenos"> 841</span></a>                        <span class="c1"># see if we&#39;re setting advance or increasing it.</span>
</span><span id="L-842"><a href="#L-842"><span class="linenos"> 842</span></a>                        <span class="c1">#</span>
</span><span id="L-843"><a href="#L-843"><span class="linenos"> 843</span></a>                        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">advance_count</span>
</span><span id="L-844"><a href="#L-844"><span class="linenos"> 844</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_advance_all</span> <span class="o">&gt;</span> <span class="n">a</span><span class="p">:</span>
</span><span id="L-845"><a href="#L-845"><span class="linenos"> 845</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">advance_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_advance_all</span>
</span><span id="L-846"><a href="#L-846"><span class="linenos"> 846</span></a>                        <span class="c1">#</span>
</span><span id="L-847"><a href="#L-847"><span class="linenos"> 847</span></a>                        <span class="c1"># all following CsvPaths must have their</span>
</span><span id="L-848"><a href="#L-848"><span class="linenos"> 848</span></a>                        <span class="c1"># advance incremented -- with the advance not being simply</span>
</span><span id="L-849"><a href="#L-849"><span class="linenos"> 849</span></a>                        <span class="c1"># additive, have to be mindful of any existing advance</span>
</span><span id="L-850"><a href="#L-850"><span class="linenos"> 850</span></a>                        <span class="c1"># count!</span>
</span><span id="L-851"><a href="#L-851"><span class="linenos"> 851</span></a>                        <span class="c1">#</span>
</span><span id="L-852"><a href="#L-852"><span class="linenos"> 852</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">stopped</span><span class="p">:</span>  <span class="c1"># pylint: disable=R1724</span>
</span><span id="L-853"><a href="#L-853"><span class="linenos"> 853</span></a>                        <span class="k">continue</span>
</span><span id="L-854"><a href="#L-854"><span class="linenos"> 854</span></a>
</span><span id="L-855"><a href="#L-855"><span class="linenos"> 855</span></a>                    <span class="c1">#</span>
</span><span id="L-856"><a href="#L-856"><span class="linenos"> 856</span></a>                    <span class="c1"># allowing the match to happen regardless of keep</span>
</span><span id="L-857"><a href="#L-857"><span class="linenos"> 857</span></a>                    <span class="c1"># because we may want side-effects or to have different</span>
</span><span id="L-858"><a href="#L-858"><span class="linenos"> 858</span></a>                    <span class="c1"># results in different named-results, as well as the</span>
</span><span id="L-859"><a href="#L-859"><span class="linenos"> 859</span></a>                    <span class="c1"># union</span>
</span><span id="L-860"><a href="#L-860"><span class="linenos"> 860</span></a>                    <span class="c1">#</span>
</span><span id="L-861"><a href="#L-861"><span class="linenos"> 861</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="L-862"><a href="#L-862"><span class="linenos"> 862</span></a>                        <span class="s2">&quot;considering line with csvpath identified as: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="L-863"><a href="#L-863"><span class="linenos"> 863</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">identity</span><span class="p">,</span>
</span><span id="L-864"><a href="#L-864"><span class="linenos"> 864</span></a>                    <span class="p">)</span>
</span><span id="L-865"><a href="#L-865"><span class="linenos"> 865</span></a>                    <span class="n">matched</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-866"><a href="#L-866"><span class="linenos"> 866</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">track_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="L-867"><a href="#L-867"><span class="linenos"> 867</span></a>                    <span class="c1">#</span>
</span><span id="L-868"><a href="#L-868"><span class="linenos"> 868</span></a>                    <span class="c1"># re: W0212: treating _consider_line something like package private</span>
</span><span id="L-869"><a href="#L-869"><span class="linenos"> 869</span></a>                    <span class="c1">#</span>
</span><span id="L-870"><a href="#L-870"><span class="linenos"> 870</span></a>                    <span class="n">matched</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-871"><a href="#L-871"><span class="linenos"> 871</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">_consider_line</span><span class="p">(</span>  <span class="c1"># pylint:disable=W0212</span>
</span><span id="L-872"><a href="#L-872"><span class="linenos"> 872</span></a>                            <span class="n">line</span>
</span><span id="L-873"><a href="#L-873"><span class="linenos"> 873</span></a>                        <span class="p">)</span>
</span><span id="L-874"><a href="#L-874"><span class="linenos"> 874</span></a>                    <span class="p">)</span>
</span><span id="L-875"><a href="#L-875"><span class="linenos"> 875</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">stopped</span><span class="p">:</span>
</span><span id="L-876"><a href="#L-876"><span class="linenos"> 876</span></a>                        <span class="n">stopped_count</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-877"><a href="#L-877"><span class="linenos"> 877</span></a>                    <span class="k">if</span> <span class="n">if_all_agree</span><span class="p">:</span>
</span><span id="L-878"><a href="#L-878"><span class="linenos"> 878</span></a>                        <span class="n">keep</span> <span class="o">=</span> <span class="n">keep</span> <span class="ow">and</span> <span class="n">matched</span>
</span><span id="L-879"><a href="#L-879"><span class="linenos"> 879</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="L-880"><a href="#L-880"><span class="linenos"> 880</span></a>                        <span class="n">keep</span> <span class="o">=</span> <span class="n">keep</span> <span class="ow">or</span> <span class="n">matched</span>
</span><span id="L-881"><a href="#L-881"><span class="linenos"> 881</span></a>                    <span class="c1">#</span>
</span><span id="L-882"><a href="#L-882"><span class="linenos"> 882</span></a>                    <span class="c1"># not doing continue if we have if_all_agree and not keep as we</span>
</span><span id="L-883"><a href="#L-883"><span class="linenos"> 883</span></a>                    <span class="c1"># used to do allows individual results to have lines that in</span>
</span><span id="L-884"><a href="#L-884"><span class="linenos"> 884</span></a>                    <span class="c1"># aggregate we do not keep.</span>
</span><span id="L-885"><a href="#L-885"><span class="linenos"> 885</span></a>                    <span class="c1">#</span>
</span><span id="L-886"><a href="#L-886"><span class="linenos"> 886</span></a>                    <span class="k">if</span> <span class="n">matched</span> <span class="ow">and</span> <span class="n">collect</span><span class="p">:</span>
</span><span id="L-887"><a href="#L-887"><span class="linenos"> 887</span></a>                        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">limit_collection</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="L-888"><a href="#L-888"><span class="linenos"> 888</span></a>                        <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="L-889"><a href="#L-889"><span class="linenos"> 889</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>  <span class="c1"># pylint: disable=W0718</span>
</span><span id="L-890"><a href="#L-890"><span class="linenos"> 890</span></a>                <span class="c1"># ex.trace = traceback.format_exc()</span>
</span><span id="L-891"><a href="#L-891"><span class="linenos"> 891</span></a>                <span class="c1"># ex.source = self</span>
</span><span id="L-892"><a href="#L-892"><span class="linenos"> 892</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">error_manager</span><span class="o">.</span><span class="n">handle_error</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-893"><a href="#L-893"><span class="linenos"> 893</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ecoms</span><span class="o">.</span><span class="n">do_i_raise</span><span class="p">():</span>
</span><span id="L-894"><a href="#L-894"><span class="linenos"> 894</span></a>                    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">csvpath_objects</span><span class="p">:</span>
</span><span id="L-895"><a href="#L-895"><span class="linenos"> 895</span></a>                        <span class="n">result</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-896"><a href="#L-896"><span class="linenos"> 896</span></a>                        <span class="n">result</span><span class="o">.</span><span class="n">unmatched</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">unmatched</span>
</span><span id="L-897"><a href="#L-897"><span class="linenos"> 897</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="L-898"><a href="#L-898"><span class="linenos"> 898</span></a>                    <span class="k">raise</span>
</span><span id="L-899"><a href="#L-899"><span class="linenos"> 899</span></a>            <span class="c1"># we yield even if we stopped in this iteration.</span>
</span><span id="L-900"><a href="#L-900"><span class="linenos"> 900</span></a>            <span class="c1"># caller needs to see what we stopped on.</span>
</span><span id="L-901"><a href="#L-901"><span class="linenos"> 901</span></a>            <span class="c1">#</span>
</span><span id="L-902"><a href="#L-902"><span class="linenos"> 902</span></a>            <span class="c1"># ! we only yield if keep is True</span>
</span><span id="L-903"><a href="#L-903"><span class="linenos"> 903</span></a>            <span class="c1">#</span>
</span><span id="L-904"><a href="#L-904"><span class="linenos"> 904</span></a>            <span class="k">if</span> <span class="n">keep</span><span class="p">:</span>
</span><span id="L-905"><a href="#L-905"><span class="linenos"> 905</span></a>                <span class="k">yield</span> <span class="n">line</span>
</span><span id="L-906"><a href="#L-906"><span class="linenos"> 906</span></a>            <span class="k">if</span> <span class="nb">sum</span><span class="p">(</span><span class="n">stopped_count</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">csvpath_objects</span><span class="p">):</span>
</span><span id="L-907"><a href="#L-907"><span class="linenos"> 907</span></a>                <span class="k">break</span>
</span><span id="L-908"><a href="#L-908"><span class="linenos"> 908</span></a>        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-909"><a href="#L-909"><span class="linenos"> 909</span></a>        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">csvpath_objects</span><span class="p">:</span>
</span><span id="L-910"><a href="#L-910"><span class="linenos"> 910</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-911"><a href="#L-911"><span class="linenos"> 911</span></a>            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="L-912"><a href="#L-912"><span class="linenos"> 912</span></a>            <span class="n">result</span><span class="o">.</span><span class="n">unmatched</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">unmatched</span>
</span><span id="L-913"><a href="#L-913"><span class="linenos"> 913</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="L-914"><a href="#L-914"><span class="linenos"> 914</span></a>
</span><span id="L-915"><a href="#L-915"><span class="linenos"> 915</span></a>        <span class="c1">#</span>
</span><span id="L-916"><a href="#L-916"><span class="linenos"> 916</span></a>        <span class="c1"># run ends here</span>
</span><span id="L-917"><a href="#L-917"><span class="linenos"> 917</span></a>        <span class="c1">#</span>
</span><span id="L-918"><a href="#L-918"><span class="linenos"> 918</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">complete_run</span><span class="p">(</span>
</span><span id="L-919"><a href="#L-919"><span class="linenos"> 919</span></a>            <span class="n">run_dir</span><span class="o">=</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">run_dir</span><span class="p">,</span> <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span>
</span><span id="L-920"><a href="#L-920"><span class="linenos"> 920</span></a>        <span class="p">)</span>
</span><span id="L-921"><a href="#L-921"><span class="linenos"> 921</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clear_run_coordination</span><span class="p">()</span>
</span><span id="L-922"><a href="#L-922"><span class="linenos"> 922</span></a>
</span><span id="L-923"><a href="#L-923"><span class="linenos"> 923</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_load_csvpath_objects</span><span class="p">(</span>
</span><span id="L-924"><a href="#L-924"><span class="linenos"> 924</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-925"><a href="#L-925"><span class="linenos"> 925</span></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="L-926"><a href="#L-926"><span class="linenos"> 926</span></a>        <span class="n">paths</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="L-927"><a href="#L-927"><span class="linenos"> 927</span></a>        <span class="n">named_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-928"><a href="#L-928"><span class="linenos"> 928</span></a>        <span class="n">collect_when_not_matched</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-929"><a href="#L-929"><span class="linenos"> 929</span></a>        <span class="n">filename</span><span class="p">,</span>
</span><span id="L-930"><a href="#L-930"><span class="linenos"> 930</span></a>        <span class="n">pathsname</span><span class="p">,</span>
</span><span id="L-931"><a href="#L-931"><span class="linenos"> 931</span></a>        <span class="n">crt</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-932"><a href="#L-932"><span class="linenos"> 932</span></a>    <span class="p">):</span>
</span><span id="L-933"><a href="#L-933"><span class="linenos"> 933</span></a>        <span class="n">csvpath_objects</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-934"><a href="#L-934"><span class="linenos"> 934</span></a>        <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">paths</span><span class="p">:</span>
</span><span id="L-935"><a href="#L-935"><span class="linenos"> 935</span></a>            <span class="n">csvpath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">csvpath</span><span class="p">()</span>
</span><span id="L-936"><a href="#L-936"><span class="linenos"> 936</span></a>            <span class="n">csvpath</span><span class="o">.</span><span class="n">collect_when_not_matched</span> <span class="o">=</span> <span class="n">collect_when_not_matched</span>
</span><span id="L-937"><a href="#L-937"><span class="linenos"> 937</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="L-938"><a href="#L-938"><span class="linenos"> 938</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_load_csvpath</span><span class="p">(</span>
</span><span id="L-939"><a href="#L-939"><span class="linenos"> 939</span></a>                    <span class="n">csvpath</span><span class="o">=</span><span class="n">csvpath</span><span class="p">,</span>
</span><span id="L-940"><a href="#L-940"><span class="linenos"> 940</span></a>                    <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>
</span><span id="L-941"><a href="#L-941"><span class="linenos"> 941</span></a>                    <span class="n">file</span><span class="o">=</span><span class="n">named_file</span><span class="p">,</span>
</span><span id="L-942"><a href="#L-942"><span class="linenos"> 942</span></a>                    <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="L-943"><a href="#L-943"><span class="linenos"> 943</span></a>                    <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="L-944"><a href="#L-944"><span class="linenos"> 944</span></a>                    <span class="n">by_line</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-945"><a href="#L-945"><span class="linenos"> 945</span></a>                    <span class="n">crt</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span>
</span><span id="L-946"><a href="#L-946"><span class="linenos"> 946</span></a>                <span class="p">)</span>
</span><span id="L-947"><a href="#L-947"><span class="linenos"> 947</span></a>                <span class="k">if</span> <span class="n">csvpath</span><span class="o">.</span><span class="n">data_from_preceding</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="L-948"><a href="#L-948"><span class="linenos"> 948</span></a>                    <span class="c1"># this exception raise may be redundant, but I&#39;m leaving it for now for good measure.</span>
</span><span id="L-949"><a href="#L-949"><span class="linenos"> 949</span></a>                    <span class="k">raise</span> <span class="n">CsvPathsException</span><span class="p">(</span>
</span><span id="L-950"><a href="#L-950"><span class="linenos"> 950</span></a>                        <span class="s2">&quot;Csvpath identified as </span><span class="si">{csvpath.identity}</span><span class="s2"> is set to use preceding data, but CsvPaths&#39;s by_line methods do not permit that&quot;</span>
</span><span id="L-951"><a href="#L-951"><span class="linenos"> 951</span></a>                    <span class="p">)</span>
</span><span id="L-952"><a href="#L-952"><span class="linenos"> 952</span></a>                <span class="n">csvpath_objects</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">csvpath</span><span class="p">,</span> <span class="p">[]])</span>
</span><span id="L-953"><a href="#L-953"><span class="linenos"> 953</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>  <span class="c1"># pylint: disable=W0718</span>
</span><span id="L-954"><a href="#L-954"><span class="linenos"> 954</span></a>                <span class="n">ex</span><span class="o">.</span><span class="n">trace</span> <span class="o">=</span> <span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">()</span>
</span><span id="L-955"><a href="#L-955"><span class="linenos"> 955</span></a>                <span class="n">ex</span><span class="o">.</span><span class="n">source</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="L-956"><a href="#L-956"><span class="linenos"> 956</span></a>                <span class="c1"># the error collector is the Results. it registers itself with</span>
</span><span id="L-957"><a href="#L-957"><span class="linenos"> 957</span></a>                <span class="c1"># the csvpath as the error collector. not as straightforward but</span>
</span><span id="L-958"><a href="#L-958"><span class="linenos"> 958</span></a>                <span class="c1"># effectively same as we do above</span>
</span><span id="L-959"><a href="#L-959"><span class="linenos"> 959</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">error_manager</span><span class="o">.</span><span class="n">handle_error</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-960"><a href="#L-960"><span class="linenos"> 960</span></a>        <span class="k">return</span> <span class="n">csvpath_objects</span>
</span><span id="L-961"><a href="#L-961"><span class="linenos"> 961</span></a>
</span><span id="L-962"><a href="#L-962"><span class="linenos"> 962</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_prep_csvpath_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">csvpath_objects</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">crt</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-963"><a href="#L-963"><span class="linenos"> 963</span></a>        <span class="c1">#</span>
</span><span id="L-964"><a href="#L-964"><span class="linenos"> 964</span></a>        <span class="c1"># run starts here</span>
</span><span id="L-965"><a href="#L-965"><span class="linenos"> 965</span></a>        <span class="c1">#</span>
</span><span id="L-966"><a href="#L-966"><span class="linenos"> 966</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">start_run</span><span class="p">(</span>
</span><span id="L-967"><a href="#L-967"><span class="linenos"> 967</span></a>            <span class="n">run_dir</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span> <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span>
</span><span id="L-968"><a href="#L-968"><span class="linenos"> 968</span></a>        <span class="p">)</span>
</span><span id="L-969"><a href="#L-969"><span class="linenos"> 969</span></a>        <span class="c1">#</span>
</span><span id="L-970"><a href="#L-970"><span class="linenos"> 970</span></a>        <span class="c1">#</span>
</span><span id="L-971"><a href="#L-971"><span class="linenos"> 971</span></a>        <span class="c1">#</span>
</span><span id="L-972"><a href="#L-972"><span class="linenos"> 972</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">csvpath</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">csvpath_objects</span><span class="p">):</span>
</span><span id="L-973"><a href="#L-973"><span class="linenos"> 973</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="L-974"><a href="#L-974"><span class="linenos"> 974</span></a>                <span class="c1">#</span>
</span><span id="L-975"><a href="#L-975"><span class="linenos"> 975</span></a>                <span class="c1"># Result will set itself into its CsvPath as error collector</span>
</span><span id="L-976"><a href="#L-976"><span class="linenos"> 976</span></a>                <span class="c1"># printer, etc.</span>
</span><span id="L-977"><a href="#L-977"><span class="linenos"> 977</span></a>                <span class="c1">#</span>
</span><span id="L-978"><a href="#L-978"><span class="linenos"> 978</span></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">Result</span><span class="p">(</span>
</span><span id="L-979"><a href="#L-979"><span class="linenos"> 979</span></a>                    <span class="n">csvpath</span><span class="o">=</span><span class="n">csvpath</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="L-980"><a href="#L-980"><span class="linenos"> 980</span></a>                    <span class="n">file_name</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="L-981"><a href="#L-981"><span class="linenos"> 981</span></a>                    <span class="n">paths_name</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="L-982"><a href="#L-982"><span class="linenos"> 982</span></a>                    <span class="n">lines</span><span class="o">=</span><span class="n">csvpath</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
</span><span id="L-983"><a href="#L-983"><span class="linenos"> 983</span></a>                    <span class="n">run_index</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>
</span><span id="L-984"><a href="#L-984"><span class="linenos"> 984</span></a>                    <span class="n">run_time</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_run_time</span><span class="p">,</span>
</span><span id="L-985"><a href="#L-985"><span class="linenos"> 985</span></a>                    <span class="n">run_dir</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span>
</span><span id="L-986"><a href="#L-986"><span class="linenos"> 986</span></a>                    <span class="n">by_line</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-987"><a href="#L-987"><span class="linenos"> 987</span></a>                <span class="p">)</span>
</span><span id="L-988"><a href="#L-988"><span class="linenos"> 988</span></a>                <span class="n">csvpath</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span>
</span><span id="L-989"><a href="#L-989"><span class="linenos"> 989</span></a>                <span class="c1">#</span>
</span><span id="L-990"><a href="#L-990"><span class="linenos"> 990</span></a>                <span class="c1"># the add has to come after _load_csvpath because we need the identity or index</span>
</span><span id="L-991"><a href="#L-991"><span class="linenos"> 991</span></a>                <span class="c1"># to be stable and the identity is found in load, if it exists.</span>
</span><span id="L-992"><a href="#L-992"><span class="linenos"> 992</span></a>                <span class="c1">#</span>
</span><span id="L-993"><a href="#L-993"><span class="linenos"> 993</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">add_named_result</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="L-994"><a href="#L-994"><span class="linenos"> 994</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>  <span class="c1"># pylint: disable=W0718</span>
</span><span id="L-995"><a href="#L-995"><span class="linenos"> 995</span></a><span class="w">                </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-996"><a href="#L-996"><span class="linenos"> 996</span></a><span class="sd">                ex.trace = traceback.format_exc()</span>
</span><span id="L-997"><a href="#L-997"><span class="linenos"> 997</span></a><span class="sd">                ex.source = self</span>
</span><span id="L-998"><a href="#L-998"><span class="linenos"> 998</span></a><span class="sd">                ErrorHandler(csvpaths=self, error_collector=csvpath).handle_error(ex)</span>
</span><span id="L-999"><a href="#L-999"><span class="linenos"> 999</span></a><span class="sd">                &quot;&quot;&quot;</span>
</span><span id="L-1000"><a href="#L-1000"><span class="linenos">1000</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">error_manager</span><span class="o">.</span><span class="n">handle_error</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-1001"><a href="#L-1001"><span class="linenos">1001</span></a>                <span class="c1">#</span>
</span><span id="L-1002"><a href="#L-1002"><span class="linenos">1002</span></a>                <span class="c1"># keep this comment for modelines avoidance</span>
</span><span id="L-1003"><a href="#L-1003"><span class="linenos">1003</span></a>                <span class="c1">#</span>
</span></pre></div>


            </section>
                <section id="CsvPathsPublic">
                            <input id="CsvPathsPublic-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">CsvPathsPublic</span><wbr>(<span class="base">abc.ABC</span>):

                <label class="view-source-button" for="CsvPathsPublic-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPathsPublic"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPathsPublic-24"><a href="#CsvPathsPublic-24"><span class="linenos">24</span></a><span class="k">class</span><span class="w"> </span><span class="nc">CsvPathsPublic</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="CsvPathsPublic-25"><a href="#CsvPathsPublic-25"><span class="linenos">25</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;this abstract class is the public interface for CsvPaths.</span>
</span><span id="CsvPathsPublic-26"><a href="#CsvPathsPublic-26"><span class="linenos">26</span></a>
</span><span id="CsvPathsPublic-27"><a href="#CsvPathsPublic-27"><span class="linenos">27</span></a><span class="sd">    a CsvPaths instance manages applying any number of csvpaths</span>
</span><span id="CsvPathsPublic-28"><a href="#CsvPathsPublic-28"><span class="linenos">28</span></a><span class="sd">    to any number of files. CsvPaths applies sets of csvpaths</span>
</span><span id="CsvPathsPublic-29"><a href="#CsvPathsPublic-29"><span class="linenos">29</span></a><span class="sd">    to a given file, on demand. Think of CsvPaths as a session</span>
</span><span id="CsvPathsPublic-30"><a href="#CsvPathsPublic-30"><span class="linenos">30</span></a><span class="sd">    object. It gives you a way to manage files, csvpaths, and</span>
</span><span id="CsvPathsPublic-31"><a href="#CsvPathsPublic-31"><span class="linenos">31</span></a><span class="sd">    the results generated by applying paths to files. It is not</span>
</span><span id="CsvPathsPublic-32"><a href="#CsvPathsPublic-32"><span class="linenos">32</span></a><span class="sd">    intended for concurrent use. If you need multiple threads,</span>
</span><span id="CsvPathsPublic-33"><a href="#CsvPathsPublic-33"><span class="linenos">33</span></a><span class="sd">    create multiple CsvPaths instances.</span>
</span><span id="CsvPathsPublic-34"><a href="#CsvPathsPublic-34"><span class="linenos">34</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="CsvPathsPublic-35"><a href="#CsvPathsPublic-35"><span class="linenos">35</span></a>
</span><span id="CsvPathsPublic-36"><a href="#CsvPathsPublic-36"><span class="linenos">36</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="CsvPathsPublic-37"><a href="#CsvPathsPublic-37"><span class="linenos">37</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">csvpath</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CsvPath</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
</span><span id="CsvPathsPublic-38"><a href="#CsvPathsPublic-38"><span class="linenos">38</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets a CsvPath object primed with a reference to this CsvPaths&quot;&quot;&quot;</span>
</span><span id="CsvPathsPublic-39"><a href="#CsvPathsPublic-39"><span class="linenos">39</span></a>
</span><span id="CsvPathsPublic-40"><a href="#CsvPathsPublic-40"><span class="linenos">40</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="CsvPathsPublic-41"><a href="#CsvPathsPublic-41"><span class="linenos">41</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">collect_paths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
</span><span id="CsvPathsPublic-42"><a href="#CsvPathsPublic-42"><span class="linenos">42</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CsvPathsPublic-43"><a href="#CsvPathsPublic-43"><span class="linenos">43</span></a><span class="sd">        Sequentially does a CsvPath.collect() on filename for every named path. lines are collected into results.&quot;&quot;&quot;</span>
</span><span id="CsvPathsPublic-44"><a href="#CsvPathsPublic-44"><span class="linenos">44</span></a>
</span><span id="CsvPathsPublic-45"><a href="#CsvPathsPublic-45"><span class="linenos">45</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="CsvPathsPublic-46"><a href="#CsvPathsPublic-46"><span class="linenos">46</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fast_forward_paths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
</span><span id="CsvPathsPublic-47"><a href="#CsvPathsPublic-47"><span class="linenos">47</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Sequentially does a CsvPath.fast_forward() on filename for every named path&quot;&quot;&quot;</span>
</span><span id="CsvPathsPublic-48"><a href="#CsvPathsPublic-48"><span class="linenos">48</span></a>
</span><span id="CsvPathsPublic-49"><a href="#CsvPathsPublic-49"><span class="linenos">49</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="CsvPathsPublic-50"><a href="#CsvPathsPublic-50"><span class="linenos">50</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">next_paths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
</span><span id="CsvPathsPublic-51"><a href="#CsvPathsPublic-51"><span class="linenos">51</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Does a CsvPath.next() on filename for every line against every named path in sequence&quot;&quot;&quot;</span>
</span><span id="CsvPathsPublic-52"><a href="#CsvPathsPublic-52"><span class="linenos">52</span></a>
</span><span id="CsvPathsPublic-53"><a href="#CsvPathsPublic-53"><span class="linenos">53</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="CsvPathsPublic-54"><a href="#CsvPathsPublic-54"><span class="linenos">54</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">collect_by_line</span><span class="p">(</span>
</span><span id="CsvPathsPublic-55"><a href="#CsvPathsPublic-55"><span class="linenos">55</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">if_all_agree</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">collect_when_not_matched</span><span class="o">=</span><span class="kc">False</span>
</span><span id="CsvPathsPublic-56"><a href="#CsvPathsPublic-56"><span class="linenos">56</span></a>    <span class="p">):</span>  <span class="c1"># pragma: no cover</span>
</span><span id="CsvPathsPublic-57"><a href="#CsvPathsPublic-57"><span class="linenos">57</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Does a CsvPath.collect() on filename where each row is considered</span>
</span><span id="CsvPathsPublic-58"><a href="#CsvPathsPublic-58"><span class="linenos">58</span></a><span class="sd">        by every named path before the next row starts</span>
</span><span id="CsvPathsPublic-59"><a href="#CsvPathsPublic-59"><span class="linenos">59</span></a>
</span><span id="CsvPathsPublic-60"><a href="#CsvPathsPublic-60"><span class="linenos">60</span></a><span class="sd">        next_by_line for if_all_agree and collect_when_not_matched.</span>
</span><span id="CsvPathsPublic-61"><a href="#CsvPathsPublic-61"><span class="linenos">61</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CsvPathsPublic-62"><a href="#CsvPathsPublic-62"><span class="linenos">62</span></a>
</span><span id="CsvPathsPublic-63"><a href="#CsvPathsPublic-63"><span class="linenos">63</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="CsvPathsPublic-64"><a href="#CsvPathsPublic-64"><span class="linenos">64</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fast_forward_by_line</span><span class="p">(</span>
</span><span id="CsvPathsPublic-65"><a href="#CsvPathsPublic-65"><span class="linenos">65</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">if_all_agree</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">collect_when_not_matched</span><span class="o">=</span><span class="kc">False</span>
</span><span id="CsvPathsPublic-66"><a href="#CsvPathsPublic-66"><span class="linenos">66</span></a>    <span class="p">):</span>  <span class="c1"># pragma: no cover</span>
</span><span id="CsvPathsPublic-67"><a href="#CsvPathsPublic-67"><span class="linenos">67</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Does a CsvPath.fast_forward() on filename where each row is</span>
</span><span id="CsvPathsPublic-68"><a href="#CsvPathsPublic-68"><span class="linenos">68</span></a><span class="sd">        considered by every named path before the next row starts</span>
</span><span id="CsvPathsPublic-69"><a href="#CsvPathsPublic-69"><span class="linenos">69</span></a>
</span><span id="CsvPathsPublic-70"><a href="#CsvPathsPublic-70"><span class="linenos">70</span></a><span class="sd">        next_by_line for if_all_agree and collect_when_not_matched.</span>
</span><span id="CsvPathsPublic-71"><a href="#CsvPathsPublic-71"><span class="linenos">71</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CsvPathsPublic-72"><a href="#CsvPathsPublic-72"><span class="linenos">72</span></a>
</span><span id="CsvPathsPublic-73"><a href="#CsvPathsPublic-73"><span class="linenos">73</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="CsvPathsPublic-74"><a href="#CsvPathsPublic-74"><span class="linenos">74</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">next_by_line</span><span class="p">(</span>
</span><span id="CsvPathsPublic-75"><a href="#CsvPathsPublic-75"><span class="linenos">75</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="CsvPathsPublic-76"><a href="#CsvPathsPublic-76"><span class="linenos">76</span></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="CsvPathsPublic-77"><a href="#CsvPathsPublic-77"><span class="linenos">77</span></a>        <span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPathsPublic-78"><a href="#CsvPathsPublic-78"><span class="linenos">78</span></a>        <span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPathsPublic-79"><a href="#CsvPathsPublic-79"><span class="linenos">79</span></a>        <span class="n">collect</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="CsvPathsPublic-80"><a href="#CsvPathsPublic-80"><span class="linenos">80</span></a>        <span class="n">if_all_agree</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="CsvPathsPublic-81"><a href="#CsvPathsPublic-81"><span class="linenos">81</span></a>        <span class="n">collect_when_not_matched</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="CsvPathsPublic-82"><a href="#CsvPathsPublic-82"><span class="linenos">82</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>  <span class="c1"># pragma: no cover</span>
</span><span id="CsvPathsPublic-83"><a href="#CsvPathsPublic-83"><span class="linenos">83</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Does a CsvPath.next() on filename where each row is considered</span>
</span><span id="CsvPathsPublic-84"><a href="#CsvPathsPublic-84"><span class="linenos">84</span></a><span class="sd">        by every named path before the next row starts.</span>
</span><span id="CsvPathsPublic-85"><a href="#CsvPathsPublic-85"><span class="linenos">85</span></a>
</span><span id="CsvPathsPublic-86"><a href="#CsvPathsPublic-86"><span class="linenos">86</span></a><span class="sd">        if_all_agree=True means all the CsvPath instances must match for</span>
</span><span id="CsvPathsPublic-87"><a href="#CsvPathsPublic-87"><span class="linenos">87</span></a><span class="sd">        the line to be kept. However, every CsvPath instance will keep its</span>
</span><span id="CsvPathsPublic-88"><a href="#CsvPathsPublic-88"><span class="linenos">88</span></a><span class="sd">        own matches in its results regardless of if every line kept was</span>
</span><span id="CsvPathsPublic-89"><a href="#CsvPathsPublic-89"><span class="linenos">89</span></a><span class="sd">        returned to the caller by CsvPaths.</span>
</span><span id="CsvPathsPublic-90"><a href="#CsvPathsPublic-90"><span class="linenos">90</span></a>
</span><span id="CsvPathsPublic-91"><a href="#CsvPathsPublic-91"><span class="linenos">91</span></a><span class="sd">        collect_when_not_matched=True inverts the match so that lines</span>
</span><span id="CsvPathsPublic-92"><a href="#CsvPathsPublic-92"><span class="linenos">92</span></a><span class="sd">        which did not match are returned, rather than the default behavior.</span>
</span><span id="CsvPathsPublic-93"><a href="#CsvPathsPublic-93"><span class="linenos">93</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span></pre></div>


            <div class="docstring"><p>this abstract class is the public interface for CsvPaths.</p>

<p>a CsvPaths instance manages applying any number of csvpaths
to any number of files. CsvPaths applies sets of csvpaths
to a given file, on demand. Think of CsvPaths as a session
object. It gives you a way to manage files, csvpaths, and
the results generated by applying paths to files. It is not
intended for concurrent use. If you need multiple threads,
create multiple CsvPaths instances.</p>
</div>


                            <div id="CsvPathsPublic.csvpath" class="classattr">
                                        <input id="CsvPathsPublic.csvpath-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-abstractmethod">@abstractmethod</div>

        <span class="def">def</span>
        <span class="name">csvpath</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">csvpath</span><span class="o">.</span><span class="n">csvpath</span><span class="o">.</span><span class="n">CsvPath</span>:</span></span>

                <label class="view-source-button" for="CsvPathsPublic.csvpath-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPathsPublic.csvpath"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPathsPublic.csvpath-36"><a href="#CsvPathsPublic.csvpath-36"><span class="linenos">36</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="CsvPathsPublic.csvpath-37"><a href="#CsvPathsPublic.csvpath-37"><span class="linenos">37</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">csvpath</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CsvPath</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
</span><span id="CsvPathsPublic.csvpath-38"><a href="#CsvPathsPublic.csvpath-38"><span class="linenos">38</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets a CsvPath object primed with a reference to this CsvPaths&quot;&quot;&quot;</span>
</span></pre></div>


            <div class="docstring"><p>Gets a CsvPath object primed with a reference to this CsvPaths</p>
</div>


                            </div>
                            <div id="CsvPathsPublic.collect_paths" class="classattr">
                                        <input id="CsvPathsPublic.collect_paths-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-abstractmethod">@abstractmethod</div>

        <span class="def">def</span>
        <span class="name">collect_paths</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span>, </span><span class="param"><span class="n">pathsname</span>, </span><span class="param"><span class="n">filename</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="CsvPathsPublic.collect_paths-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPathsPublic.collect_paths"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPathsPublic.collect_paths-40"><a href="#CsvPathsPublic.collect_paths-40"><span class="linenos">40</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="CsvPathsPublic.collect_paths-41"><a href="#CsvPathsPublic.collect_paths-41"><span class="linenos">41</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">collect_paths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
</span><span id="CsvPathsPublic.collect_paths-42"><a href="#CsvPathsPublic.collect_paths-42"><span class="linenos">42</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CsvPathsPublic.collect_paths-43"><a href="#CsvPathsPublic.collect_paths-43"><span class="linenos">43</span></a><span class="sd">        Sequentially does a CsvPath.collect() on filename for every named path. lines are collected into results.&quot;&quot;&quot;</span>
</span></pre></div>


            <div class="docstring"><p>Sequentially does a CsvPath.collect() on filename for every named path. lines are collected into results.</p>
</div>


                            </div>
                            <div id="CsvPathsPublic.fast_forward_paths" class="classattr">
                                        <input id="CsvPathsPublic.fast_forward_paths-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-abstractmethod">@abstractmethod</div>

        <span class="def">def</span>
        <span class="name">fast_forward_paths</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span>, </span><span class="param"><span class="n">pathsname</span>, </span><span class="param"><span class="n">filename</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="CsvPathsPublic.fast_forward_paths-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPathsPublic.fast_forward_paths"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPathsPublic.fast_forward_paths-45"><a href="#CsvPathsPublic.fast_forward_paths-45"><span class="linenos">45</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="CsvPathsPublic.fast_forward_paths-46"><a href="#CsvPathsPublic.fast_forward_paths-46"><span class="linenos">46</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fast_forward_paths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
</span><span id="CsvPathsPublic.fast_forward_paths-47"><a href="#CsvPathsPublic.fast_forward_paths-47"><span class="linenos">47</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Sequentially does a CsvPath.fast_forward() on filename for every named path&quot;&quot;&quot;</span>
</span></pre></div>


            <div class="docstring"><p>Sequentially does a CsvPath.fast_forward() on filename for every named path</p>
</div>


                            </div>
                            <div id="CsvPathsPublic.next_paths" class="classattr">
                                        <input id="CsvPathsPublic.next_paths-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-abstractmethod">@abstractmethod</div>

        <span class="def">def</span>
        <span class="name">next_paths</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span>, </span><span class="param"><span class="n">pathsname</span>, </span><span class="param"><span class="n">filename</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="CsvPathsPublic.next_paths-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPathsPublic.next_paths"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPathsPublic.next_paths-49"><a href="#CsvPathsPublic.next_paths-49"><span class="linenos">49</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="CsvPathsPublic.next_paths-50"><a href="#CsvPathsPublic.next_paths-50"><span class="linenos">50</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">next_paths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
</span><span id="CsvPathsPublic.next_paths-51"><a href="#CsvPathsPublic.next_paths-51"><span class="linenos">51</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Does a CsvPath.next() on filename for every line against every named path in sequence&quot;&quot;&quot;</span>
</span></pre></div>


            <div class="docstring"><p>Does a CsvPath.next() on filename for every line against every named path in sequence</p>
</div>


                            </div>
                            <div id="CsvPathsPublic.collect_by_line" class="classattr">
                                        <input id="CsvPathsPublic.collect_by_line-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-abstractmethod">@abstractmethod</div>

        <span class="def">def</span>
        <span class="name">collect_by_line</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">pathsname</span>,</span><span class="param">	<span class="n">filename</span>,</span><span class="param">	<span class="n">if_all_agree</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">collect_when_not_matched</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="CsvPathsPublic.collect_by_line-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPathsPublic.collect_by_line"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPathsPublic.collect_by_line-53"><a href="#CsvPathsPublic.collect_by_line-53"><span class="linenos">53</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="CsvPathsPublic.collect_by_line-54"><a href="#CsvPathsPublic.collect_by_line-54"><span class="linenos">54</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">collect_by_line</span><span class="p">(</span>
</span><span id="CsvPathsPublic.collect_by_line-55"><a href="#CsvPathsPublic.collect_by_line-55"><span class="linenos">55</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">if_all_agree</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">collect_when_not_matched</span><span class="o">=</span><span class="kc">False</span>
</span><span id="CsvPathsPublic.collect_by_line-56"><a href="#CsvPathsPublic.collect_by_line-56"><span class="linenos">56</span></a>    <span class="p">):</span>  <span class="c1"># pragma: no cover</span>
</span><span id="CsvPathsPublic.collect_by_line-57"><a href="#CsvPathsPublic.collect_by_line-57"><span class="linenos">57</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Does a CsvPath.collect() on filename where each row is considered</span>
</span><span id="CsvPathsPublic.collect_by_line-58"><a href="#CsvPathsPublic.collect_by_line-58"><span class="linenos">58</span></a><span class="sd">        by every named path before the next row starts</span>
</span><span id="CsvPathsPublic.collect_by_line-59"><a href="#CsvPathsPublic.collect_by_line-59"><span class="linenos">59</span></a>
</span><span id="CsvPathsPublic.collect_by_line-60"><a href="#CsvPathsPublic.collect_by_line-60"><span class="linenos">60</span></a><span class="sd">        next_by_line for if_all_agree and collect_when_not_matched.</span>
</span><span id="CsvPathsPublic.collect_by_line-61"><a href="#CsvPathsPublic.collect_by_line-61"><span class="linenos">61</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span></pre></div>


            <div class="docstring"><p>Does a CsvPath.collect() on filename where each row is considered
by every named path before the next row starts</p>

<p>next_by_line for if_all_agree and collect_when_not_matched.</p>
</div>


                            </div>
                            <div id="CsvPathsPublic.fast_forward_by_line" class="classattr">
                                        <input id="CsvPathsPublic.fast_forward_by_line-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-abstractmethod">@abstractmethod</div>

        <span class="def">def</span>
        <span class="name">fast_forward_by_line</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">pathsname</span>,</span><span class="param">	<span class="n">filename</span>,</span><span class="param">	<span class="n">if_all_agree</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">collect_when_not_matched</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="CsvPathsPublic.fast_forward_by_line-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPathsPublic.fast_forward_by_line"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPathsPublic.fast_forward_by_line-63"><a href="#CsvPathsPublic.fast_forward_by_line-63"><span class="linenos">63</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="CsvPathsPublic.fast_forward_by_line-64"><a href="#CsvPathsPublic.fast_forward_by_line-64"><span class="linenos">64</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fast_forward_by_line</span><span class="p">(</span>
</span><span id="CsvPathsPublic.fast_forward_by_line-65"><a href="#CsvPathsPublic.fast_forward_by_line-65"><span class="linenos">65</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">if_all_agree</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">collect_when_not_matched</span><span class="o">=</span><span class="kc">False</span>
</span><span id="CsvPathsPublic.fast_forward_by_line-66"><a href="#CsvPathsPublic.fast_forward_by_line-66"><span class="linenos">66</span></a>    <span class="p">):</span>  <span class="c1"># pragma: no cover</span>
</span><span id="CsvPathsPublic.fast_forward_by_line-67"><a href="#CsvPathsPublic.fast_forward_by_line-67"><span class="linenos">67</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Does a CsvPath.fast_forward() on filename where each row is</span>
</span><span id="CsvPathsPublic.fast_forward_by_line-68"><a href="#CsvPathsPublic.fast_forward_by_line-68"><span class="linenos">68</span></a><span class="sd">        considered by every named path before the next row starts</span>
</span><span id="CsvPathsPublic.fast_forward_by_line-69"><a href="#CsvPathsPublic.fast_forward_by_line-69"><span class="linenos">69</span></a>
</span><span id="CsvPathsPublic.fast_forward_by_line-70"><a href="#CsvPathsPublic.fast_forward_by_line-70"><span class="linenos">70</span></a><span class="sd">        next_by_line for if_all_agree and collect_when_not_matched.</span>
</span><span id="CsvPathsPublic.fast_forward_by_line-71"><a href="#CsvPathsPublic.fast_forward_by_line-71"><span class="linenos">71</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span></pre></div>


            <div class="docstring"><p>Does a CsvPath.fast_forward() on filename where each row is
considered by every named path before the next row starts</p>

<p>next_by_line for if_all_agree and collect_when_not_matched.</p>
</div>


                            </div>
                            <div id="CsvPathsPublic.next_by_line" class="classattr">
                                        <input id="CsvPathsPublic.next_by_line-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-abstractmethod">@abstractmethod</div>

        <span class="def">def</span>
        <span class="name">next_by_line</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">pathsname</span>,</span><span class="param">	<span class="n">filename</span>,</span><span class="param">	<span class="n">collect</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">if_all_agree</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">collect_when_not_matched</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">) -> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="CsvPathsPublic.next_by_line-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPathsPublic.next_by_line"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPathsPublic.next_by_line-73"><a href="#CsvPathsPublic.next_by_line-73"><span class="linenos">73</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="CsvPathsPublic.next_by_line-74"><a href="#CsvPathsPublic.next_by_line-74"><span class="linenos">74</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">next_by_line</span><span class="p">(</span>
</span><span id="CsvPathsPublic.next_by_line-75"><a href="#CsvPathsPublic.next_by_line-75"><span class="linenos">75</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="CsvPathsPublic.next_by_line-76"><a href="#CsvPathsPublic.next_by_line-76"><span class="linenos">76</span></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="CsvPathsPublic.next_by_line-77"><a href="#CsvPathsPublic.next_by_line-77"><span class="linenos">77</span></a>        <span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPathsPublic.next_by_line-78"><a href="#CsvPathsPublic.next_by_line-78"><span class="linenos">78</span></a>        <span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPathsPublic.next_by_line-79"><a href="#CsvPathsPublic.next_by_line-79"><span class="linenos">79</span></a>        <span class="n">collect</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="CsvPathsPublic.next_by_line-80"><a href="#CsvPathsPublic.next_by_line-80"><span class="linenos">80</span></a>        <span class="n">if_all_agree</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="CsvPathsPublic.next_by_line-81"><a href="#CsvPathsPublic.next_by_line-81"><span class="linenos">81</span></a>        <span class="n">collect_when_not_matched</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="CsvPathsPublic.next_by_line-82"><a href="#CsvPathsPublic.next_by_line-82"><span class="linenos">82</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>  <span class="c1"># pragma: no cover</span>
</span><span id="CsvPathsPublic.next_by_line-83"><a href="#CsvPathsPublic.next_by_line-83"><span class="linenos">83</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Does a CsvPath.next() on filename where each row is considered</span>
</span><span id="CsvPathsPublic.next_by_line-84"><a href="#CsvPathsPublic.next_by_line-84"><span class="linenos">84</span></a><span class="sd">        by every named path before the next row starts.</span>
</span><span id="CsvPathsPublic.next_by_line-85"><a href="#CsvPathsPublic.next_by_line-85"><span class="linenos">85</span></a>
</span><span id="CsvPathsPublic.next_by_line-86"><a href="#CsvPathsPublic.next_by_line-86"><span class="linenos">86</span></a><span class="sd">        if_all_agree=True means all the CsvPath instances must match for</span>
</span><span id="CsvPathsPublic.next_by_line-87"><a href="#CsvPathsPublic.next_by_line-87"><span class="linenos">87</span></a><span class="sd">        the line to be kept. However, every CsvPath instance will keep its</span>
</span><span id="CsvPathsPublic.next_by_line-88"><a href="#CsvPathsPublic.next_by_line-88"><span class="linenos">88</span></a><span class="sd">        own matches in its results regardless of if every line kept was</span>
</span><span id="CsvPathsPublic.next_by_line-89"><a href="#CsvPathsPublic.next_by_line-89"><span class="linenos">89</span></a><span class="sd">        returned to the caller by CsvPaths.</span>
</span><span id="CsvPathsPublic.next_by_line-90"><a href="#CsvPathsPublic.next_by_line-90"><span class="linenos">90</span></a>
</span><span id="CsvPathsPublic.next_by_line-91"><a href="#CsvPathsPublic.next_by_line-91"><span class="linenos">91</span></a><span class="sd">        collect_when_not_matched=True inverts the match so that lines</span>
</span><span id="CsvPathsPublic.next_by_line-92"><a href="#CsvPathsPublic.next_by_line-92"><span class="linenos">92</span></a><span class="sd">        which did not match are returned, rather than the default behavior.</span>
</span><span id="CsvPathsPublic.next_by_line-93"><a href="#CsvPathsPublic.next_by_line-93"><span class="linenos">93</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span></pre></div>


            <div class="docstring"><p>Does a CsvPath.next() on filename where each row is considered
by every named path before the next row starts.</p>

<p>if_all_agree=True means all the CsvPath instances must match for
the line to be kept. However, every CsvPath instance will keep its
own matches in its results regardless of if every line kept was
returned to the caller by CsvPaths.</p>

<p>collect_when_not_matched=True inverts the match so that lines
which did not match are returned, rather than the default behavior.</p>
</div>


                            </div>
                </section>
                <section id="CsvPaths">
                            <input id="CsvPaths-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">CsvPaths</span><wbr>(<span class="base"><a href="#CsvPathsPublic">CsvPathsPublic</a></span>, <span class="base"><a href="#CsvPathsCoordinator">CsvPathsCoordinator</a></span>, <span class="base">csvpath.managers.errors.error_collector.ErrorCollector</span>):

                <label class="view-source-button" for="CsvPaths-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPaths"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPaths-131"><a href="#CsvPaths-131"><span class="linenos"> 131</span></a><span class="k">class</span><span class="w"> </span><span class="nc">CsvPaths</span><span class="p">(</span><span class="n">CsvPathsPublic</span><span class="p">,</span> <span class="n">CsvPathsCoordinator</span><span class="p">,</span> <span class="n">ErrorCollector</span><span class="p">):</span>
</span><span id="CsvPaths-132"><a href="#CsvPaths-132"><span class="linenos"> 132</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Manages the application of csvpaths to files. Csvpaths must be grouped and named.</span>
</span><span id="CsvPaths-133"><a href="#CsvPaths-133"><span class="linenos"> 133</span></a><span class="sd">    Files must be named. Results are held by the results_manager.</span>
</span><span id="CsvPaths-134"><a href="#CsvPaths-134"><span class="linenos"> 134</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="CsvPaths-135"><a href="#CsvPaths-135"><span class="linenos"> 135</span></a>
</span><span id="CsvPaths-136"><a href="#CsvPaths-136"><span class="linenos"> 136</span></a>    <span class="c1"># pylint: disable=too-many-instance-attributes</span>
</span><span id="CsvPaths-137"><a href="#CsvPaths-137"><span class="linenos"> 137</span></a>
</span><span id="CsvPaths-138"><a href="#CsvPaths-138"><span class="linenos"> 138</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="CsvPaths-139"><a href="#CsvPaths-139"><span class="linenos"> 139</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="CsvPaths-140"><a href="#CsvPaths-140"><span class="linenos"> 140</span></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="CsvPaths-141"><a href="#CsvPaths-141"><span class="linenos"> 141</span></a>        <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span>
</span><span id="CsvPaths-142"><a href="#CsvPaths-142"><span class="linenos"> 142</span></a>        <span class="n">quotechar</span><span class="o">=</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span>
</span><span id="CsvPaths-143"><a href="#CsvPaths-143"><span class="linenos"> 143</span></a>        <span class="n">skip_blank_lines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="CsvPaths-144"><a href="#CsvPaths-144"><span class="linenos"> 144</span></a>        <span class="n">print_default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="CsvPaths-145"><a href="#CsvPaths-145"><span class="linenos"> 145</span></a>        <span class="n">config</span><span class="p">:</span> <span class="n">Config</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="CsvPaths-146"><a href="#CsvPaths-146"><span class="linenos"> 146</span></a>    <span class="p">):</span>
</span><span id="CsvPaths-147"><a href="#CsvPaths-147"><span class="linenos"> 147</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">()</span> <span class="k">if</span> <span class="n">config</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">config</span>
</span><span id="CsvPaths-148"><a href="#CsvPaths-148"><span class="linenos"> 148</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-149"><a href="#CsvPaths-149"><span class="linenos"> 149</span></a>        <span class="c1"># managers centralize activities, offer async potential, and</span>
</span><span id="CsvPaths-150"><a href="#CsvPaths-150"><span class="linenos"> 150</span></a>        <span class="c1"># are where integrations hook in. ErrorManager functionality</span>
</span><span id="CsvPaths-151"><a href="#CsvPaths-151"><span class="linenos"> 151</span></a>        <span class="c1"># must be available in CsvPath too. The others are CsvPaths</span>
</span><span id="CsvPaths-152"><a href="#CsvPaths-152"><span class="linenos"> 152</span></a>        <span class="c1"># only.</span>
</span><span id="CsvPaths-153"><a href="#CsvPaths-153"><span class="linenos"> 153</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-154"><a href="#CsvPaths-154"><span class="linenos"> 154</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_managers</span><span class="p">()</span>
</span><span id="CsvPaths-155"><a href="#CsvPaths-155"><span class="linenos"> 155</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CsvPaths-156"><a href="#CsvPaths-156"><span class="linenos"> 156</span></a><span class="sd">        self.paths_manager = PathsManager(csvpaths=self)</span>
</span><span id="CsvPaths-157"><a href="#CsvPaths-157"><span class="linenos"> 157</span></a><span class="sd">        self.file_manager = FileManager(csvpaths=self)</span>
</span><span id="CsvPaths-158"><a href="#CsvPaths-158"><span class="linenos"> 158</span></a><span class="sd">        self.results_manager = ResultsManager(csvpaths=self)</span>
</span><span id="CsvPaths-159"><a href="#CsvPaths-159"><span class="linenos"> 159</span></a><span class="sd">        self.ecoms = ErrorCommunications(csvpaths=self)</span>
</span><span id="CsvPaths-160"><a href="#CsvPaths-160"><span class="linenos"> 160</span></a><span class="sd">        self._error_manager = ErrorManager(csvpaths=self)</span>
</span><span id="CsvPaths-161"><a href="#CsvPaths-161"><span class="linenos"> 161</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CsvPaths-162"><a href="#CsvPaths-162"><span class="linenos"> 162</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-163"><a href="#CsvPaths-163"><span class="linenos"> 163</span></a>        <span class="c1"># TODO:</span>
</span><span id="CsvPaths-164"><a href="#CsvPaths-164"><span class="linenos"> 164</span></a>        <span class="c1"># self.print_manager = ... &lt;&lt;&lt;=== should we do this?</span>
</span><span id="CsvPaths-165"><a href="#CsvPaths-165"><span class="linenos"> 165</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-166"><a href="#CsvPaths-166"><span class="linenos"> 166</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-167"><a href="#CsvPaths-167"><span class="linenos"> 167</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">print_default</span> <span class="o">=</span> <span class="n">print_default</span>
</span><span id="CsvPaths-168"><a href="#CsvPaths-168"><span class="linenos"> 168</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span> <span class="o">=</span> <span class="n">delimiter</span>
</span><span id="CsvPaths-169"><a href="#CsvPaths-169"><span class="linenos"> 169</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">quotechar</span> <span class="o">=</span> <span class="n">quotechar</span>
</span><span id="CsvPaths-170"><a href="#CsvPaths-170"><span class="linenos"> 170</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">skip_blank_lines</span> <span class="o">=</span> <span class="n">skip_blank_lines</span>
</span><span id="CsvPaths-171"><a href="#CsvPaths-171"><span class="linenos"> 171</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="p">:</span> <span class="n">CsvPath</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPaths-172"><a href="#CsvPaths-172"><span class="linenos"> 172</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">LogUtility</span><span class="o">.</span><span class="n">logger</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="CsvPaths-173"><a href="#CsvPaths-173"><span class="linenos"> 173</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CsvPaths-174"><a href="#CsvPaths-174"><span class="linenos"> 174</span></a>        <span class="c1"># coordinator attributes</span>
</span><span id="CsvPaths-175"><a href="#CsvPaths-175"><span class="linenos"> 175</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_stop_all</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CsvPaths-176"><a href="#CsvPaths-176"><span class="linenos"> 176</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_fail_all</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CsvPaths-177"><a href="#CsvPaths-177"><span class="linenos"> 177</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_skip_all</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CsvPaths-178"><a href="#CsvPaths-178"><span class="linenos"> 178</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_advance_all</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="CsvPaths-179"><a href="#CsvPaths-179"><span class="linenos"> 179</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_current_run_time</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPaths-180"><a href="#CsvPaths-180"><span class="linenos"> 180</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_run_time_str</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPaths-181"><a href="#CsvPaths-181"><span class="linenos"> 181</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">named_paths_name</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPaths-182"><a href="#CsvPaths-182"><span class="linenos"> 182</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">named_file_name</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPaths-183"><a href="#CsvPaths-183"><span class="linenos"> 183</span></a>
</span><span id="CsvPaths-184"><a href="#CsvPaths-184"><span class="linenos"> 184</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-185"><a href="#CsvPaths-185"><span class="linenos"> 185</span></a>        <span class="c1"># metrics is for OTLP OpenTelemetry. it should only</span>
</span><span id="CsvPaths-186"><a href="#CsvPaths-186"><span class="linenos"> 186</span></a>        <span class="c1"># be used by the OTLP listener. it is here because</span>
</span><span id="CsvPaths-187"><a href="#CsvPaths-187"><span class="linenos"> 187</span></a>        <span class="c1"># the integration may need a long-lived presence. if</span>
</span><span id="CsvPaths-188"><a href="#CsvPaths-188"><span class="linenos"> 188</span></a>        <span class="c1"># needed, the first OTLP listener will set it up</span>
</span><span id="CsvPaths-189"><a href="#CsvPaths-189"><span class="linenos"> 189</span></a>        <span class="c1"># before spinning up a thread. any other OTLP</span>
</span><span id="CsvPaths-190"><a href="#CsvPaths-190"><span class="linenos"> 190</span></a>        <span class="c1"># listener threads that need to use a long-lived metric</span>
</span><span id="CsvPaths-191"><a href="#CsvPaths-191"><span class="linenos"> 191</span></a>        <span class="c1"># will work with this property.</span>
</span><span id="CsvPaths-192"><a href="#CsvPaths-192"><span class="linenos"> 192</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-193"><a href="#CsvPaths-193"><span class="linenos"> 193</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPaths-194"><a href="#CsvPaths-194"><span class="linenos"> 194</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;initialized CsvPaths&quot;</span><span class="p">)</span>
</span><span id="CsvPaths-195"><a href="#CsvPaths-195"><span class="linenos"> 195</span></a>
</span><span id="CsvPaths-196"><a href="#CsvPaths-196"><span class="linenos"> 196</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_set_managers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPaths-197"><a href="#CsvPaths-197"><span class="linenos"> 197</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">paths_manager</span> <span class="o">=</span> <span class="n">PathsManager</span><span class="p">(</span><span class="n">csvpaths</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="CsvPaths-198"><a href="#CsvPaths-198"><span class="linenos"> 198</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">file_manager</span> <span class="o">=</span> <span class="n">FileManager</span><span class="p">(</span><span class="n">csvpaths</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="CsvPaths-199"><a href="#CsvPaths-199"><span class="linenos"> 199</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span> <span class="o">=</span> <span class="n">ResultsManager</span><span class="p">(</span><span class="n">csvpaths</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="CsvPaths-200"><a href="#CsvPaths-200"><span class="linenos"> 200</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ecoms</span> <span class="o">=</span> <span class="n">ErrorCommunications</span><span class="p">(</span><span class="n">csvpaths</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="CsvPaths-201"><a href="#CsvPaths-201"><span class="linenos"> 201</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_error_manager</span> <span class="o">=</span> <span class="n">ErrorManager</span><span class="p">(</span><span class="n">csvpaths</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="CsvPaths-202"><a href="#CsvPaths-202"><span class="linenos"> 202</span></a>
</span><span id="CsvPaths-203"><a href="#CsvPaths-203"><span class="linenos"> 203</span></a>    <span class="nd">@property</span>
</span><span id="CsvPaths-204"><a href="#CsvPaths-204"><span class="linenos"> 204</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">error_manager</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ErrorManager</span><span class="p">:</span>
</span><span id="CsvPaths-205"><a href="#CsvPaths-205"><span class="linenos"> 205</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_error_manager</span>
</span><span id="CsvPaths-206"><a href="#CsvPaths-206"><span class="linenos"> 206</span></a>
</span><span id="CsvPaths-207"><a href="#CsvPaths-207"><span class="linenos"> 207</span></a>    <span class="nd">@error_manager</span><span class="o">.</span><span class="n">setter</span>
</span><span id="CsvPaths-208"><a href="#CsvPaths-208"><span class="linenos"> 208</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">error_manager</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">em</span><span class="p">:</span> <span class="n">ErrorManager</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPaths-209"><a href="#CsvPaths-209"><span class="linenos"> 209</span></a>        <span class="k">if</span> <span class="n">em</span><span class="o">.</span><span class="n">csvpaths</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPaths-210"><a href="#CsvPaths-210"><span class="linenos"> 210</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;CsvPaths cannot be None&quot;</span><span class="p">)</span>
</span><span id="CsvPaths-211"><a href="#CsvPaths-211"><span class="linenos"> 211</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_error_manager</span> <span class="o">=</span> <span class="n">em</span>
</span><span id="CsvPaths-212"><a href="#CsvPaths-212"><span class="linenos"> 212</span></a>
</span><span id="CsvPaths-213"><a href="#CsvPaths-213"><span class="linenos"> 213</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">run_time_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pathsname</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="CsvPaths-214"><a href="#CsvPaths-214"><span class="linenos"> 214</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;adds the stringified current run time to the named-paths</span>
</span><span id="CsvPaths-215"><a href="#CsvPaths-215"><span class="linenos"> 215</span></a><span class="sd">        group home_dir to create the run_dir&quot;&quot;&quot;</span>
</span><span id="CsvPaths-216"><a href="#CsvPaths-216"><span class="linenos"> 216</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_time_str</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">pathsname</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPaths-217"><a href="#CsvPaths-217"><span class="linenos"> 217</span></a>            <span class="k">raise</span> <span class="n">CsvPathsException</span><span class="p">(</span>
</span><span id="CsvPaths-218"><a href="#CsvPaths-218"><span class="linenos"> 218</span></a>                <span class="s2">&quot;Cannot have None in both run_time_str and pathsname&quot;</span>
</span><span id="CsvPaths-219"><a href="#CsvPaths-219"><span class="linenos"> 219</span></a>            <span class="p">)</span>
</span><span id="CsvPaths-220"><a href="#CsvPaths-220"><span class="linenos"> 220</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_time_str</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPaths-221"><a href="#CsvPaths-221"><span class="linenos"> 221</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_run_time_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">get_run_time_str</span><span class="p">(</span>
</span><span id="CsvPaths-222"><a href="#CsvPaths-222"><span class="linenos"> 222</span></a>                <span class="n">pathsname</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_run_time</span>
</span><span id="CsvPaths-223"><a href="#CsvPaths-223"><span class="linenos"> 223</span></a>            <span class="p">)</span>
</span><span id="CsvPaths-224"><a href="#CsvPaths-224"><span class="linenos"> 224</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_time_str</span>
</span><span id="CsvPaths-225"><a href="#CsvPaths-225"><span class="linenos"> 225</span></a>
</span><span id="CsvPaths-226"><a href="#CsvPaths-226"><span class="linenos"> 226</span></a>    <span class="nd">@property</span>
</span><span id="CsvPaths-227"><a href="#CsvPaths-227"><span class="linenos"> 227</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">current_run_time</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datetime</span><span class="p">:</span>
</span><span id="CsvPaths-228"><a href="#CsvPaths-228"><span class="linenos"> 228</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;gets the time marking the start of the run. used to create the run home directory.&quot;&quot;&quot;</span>
</span><span id="CsvPaths-229"><a href="#CsvPaths-229"><span class="linenos"> 229</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_run_time</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPaths-230"><a href="#CsvPaths-230"><span class="linenos"> 230</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_current_run_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
</span><span id="CsvPaths-231"><a href="#CsvPaths-231"><span class="linenos"> 231</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_run_time</span>
</span><span id="CsvPaths-232"><a href="#CsvPaths-232"><span class="linenos"> 232</span></a>
</span><span id="CsvPaths-233"><a href="#CsvPaths-233"><span class="linenos"> 233</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">clear_run_coordination</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPaths-234"><a href="#CsvPaths-234"><span class="linenos"> 234</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;run coordination is the set of signals that csvpaths send to affect</span>
</span><span id="CsvPaths-235"><a href="#CsvPaths-235"><span class="linenos"> 235</span></a><span class="sd">        one another through the CsvPaths instance&quot;&quot;&quot;</span>
</span><span id="CsvPaths-236"><a href="#CsvPaths-236"><span class="linenos"> 236</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_stop_all</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CsvPaths-237"><a href="#CsvPaths-237"><span class="linenos"> 237</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_fail_all</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CsvPaths-238"><a href="#CsvPaths-238"><span class="linenos"> 238</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_skip_all</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CsvPaths-239"><a href="#CsvPaths-239"><span class="linenos"> 239</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_advance_all</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="CsvPaths-240"><a href="#CsvPaths-240"><span class="linenos"> 240</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_current_run_time</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPaths-241"><a href="#CsvPaths-241"><span class="linenos"> 241</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_run_time_str</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPaths-242"><a href="#CsvPaths-242"><span class="linenos"> 242</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Cleared run coordination&quot;</span><span class="p">)</span>
</span><span id="CsvPaths-243"><a href="#CsvPaths-243"><span class="linenos"> 243</span></a>
</span><span id="CsvPaths-244"><a href="#CsvPaths-244"><span class="linenos"> 244</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">csvpath</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CsvPath</span><span class="p">:</span>
</span><span id="CsvPaths-245"><a href="#CsvPaths-245"><span class="linenos"> 245</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="n">CsvPath</span><span class="p">(</span>
</span><span id="CsvPaths-246"><a href="#CsvPaths-246"><span class="linenos"> 246</span></a>            <span class="n">csvpaths</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
</span><span id="CsvPaths-247"><a href="#CsvPaths-247"><span class="linenos"> 247</span></a>            <span class="n">delimiter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">,</span>
</span><span id="CsvPaths-248"><a href="#CsvPaths-248"><span class="linenos"> 248</span></a>            <span class="n">quotechar</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">quotechar</span><span class="p">,</span>
</span><span id="CsvPaths-249"><a href="#CsvPaths-249"><span class="linenos"> 249</span></a>            <span class="n">skip_blank_lines</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">skip_blank_lines</span><span class="p">,</span>
</span><span id="CsvPaths-250"><a href="#CsvPaths-250"><span class="linenos"> 250</span></a>            <span class="c1">#</span>
</span><span id="CsvPaths-251"><a href="#CsvPaths-251"><span class="linenos"> 251</span></a>            <span class="c1"># in the usual case we don&#39;t want csvpaths and its csvpath children</span>
</span><span id="CsvPaths-252"><a href="#CsvPaths-252"><span class="linenos"> 252</span></a>            <span class="c1"># to share the same config. sharing doesn&#39;t offer much. the flexibility</span>
</span><span id="CsvPaths-253"><a href="#CsvPaths-253"><span class="linenos"> 253</span></a>            <span class="c1"># of having separate configs is valuable.</span>
</span><span id="CsvPaths-254"><a href="#CsvPaths-254"><span class="linenos"> 254</span></a>            <span class="c1">#</span>
</span><span id="CsvPaths-255"><a href="#CsvPaths-255"><span class="linenos"> 255</span></a>            <span class="n">config</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="CsvPaths-256"><a href="#CsvPaths-256"><span class="linenos"> 256</span></a>            <span class="n">print_default</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">print_default</span><span class="p">,</span>
</span><span id="CsvPaths-257"><a href="#CsvPaths-257"><span class="linenos"> 257</span></a>            <span class="n">error_manager</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">error_manager</span><span class="p">,</span>
</span><span id="CsvPaths-258"><a href="#CsvPaths-258"><span class="linenos"> 258</span></a>        <span class="p">)</span>
</span><span id="CsvPaths-259"><a href="#CsvPaths-259"><span class="linenos"> 259</span></a>        <span class="k">return</span> <span class="n">path</span>
</span><span id="CsvPaths-260"><a href="#CsvPaths-260"><span class="linenos"> 260</span></a>
</span><span id="CsvPaths-261"><a href="#CsvPaths-261"><span class="linenos"> 261</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">stop_all</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
</span><span id="CsvPaths-262"><a href="#CsvPaths-262"><span class="linenos"> 262</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_stop_all</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="CsvPaths-263"><a href="#CsvPaths-263"><span class="linenos"> 263</span></a>
</span><span id="CsvPaths-264"><a href="#CsvPaths-264"><span class="linenos"> 264</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fail_all</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
</span><span id="CsvPaths-265"><a href="#CsvPaths-265"><span class="linenos"> 265</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_fail_all</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="CsvPaths-266"><a href="#CsvPaths-266"><span class="linenos"> 266</span></a>
</span><span id="CsvPaths-267"><a href="#CsvPaths-267"><span class="linenos"> 267</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">skip_all</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
</span><span id="CsvPaths-268"><a href="#CsvPaths-268"><span class="linenos"> 268</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_skip_all</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="CsvPaths-269"><a href="#CsvPaths-269"><span class="linenos"> 269</span></a>
</span><span id="CsvPaths-270"><a href="#CsvPaths-270"><span class="linenos"> 270</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">advance_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lines</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
</span><span id="CsvPaths-271"><a href="#CsvPaths-271"><span class="linenos"> 271</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_advance_all</span> <span class="o">=</span> <span class="n">lines</span>
</span><span id="CsvPaths-272"><a href="#CsvPaths-272"><span class="linenos"> 272</span></a>
</span><span id="CsvPaths-273"><a href="#CsvPaths-273"><span class="linenos"> 273</span></a>    <span class="nd">@property</span>
</span><span id="CsvPaths-274"><a href="#CsvPaths-274"><span class="linenos"> 274</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">errors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Error</span><span class="p">]:</span>  <span class="c1"># pylint: disable=C0116</span>
</span><span id="CsvPaths-275"><a href="#CsvPaths-275"><span class="linenos"> 275</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span>
</span><span id="CsvPaths-276"><a href="#CsvPaths-276"><span class="linenos"> 276</span></a>
</span><span id="CsvPaths-277"><a href="#CsvPaths-277"><span class="linenos"> 277</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">collect_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">error</span><span class="p">:</span> <span class="n">Error</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pylint: disable=C0116</span>
</span><span id="CsvPaths-278"><a href="#CsvPaths-278"><span class="linenos"> 278</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
</span><span id="CsvPaths-279"><a href="#CsvPaths-279"><span class="linenos"> 279</span></a>
</span><span id="CsvPaths-280"><a href="#CsvPaths-280"><span class="linenos"> 280</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">has_errors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>  <span class="c1"># pylint: disable=C0116</span>
</span><span id="CsvPaths-281"><a href="#CsvPaths-281"><span class="linenos"> 281</span></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_errors</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
</span><span id="CsvPaths-282"><a href="#CsvPaths-282"><span class="linenos"> 282</span></a>
</span><span id="CsvPaths-283"><a href="#CsvPaths-283"><span class="linenos"> 283</span></a>    <span class="nd">@property</span>
</span><span id="CsvPaths-284"><a href="#CsvPaths-284"><span class="linenos"> 284</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Config</span><span class="p">:</span>  <span class="c1"># pylint: disable=C0116</span>
</span><span id="CsvPaths-285"><a href="#CsvPaths-285"><span class="linenos"> 285</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">:</span>
</span><span id="CsvPaths-286"><a href="#CsvPaths-286"><span class="linenos"> 286</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">()</span>  <span class="c1"># pragma: no cover</span>
</span><span id="CsvPaths-287"><a href="#CsvPaths-287"><span class="linenos"> 287</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config</span>
</span><span id="CsvPaths-288"><a href="#CsvPaths-288"><span class="linenos"> 288</span></a>
</span><span id="CsvPaths-289"><a href="#CsvPaths-289"><span class="linenos"> 289</span></a>    <span class="c1">#</span>
</span><span id="CsvPaths-290"><a href="#CsvPaths-290"><span class="linenos"> 290</span></a>    <span class="c1"># this is the preferred way to update config. it is preferred because</span>
</span><span id="CsvPaths-291"><a href="#CsvPaths-291"><span class="linenos"> 291</span></a>    <span class="c1"># csvpath and csvpaths work off the same config file, even though they,</span>
</span><span id="CsvPaths-292"><a href="#CsvPaths-292"><span class="linenos"> 292</span></a>    <span class="c1"># in some cases, have separate keys. if you update the config directly</span>
</span><span id="CsvPaths-293"><a href="#CsvPaths-293"><span class="linenos"> 293</span></a>    <span class="c1"># before a run starts using the CsvPaths&#39;s Config you have to remember</span>
</span><span id="CsvPaths-294"><a href="#CsvPaths-294"><span class="linenos"> 294</span></a>    <span class="c1"># to save and reload for it to effect both CsvPaths and CsvPath. this</span>
</span><span id="CsvPaths-295"><a href="#CsvPaths-295"><span class="linenos"> 295</span></a>    <span class="c1"># method does the save and reload every time.</span>
</span><span id="CsvPaths-296"><a href="#CsvPaths-296"><span class="linenos"> 296</span></a>    <span class="c1">#</span>
</span><span id="CsvPaths-297"><a href="#CsvPaths-297"><span class="linenos"> 297</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">add_to_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">section</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPaths-298"><a href="#CsvPaths-298"><span class="linenos"> 298</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">add_to_config</span><span class="p">(</span><span class="n">section</span><span class="o">=</span><span class="n">section</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>
</span><span id="CsvPaths-299"><a href="#CsvPaths-299"><span class="linenos"> 299</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">save_config</span><span class="p">()</span>
</span><span id="CsvPaths-300"><a href="#CsvPaths-300"><span class="linenos"> 300</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">reload</span><span class="p">()</span>
</span><span id="CsvPaths-301"><a href="#CsvPaths-301"><span class="linenos"> 301</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_managers</span><span class="p">()</span>
</span><span id="CsvPaths-302"><a href="#CsvPaths-302"><span class="linenos"> 302</span></a>
</span><span id="CsvPaths-303"><a href="#CsvPaths-303"><span class="linenos"> 303</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">clean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">paths</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPaths-304"><a href="#CsvPaths-304"><span class="linenos"> 304</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;at this time we do not recommend reusing CsvPaths, but it is doable</span>
</span><span id="CsvPaths-305"><a href="#CsvPaths-305"><span class="linenos"> 305</span></a><span class="sd">        you should clean before reuse unless you want to accumulate results.&quot;&quot;&quot;</span>
</span><span id="CsvPaths-306"><a href="#CsvPaths-306"><span class="linenos"> 306</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">clean_named_results</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span>
</span><span id="CsvPaths-307"><a href="#CsvPaths-307"><span class="linenos"> 307</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clear_run_coordination</span><span class="p">()</span>
</span><span id="CsvPaths-308"><a href="#CsvPaths-308"><span class="linenos"> 308</span></a>        <span class="c1"># self.error_manager.reset()</span>
</span><span id="CsvPaths-309"><a href="#CsvPaths-309"><span class="linenos"> 309</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CsvPaths-310"><a href="#CsvPaths-310"><span class="linenos"> 310</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">named_paths_name</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPaths-311"><a href="#CsvPaths-311"><span class="linenos"> 311</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">named_file_name</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPaths-312"><a href="#CsvPaths-312"><span class="linenos"> 312</span></a>
</span><span id="CsvPaths-313"><a href="#CsvPaths-313"><span class="linenos"> 313</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">collect_paths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPaths-314"><a href="#CsvPaths-314"><span class="linenos"> 314</span></a>        <span class="n">paths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">paths_manager</span><span class="o">.</span><span class="n">get_named_paths</span><span class="p">(</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths-315"><a href="#CsvPaths-315"><span class="linenos"> 315</span></a>        <span class="k">if</span> <span class="n">paths</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPaths-316"><a href="#CsvPaths-316"><span class="linenos"> 316</span></a>            <span class="k">raise</span> <span class="n">InputException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No named-paths found for </span><span class="si">{</span><span class="n">pathsname</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="CsvPaths-317"><a href="#CsvPaths-317"><span class="linenos"> 317</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CsvPaths-318"><a href="#CsvPaths-318"><span class="linenos"> 318</span></a>            <span class="k">raise</span> <span class="n">InputException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Named-paths group </span><span class="si">{</span><span class="n">pathsname</span><span class="si">}</span><span class="s2"> is empty&quot;</span><span class="p">)</span>
</span><span id="CsvPaths-319"><a href="#CsvPaths-319"><span class="linenos"> 319</span></a>        <span class="k">if</span> <span class="s2">&quot;&quot;</span> <span class="ow">in</span> <span class="n">paths</span><span class="p">:</span>
</span><span id="CsvPaths-320"><a href="#CsvPaths-320"><span class="linenos"> 320</span></a>            <span class="k">raise</span> <span class="n">InputException</span><span class="p">(</span>
</span><span id="CsvPaths-321"><a href="#CsvPaths-321"><span class="linenos"> 321</span></a>                <span class="sa">f</span><span class="s2">&quot;Named-paths group </span><span class="si">{</span><span class="n">pathsname</span><span class="si">}</span><span class="s2"> has one or more empty csvpaths&quot;</span>
</span><span id="CsvPaths-322"><a href="#CsvPaths-322"><span class="linenos"> 322</span></a>            <span class="p">)</span>
</span><span id="CsvPaths-323"><a href="#CsvPaths-323"><span class="linenos"> 323</span></a>        <span class="n">file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_manager</span><span class="o">.</span><span class="n">get_named_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span><span id="CsvPaths-324"><a href="#CsvPaths-324"><span class="linenos"> 324</span></a>        <span class="k">if</span> <span class="n">file</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPaths-325"><a href="#CsvPaths-325"><span class="linenos"> 325</span></a>            <span class="k">raise</span> <span class="n">InputException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No named-file found for </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="CsvPaths-326"><a href="#CsvPaths-326"><span class="linenos"> 326</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Prepping </span><span class="si">%s</span><span class="s2"> and </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths-327"><a href="#CsvPaths-327"><span class="linenos"> 327</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clean</span><span class="p">(</span><span class="n">paths</span><span class="o">=</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths-328"><a href="#CsvPaths-328"><span class="linenos"> 328</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="CsvPaths-329"><a href="#CsvPaths-329"><span class="linenos"> 329</span></a>            <span class="s2">&quot;Beginning collect_paths </span><span class="si">%s</span><span class="s2"> with </span><span class="si">%s</span><span class="s2"> paths&quot;</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span>
</span><span id="CsvPaths-330"><a href="#CsvPaths-330"><span class="linenos"> 330</span></a>        <span class="p">)</span>
</span><span id="CsvPaths-331"><a href="#CsvPaths-331"><span class="linenos"> 331</span></a>        <span class="n">crt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_time_str</span><span class="p">(</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths-332"><a href="#CsvPaths-332"><span class="linenos"> 332</span></a>        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CsvPaths-333"><a href="#CsvPaths-333"><span class="linenos"> 333</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-334"><a href="#CsvPaths-334"><span class="linenos"> 334</span></a>        <span class="c1"># run starts here</span>
</span><span id="CsvPaths-335"><a href="#CsvPaths-335"><span class="linenos"> 335</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-336"><a href="#CsvPaths-336"><span class="linenos"> 336</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">start_run</span><span class="p">(</span>
</span><span id="CsvPaths-337"><a href="#CsvPaths-337"><span class="linenos"> 337</span></a>            <span class="n">run_dir</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span> <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span>
</span><span id="CsvPaths-338"><a href="#CsvPaths-338"><span class="linenos"> 338</span></a>        <span class="p">)</span>
</span><span id="CsvPaths-339"><a href="#CsvPaths-339"><span class="linenos"> 339</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-340"><a href="#CsvPaths-340"><span class="linenos"> 340</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-341"><a href="#CsvPaths-341"><span class="linenos"> 341</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-342"><a href="#CsvPaths-342"><span class="linenos"> 342</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">path</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">paths</span><span class="p">):</span>
</span><span id="CsvPaths-343"><a href="#CsvPaths-343"><span class="linenos"> 343</span></a>            <span class="n">csvpath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">csvpath</span><span class="p">()</span>
</span><span id="CsvPaths-344"><a href="#CsvPaths-344"><span class="linenos"> 344</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">csvpath</span><span class="o">.</span><span class="n">will_run</span><span class="p">:</span>
</span><span id="CsvPaths-345"><a href="#CsvPaths-345"><span class="linenos"> 345</span></a>                <span class="k">continue</span>
</span><span id="CsvPaths-346"><a href="#CsvPaths-346"><span class="linenos"> 346</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">Result</span><span class="p">(</span>
</span><span id="CsvPaths-347"><a href="#CsvPaths-347"><span class="linenos"> 347</span></a>                <span class="n">csvpath</span><span class="o">=</span><span class="n">csvpath</span><span class="p">,</span>
</span><span id="CsvPaths-348"><a href="#CsvPaths-348"><span class="linenos"> 348</span></a>                <span class="n">file_name</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths-349"><a href="#CsvPaths-349"><span class="linenos"> 349</span></a>                <span class="n">paths_name</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths-350"><a href="#CsvPaths-350"><span class="linenos"> 350</span></a>                <span class="n">run_index</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>
</span><span id="CsvPaths-351"><a href="#CsvPaths-351"><span class="linenos"> 351</span></a>                <span class="n">run_time</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_run_time</span><span class="p">,</span>
</span><span id="CsvPaths-352"><a href="#CsvPaths-352"><span class="linenos"> 352</span></a>                <span class="n">run_dir</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span>
</span><span id="CsvPaths-353"><a href="#CsvPaths-353"><span class="linenos"> 353</span></a>            <span class="p">)</span>
</span><span id="CsvPaths-354"><a href="#CsvPaths-354"><span class="linenos"> 354</span></a>            <span class="c1"># casting a broad net because if &quot;raise&quot; not in the error policy we</span>
</span><span id="CsvPaths-355"><a href="#CsvPaths-355"><span class="linenos"> 355</span></a>            <span class="c1"># want to never fail during a run</span>
</span><span id="CsvPaths-356"><a href="#CsvPaths-356"><span class="linenos"> 356</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="CsvPaths-357"><a href="#CsvPaths-357"><span class="linenos"> 357</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_load_csvpath</span><span class="p">(</span>
</span><span id="CsvPaths-358"><a href="#CsvPaths-358"><span class="linenos"> 358</span></a>                    <span class="n">csvpath</span><span class="o">=</span><span class="n">csvpath</span><span class="p">,</span>
</span><span id="CsvPaths-359"><a href="#CsvPaths-359"><span class="linenos"> 359</span></a>                    <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>
</span><span id="CsvPaths-360"><a href="#CsvPaths-360"><span class="linenos"> 360</span></a>                    <span class="n">file</span><span class="o">=</span><span class="n">file</span><span class="p">,</span>
</span><span id="CsvPaths-361"><a href="#CsvPaths-361"><span class="linenos"> 361</span></a>                    <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths-362"><a href="#CsvPaths-362"><span class="linenos"> 362</span></a>                    <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths-363"><a href="#CsvPaths-363"><span class="linenos"> 363</span></a>                    <span class="n">crt</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span>
</span><span id="CsvPaths-364"><a href="#CsvPaths-364"><span class="linenos"> 364</span></a>                <span class="p">)</span>
</span><span id="CsvPaths-365"><a href="#CsvPaths-365"><span class="linenos"> 365</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths-366"><a href="#CsvPaths-366"><span class="linenos"> 366</span></a>                <span class="c1"># if run-mode: no-run we skip ahead without saving results</span>
</span><span id="CsvPaths-367"><a href="#CsvPaths-367"><span class="linenos"> 367</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths-368"><a href="#CsvPaths-368"><span class="linenos"> 368</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">csvpath</span><span class="o">.</span><span class="n">will_run</span><span class="p">:</span>
</span><span id="CsvPaths-369"><a href="#CsvPaths-369"><span class="linenos"> 369</span></a>                    <span class="k">continue</span>
</span><span id="CsvPaths-370"><a href="#CsvPaths-370"><span class="linenos"> 370</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths-371"><a href="#CsvPaths-371"><span class="linenos"> 371</span></a>                <span class="c1"># the add has to come after _load_csvpath because we need the identity or index</span>
</span><span id="CsvPaths-372"><a href="#CsvPaths-372"><span class="linenos"> 372</span></a>                <span class="c1"># to be stable and the identity is found in load, if it exists.</span>
</span><span id="CsvPaths-373"><a href="#CsvPaths-373"><span class="linenos"> 373</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths-374"><a href="#CsvPaths-374"><span class="linenos"> 374</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">add_named_result</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths-375"><a href="#CsvPaths-375"><span class="linenos"> 375</span></a>                <span class="n">lines</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">lines</span>
</span><span id="CsvPaths-376"><a href="#CsvPaths-376"><span class="linenos"> 376</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Collecting lines using a </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">lines</span><span class="p">))</span>
</span><span id="CsvPaths-377"><a href="#CsvPaths-377"><span class="linenos"> 377</span></a>                <span class="n">csvpath</span><span class="o">.</span><span class="n">collect</span><span class="p">(</span><span class="n">lines</span><span class="o">=</span><span class="n">lines</span><span class="p">)</span>
</span><span id="CsvPaths-378"><a href="#CsvPaths-378"><span class="linenos"> 378</span></a>                <span class="k">if</span> <span class="n">lines</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPaths-379"><a href="#CsvPaths-379"><span class="linenos"> 379</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>  <span class="c1"># pragma: no cover</span>
</span><span id="CsvPaths-380"><a href="#CsvPaths-380"><span class="linenos"> 380</span></a>                        <span class="s2">&quot;Unexpected None for lines after collect_paths: file: </span><span class="si">%s</span><span class="s2">, match: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="CsvPaths-381"><a href="#CsvPaths-381"><span class="linenos"> 381</span></a>                        <span class="n">file</span><span class="p">,</span>
</span><span id="CsvPaths-382"><a href="#CsvPaths-382"><span class="linenos"> 382</span></a>                        <span class="n">csvpath</span><span class="o">.</span><span class="n">match</span><span class="p">,</span>
</span><span id="CsvPaths-383"><a href="#CsvPaths-383"><span class="linenos"> 383</span></a>                    <span class="p">)</span>
</span><span id="CsvPaths-384"><a href="#CsvPaths-384"><span class="linenos"> 384</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths-385"><a href="#CsvPaths-385"><span class="linenos"> 385</span></a>                <span class="c1"># this is obviously not a good idea for very large files!</span>
</span><span id="CsvPaths-386"><a href="#CsvPaths-386"><span class="linenos"> 386</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths-387"><a href="#CsvPaths-387"><span class="linenos"> 387</span></a>                <span class="n">result</span><span class="o">.</span><span class="n">unmatched</span> <span class="o">=</span> <span class="n">csvpath</span><span class="o">.</span><span class="n">unmatched</span>
</span><span id="CsvPaths-388"><a href="#CsvPaths-388"><span class="linenos"> 388</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>  <span class="c1"># pylint: disable=W0718</span>
</span><span id="CsvPaths-389"><a href="#CsvPaths-389"><span class="linenos"> 389</span></a>                <span class="c1"># ex.trace = traceback.format_exc()</span>
</span><span id="CsvPaths-390"><a href="#CsvPaths-390"><span class="linenos"> 390</span></a>                <span class="c1"># ex.source = self</span>
</span><span id="CsvPaths-391"><a href="#CsvPaths-391"><span class="linenos"> 391</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">error_manager</span><span class="o">.</span><span class="n">csvpaths</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPaths-392"><a href="#CsvPaths-392"><span class="linenos"> 392</span></a>                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;ErrorManager&#39;s CsvPaths cannot be None&quot;</span><span class="p">)</span>
</span><span id="CsvPaths-393"><a href="#CsvPaths-393"><span class="linenos"> 393</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">error_manager</span><span class="o">.</span><span class="n">handle_error</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="CsvPaths-394"><a href="#CsvPaths-394"><span class="linenos"> 394</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ecoms</span><span class="o">.</span><span class="n">do_i_raise</span><span class="p">():</span>
</span><span id="CsvPaths-395"><a href="#CsvPaths-395"><span class="linenos"> 395</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths-396"><a href="#CsvPaths-396"><span class="linenos"> 396</span></a>                    <span class="k">raise</span>
</span><span id="CsvPaths-397"><a href="#CsvPaths-397"><span class="linenos"> 397</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths-398"><a href="#CsvPaths-398"><span class="linenos"> 398</span></a>            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths-399"><a href="#CsvPaths-399"><span class="linenos"> 399</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-400"><a href="#CsvPaths-400"><span class="linenos"> 400</span></a>        <span class="c1"># run ends here</span>
</span><span id="CsvPaths-401"><a href="#CsvPaths-401"><span class="linenos"> 401</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-402"><a href="#CsvPaths-402"><span class="linenos"> 402</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">complete_run</span><span class="p">(</span>
</span><span id="CsvPaths-403"><a href="#CsvPaths-403"><span class="linenos"> 403</span></a>            <span class="n">run_dir</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span> <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span>
</span><span id="CsvPaths-404"><a href="#CsvPaths-404"><span class="linenos"> 404</span></a>        <span class="p">)</span>
</span><span id="CsvPaths-405"><a href="#CsvPaths-405"><span class="linenos"> 405</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-406"><a href="#CsvPaths-406"><span class="linenos"> 406</span></a>        <span class="c1"># update/write run manifests here</span>
</span><span id="CsvPaths-407"><a href="#CsvPaths-407"><span class="linenos"> 407</span></a>        <span class="c1">#  - validity (are all paths valid)</span>
</span><span id="CsvPaths-408"><a href="#CsvPaths-408"><span class="linenos"> 408</span></a>        <span class="c1">#  - paths-completeness (did they all run and complete)</span>
</span><span id="CsvPaths-409"><a href="#CsvPaths-409"><span class="linenos"> 409</span></a>        <span class="c1">#  - method (collect, fast_forward, next)</span>
</span><span id="CsvPaths-410"><a href="#CsvPaths-410"><span class="linenos"> 410</span></a>        <span class="c1">#  - timestamp</span>
</span><span id="CsvPaths-411"><a href="#CsvPaths-411"><span class="linenos"> 411</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-412"><a href="#CsvPaths-412"><span class="linenos"> 412</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clear_run_coordination</span><span class="p">()</span>
</span><span id="CsvPaths-413"><a href="#CsvPaths-413"><span class="linenos"> 413</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="CsvPaths-414"><a href="#CsvPaths-414"><span class="linenos"> 414</span></a>            <span class="s2">&quot;Completed collect_paths </span><span class="si">%s</span><span class="s2"> with </span><span class="si">%s</span><span class="s2"> paths&quot;</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span>
</span><span id="CsvPaths-415"><a href="#CsvPaths-415"><span class="linenos"> 415</span></a>        <span class="p">)</span>
</span><span id="CsvPaths-416"><a href="#CsvPaths-416"><span class="linenos"> 416</span></a>
</span><span id="CsvPaths-417"><a href="#CsvPaths-417"><span class="linenos"> 417</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_load_csvpath</span><span class="p">(</span>
</span><span id="CsvPaths-418"><a href="#CsvPaths-418"><span class="linenos"> 418</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="CsvPaths-419"><a href="#CsvPaths-419"><span class="linenos"> 419</span></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="CsvPaths-420"><a href="#CsvPaths-420"><span class="linenos"> 420</span></a>        <span class="n">csvpath</span><span class="p">:</span> <span class="n">CsvPath</span><span class="p">,</span>
</span><span id="CsvPaths-421"><a href="#CsvPaths-421"><span class="linenos"> 421</span></a>        <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="CsvPaths-422"><a href="#CsvPaths-422"><span class="linenos"> 422</span></a>        <span class="n">file</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="CsvPaths-423"><a href="#CsvPaths-423"><span class="linenos"> 423</span></a>        <span class="n">pathsname</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="CsvPaths-424"><a href="#CsvPaths-424"><span class="linenos"> 424</span></a>        <span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths-425"><a href="#CsvPaths-425"><span class="linenos"> 425</span></a>        <span class="n">by_line</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="CsvPaths-426"><a href="#CsvPaths-426"><span class="linenos"> 426</span></a>        <span class="n">crt</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="CsvPaths-427"><a href="#CsvPaths-427"><span class="linenos"> 427</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPaths-428"><a href="#CsvPaths-428"><span class="linenos"> 428</span></a>        <span class="c1"># file is the physical file (+/- if preceding mode) filename is the named-file name</span>
</span><span id="CsvPaths-429"><a href="#CsvPaths-429"><span class="linenos"> 429</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Beginning to load csvpath </span><span class="si">%s</span><span class="s2"> with file </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
</span><span id="CsvPaths-430"><a href="#CsvPaths-430"><span class="linenos"> 430</span></a>        <span class="n">csvpath</span><span class="o">.</span><span class="n">named_paths_name</span> <span class="o">=</span> <span class="n">pathsname</span>
</span><span id="CsvPaths-431"><a href="#CsvPaths-431"><span class="linenos"> 431</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">named_paths_name</span> <span class="o">=</span> <span class="n">pathsname</span>
</span><span id="CsvPaths-432"><a href="#CsvPaths-432"><span class="linenos"> 432</span></a>        <span class="n">csvpath</span><span class="o">.</span><span class="n">named_file_name</span> <span class="o">=</span> <span class="n">filename</span>
</span><span id="CsvPaths-433"><a href="#CsvPaths-433"><span class="linenos"> 433</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">named_file_name</span> <span class="o">=</span> <span class="n">filename</span>
</span><span id="CsvPaths-434"><a href="#CsvPaths-434"><span class="linenos"> 434</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-435"><a href="#CsvPaths-435"><span class="linenos"> 435</span></a>        <span class="c1"># by_line==True means we are starting a run that is breadth-first ultimately using</span>
</span><span id="CsvPaths-436"><a href="#CsvPaths-436"><span class="linenos"> 436</span></a>        <span class="c1"># next_by_line(). by_line runs cannot be source-mode preceding and have different</span>
</span><span id="CsvPaths-437"><a href="#CsvPaths-437"><span class="linenos"> 437</span></a>        <span class="c1"># semantics around csvpaths influencing one another.</span>
</span><span id="CsvPaths-438"><a href="#CsvPaths-438"><span class="linenos"> 438</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-439"><a href="#CsvPaths-439"><span class="linenos"> 439</span></a>        <span class="c1"># we strip comments from above the path so we need to extract them first</span>
</span><span id="CsvPaths-440"><a href="#CsvPaths-440"><span class="linenos"> 440</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="n">MetadataParser</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">extract_metadata</span><span class="p">(</span><span class="n">instance</span><span class="o">=</span><span class="n">csvpath</span><span class="p">,</span> <span class="n">csvpath</span><span class="o">=</span><span class="n">path</span><span class="p">)</span>
</span><span id="CsvPaths-441"><a href="#CsvPaths-441"><span class="linenos"> 441</span></a>        <span class="n">identity</span> <span class="o">=</span> <span class="n">csvpath</span><span class="o">.</span><span class="n">identity</span>
</span><span id="CsvPaths-442"><a href="#CsvPaths-442"><span class="linenos"> 442</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Csvpath </span><span class="si">%s</span><span class="s2"> after metadata extract: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">identity</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
</span><span id="CsvPaths-443"><a href="#CsvPaths-443"><span class="linenos"> 443</span></a>        <span class="c1"># update the settings using the metadata fields we just collected</span>
</span><span id="CsvPaths-444"><a href="#CsvPaths-444"><span class="linenos"> 444</span></a>        <span class="n">csvpath</span><span class="o">.</span><span class="n">update_settings_from_metadata</span><span class="p">()</span>
</span><span id="CsvPaths-445"><a href="#CsvPaths-445"><span class="linenos"> 445</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-446"><a href="#CsvPaths-446"><span class="linenos"> 446</span></a>        <span class="c1"># if we have a reference, resolve it. we may not actually use the file</span>
</span><span id="CsvPaths-447"><a href="#CsvPaths-447"><span class="linenos"> 447</span></a>        <span class="c1"># if we&#39;re in source-mode: preceding, but that doesn&#39;t matter from the</span>
</span><span id="CsvPaths-448"><a href="#CsvPaths-448"><span class="linenos"> 448</span></a>        <span class="c1"># pov of the reference.</span>
</span><span id="CsvPaths-449"><a href="#CsvPaths-449"><span class="linenos"> 449</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-450"><a href="#CsvPaths-450"><span class="linenos"> 450</span></a>        <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;$&quot;</span><span class="p">):</span>
</span><span id="CsvPaths-451"><a href="#CsvPaths-451"><span class="linenos"> 451</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="CsvPaths-452"><a href="#CsvPaths-452"><span class="linenos"> 452</span></a>                <span class="s2">&quot;File name is a reference: </span><span class="si">%s</span><span class="s2">. Replacing the path passed in with the reffed data file path.&quot;</span><span class="p">,</span>
</span><span id="CsvPaths-453"><a href="#CsvPaths-453"><span class="linenos"> 453</span></a>                <span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths-454"><a href="#CsvPaths-454"><span class="linenos"> 454</span></a>            <span class="p">)</span>
</span><span id="CsvPaths-455"><a href="#CsvPaths-455"><span class="linenos"> 455</span></a>            <span class="n">file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">data_file_for_reference</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">not_name</span><span class="o">=</span><span class="n">crt</span><span class="p">)</span>
</span><span id="CsvPaths-456"><a href="#CsvPaths-456"><span class="linenos"> 456</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-457"><a href="#CsvPaths-457"><span class="linenos"> 457</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-458"><a href="#CsvPaths-458"><span class="linenos"> 458</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-459"><a href="#CsvPaths-459"><span class="linenos"> 459</span></a>        <span class="k">if</span> <span class="n">csvpath</span><span class="o">.</span><span class="n">data_from_preceding</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="CsvPaths-460"><a href="#CsvPaths-460"><span class="linenos"> 460</span></a>            <span class="k">if</span> <span class="n">by_line</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="CsvPaths-461"><a href="#CsvPaths-461"><span class="linenos"> 461</span></a>                <span class="k">raise</span> <span class="n">CsvPathsException</span><span class="p">(</span>
</span><span id="CsvPaths-462"><a href="#CsvPaths-462"><span class="linenos"> 462</span></a>                    <span class="s2">&quot;Breadth-first runs do not support source-mode preceding because each line of data flows through each csvpath in order already&quot;</span>
</span><span id="CsvPaths-463"><a href="#CsvPaths-463"><span class="linenos"> 463</span></a>                <span class="p">)</span>
</span><span id="CsvPaths-464"><a href="#CsvPaths-464"><span class="linenos"> 464</span></a>            <span class="c1">#</span>
</span><span id="CsvPaths-465"><a href="#CsvPaths-465"><span class="linenos"> 465</span></a>            <span class="c1"># we are in source-mode: preceding</span>
</span><span id="CsvPaths-466"><a href="#CsvPaths-466"><span class="linenos"> 466</span></a>            <span class="c1"># that means we ignore the original data file path and</span>
</span><span id="CsvPaths-467"><a href="#CsvPaths-467"><span class="linenos"> 467</span></a>            <span class="c1"># instead use the data.csv from the preceding csvpath. that is,</span>
</span><span id="CsvPaths-468"><a href="#CsvPaths-468"><span class="linenos"> 468</span></a>            <span class="c1"># assuming there is a preceding csvpath and it created and</span>
</span><span id="CsvPaths-469"><a href="#CsvPaths-469"><span class="linenos"> 469</span></a>            <span class="c1"># saved data.</span>
</span><span id="CsvPaths-470"><a href="#CsvPaths-470"><span class="linenos"> 470</span></a>            <span class="c1">#</span>
</span><span id="CsvPaths-471"><a href="#CsvPaths-471"><span class="linenos"> 471</span></a>            <span class="c1"># find the preceding csvpath in the named-paths</span>
</span><span id="CsvPaths-472"><a href="#CsvPaths-472"><span class="linenos"> 472</span></a>            <span class="c1">#</span>
</span><span id="CsvPaths-473"><a href="#CsvPaths-473"><span class="linenos"> 473</span></a>            <span class="c1"># we may be in a file reference like: $sourcemode.csvpaths.source2:from. if so</span>
</span><span id="CsvPaths-474"><a href="#CsvPaths-474"><span class="linenos"> 474</span></a>            <span class="c1"># we just need the named-paths name.</span>
</span><span id="CsvPaths-475"><a href="#CsvPaths-475"><span class="linenos"> 475</span></a>            <span class="c1">#</span>
</span><span id="CsvPaths-476"><a href="#CsvPaths-476"><span class="linenos"> 476</span></a>            <span class="k">if</span> <span class="n">pathsname</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;$&quot;</span><span class="p">):</span>
</span><span id="CsvPaths-477"><a href="#CsvPaths-477"><span class="linenos"> 477</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="CsvPaths-478"><a href="#CsvPaths-478"><span class="linenos"> 478</span></a>                    <span class="s2">&quot;Named-paths name is a reference: </span><span class="si">%s</span><span class="s2">. Stripping it down to just the actual named-paths name.&quot;</span><span class="p">,</span>
</span><span id="CsvPaths-479"><a href="#CsvPaths-479"><span class="linenos"> 479</span></a>                    <span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths-480"><a href="#CsvPaths-480"><span class="linenos"> 480</span></a>                <span class="p">)</span>
</span><span id="CsvPaths-481"><a href="#CsvPaths-481"><span class="linenos"> 481</span></a>                <span class="n">pathsname</span> <span class="o">=</span> <span class="n">pathsname</span><span class="p">[</span><span class="mi">1</span> <span class="p">:</span> <span class="n">pathsname</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)]</span>
</span><span id="CsvPaths-482"><a href="#CsvPaths-482"><span class="linenos"> 482</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">get_last_named_result</span><span class="p">(</span>
</span><span id="CsvPaths-483"><a href="#CsvPaths-483"><span class="linenos"> 483</span></a>                <span class="n">name</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span> <span class="n">before</span><span class="o">=</span><span class="n">csvpath</span><span class="o">.</span><span class="n">identity</span>
</span><span id="CsvPaths-484"><a href="#CsvPaths-484"><span class="linenos"> 484</span></a>            <span class="p">)</span>
</span><span id="CsvPaths-485"><a href="#CsvPaths-485"><span class="linenos"> 485</span></a>            <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPaths-486"><a href="#CsvPaths-486"><span class="linenos"> 486</span></a>                <span class="c1"># get its data.csv path for this present run</span>
</span><span id="CsvPaths-487"><a href="#CsvPaths-487"><span class="linenos"> 487</span></a>                <span class="c1"># swap in that path for the regular origin path</span>
</span><span id="CsvPaths-488"><a href="#CsvPaths-488"><span class="linenos"> 488</span></a>                <span class="n">file</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">data_file_path</span>
</span><span id="CsvPaths-489"><a href="#CsvPaths-489"><span class="linenos"> 489</span></a>                <span class="n">csvpath</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;source-mode-source&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">file</span>
</span><span id="CsvPaths-490"><a href="#CsvPaths-490"><span class="linenos"> 490</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="CsvPaths-491"><a href="#CsvPaths-491"><span class="linenos"> 491</span></a>                    <span class="s2">&quot;Csvpath identified as </span><span class="si">%s</span><span class="s2"> uses last csvpath&#39;s data.csv at </span><span class="si">%s</span><span class="s2"> as source&quot;</span><span class="p">,</span>
</span><span id="CsvPaths-492"><a href="#CsvPaths-492"><span class="linenos"> 492</span></a>                    <span class="n">csvpath</span><span class="o">.</span><span class="n">identity</span><span class="p">,</span>
</span><span id="CsvPaths-493"><a href="#CsvPaths-493"><span class="linenos"> 493</span></a>                    <span class="n">file</span><span class="p">,</span>
</span><span id="CsvPaths-494"><a href="#CsvPaths-494"><span class="linenos"> 494</span></a>                <span class="p">)</span>
</span><span id="CsvPaths-495"><a href="#CsvPaths-495"><span class="linenos"> 495</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="CsvPaths-496"><a href="#CsvPaths-496"><span class="linenos"> 496</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="CsvPaths-497"><a href="#CsvPaths-497"><span class="linenos"> 497</span></a>                    <span class="s2">&quot;Cannot find a preceding data file to use for csvpath identified as </span><span class="si">%s</span><span class="s2"> running in source-mode&quot;</span><span class="p">,</span>
</span><span id="CsvPaths-498"><a href="#CsvPaths-498"><span class="linenos"> 498</span></a>                    <span class="n">csvpath</span><span class="o">.</span><span class="n">identity</span><span class="p">,</span>
</span><span id="CsvPaths-499"><a href="#CsvPaths-499"><span class="linenos"> 499</span></a>                <span class="p">)</span>
</span><span id="CsvPaths-500"><a href="#CsvPaths-500"><span class="linenos"> 500</span></a>        <span class="n">f</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">)</span>
</span><span id="CsvPaths-501"><a href="#CsvPaths-501"><span class="linenos"> 501</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Csvpath matching part starts at char # </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span><span id="CsvPaths-502"><a href="#CsvPaths-502"><span class="linenos"> 502</span></a>        <span class="n">apath</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;$</span><span class="si">{</span><span class="n">file</span><span class="si">}{</span><span class="n">path</span><span class="p">[</span><span class="n">f</span><span class="p">:]</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="CsvPaths-503"><a href="#CsvPaths-503"><span class="linenos"> 503</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Parsing csvpath </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">apath</span><span class="p">)</span>
</span><span id="CsvPaths-504"><a href="#CsvPaths-504"><span class="linenos"> 504</span></a>        <span class="n">csvpath</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">apath</span><span class="p">)</span>
</span><span id="CsvPaths-505"><a href="#CsvPaths-505"><span class="linenos"> 505</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-506"><a href="#CsvPaths-506"><span class="linenos"> 506</span></a>        <span class="c1"># ready to run. time to register the run. this is separate from</span>
</span><span id="CsvPaths-507"><a href="#CsvPaths-507"><span class="linenos"> 507</span></a>        <span class="c1"># the run_register.py (ResultsRegister) event</span>
</span><span id="CsvPaths-508"><a href="#CsvPaths-508"><span class="linenos"> 508</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-509"><a href="#CsvPaths-509"><span class="linenos"> 509</span></a>        <span class="c1"># crt = self.run_time_str(pathsname)</span>
</span><span id="CsvPaths-510"><a href="#CsvPaths-510"><span class="linenos"> 510</span></a>        <span class="c1"># fingerprint = self.file_manager.get_fingerprint_for_name(filename)</span>
</span><span id="CsvPaths-511"><a href="#CsvPaths-511"><span class="linenos"> 511</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-512"><a href="#CsvPaths-512"><span class="linenos"> 512</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Done loading csvpath&quot;</span><span class="p">)</span>
</span><span id="CsvPaths-513"><a href="#CsvPaths-513"><span class="linenos"> 513</span></a>
</span><span id="CsvPaths-514"><a href="#CsvPaths-514"><span class="linenos"> 514</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fast_forward_paths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
</span><span id="CsvPaths-515"><a href="#CsvPaths-515"><span class="linenos"> 515</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;runs the named-paths group named without collecting matches.&quot;&quot;&quot;</span>
</span><span id="CsvPaths-516"><a href="#CsvPaths-516"><span class="linenos"> 516</span></a>        <span class="n">paths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">paths_manager</span><span class="o">.</span><span class="n">get_named_paths</span><span class="p">(</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths-517"><a href="#CsvPaths-517"><span class="linenos"> 517</span></a>        <span class="n">file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_manager</span><span class="o">.</span><span class="n">get_named_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span><span id="CsvPaths-518"><a href="#CsvPaths-518"><span class="linenos"> 518</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Prepping </span><span class="si">%s</span><span class="s2"> and </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths-519"><a href="#CsvPaths-519"><span class="linenos"> 519</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clean</span><span class="p">(</span><span class="n">paths</span><span class="o">=</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths-520"><a href="#CsvPaths-520"><span class="linenos"> 520</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="CsvPaths-521"><a href="#CsvPaths-521"><span class="linenos"> 521</span></a>            <span class="s2">&quot;Beginning FF </span><span class="si">%s</span><span class="s2"> with </span><span class="si">%s</span><span class="s2"> paths against file </span><span class="si">%s</span><span class="s2">. No match results will be held.&quot;</span><span class="p">,</span>
</span><span id="CsvPaths-522"><a href="#CsvPaths-522"><span class="linenos"> 522</span></a>            <span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths-523"><a href="#CsvPaths-523"><span class="linenos"> 523</span></a>            <span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">),</span>
</span><span id="CsvPaths-524"><a href="#CsvPaths-524"><span class="linenos"> 524</span></a>            <span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths-525"><a href="#CsvPaths-525"><span class="linenos"> 525</span></a>        <span class="p">)</span>
</span><span id="CsvPaths-526"><a href="#CsvPaths-526"><span class="linenos"> 526</span></a>        <span class="n">crt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_time_str</span><span class="p">(</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths-527"><a href="#CsvPaths-527"><span class="linenos"> 527</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-528"><a href="#CsvPaths-528"><span class="linenos"> 528</span></a>        <span class="c1"># run starts here</span>
</span><span id="CsvPaths-529"><a href="#CsvPaths-529"><span class="linenos"> 529</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-530"><a href="#CsvPaths-530"><span class="linenos"> 530</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">start_run</span><span class="p">(</span>
</span><span id="CsvPaths-531"><a href="#CsvPaths-531"><span class="linenos"> 531</span></a>            <span class="n">run_dir</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span> <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span>
</span><span id="CsvPaths-532"><a href="#CsvPaths-532"><span class="linenos"> 532</span></a>        <span class="p">)</span>
</span><span id="CsvPaths-533"><a href="#CsvPaths-533"><span class="linenos"> 533</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-534"><a href="#CsvPaths-534"><span class="linenos"> 534</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-535"><a href="#CsvPaths-535"><span class="linenos"> 535</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-536"><a href="#CsvPaths-536"><span class="linenos"> 536</span></a>        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CsvPaths-537"><a href="#CsvPaths-537"><span class="linenos"> 537</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">path</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">paths</span><span class="p">):</span>
</span><span id="CsvPaths-538"><a href="#CsvPaths-538"><span class="linenos"> 538</span></a>            <span class="n">csvpath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">csvpath</span><span class="p">()</span>
</span><span id="CsvPaths-539"><a href="#CsvPaths-539"><span class="linenos"> 539</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Beginning to FF CsvPath instance: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">csvpath</span><span class="p">)</span>
</span><span id="CsvPaths-540"><a href="#CsvPaths-540"><span class="linenos"> 540</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">Result</span><span class="p">(</span>
</span><span id="CsvPaths-541"><a href="#CsvPaths-541"><span class="linenos"> 541</span></a>                <span class="n">csvpath</span><span class="o">=</span><span class="n">csvpath</span><span class="p">,</span>
</span><span id="CsvPaths-542"><a href="#CsvPaths-542"><span class="linenos"> 542</span></a>                <span class="n">file_name</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths-543"><a href="#CsvPaths-543"><span class="linenos"> 543</span></a>                <span class="n">paths_name</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths-544"><a href="#CsvPaths-544"><span class="linenos"> 544</span></a>                <span class="n">run_index</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>
</span><span id="CsvPaths-545"><a href="#CsvPaths-545"><span class="linenos"> 545</span></a>                <span class="n">run_time</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_run_time</span><span class="p">,</span>
</span><span id="CsvPaths-546"><a href="#CsvPaths-546"><span class="linenos"> 546</span></a>                <span class="n">run_dir</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span>
</span><span id="CsvPaths-547"><a href="#CsvPaths-547"><span class="linenos"> 547</span></a>            <span class="p">)</span>
</span><span id="CsvPaths-548"><a href="#CsvPaths-548"><span class="linenos"> 548</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="CsvPaths-549"><a href="#CsvPaths-549"><span class="linenos"> 549</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_load_csvpath</span><span class="p">(</span>
</span><span id="CsvPaths-550"><a href="#CsvPaths-550"><span class="linenos"> 550</span></a>                    <span class="n">csvpath</span><span class="o">=</span><span class="n">csvpath</span><span class="p">,</span>
</span><span id="CsvPaths-551"><a href="#CsvPaths-551"><span class="linenos"> 551</span></a>                    <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>
</span><span id="CsvPaths-552"><a href="#CsvPaths-552"><span class="linenos"> 552</span></a>                    <span class="n">file</span><span class="o">=</span><span class="n">file</span><span class="p">,</span>
</span><span id="CsvPaths-553"><a href="#CsvPaths-553"><span class="linenos"> 553</span></a>                    <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths-554"><a href="#CsvPaths-554"><span class="linenos"> 554</span></a>                    <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths-555"><a href="#CsvPaths-555"><span class="linenos"> 555</span></a>                    <span class="n">crt</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span>
</span><span id="CsvPaths-556"><a href="#CsvPaths-556"><span class="linenos"> 556</span></a>                <span class="p">)</span>
</span><span id="CsvPaths-557"><a href="#CsvPaths-557"><span class="linenos"> 557</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths-558"><a href="#CsvPaths-558"><span class="linenos"> 558</span></a>                <span class="c1"># if run-mode: no-run we skip ahead without saving results</span>
</span><span id="CsvPaths-559"><a href="#CsvPaths-559"><span class="linenos"> 559</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths-560"><a href="#CsvPaths-560"><span class="linenos"> 560</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">csvpath</span><span class="o">.</span><span class="n">will_run</span><span class="p">:</span>
</span><span id="CsvPaths-561"><a href="#CsvPaths-561"><span class="linenos"> 561</span></a>                    <span class="k">continue</span>
</span><span id="CsvPaths-562"><a href="#CsvPaths-562"><span class="linenos"> 562</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths-563"><a href="#CsvPaths-563"><span class="linenos"> 563</span></a>                <span class="c1"># the add has to come after _load_csvpath because we need the identity or index</span>
</span><span id="CsvPaths-564"><a href="#CsvPaths-564"><span class="linenos"> 564</span></a>                <span class="c1"># to be stable and the identity is found in load, if it exists.</span>
</span><span id="CsvPaths-565"><a href="#CsvPaths-565"><span class="linenos"> 565</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths-566"><a href="#CsvPaths-566"><span class="linenos"> 566</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">add_named_result</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths-567"><a href="#CsvPaths-567"><span class="linenos"> 567</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="CsvPaths-568"><a href="#CsvPaths-568"><span class="linenos"> 568</span></a>                    <span class="s2">&quot;Parsed csvpath </span><span class="si">%s</span><span class="s2"> pointed at </span><span class="si">%s</span><span class="s2"> and starting to fast-forward&quot;</span><span class="p">,</span>
</span><span id="CsvPaths-569"><a href="#CsvPaths-569"><span class="linenos"> 569</span></a>                    <span class="n">i</span><span class="p">,</span>
</span><span id="CsvPaths-570"><a href="#CsvPaths-570"><span class="linenos"> 570</span></a>                    <span class="n">file</span><span class="p">,</span>
</span><span id="CsvPaths-571"><a href="#CsvPaths-571"><span class="linenos"> 571</span></a>                <span class="p">)</span>
</span><span id="CsvPaths-572"><a href="#CsvPaths-572"><span class="linenos"> 572</span></a>                <span class="n">csvpath</span><span class="o">.</span><span class="n">fast_forward</span><span class="p">()</span>
</span><span id="CsvPaths-573"><a href="#CsvPaths-573"><span class="linenos"> 573</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="CsvPaths-574"><a href="#CsvPaths-574"><span class="linenos"> 574</span></a>                    <span class="s2">&quot;Completed fast forward of csvpath </span><span class="si">%s</span><span class="s2"> against </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">file</span>
</span><span id="CsvPaths-575"><a href="#CsvPaths-575"><span class="linenos"> 575</span></a>                <span class="p">)</span>
</span><span id="CsvPaths-576"><a href="#CsvPaths-576"><span class="linenos"> 576</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>  <span class="c1"># pylint: disable=W0718</span>
</span><span id="CsvPaths-577"><a href="#CsvPaths-577"><span class="linenos"> 577</span></a>                <span class="c1"># ex.trace = traceback.format_exc()</span>
</span><span id="CsvPaths-578"><a href="#CsvPaths-578"><span class="linenos"> 578</span></a>                <span class="c1"># ex.source = self</span>
</span><span id="CsvPaths-579"><a href="#CsvPaths-579"><span class="linenos"> 579</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">error_manager</span><span class="o">.</span><span class="n">handle_error</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="CsvPaths-580"><a href="#CsvPaths-580"><span class="linenos"> 580</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ecoms</span><span class="o">.</span><span class="n">do_i_raise</span><span class="p">():</span>
</span><span id="CsvPaths-581"><a href="#CsvPaths-581"><span class="linenos"> 581</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths-582"><a href="#CsvPaths-582"><span class="linenos"> 582</span></a>                    <span class="k">raise</span>
</span><span id="CsvPaths-583"><a href="#CsvPaths-583"><span class="linenos"> 583</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths-584"><a href="#CsvPaths-584"><span class="linenos"> 584</span></a>            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths-585"><a href="#CsvPaths-585"><span class="linenos"> 585</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-586"><a href="#CsvPaths-586"><span class="linenos"> 586</span></a>        <span class="c1"># run ends here</span>
</span><span id="CsvPaths-587"><a href="#CsvPaths-587"><span class="linenos"> 587</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-588"><a href="#CsvPaths-588"><span class="linenos"> 588</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">complete_run</span><span class="p">(</span>
</span><span id="CsvPaths-589"><a href="#CsvPaths-589"><span class="linenos"> 589</span></a>            <span class="n">run_dir</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span> <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span>
</span><span id="CsvPaths-590"><a href="#CsvPaths-590"><span class="linenos"> 590</span></a>        <span class="p">)</span>
</span><span id="CsvPaths-591"><a href="#CsvPaths-591"><span class="linenos"> 591</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clear_run_coordination</span><span class="p">()</span>
</span><span id="CsvPaths-592"><a href="#CsvPaths-592"><span class="linenos"> 592</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="CsvPaths-593"><a href="#CsvPaths-593"><span class="linenos"> 593</span></a>            <span class="s2">&quot;Completed fast_forward_paths </span><span class="si">%s</span><span class="s2"> with </span><span class="si">%s</span><span class="s2"> paths&quot;</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span>
</span><span id="CsvPaths-594"><a href="#CsvPaths-594"><span class="linenos"> 594</span></a>        <span class="p">)</span>
</span><span id="CsvPaths-595"><a href="#CsvPaths-595"><span class="linenos"> 595</span></a>
</span><span id="CsvPaths-596"><a href="#CsvPaths-596"><span class="linenos"> 596</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">next_paths</span><span class="p">(</span>
</span><span id="CsvPaths-597"><a href="#CsvPaths-597"><span class="linenos"> 597</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">collect</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CsvPaths-598"><a href="#CsvPaths-598"><span class="linenos"> 598</span></a>    <span class="p">):</span>  <span class="c1"># pylint: disable=R0914</span>
</span><span id="CsvPaths-599"><a href="#CsvPaths-599"><span class="linenos"> 599</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;appends the Result for each CsvPath to the end of</span>
</span><span id="CsvPaths-600"><a href="#CsvPaths-600"><span class="linenos"> 600</span></a><span class="sd">        each line it produces. this is so that the caller can easily</span>
</span><span id="CsvPaths-601"><a href="#CsvPaths-601"><span class="linenos"> 601</span></a><span class="sd">        interrogate the CsvPath for its path parts, file, etc.&quot;&quot;&quot;</span>
</span><span id="CsvPaths-602"><a href="#CsvPaths-602"><span class="linenos"> 602</span></a>        <span class="n">paths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">paths_manager</span><span class="o">.</span><span class="n">get_named_paths</span><span class="p">(</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths-603"><a href="#CsvPaths-603"><span class="linenos"> 603</span></a>        <span class="n">file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_manager</span><span class="o">.</span><span class="n">get_named_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span><span id="CsvPaths-604"><a href="#CsvPaths-604"><span class="linenos"> 604</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Prepping </span><span class="si">%s</span><span class="s2"> and </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths-605"><a href="#CsvPaths-605"><span class="linenos"> 605</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clean</span><span class="p">(</span><span class="n">paths</span><span class="o">=</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths-606"><a href="#CsvPaths-606"><span class="linenos"> 606</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Beginning next_paths with </span><span class="si">%s</span><span class="s2"> paths&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">))</span>
</span><span id="CsvPaths-607"><a href="#CsvPaths-607"><span class="linenos"> 607</span></a>        <span class="n">crt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_time_str</span><span class="p">(</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths-608"><a href="#CsvPaths-608"><span class="linenos"> 608</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-609"><a href="#CsvPaths-609"><span class="linenos"> 609</span></a>        <span class="c1"># run starts here</span>
</span><span id="CsvPaths-610"><a href="#CsvPaths-610"><span class="linenos"> 610</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-611"><a href="#CsvPaths-611"><span class="linenos"> 611</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">start_run</span><span class="p">(</span>
</span><span id="CsvPaths-612"><a href="#CsvPaths-612"><span class="linenos"> 612</span></a>            <span class="n">run_dir</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span> <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span>
</span><span id="CsvPaths-613"><a href="#CsvPaths-613"><span class="linenos"> 613</span></a>        <span class="p">)</span>
</span><span id="CsvPaths-614"><a href="#CsvPaths-614"><span class="linenos"> 614</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-615"><a href="#CsvPaths-615"><span class="linenos"> 615</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-616"><a href="#CsvPaths-616"><span class="linenos"> 616</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-617"><a href="#CsvPaths-617"><span class="linenos"> 617</span></a>        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CsvPaths-618"><a href="#CsvPaths-618"><span class="linenos"> 618</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">path</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">paths</span><span class="p">):</span>
</span><span id="CsvPaths-619"><a href="#CsvPaths-619"><span class="linenos"> 619</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_skip_all</span><span class="p">:</span>
</span><span id="CsvPaths-620"><a href="#CsvPaths-620"><span class="linenos"> 620</span></a>                <span class="n">skip_err</span> <span class="o">=</span> <span class="s2">&quot;Found the skip-all signal set. skip_all() is&quot;</span>
</span><span id="CsvPaths-621"><a href="#CsvPaths-621"><span class="linenos"> 621</span></a>                <span class="n">skip_err</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">skip_err</span><span class="si">}</span><span class="s2"> only for breadth-first runs using the&quot;</span>
</span><span id="CsvPaths-622"><a href="#CsvPaths-622"><span class="linenos"> 622</span></a>                <span class="n">skip_err</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">skip_err</span><span class="si">}</span><span class="s2"> &#39;_by_line&#39; methods. It has the same&quot;</span>
</span><span id="CsvPaths-623"><a href="#CsvPaths-623"><span class="linenos"> 623</span></a>                <span class="n">skip_err</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">skip_err</span><span class="si">}</span><span class="s2"> effect as skip() in a&quot;</span>
</span><span id="CsvPaths-624"><a href="#CsvPaths-624"><span class="linenos"> 624</span></a>                <span class="n">skip_err</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">skip_err</span><span class="si">}</span><span class="s2"> serial run like this one.&quot;</span>
</span><span id="CsvPaths-625"><a href="#CsvPaths-625"><span class="linenos"> 625</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">skip_err</span><span class="p">)</span>
</span><span id="CsvPaths-626"><a href="#CsvPaths-626"><span class="linenos"> 626</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stop_all</span><span class="p">:</span>
</span><span id="CsvPaths-627"><a href="#CsvPaths-627"><span class="linenos"> 627</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Stop-all set. Shutting down run.&quot;</span><span class="p">)</span>
</span><span id="CsvPaths-628"><a href="#CsvPaths-628"><span class="linenos"> 628</span></a>                <span class="k">break</span>
</span><span id="CsvPaths-629"><a href="#CsvPaths-629"><span class="linenos"> 629</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_advance_all</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CsvPaths-630"><a href="#CsvPaths-630"><span class="linenos"> 630</span></a>                <span class="n">advance_err</span> <span class="o">=</span> <span class="s2">&quot;Found the advance-all signal set. advance_all() is&quot;</span>
</span><span id="CsvPaths-631"><a href="#CsvPaths-631"><span class="linenos"> 631</span></a>                <span class="n">advance_err</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">advance_err</span><span class="si">}</span><span class="s2"> only for breadth-first runs using the&quot;</span>
</span><span id="CsvPaths-632"><a href="#CsvPaths-632"><span class="linenos"> 632</span></a>                <span class="n">advance_err</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">advance_err</span><span class="si">}</span><span class="s2"> &#39;_by_line&#39; methods. It has the same&quot;</span>
</span><span id="CsvPaths-633"><a href="#CsvPaths-633"><span class="linenos"> 633</span></a>                <span class="n">advance_err</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">advance_err</span><span class="si">}</span><span class="s2"> effect as advance() in a&quot;</span>
</span><span id="CsvPaths-634"><a href="#CsvPaths-634"><span class="linenos"> 634</span></a>                <span class="n">advance_err</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">advance_err</span><span class="si">}</span><span class="s2"> serial run like this one.&quot;</span>
</span><span id="CsvPaths-635"><a href="#CsvPaths-635"><span class="linenos"> 635</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">advance_err</span><span class="p">)</span>
</span><span id="CsvPaths-636"><a href="#CsvPaths-636"><span class="linenos"> 636</span></a>            <span class="n">csvpath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">csvpath</span><span class="p">()</span>
</span><span id="CsvPaths-637"><a href="#CsvPaths-637"><span class="linenos"> 637</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">Result</span><span class="p">(</span>
</span><span id="CsvPaths-638"><a href="#CsvPaths-638"><span class="linenos"> 638</span></a>                <span class="n">csvpath</span><span class="o">=</span><span class="n">csvpath</span><span class="p">,</span>
</span><span id="CsvPaths-639"><a href="#CsvPaths-639"><span class="linenos"> 639</span></a>                <span class="n">file_name</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths-640"><a href="#CsvPaths-640"><span class="linenos"> 640</span></a>                <span class="n">paths_name</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths-641"><a href="#CsvPaths-641"><span class="linenos"> 641</span></a>                <span class="n">run_index</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>
</span><span id="CsvPaths-642"><a href="#CsvPaths-642"><span class="linenos"> 642</span></a>                <span class="n">run_time</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_run_time</span><span class="p">,</span>
</span><span id="CsvPaths-643"><a href="#CsvPaths-643"><span class="linenos"> 643</span></a>                <span class="n">run_dir</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span>
</span><span id="CsvPaths-644"><a href="#CsvPaths-644"><span class="linenos"> 644</span></a>            <span class="p">)</span>
</span><span id="CsvPaths-645"><a href="#CsvPaths-645"><span class="linenos"> 645</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fail_all</span><span class="p">:</span>
</span><span id="CsvPaths-646"><a href="#CsvPaths-646"><span class="linenos"> 646</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="CsvPaths-647"><a href="#CsvPaths-647"><span class="linenos"> 647</span></a>                    <span class="s2">&quot;Fail-all set. Failing all remaining CsvPath instances in the run.&quot;</span>
</span><span id="CsvPaths-648"><a href="#CsvPaths-648"><span class="linenos"> 648</span></a>                <span class="p">)</span>
</span><span id="CsvPaths-649"><a href="#CsvPaths-649"><span class="linenos"> 649</span></a>                <span class="n">csvpath</span><span class="o">.</span><span class="n">is_valid</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CsvPaths-650"><a href="#CsvPaths-650"><span class="linenos"> 650</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="CsvPaths-651"><a href="#CsvPaths-651"><span class="linenos"> 651</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_load_csvpath</span><span class="p">(</span>
</span><span id="CsvPaths-652"><a href="#CsvPaths-652"><span class="linenos"> 652</span></a>                    <span class="n">csvpath</span><span class="o">=</span><span class="n">csvpath</span><span class="p">,</span>
</span><span id="CsvPaths-653"><a href="#CsvPaths-653"><span class="linenos"> 653</span></a>                    <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>
</span><span id="CsvPaths-654"><a href="#CsvPaths-654"><span class="linenos"> 654</span></a>                    <span class="n">file</span><span class="o">=</span><span class="n">file</span><span class="p">,</span>
</span><span id="CsvPaths-655"><a href="#CsvPaths-655"><span class="linenos"> 655</span></a>                    <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths-656"><a href="#CsvPaths-656"><span class="linenos"> 656</span></a>                    <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths-657"><a href="#CsvPaths-657"><span class="linenos"> 657</span></a>                    <span class="n">crt</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span>
</span><span id="CsvPaths-658"><a href="#CsvPaths-658"><span class="linenos"> 658</span></a>                <span class="p">)</span>
</span><span id="CsvPaths-659"><a href="#CsvPaths-659"><span class="linenos"> 659</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths-660"><a href="#CsvPaths-660"><span class="linenos"> 660</span></a>                <span class="c1"># if run-mode: no-run we skip ahead without saving results</span>
</span><span id="CsvPaths-661"><a href="#CsvPaths-661"><span class="linenos"> 661</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths-662"><a href="#CsvPaths-662"><span class="linenos"> 662</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">csvpath</span><span class="o">.</span><span class="n">will_run</span><span class="p">:</span>
</span><span id="CsvPaths-663"><a href="#CsvPaths-663"><span class="linenos"> 663</span></a>                    <span class="k">continue</span>
</span><span id="CsvPaths-664"><a href="#CsvPaths-664"><span class="linenos"> 664</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths-665"><a href="#CsvPaths-665"><span class="linenos"> 665</span></a>                <span class="c1"># the add has to come after _load_csvpath because we need the identity or index</span>
</span><span id="CsvPaths-666"><a href="#CsvPaths-666"><span class="linenos"> 666</span></a>                <span class="c1"># to be stable and the identity is found in load, if it exists.</span>
</span><span id="CsvPaths-667"><a href="#CsvPaths-667"><span class="linenos"> 667</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths-668"><a href="#CsvPaths-668"><span class="linenos"> 668</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">add_named_result</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths-669"><a href="#CsvPaths-669"><span class="linenos"> 669</span></a>                <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">csvpath</span><span class="o">.</span><span class="n">next</span><span class="p">():</span>
</span><span id="CsvPaths-670"><a href="#CsvPaths-670"><span class="linenos"> 670</span></a>                    <span class="c1">#</span>
</span><span id="CsvPaths-671"><a href="#CsvPaths-671"><span class="linenos"> 671</span></a>                    <span class="c1"># removed dec 1. why was this? it doesn&#39;t seem to make sense and</span>
</span><span id="CsvPaths-672"><a href="#CsvPaths-672"><span class="linenos"> 672</span></a>                    <span class="c1"># removing it doesn&#39;t break any unit tests. was it a mistake?</span>
</span><span id="CsvPaths-673"><a href="#CsvPaths-673"><span class="linenos"> 673</span></a>                    <span class="c1">#</span>
</span><span id="CsvPaths-674"><a href="#CsvPaths-674"><span class="linenos"> 674</span></a>                    <span class="c1"># line.append(result)</span>
</span><span id="CsvPaths-675"><a href="#CsvPaths-675"><span class="linenos"> 675</span></a>                    <span class="k">if</span> <span class="n">collect</span><span class="p">:</span>
</span><span id="CsvPaths-676"><a href="#CsvPaths-676"><span class="linenos"> 676</span></a>                        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="CsvPaths-677"><a href="#CsvPaths-677"><span class="linenos"> 677</span></a>                        <span class="n">result</span><span class="o">.</span><span class="n">unmatched</span> <span class="o">=</span> <span class="n">csvpath</span><span class="o">.</span><span class="n">unmatched</span>
</span><span id="CsvPaths-678"><a href="#CsvPaths-678"><span class="linenos"> 678</span></a>                    <span class="k">yield</span> <span class="n">line</span>
</span><span id="CsvPaths-679"><a href="#CsvPaths-679"><span class="linenos"> 679</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>  <span class="c1"># pylint: disable=W0718</span>
</span><span id="CsvPaths-680"><a href="#CsvPaths-680"><span class="linenos"> 680</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">error_manager</span><span class="o">.</span><span class="n">handle_error</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="CsvPaths-681"><a href="#CsvPaths-681"><span class="linenos"> 681</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ecoms</span><span class="o">.</span><span class="n">do_i_raise</span><span class="p">():</span>
</span><span id="CsvPaths-682"><a href="#CsvPaths-682"><span class="linenos"> 682</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths-683"><a href="#CsvPaths-683"><span class="linenos"> 683</span></a>                    <span class="k">raise</span>
</span><span id="CsvPaths-684"><a href="#CsvPaths-684"><span class="linenos"> 684</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths-685"><a href="#CsvPaths-685"><span class="linenos"> 685</span></a>            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths-686"><a href="#CsvPaths-686"><span class="linenos"> 686</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-687"><a href="#CsvPaths-687"><span class="linenos"> 687</span></a>        <span class="c1"># run ends here</span>
</span><span id="CsvPaths-688"><a href="#CsvPaths-688"><span class="linenos"> 688</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-689"><a href="#CsvPaths-689"><span class="linenos"> 689</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">complete_run</span><span class="p">(</span>
</span><span id="CsvPaths-690"><a href="#CsvPaths-690"><span class="linenos"> 690</span></a>            <span class="n">run_dir</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span> <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span>
</span><span id="CsvPaths-691"><a href="#CsvPaths-691"><span class="linenos"> 691</span></a>        <span class="p">)</span>
</span><span id="CsvPaths-692"><a href="#CsvPaths-692"><span class="linenos"> 692</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clear_run_coordination</span><span class="p">()</span>
</span><span id="CsvPaths-693"><a href="#CsvPaths-693"><span class="linenos"> 693</span></a>
</span><span id="CsvPaths-694"><a href="#CsvPaths-694"><span class="linenos"> 694</span></a>    <span class="c1"># =============== breadth first processing ================</span>
</span><span id="CsvPaths-695"><a href="#CsvPaths-695"><span class="linenos"> 695</span></a>
</span><span id="CsvPaths-696"><a href="#CsvPaths-696"><span class="linenos"> 696</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">collect_by_line</span><span class="p">(</span>
</span><span id="CsvPaths-697"><a href="#CsvPaths-697"><span class="linenos"> 697</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">if_all_agree</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">collect_when_not_matched</span><span class="o">=</span><span class="kc">False</span>
</span><span id="CsvPaths-698"><a href="#CsvPaths-698"><span class="linenos"> 698</span></a>    <span class="p">):</span>
</span><span id="CsvPaths-699"><a href="#CsvPaths-699"><span class="linenos"> 699</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="CsvPaths-700"><a href="#CsvPaths-700"><span class="linenos"> 700</span></a>            <span class="s2">&quot;Starting collect_by_line for paths: </span><span class="si">%s</span><span class="s2"> and file: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span>
</span><span id="CsvPaths-701"><a href="#CsvPaths-701"><span class="linenos"> 701</span></a>        <span class="p">)</span>
</span><span id="CsvPaths-702"><a href="#CsvPaths-702"><span class="linenos"> 702</span></a>        <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CsvPaths-703"><a href="#CsvPaths-703"><span class="linenos"> 703</span></a>        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">next_by_line</span><span class="p">(</span>  <span class="c1"># pylint: disable=W0612</span>
</span><span id="CsvPaths-704"><a href="#CsvPaths-704"><span class="linenos"> 704</span></a>            <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths-705"><a href="#CsvPaths-705"><span class="linenos"> 705</span></a>            <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths-706"><a href="#CsvPaths-706"><span class="linenos"> 706</span></a>            <span class="n">collect</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="CsvPaths-707"><a href="#CsvPaths-707"><span class="linenos"> 707</span></a>            <span class="n">if_all_agree</span><span class="o">=</span><span class="n">if_all_agree</span><span class="p">,</span>
</span><span id="CsvPaths-708"><a href="#CsvPaths-708"><span class="linenos"> 708</span></a>            <span class="n">collect_when_not_matched</span><span class="o">=</span><span class="n">collect_when_not_matched</span><span class="p">,</span>
</span><span id="CsvPaths-709"><a href="#CsvPaths-709"><span class="linenos"> 709</span></a>        <span class="p">):</span>
</span><span id="CsvPaths-710"><a href="#CsvPaths-710"><span class="linenos"> 710</span></a>            <span class="c1"># re: W0612: we need &#39;line&#39; in order to do the iteration. we have to iterate.</span>
</span><span id="CsvPaths-711"><a href="#CsvPaths-711"><span class="linenos"> 711</span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="CsvPaths-712"><a href="#CsvPaths-712"><span class="linenos"> 712</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="CsvPaths-713"><a href="#CsvPaths-713"><span class="linenos"> 713</span></a>            <span class="s2">&quot;Completed collect_by_line for paths: </span><span class="si">%s</span><span class="s2"> and file: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span>
</span><span id="CsvPaths-714"><a href="#CsvPaths-714"><span class="linenos"> 714</span></a>        <span class="p">)</span>
</span><span id="CsvPaths-715"><a href="#CsvPaths-715"><span class="linenos"> 715</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-716"><a href="#CsvPaths-716"><span class="linenos"> 716</span></a>        <span class="c1"># the results have all the lines according to what CsvPath captured them, but</span>
</span><span id="CsvPaths-717"><a href="#CsvPaths-717"><span class="linenos"> 717</span></a>        <span class="c1"># since we&#39;re doing if_all_agree T/F we should return the union here. for some</span>
</span><span id="CsvPaths-718"><a href="#CsvPaths-718"><span class="linenos"> 718</span></a>        <span class="c1"># files this obviously makes the data in memory problem even bigger, but it&#39;s</span>
</span><span id="CsvPaths-719"><a href="#CsvPaths-719"><span class="linenos"> 719</span></a>        <span class="c1"># operator&#39;s responsibility to know if that will be a problem for their use</span>
</span><span id="CsvPaths-720"><a href="#CsvPaths-720"><span class="linenos"> 720</span></a>        <span class="c1"># case.</span>
</span><span id="CsvPaths-721"><a href="#CsvPaths-721"><span class="linenos"> 721</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-722"><a href="#CsvPaths-722"><span class="linenos"> 722</span></a>        <span class="k">return</span> <span class="n">lines</span>
</span><span id="CsvPaths-723"><a href="#CsvPaths-723"><span class="linenos"> 723</span></a>
</span><span id="CsvPaths-724"><a href="#CsvPaths-724"><span class="linenos"> 724</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fast_forward_by_line</span><span class="p">(</span>
</span><span id="CsvPaths-725"><a href="#CsvPaths-725"><span class="linenos"> 725</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">if_all_agree</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">collect_when_not_matched</span><span class="o">=</span><span class="kc">False</span>
</span><span id="CsvPaths-726"><a href="#CsvPaths-726"><span class="linenos"> 726</span></a>    <span class="p">):</span>
</span><span id="CsvPaths-727"><a href="#CsvPaths-727"><span class="linenos"> 727</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="CsvPaths-728"><a href="#CsvPaths-728"><span class="linenos"> 728</span></a>            <span class="s2">&quot;Starting fast_forward_by_line for paths: </span><span class="si">%s</span><span class="s2"> and file: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="CsvPaths-729"><a href="#CsvPaths-729"><span class="linenos"> 729</span></a>            <span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths-730"><a href="#CsvPaths-730"><span class="linenos"> 730</span></a>            <span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths-731"><a href="#CsvPaths-731"><span class="linenos"> 731</span></a>        <span class="p">)</span>
</span><span id="CsvPaths-732"><a href="#CsvPaths-732"><span class="linenos"> 732</span></a>        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">next_by_line</span><span class="p">(</span>  <span class="c1"># pylint: disable=W0612</span>
</span><span id="CsvPaths-733"><a href="#CsvPaths-733"><span class="linenos"> 733</span></a>            <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths-734"><a href="#CsvPaths-734"><span class="linenos"> 734</span></a>            <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths-735"><a href="#CsvPaths-735"><span class="linenos"> 735</span></a>            <span class="n">collect</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="CsvPaths-736"><a href="#CsvPaths-736"><span class="linenos"> 736</span></a>            <span class="n">if_all_agree</span><span class="o">=</span><span class="n">if_all_agree</span><span class="p">,</span>
</span><span id="CsvPaths-737"><a href="#CsvPaths-737"><span class="linenos"> 737</span></a>            <span class="n">collect_when_not_matched</span><span class="o">=</span><span class="n">collect_when_not_matched</span><span class="p">,</span>
</span><span id="CsvPaths-738"><a href="#CsvPaths-738"><span class="linenos"> 738</span></a>        <span class="p">):</span>
</span><span id="CsvPaths-739"><a href="#CsvPaths-739"><span class="linenos"> 739</span></a>            <span class="c1"># re: W0612: we need &#39;line&#39; in order to do the iteration. we have to iterate.</span>
</span><span id="CsvPaths-740"><a href="#CsvPaths-740"><span class="linenos"> 740</span></a>            <span class="k">pass</span>
</span><span id="CsvPaths-741"><a href="#CsvPaths-741"><span class="linenos"> 741</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="CsvPaths-742"><a href="#CsvPaths-742"><span class="linenos"> 742</span></a>            <span class="s2">&quot;Completed fast_forward_by_line for paths: </span><span class="si">%s</span><span class="s2"> and file: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="CsvPaths-743"><a href="#CsvPaths-743"><span class="linenos"> 743</span></a>            <span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths-744"><a href="#CsvPaths-744"><span class="linenos"> 744</span></a>            <span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths-745"><a href="#CsvPaths-745"><span class="linenos"> 745</span></a>        <span class="p">)</span>
</span><span id="CsvPaths-746"><a href="#CsvPaths-746"><span class="linenos"> 746</span></a>
</span><span id="CsvPaths-747"><a href="#CsvPaths-747"><span class="linenos"> 747</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">next_by_line</span><span class="p">(</span>  <span class="c1"># pylint: disable=R0912,R0915,R0914</span>
</span><span id="CsvPaths-748"><a href="#CsvPaths-748"><span class="linenos"> 748</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="CsvPaths-749"><a href="#CsvPaths-749"><span class="linenos"> 749</span></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="CsvPaths-750"><a href="#CsvPaths-750"><span class="linenos"> 750</span></a>        <span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths-751"><a href="#CsvPaths-751"><span class="linenos"> 751</span></a>        <span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths-752"><a href="#CsvPaths-752"><span class="linenos"> 752</span></a>        <span class="n">collect</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="CsvPaths-753"><a href="#CsvPaths-753"><span class="linenos"> 753</span></a>        <span class="n">if_all_agree</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="CsvPaths-754"><a href="#CsvPaths-754"><span class="linenos"> 754</span></a>        <span class="n">collect_when_not_matched</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="CsvPaths-755"><a href="#CsvPaths-755"><span class="linenos"> 755</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
</span><span id="CsvPaths-756"><a href="#CsvPaths-756"><span class="linenos"> 756</span></a>        <span class="c1"># re: R0912 -- absolutely. plan to refactor.</span>
</span><span id="CsvPaths-757"><a href="#CsvPaths-757"><span class="linenos"> 757</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Prepping </span><span class="si">%s</span><span class="s2"> and </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths-758"><a href="#CsvPaths-758"><span class="linenos"> 758</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clean</span><span class="p">(</span><span class="n">paths</span><span class="o">=</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths-759"><a href="#CsvPaths-759"><span class="linenos"> 759</span></a>        <span class="n">fn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_manager</span><span class="o">.</span><span class="n">get_named_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span><span id="CsvPaths-760"><a href="#CsvPaths-760"><span class="linenos"> 760</span></a>        <span class="n">paths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">paths_manager</span><span class="o">.</span><span class="n">get_named_paths</span><span class="p">(</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths-761"><a href="#CsvPaths-761"><span class="linenos"> 761</span></a>        <span class="k">if</span> <span class="p">(</span>
</span><span id="CsvPaths-762"><a href="#CsvPaths-762"><span class="linenos"> 762</span></a>            <span class="n">paths</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">paths</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
</span><span id="CsvPaths-763"><a href="#CsvPaths-763"><span class="linenos"> 763</span></a>        <span class="p">):</span>  <span class="c1"># pragma: no cover</span>
</span><span id="CsvPaths-764"><a href="#CsvPaths-764"><span class="linenos"> 764</span></a>            <span class="k">raise</span> <span class="n">InputException</span><span class="p">(</span>
</span><span id="CsvPaths-765"><a href="#CsvPaths-765"><span class="linenos"> 765</span></a>                <span class="sa">f</span><span class="s2">&quot;Pathsname &#39;</span><span class="si">{</span><span class="n">pathsname</span><span class="si">}</span><span class="s2">&#39; must name a list of csvpaths&quot;</span>
</span><span id="CsvPaths-766"><a href="#CsvPaths-766"><span class="linenos"> 766</span></a>            <span class="p">)</span>
</span><span id="CsvPaths-767"><a href="#CsvPaths-767"><span class="linenos"> 767</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-768"><a href="#CsvPaths-768"><span class="linenos"> 768</span></a>        <span class="c1"># experiment!</span>
</span><span id="CsvPaths-769"><a href="#CsvPaths-769"><span class="linenos"> 769</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-770"><a href="#CsvPaths-770"><span class="linenos"> 770</span></a>        <span class="n">crt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_time_str</span><span class="p">(</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths-771"><a href="#CsvPaths-771"><span class="linenos"> 771</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-772"><a href="#CsvPaths-772"><span class="linenos"> 772</span></a>        <span class="c1"># also use of crt below</span>
</span><span id="CsvPaths-773"><a href="#CsvPaths-773"><span class="linenos"> 773</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-774"><a href="#CsvPaths-774"><span class="linenos"> 774</span></a>        <span class="n">csvpath_objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_csvpath_objects</span><span class="p">(</span>
</span><span id="CsvPaths-775"><a href="#CsvPaths-775"><span class="linenos"> 775</span></a>            <span class="n">paths</span><span class="o">=</span><span class="n">paths</span><span class="p">,</span>
</span><span id="CsvPaths-776"><a href="#CsvPaths-776"><span class="linenos"> 776</span></a>            <span class="n">named_file</span><span class="o">=</span><span class="n">fn</span><span class="p">,</span>
</span><span id="CsvPaths-777"><a href="#CsvPaths-777"><span class="linenos"> 777</span></a>            <span class="n">collect_when_not_matched</span><span class="o">=</span><span class="n">collect_when_not_matched</span><span class="p">,</span>
</span><span id="CsvPaths-778"><a href="#CsvPaths-778"><span class="linenos"> 778</span></a>            <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths-779"><a href="#CsvPaths-779"><span class="linenos"> 779</span></a>            <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths-780"><a href="#CsvPaths-780"><span class="linenos"> 780</span></a>            <span class="n">crt</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span>
</span><span id="CsvPaths-781"><a href="#CsvPaths-781"><span class="linenos"> 781</span></a>        <span class="p">)</span>
</span><span id="CsvPaths-782"><a href="#CsvPaths-782"><span class="linenos"> 782</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-783"><a href="#CsvPaths-783"><span class="linenos"> 783</span></a>        <span class="c1"># prep has to come after _load_csvpath_objects because we need the identity or</span>
</span><span id="CsvPaths-784"><a href="#CsvPaths-784"><span class="linenos"> 784</span></a>        <span class="c1"># indexes to be stable and the identity is found in the load, if it exists.</span>
</span><span id="CsvPaths-785"><a href="#CsvPaths-785"><span class="linenos"> 785</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-786"><a href="#CsvPaths-786"><span class="linenos"> 786</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_prep_csvpath_results</span><span class="p">(</span>
</span><span id="CsvPaths-787"><a href="#CsvPaths-787"><span class="linenos"> 787</span></a>            <span class="n">csvpath_objects</span><span class="o">=</span><span class="n">csvpath_objects</span><span class="p">,</span>
</span><span id="CsvPaths-788"><a href="#CsvPaths-788"><span class="linenos"> 788</span></a>            <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths-789"><a href="#CsvPaths-789"><span class="linenos"> 789</span></a>            <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths-790"><a href="#CsvPaths-790"><span class="linenos"> 790</span></a>            <span class="n">crt</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span>
</span><span id="CsvPaths-791"><a href="#CsvPaths-791"><span class="linenos"> 791</span></a>        <span class="p">)</span>
</span><span id="CsvPaths-792"><a href="#CsvPaths-792"><span class="linenos"> 792</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-793"><a href="#CsvPaths-793"><span class="linenos"> 793</span></a>        <span class="c1"># setting fn into the csvpath is less obviously useful at CsvPaths</span>
</span><span id="CsvPaths-794"><a href="#CsvPaths-794"><span class="linenos"> 794</span></a>        <span class="c1"># but we&#39;ll do it for consistency.</span>
</span><span id="CsvPaths-795"><a href="#CsvPaths-795"><span class="linenos"> 795</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-796"><a href="#CsvPaths-796"><span class="linenos"> 796</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Beginning next_by_line with </span><span class="si">%s</span><span class="s2"> paths&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">csvpath_objects</span><span class="p">))</span>
</span><span id="CsvPaths-797"><a href="#CsvPaths-797"><span class="linenos"> 797</span></a>        <span class="n">reader</span> <span class="o">=</span> <span class="n">FileManager</span><span class="o">.</span><span class="n">get_reader</span><span class="p">(</span>
</span><span id="CsvPaths-798"><a href="#CsvPaths-798"><span class="linenos"> 798</span></a>            <span class="n">fn</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">,</span> <span class="n">quotechar</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">quotechar</span>
</span><span id="CsvPaths-799"><a href="#CsvPaths-799"><span class="linenos"> 799</span></a>        <span class="p">)</span>
</span><span id="CsvPaths-800"><a href="#CsvPaths-800"><span class="linenos"> 800</span></a>        <span class="n">stopped_count</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CsvPaths-801"><a href="#CsvPaths-801"><span class="linenos"> 801</span></a>        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">reader</span><span class="o">.</span><span class="n">next</span><span class="p">():</span>
</span><span id="CsvPaths-802"><a href="#CsvPaths-802"><span class="linenos"> 802</span></a>            <span class="c1"># for line in reader:  # pylint: disable=R1702</span>
</span><span id="CsvPaths-803"><a href="#CsvPaths-803"><span class="linenos"> 803</span></a>            <span class="c1"># question to self: should this default be in a central place</span>
</span><span id="CsvPaths-804"><a href="#CsvPaths-804"><span class="linenos"> 804</span></a>            <span class="c1"># so that we can switch to OR, in part by changing the default?</span>
</span><span id="CsvPaths-805"><a href="#CsvPaths-805"><span class="linenos"> 805</span></a>            <span class="n">keep</span> <span class="o">=</span> <span class="n">if_all_agree</span>
</span><span id="CsvPaths-806"><a href="#CsvPaths-806"><span class="linenos"> 806</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_skip_all</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CsvPaths-807"><a href="#CsvPaths-807"><span class="linenos"> 807</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_advance_all</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="CsvPaths-808"><a href="#CsvPaths-808"><span class="linenos"> 808</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="CsvPaths-809"><a href="#CsvPaths-809"><span class="linenos"> 809</span></a>                <span class="c1"># p is a (CsvPath, List[List[str]]) where the second item is</span>
</span><span id="CsvPaths-810"><a href="#CsvPaths-810"><span class="linenos"> 810</span></a>                <span class="c1"># the line-by-line results of the first item&#39;s matching</span>
</span><span id="CsvPaths-811"><a href="#CsvPaths-811"><span class="linenos"> 811</span></a>                <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">csvpath_objects</span><span class="p">:</span>
</span><span id="CsvPaths-812"><a href="#CsvPaths-812"><span class="linenos"> 812</span></a>                    <span class="c1">#</span>
</span><span id="CsvPaths-813"><a href="#CsvPaths-813"><span class="linenos"> 813</span></a>                    <span class="c1"># if run-mode: no-run we skip ahead without saving results</span>
</span><span id="CsvPaths-814"><a href="#CsvPaths-814"><span class="linenos"> 814</span></a>                    <span class="c1">#</span>
</span><span id="CsvPaths-815"><a href="#CsvPaths-815"><span class="linenos"> 815</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">will_run</span><span class="p">:</span>
</span><span id="CsvPaths-816"><a href="#CsvPaths-816"><span class="linenos"> 816</span></a>                        <span class="k">continue</span>
</span><span id="CsvPaths-817"><a href="#CsvPaths-817"><span class="linenos"> 817</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="CsvPaths-818"><a href="#CsvPaths-818"><span class="linenos"> 818</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fail_all</span><span class="p">:</span>
</span><span id="CsvPaths-819"><a href="#CsvPaths-819"><span class="linenos"> 819</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="CsvPaths-820"><a href="#CsvPaths-820"><span class="linenos"> 820</span></a>                            <span class="s2">&quot;Fail-all set. Setting CsvPath is_valid to False.&quot;</span>
</span><span id="CsvPaths-821"><a href="#CsvPaths-821"><span class="linenos"> 821</span></a>                        <span class="p">)</span>
</span><span id="CsvPaths-822"><a href="#CsvPaths-822"><span class="linenos"> 822</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">is_valid</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CsvPaths-823"><a href="#CsvPaths-823"><span class="linenos"> 823</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stop_all</span><span class="p">:</span>
</span><span id="CsvPaths-824"><a href="#CsvPaths-824"><span class="linenos"> 824</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Stop-all set. Shutting down run.&quot;</span><span class="p">)</span>
</span><span id="CsvPaths-825"><a href="#CsvPaths-825"><span class="linenos"> 825</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">stopped</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="CsvPaths-826"><a href="#CsvPaths-826"><span class="linenos"> 826</span></a>                        <span class="k">continue</span>
</span><span id="CsvPaths-827"><a href="#CsvPaths-827"><span class="linenos"> 827</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_skip_all</span><span class="p">:</span>
</span><span id="CsvPaths-828"><a href="#CsvPaths-828"><span class="linenos"> 828</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Skip-all set. Continuing to next.&quot;</span><span class="p">)</span>
</span><span id="CsvPaths-829"><a href="#CsvPaths-829"><span class="linenos"> 829</span></a>                        <span class="c1">#</span>
</span><span id="CsvPaths-830"><a href="#CsvPaths-830"><span class="linenos"> 830</span></a>                        <span class="c1"># all following CsvPaths must have their</span>
</span><span id="CsvPaths-831"><a href="#CsvPaths-831"><span class="linenos"> 831</span></a>                        <span class="c1"># line_monitors incremented</span>
</span><span id="CsvPaths-832"><a href="#CsvPaths-832"><span class="linenos"> 832</span></a>                        <span class="c1">#</span>
</span><span id="CsvPaths-833"><a href="#CsvPaths-833"><span class="linenos"> 833</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">track_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="CsvPaths-834"><a href="#CsvPaths-834"><span class="linenos"> 834</span></a>                        <span class="k">continue</span>
</span><span id="CsvPaths-835"><a href="#CsvPaths-835"><span class="linenos"> 835</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_advance_all</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CsvPaths-836"><a href="#CsvPaths-836"><span class="linenos"> 836</span></a>                        <span class="n">logtxt</span> <span class="o">=</span> <span class="s2">&quot;Advance-all set. Setting advance. &quot;</span>
</span><span id="CsvPaths-837"><a href="#CsvPaths-837"><span class="linenos"> 837</span></a>                        <span class="n">logtxt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">logtxt</span><span class="si">}</span><span class="s2">CsvPath and its Matcher will handle the advancing.&quot;</span>
</span><span id="CsvPaths-838"><a href="#CsvPaths-838"><span class="linenos"> 838</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">logtxt</span><span class="p">)</span>
</span><span id="CsvPaths-839"><a href="#CsvPaths-839"><span class="linenos"> 839</span></a>                        <span class="c1">#</span>
</span><span id="CsvPaths-840"><a href="#CsvPaths-840"><span class="linenos"> 840</span></a>                        <span class="c1"># CsvPath will handle advancing so we don&#39;t need to do</span>
</span><span id="CsvPaths-841"><a href="#CsvPaths-841"><span class="linenos"> 841</span></a>                        <span class="c1"># anything, including track_line(line). we just need to</span>
</span><span id="CsvPaths-842"><a href="#CsvPaths-842"><span class="linenos"> 842</span></a>                        <span class="c1"># see if we&#39;re setting advance or increasing it.</span>
</span><span id="CsvPaths-843"><a href="#CsvPaths-843"><span class="linenos"> 843</span></a>                        <span class="c1">#</span>
</span><span id="CsvPaths-844"><a href="#CsvPaths-844"><span class="linenos"> 844</span></a>                        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">advance_count</span>
</span><span id="CsvPaths-845"><a href="#CsvPaths-845"><span class="linenos"> 845</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_advance_all</span> <span class="o">&gt;</span> <span class="n">a</span><span class="p">:</span>
</span><span id="CsvPaths-846"><a href="#CsvPaths-846"><span class="linenos"> 846</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">advance_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_advance_all</span>
</span><span id="CsvPaths-847"><a href="#CsvPaths-847"><span class="linenos"> 847</span></a>                        <span class="c1">#</span>
</span><span id="CsvPaths-848"><a href="#CsvPaths-848"><span class="linenos"> 848</span></a>                        <span class="c1"># all following CsvPaths must have their</span>
</span><span id="CsvPaths-849"><a href="#CsvPaths-849"><span class="linenos"> 849</span></a>                        <span class="c1"># advance incremented -- with the advance not being simply</span>
</span><span id="CsvPaths-850"><a href="#CsvPaths-850"><span class="linenos"> 850</span></a>                        <span class="c1"># additive, have to be mindful of any existing advance</span>
</span><span id="CsvPaths-851"><a href="#CsvPaths-851"><span class="linenos"> 851</span></a>                        <span class="c1"># count!</span>
</span><span id="CsvPaths-852"><a href="#CsvPaths-852"><span class="linenos"> 852</span></a>                        <span class="c1">#</span>
</span><span id="CsvPaths-853"><a href="#CsvPaths-853"><span class="linenos"> 853</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">stopped</span><span class="p">:</span>  <span class="c1"># pylint: disable=R1724</span>
</span><span id="CsvPaths-854"><a href="#CsvPaths-854"><span class="linenos"> 854</span></a>                        <span class="k">continue</span>
</span><span id="CsvPaths-855"><a href="#CsvPaths-855"><span class="linenos"> 855</span></a>
</span><span id="CsvPaths-856"><a href="#CsvPaths-856"><span class="linenos"> 856</span></a>                    <span class="c1">#</span>
</span><span id="CsvPaths-857"><a href="#CsvPaths-857"><span class="linenos"> 857</span></a>                    <span class="c1"># allowing the match to happen regardless of keep</span>
</span><span id="CsvPaths-858"><a href="#CsvPaths-858"><span class="linenos"> 858</span></a>                    <span class="c1"># because we may want side-effects or to have different</span>
</span><span id="CsvPaths-859"><a href="#CsvPaths-859"><span class="linenos"> 859</span></a>                    <span class="c1"># results in different named-results, as well as the</span>
</span><span id="CsvPaths-860"><a href="#CsvPaths-860"><span class="linenos"> 860</span></a>                    <span class="c1"># union</span>
</span><span id="CsvPaths-861"><a href="#CsvPaths-861"><span class="linenos"> 861</span></a>                    <span class="c1">#</span>
</span><span id="CsvPaths-862"><a href="#CsvPaths-862"><span class="linenos"> 862</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="CsvPaths-863"><a href="#CsvPaths-863"><span class="linenos"> 863</span></a>                        <span class="s2">&quot;considering line with csvpath identified as: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="CsvPaths-864"><a href="#CsvPaths-864"><span class="linenos"> 864</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">identity</span><span class="p">,</span>
</span><span id="CsvPaths-865"><a href="#CsvPaths-865"><span class="linenos"> 865</span></a>                    <span class="p">)</span>
</span><span id="CsvPaths-866"><a href="#CsvPaths-866"><span class="linenos"> 866</span></a>                    <span class="n">matched</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CsvPaths-867"><a href="#CsvPaths-867"><span class="linenos"> 867</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">track_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="CsvPaths-868"><a href="#CsvPaths-868"><span class="linenos"> 868</span></a>                    <span class="c1">#</span>
</span><span id="CsvPaths-869"><a href="#CsvPaths-869"><span class="linenos"> 869</span></a>                    <span class="c1"># re: W0212: treating _consider_line something like package private</span>
</span><span id="CsvPaths-870"><a href="#CsvPaths-870"><span class="linenos"> 870</span></a>                    <span class="c1">#</span>
</span><span id="CsvPaths-871"><a href="#CsvPaths-871"><span class="linenos"> 871</span></a>                    <span class="n">matched</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="CsvPaths-872"><a href="#CsvPaths-872"><span class="linenos"> 872</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">_consider_line</span><span class="p">(</span>  <span class="c1"># pylint:disable=W0212</span>
</span><span id="CsvPaths-873"><a href="#CsvPaths-873"><span class="linenos"> 873</span></a>                            <span class="n">line</span>
</span><span id="CsvPaths-874"><a href="#CsvPaths-874"><span class="linenos"> 874</span></a>                        <span class="p">)</span>
</span><span id="CsvPaths-875"><a href="#CsvPaths-875"><span class="linenos"> 875</span></a>                    <span class="p">)</span>
</span><span id="CsvPaths-876"><a href="#CsvPaths-876"><span class="linenos"> 876</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">stopped</span><span class="p">:</span>
</span><span id="CsvPaths-877"><a href="#CsvPaths-877"><span class="linenos"> 877</span></a>                        <span class="n">stopped_count</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="CsvPaths-878"><a href="#CsvPaths-878"><span class="linenos"> 878</span></a>                    <span class="k">if</span> <span class="n">if_all_agree</span><span class="p">:</span>
</span><span id="CsvPaths-879"><a href="#CsvPaths-879"><span class="linenos"> 879</span></a>                        <span class="n">keep</span> <span class="o">=</span> <span class="n">keep</span> <span class="ow">and</span> <span class="n">matched</span>
</span><span id="CsvPaths-880"><a href="#CsvPaths-880"><span class="linenos"> 880</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="CsvPaths-881"><a href="#CsvPaths-881"><span class="linenos"> 881</span></a>                        <span class="n">keep</span> <span class="o">=</span> <span class="n">keep</span> <span class="ow">or</span> <span class="n">matched</span>
</span><span id="CsvPaths-882"><a href="#CsvPaths-882"><span class="linenos"> 882</span></a>                    <span class="c1">#</span>
</span><span id="CsvPaths-883"><a href="#CsvPaths-883"><span class="linenos"> 883</span></a>                    <span class="c1"># not doing continue if we have if_all_agree and not keep as we</span>
</span><span id="CsvPaths-884"><a href="#CsvPaths-884"><span class="linenos"> 884</span></a>                    <span class="c1"># used to do allows individual results to have lines that in</span>
</span><span id="CsvPaths-885"><a href="#CsvPaths-885"><span class="linenos"> 885</span></a>                    <span class="c1"># aggregate we do not keep.</span>
</span><span id="CsvPaths-886"><a href="#CsvPaths-886"><span class="linenos"> 886</span></a>                    <span class="c1">#</span>
</span><span id="CsvPaths-887"><a href="#CsvPaths-887"><span class="linenos"> 887</span></a>                    <span class="k">if</span> <span class="n">matched</span> <span class="ow">and</span> <span class="n">collect</span><span class="p">:</span>
</span><span id="CsvPaths-888"><a href="#CsvPaths-888"><span class="linenos"> 888</span></a>                        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">limit_collection</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="CsvPaths-889"><a href="#CsvPaths-889"><span class="linenos"> 889</span></a>                        <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="CsvPaths-890"><a href="#CsvPaths-890"><span class="linenos"> 890</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>  <span class="c1"># pylint: disable=W0718</span>
</span><span id="CsvPaths-891"><a href="#CsvPaths-891"><span class="linenos"> 891</span></a>                <span class="c1"># ex.trace = traceback.format_exc()</span>
</span><span id="CsvPaths-892"><a href="#CsvPaths-892"><span class="linenos"> 892</span></a>                <span class="c1"># ex.source = self</span>
</span><span id="CsvPaths-893"><a href="#CsvPaths-893"><span class="linenos"> 893</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">error_manager</span><span class="o">.</span><span class="n">handle_error</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="CsvPaths-894"><a href="#CsvPaths-894"><span class="linenos"> 894</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ecoms</span><span class="o">.</span><span class="n">do_i_raise</span><span class="p">():</span>
</span><span id="CsvPaths-895"><a href="#CsvPaths-895"><span class="linenos"> 895</span></a>                    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">csvpath_objects</span><span class="p">:</span>
</span><span id="CsvPaths-896"><a href="#CsvPaths-896"><span class="linenos"> 896</span></a>                        <span class="n">result</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="CsvPaths-897"><a href="#CsvPaths-897"><span class="linenos"> 897</span></a>                        <span class="n">result</span><span class="o">.</span><span class="n">unmatched</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">unmatched</span>
</span><span id="CsvPaths-898"><a href="#CsvPaths-898"><span class="linenos"> 898</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths-899"><a href="#CsvPaths-899"><span class="linenos"> 899</span></a>                    <span class="k">raise</span>
</span><span id="CsvPaths-900"><a href="#CsvPaths-900"><span class="linenos"> 900</span></a>            <span class="c1"># we yield even if we stopped in this iteration.</span>
</span><span id="CsvPaths-901"><a href="#CsvPaths-901"><span class="linenos"> 901</span></a>            <span class="c1"># caller needs to see what we stopped on.</span>
</span><span id="CsvPaths-902"><a href="#CsvPaths-902"><span class="linenos"> 902</span></a>            <span class="c1">#</span>
</span><span id="CsvPaths-903"><a href="#CsvPaths-903"><span class="linenos"> 903</span></a>            <span class="c1"># ! we only yield if keep is True</span>
</span><span id="CsvPaths-904"><a href="#CsvPaths-904"><span class="linenos"> 904</span></a>            <span class="c1">#</span>
</span><span id="CsvPaths-905"><a href="#CsvPaths-905"><span class="linenos"> 905</span></a>            <span class="k">if</span> <span class="n">keep</span><span class="p">:</span>
</span><span id="CsvPaths-906"><a href="#CsvPaths-906"><span class="linenos"> 906</span></a>                <span class="k">yield</span> <span class="n">line</span>
</span><span id="CsvPaths-907"><a href="#CsvPaths-907"><span class="linenos"> 907</span></a>            <span class="k">if</span> <span class="nb">sum</span><span class="p">(</span><span class="n">stopped_count</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">csvpath_objects</span><span class="p">):</span>
</span><span id="CsvPaths-908"><a href="#CsvPaths-908"><span class="linenos"> 908</span></a>                <span class="k">break</span>
</span><span id="CsvPaths-909"><a href="#CsvPaths-909"><span class="linenos"> 909</span></a>        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CsvPaths-910"><a href="#CsvPaths-910"><span class="linenos"> 910</span></a>        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">csvpath_objects</span><span class="p">:</span>
</span><span id="CsvPaths-911"><a href="#CsvPaths-911"><span class="linenos"> 911</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="CsvPaths-912"><a href="#CsvPaths-912"><span class="linenos"> 912</span></a>            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths-913"><a href="#CsvPaths-913"><span class="linenos"> 913</span></a>            <span class="n">result</span><span class="o">.</span><span class="n">unmatched</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">unmatched</span>
</span><span id="CsvPaths-914"><a href="#CsvPaths-914"><span class="linenos"> 914</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths-915"><a href="#CsvPaths-915"><span class="linenos"> 915</span></a>
</span><span id="CsvPaths-916"><a href="#CsvPaths-916"><span class="linenos"> 916</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-917"><a href="#CsvPaths-917"><span class="linenos"> 917</span></a>        <span class="c1"># run ends here</span>
</span><span id="CsvPaths-918"><a href="#CsvPaths-918"><span class="linenos"> 918</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-919"><a href="#CsvPaths-919"><span class="linenos"> 919</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">complete_run</span><span class="p">(</span>
</span><span id="CsvPaths-920"><a href="#CsvPaths-920"><span class="linenos"> 920</span></a>            <span class="n">run_dir</span><span class="o">=</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">run_dir</span><span class="p">,</span> <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span>
</span><span id="CsvPaths-921"><a href="#CsvPaths-921"><span class="linenos"> 921</span></a>        <span class="p">)</span>
</span><span id="CsvPaths-922"><a href="#CsvPaths-922"><span class="linenos"> 922</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clear_run_coordination</span><span class="p">()</span>
</span><span id="CsvPaths-923"><a href="#CsvPaths-923"><span class="linenos"> 923</span></a>
</span><span id="CsvPaths-924"><a href="#CsvPaths-924"><span class="linenos"> 924</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_load_csvpath_objects</span><span class="p">(</span>
</span><span id="CsvPaths-925"><a href="#CsvPaths-925"><span class="linenos"> 925</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="CsvPaths-926"><a href="#CsvPaths-926"><span class="linenos"> 926</span></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="CsvPaths-927"><a href="#CsvPaths-927"><span class="linenos"> 927</span></a>        <span class="n">paths</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="CsvPaths-928"><a href="#CsvPaths-928"><span class="linenos"> 928</span></a>        <span class="n">named_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="CsvPaths-929"><a href="#CsvPaths-929"><span class="linenos"> 929</span></a>        <span class="n">collect_when_not_matched</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="CsvPaths-930"><a href="#CsvPaths-930"><span class="linenos"> 930</span></a>        <span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths-931"><a href="#CsvPaths-931"><span class="linenos"> 931</span></a>        <span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths-932"><a href="#CsvPaths-932"><span class="linenos"> 932</span></a>        <span class="n">crt</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="CsvPaths-933"><a href="#CsvPaths-933"><span class="linenos"> 933</span></a>    <span class="p">):</span>
</span><span id="CsvPaths-934"><a href="#CsvPaths-934"><span class="linenos"> 934</span></a>        <span class="n">csvpath_objects</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CsvPaths-935"><a href="#CsvPaths-935"><span class="linenos"> 935</span></a>        <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">paths</span><span class="p">:</span>
</span><span id="CsvPaths-936"><a href="#CsvPaths-936"><span class="linenos"> 936</span></a>            <span class="n">csvpath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">csvpath</span><span class="p">()</span>
</span><span id="CsvPaths-937"><a href="#CsvPaths-937"><span class="linenos"> 937</span></a>            <span class="n">csvpath</span><span class="o">.</span><span class="n">collect_when_not_matched</span> <span class="o">=</span> <span class="n">collect_when_not_matched</span>
</span><span id="CsvPaths-938"><a href="#CsvPaths-938"><span class="linenos"> 938</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="CsvPaths-939"><a href="#CsvPaths-939"><span class="linenos"> 939</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_load_csvpath</span><span class="p">(</span>
</span><span id="CsvPaths-940"><a href="#CsvPaths-940"><span class="linenos"> 940</span></a>                    <span class="n">csvpath</span><span class="o">=</span><span class="n">csvpath</span><span class="p">,</span>
</span><span id="CsvPaths-941"><a href="#CsvPaths-941"><span class="linenos"> 941</span></a>                    <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>
</span><span id="CsvPaths-942"><a href="#CsvPaths-942"><span class="linenos"> 942</span></a>                    <span class="n">file</span><span class="o">=</span><span class="n">named_file</span><span class="p">,</span>
</span><span id="CsvPaths-943"><a href="#CsvPaths-943"><span class="linenos"> 943</span></a>                    <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths-944"><a href="#CsvPaths-944"><span class="linenos"> 944</span></a>                    <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths-945"><a href="#CsvPaths-945"><span class="linenos"> 945</span></a>                    <span class="n">by_line</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="CsvPaths-946"><a href="#CsvPaths-946"><span class="linenos"> 946</span></a>                    <span class="n">crt</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span>
</span><span id="CsvPaths-947"><a href="#CsvPaths-947"><span class="linenos"> 947</span></a>                <span class="p">)</span>
</span><span id="CsvPaths-948"><a href="#CsvPaths-948"><span class="linenos"> 948</span></a>                <span class="k">if</span> <span class="n">csvpath</span><span class="o">.</span><span class="n">data_from_preceding</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="CsvPaths-949"><a href="#CsvPaths-949"><span class="linenos"> 949</span></a>                    <span class="c1"># this exception raise may be redundant, but I&#39;m leaving it for now for good measure.</span>
</span><span id="CsvPaths-950"><a href="#CsvPaths-950"><span class="linenos"> 950</span></a>                    <span class="k">raise</span> <span class="n">CsvPathsException</span><span class="p">(</span>
</span><span id="CsvPaths-951"><a href="#CsvPaths-951"><span class="linenos"> 951</span></a>                        <span class="s2">&quot;Csvpath identified as </span><span class="si">{csvpath.identity}</span><span class="s2"> is set to use preceding data, but CsvPaths&#39;s by_line methods do not permit that&quot;</span>
</span><span id="CsvPaths-952"><a href="#CsvPaths-952"><span class="linenos"> 952</span></a>                    <span class="p">)</span>
</span><span id="CsvPaths-953"><a href="#CsvPaths-953"><span class="linenos"> 953</span></a>                <span class="n">csvpath_objects</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">csvpath</span><span class="p">,</span> <span class="p">[]])</span>
</span><span id="CsvPaths-954"><a href="#CsvPaths-954"><span class="linenos"> 954</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>  <span class="c1"># pylint: disable=W0718</span>
</span><span id="CsvPaths-955"><a href="#CsvPaths-955"><span class="linenos"> 955</span></a>                <span class="n">ex</span><span class="o">.</span><span class="n">trace</span> <span class="o">=</span> <span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">()</span>
</span><span id="CsvPaths-956"><a href="#CsvPaths-956"><span class="linenos"> 956</span></a>                <span class="n">ex</span><span class="o">.</span><span class="n">source</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="CsvPaths-957"><a href="#CsvPaths-957"><span class="linenos"> 957</span></a>                <span class="c1"># the error collector is the Results. it registers itself with</span>
</span><span id="CsvPaths-958"><a href="#CsvPaths-958"><span class="linenos"> 958</span></a>                <span class="c1"># the csvpath as the error collector. not as straightforward but</span>
</span><span id="CsvPaths-959"><a href="#CsvPaths-959"><span class="linenos"> 959</span></a>                <span class="c1"># effectively same as we do above</span>
</span><span id="CsvPaths-960"><a href="#CsvPaths-960"><span class="linenos"> 960</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">error_manager</span><span class="o">.</span><span class="n">handle_error</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="CsvPaths-961"><a href="#CsvPaths-961"><span class="linenos"> 961</span></a>        <span class="k">return</span> <span class="n">csvpath_objects</span>
</span><span id="CsvPaths-962"><a href="#CsvPaths-962"><span class="linenos"> 962</span></a>
</span><span id="CsvPaths-963"><a href="#CsvPaths-963"><span class="linenos"> 963</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_prep_csvpath_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">csvpath_objects</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">crt</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="CsvPaths-964"><a href="#CsvPaths-964"><span class="linenos"> 964</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-965"><a href="#CsvPaths-965"><span class="linenos"> 965</span></a>        <span class="c1"># run starts here</span>
</span><span id="CsvPaths-966"><a href="#CsvPaths-966"><span class="linenos"> 966</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-967"><a href="#CsvPaths-967"><span class="linenos"> 967</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">start_run</span><span class="p">(</span>
</span><span id="CsvPaths-968"><a href="#CsvPaths-968"><span class="linenos"> 968</span></a>            <span class="n">run_dir</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span> <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span>
</span><span id="CsvPaths-969"><a href="#CsvPaths-969"><span class="linenos"> 969</span></a>        <span class="p">)</span>
</span><span id="CsvPaths-970"><a href="#CsvPaths-970"><span class="linenos"> 970</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-971"><a href="#CsvPaths-971"><span class="linenos"> 971</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-972"><a href="#CsvPaths-972"><span class="linenos"> 972</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-973"><a href="#CsvPaths-973"><span class="linenos"> 973</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">csvpath</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">csvpath_objects</span><span class="p">):</span>
</span><span id="CsvPaths-974"><a href="#CsvPaths-974"><span class="linenos"> 974</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="CsvPaths-975"><a href="#CsvPaths-975"><span class="linenos"> 975</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths-976"><a href="#CsvPaths-976"><span class="linenos"> 976</span></a>                <span class="c1"># Result will set itself into its CsvPath as error collector</span>
</span><span id="CsvPaths-977"><a href="#CsvPaths-977"><span class="linenos"> 977</span></a>                <span class="c1"># printer, etc.</span>
</span><span id="CsvPaths-978"><a href="#CsvPaths-978"><span class="linenos"> 978</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths-979"><a href="#CsvPaths-979"><span class="linenos"> 979</span></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">Result</span><span class="p">(</span>
</span><span id="CsvPaths-980"><a href="#CsvPaths-980"><span class="linenos"> 980</span></a>                    <span class="n">csvpath</span><span class="o">=</span><span class="n">csvpath</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="CsvPaths-981"><a href="#CsvPaths-981"><span class="linenos"> 981</span></a>                    <span class="n">file_name</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths-982"><a href="#CsvPaths-982"><span class="linenos"> 982</span></a>                    <span class="n">paths_name</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths-983"><a href="#CsvPaths-983"><span class="linenos"> 983</span></a>                    <span class="n">lines</span><span class="o">=</span><span class="n">csvpath</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
</span><span id="CsvPaths-984"><a href="#CsvPaths-984"><span class="linenos"> 984</span></a>                    <span class="n">run_index</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>
</span><span id="CsvPaths-985"><a href="#CsvPaths-985"><span class="linenos"> 985</span></a>                    <span class="n">run_time</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_run_time</span><span class="p">,</span>
</span><span id="CsvPaths-986"><a href="#CsvPaths-986"><span class="linenos"> 986</span></a>                    <span class="n">run_dir</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span>
</span><span id="CsvPaths-987"><a href="#CsvPaths-987"><span class="linenos"> 987</span></a>                    <span class="n">by_line</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="CsvPaths-988"><a href="#CsvPaths-988"><span class="linenos"> 988</span></a>                <span class="p">)</span>
</span><span id="CsvPaths-989"><a href="#CsvPaths-989"><span class="linenos"> 989</span></a>                <span class="n">csvpath</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span>
</span><span id="CsvPaths-990"><a href="#CsvPaths-990"><span class="linenos"> 990</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths-991"><a href="#CsvPaths-991"><span class="linenos"> 991</span></a>                <span class="c1"># the add has to come after _load_csvpath because we need the identity or index</span>
</span><span id="CsvPaths-992"><a href="#CsvPaths-992"><span class="linenos"> 992</span></a>                <span class="c1"># to be stable and the identity is found in load, if it exists.</span>
</span><span id="CsvPaths-993"><a href="#CsvPaths-993"><span class="linenos"> 993</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths-994"><a href="#CsvPaths-994"><span class="linenos"> 994</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">add_named_result</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths-995"><a href="#CsvPaths-995"><span class="linenos"> 995</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>  <span class="c1"># pylint: disable=W0718</span>
</span><span id="CsvPaths-996"><a href="#CsvPaths-996"><span class="linenos"> 996</span></a><span class="w">                </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CsvPaths-997"><a href="#CsvPaths-997"><span class="linenos"> 997</span></a><span class="sd">                ex.trace = traceback.format_exc()</span>
</span><span id="CsvPaths-998"><a href="#CsvPaths-998"><span class="linenos"> 998</span></a><span class="sd">                ex.source = self</span>
</span><span id="CsvPaths-999"><a href="#CsvPaths-999"><span class="linenos"> 999</span></a><span class="sd">                ErrorHandler(csvpaths=self, error_collector=csvpath).handle_error(ex)</span>
</span><span id="CsvPaths-1000"><a href="#CsvPaths-1000"><span class="linenos">1000</span></a><span class="sd">                &quot;&quot;&quot;</span>
</span><span id="CsvPaths-1001"><a href="#CsvPaths-1001"><span class="linenos">1001</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">error_manager</span><span class="o">.</span><span class="n">handle_error</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="CsvPaths-1002"><a href="#CsvPaths-1002"><span class="linenos">1002</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths-1003"><a href="#CsvPaths-1003"><span class="linenos">1003</span></a>                <span class="c1"># keep this comment for modelines avoidance</span>
</span><span id="CsvPaths-1004"><a href="#CsvPaths-1004"><span class="linenos">1004</span></a>                <span class="c1">#</span>
</span></pre></div>


            <div class="docstring"><p>Manages the application of csvpaths to files. Csvpaths must be grouped and named.
Files must be named. Results are held by the results_manager.</p>
</div>


                            <div id="CsvPaths.__init__" class="classattr">
                                        <input id="CsvPaths.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">CsvPaths</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span>,</span><span class="param">	<span class="n">quotechar</span><span class="o">=</span><span class="s1">&#39;&quot;&#39;</span>,</span><span class="param">	<span class="n">skip_blank_lines</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">print_default</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">config</span><span class="p">:</span> <span class="n">csvpath</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">Config</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="CsvPaths.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPaths.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPaths.__init__-138"><a href="#CsvPaths.__init__-138"><span class="linenos">138</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="CsvPaths.__init__-139"><a href="#CsvPaths.__init__-139"><span class="linenos">139</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="CsvPaths.__init__-140"><a href="#CsvPaths.__init__-140"><span class="linenos">140</span></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="CsvPaths.__init__-141"><a href="#CsvPaths.__init__-141"><span class="linenos">141</span></a>        <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span>
</span><span id="CsvPaths.__init__-142"><a href="#CsvPaths.__init__-142"><span class="linenos">142</span></a>        <span class="n">quotechar</span><span class="o">=</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span>
</span><span id="CsvPaths.__init__-143"><a href="#CsvPaths.__init__-143"><span class="linenos">143</span></a>        <span class="n">skip_blank_lines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="CsvPaths.__init__-144"><a href="#CsvPaths.__init__-144"><span class="linenos">144</span></a>        <span class="n">print_default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="CsvPaths.__init__-145"><a href="#CsvPaths.__init__-145"><span class="linenos">145</span></a>        <span class="n">config</span><span class="p">:</span> <span class="n">Config</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="CsvPaths.__init__-146"><a href="#CsvPaths.__init__-146"><span class="linenos">146</span></a>    <span class="p">):</span>
</span><span id="CsvPaths.__init__-147"><a href="#CsvPaths.__init__-147"><span class="linenos">147</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">()</span> <span class="k">if</span> <span class="n">config</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">config</span>
</span><span id="CsvPaths.__init__-148"><a href="#CsvPaths.__init__-148"><span class="linenos">148</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.__init__-149"><a href="#CsvPaths.__init__-149"><span class="linenos">149</span></a>        <span class="c1"># managers centralize activities, offer async potential, and</span>
</span><span id="CsvPaths.__init__-150"><a href="#CsvPaths.__init__-150"><span class="linenos">150</span></a>        <span class="c1"># are where integrations hook in. ErrorManager functionality</span>
</span><span id="CsvPaths.__init__-151"><a href="#CsvPaths.__init__-151"><span class="linenos">151</span></a>        <span class="c1"># must be available in CsvPath too. The others are CsvPaths</span>
</span><span id="CsvPaths.__init__-152"><a href="#CsvPaths.__init__-152"><span class="linenos">152</span></a>        <span class="c1"># only.</span>
</span><span id="CsvPaths.__init__-153"><a href="#CsvPaths.__init__-153"><span class="linenos">153</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.__init__-154"><a href="#CsvPaths.__init__-154"><span class="linenos">154</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_managers</span><span class="p">()</span>
</span><span id="CsvPaths.__init__-155"><a href="#CsvPaths.__init__-155"><span class="linenos">155</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CsvPaths.__init__-156"><a href="#CsvPaths.__init__-156"><span class="linenos">156</span></a><span class="sd">        self.paths_manager = PathsManager(csvpaths=self)</span>
</span><span id="CsvPaths.__init__-157"><a href="#CsvPaths.__init__-157"><span class="linenos">157</span></a><span class="sd">        self.file_manager = FileManager(csvpaths=self)</span>
</span><span id="CsvPaths.__init__-158"><a href="#CsvPaths.__init__-158"><span class="linenos">158</span></a><span class="sd">        self.results_manager = ResultsManager(csvpaths=self)</span>
</span><span id="CsvPaths.__init__-159"><a href="#CsvPaths.__init__-159"><span class="linenos">159</span></a><span class="sd">        self.ecoms = ErrorCommunications(csvpaths=self)</span>
</span><span id="CsvPaths.__init__-160"><a href="#CsvPaths.__init__-160"><span class="linenos">160</span></a><span class="sd">        self._error_manager = ErrorManager(csvpaths=self)</span>
</span><span id="CsvPaths.__init__-161"><a href="#CsvPaths.__init__-161"><span class="linenos">161</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CsvPaths.__init__-162"><a href="#CsvPaths.__init__-162"><span class="linenos">162</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.__init__-163"><a href="#CsvPaths.__init__-163"><span class="linenos">163</span></a>        <span class="c1"># TODO:</span>
</span><span id="CsvPaths.__init__-164"><a href="#CsvPaths.__init__-164"><span class="linenos">164</span></a>        <span class="c1"># self.print_manager = ... &lt;&lt;&lt;=== should we do this?</span>
</span><span id="CsvPaths.__init__-165"><a href="#CsvPaths.__init__-165"><span class="linenos">165</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.__init__-166"><a href="#CsvPaths.__init__-166"><span class="linenos">166</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.__init__-167"><a href="#CsvPaths.__init__-167"><span class="linenos">167</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">print_default</span> <span class="o">=</span> <span class="n">print_default</span>
</span><span id="CsvPaths.__init__-168"><a href="#CsvPaths.__init__-168"><span class="linenos">168</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span> <span class="o">=</span> <span class="n">delimiter</span>
</span><span id="CsvPaths.__init__-169"><a href="#CsvPaths.__init__-169"><span class="linenos">169</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">quotechar</span> <span class="o">=</span> <span class="n">quotechar</span>
</span><span id="CsvPaths.__init__-170"><a href="#CsvPaths.__init__-170"><span class="linenos">170</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">skip_blank_lines</span> <span class="o">=</span> <span class="n">skip_blank_lines</span>
</span><span id="CsvPaths.__init__-171"><a href="#CsvPaths.__init__-171"><span class="linenos">171</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="p">:</span> <span class="n">CsvPath</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPaths.__init__-172"><a href="#CsvPaths.__init__-172"><span class="linenos">172</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">LogUtility</span><span class="o">.</span><span class="n">logger</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="CsvPaths.__init__-173"><a href="#CsvPaths.__init__-173"><span class="linenos">173</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CsvPaths.__init__-174"><a href="#CsvPaths.__init__-174"><span class="linenos">174</span></a>        <span class="c1"># coordinator attributes</span>
</span><span id="CsvPaths.__init__-175"><a href="#CsvPaths.__init__-175"><span class="linenos">175</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_stop_all</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CsvPaths.__init__-176"><a href="#CsvPaths.__init__-176"><span class="linenos">176</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_fail_all</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CsvPaths.__init__-177"><a href="#CsvPaths.__init__-177"><span class="linenos">177</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_skip_all</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CsvPaths.__init__-178"><a href="#CsvPaths.__init__-178"><span class="linenos">178</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_advance_all</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="CsvPaths.__init__-179"><a href="#CsvPaths.__init__-179"><span class="linenos">179</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_current_run_time</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPaths.__init__-180"><a href="#CsvPaths.__init__-180"><span class="linenos">180</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_run_time_str</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPaths.__init__-181"><a href="#CsvPaths.__init__-181"><span class="linenos">181</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">named_paths_name</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPaths.__init__-182"><a href="#CsvPaths.__init__-182"><span class="linenos">182</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">named_file_name</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPaths.__init__-183"><a href="#CsvPaths.__init__-183"><span class="linenos">183</span></a>
</span><span id="CsvPaths.__init__-184"><a href="#CsvPaths.__init__-184"><span class="linenos">184</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.__init__-185"><a href="#CsvPaths.__init__-185"><span class="linenos">185</span></a>        <span class="c1"># metrics is for OTLP OpenTelemetry. it should only</span>
</span><span id="CsvPaths.__init__-186"><a href="#CsvPaths.__init__-186"><span class="linenos">186</span></a>        <span class="c1"># be used by the OTLP listener. it is here because</span>
</span><span id="CsvPaths.__init__-187"><a href="#CsvPaths.__init__-187"><span class="linenos">187</span></a>        <span class="c1"># the integration may need a long-lived presence. if</span>
</span><span id="CsvPaths.__init__-188"><a href="#CsvPaths.__init__-188"><span class="linenos">188</span></a>        <span class="c1"># needed, the first OTLP listener will set it up</span>
</span><span id="CsvPaths.__init__-189"><a href="#CsvPaths.__init__-189"><span class="linenos">189</span></a>        <span class="c1"># before spinning up a thread. any other OTLP</span>
</span><span id="CsvPaths.__init__-190"><a href="#CsvPaths.__init__-190"><span class="linenos">190</span></a>        <span class="c1"># listener threads that need to use a long-lived metric</span>
</span><span id="CsvPaths.__init__-191"><a href="#CsvPaths.__init__-191"><span class="linenos">191</span></a>        <span class="c1"># will work with this property.</span>
</span><span id="CsvPaths.__init__-192"><a href="#CsvPaths.__init__-192"><span class="linenos">192</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.__init__-193"><a href="#CsvPaths.__init__-193"><span class="linenos">193</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPaths.__init__-194"><a href="#CsvPaths.__init__-194"><span class="linenos">194</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;initialized CsvPaths&quot;</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="CsvPaths.print_default" class="classattr">
                                <div class="attr variable">
            <span class="name">print_default</span>

        
    </div>
    <a class="headerlink" href="#CsvPaths.print_default"></a>
    
    

                            </div>
                            <div id="CsvPaths.delimiter" class="classattr">
                                <div class="attr variable">
            <span class="name">delimiter</span>

        
    </div>
    <a class="headerlink" href="#CsvPaths.delimiter"></a>
    
    

                            </div>
                            <div id="CsvPaths.quotechar" class="classattr">
                                <div class="attr variable">
            <span class="name">quotechar</span>

        
    </div>
    <a class="headerlink" href="#CsvPaths.quotechar"></a>
    
    

                            </div>
                            <div id="CsvPaths.skip_blank_lines" class="classattr">
                                <div class="attr variable">
            <span class="name">skip_blank_lines</span>

        
    </div>
    <a class="headerlink" href="#CsvPaths.skip_blank_lines"></a>
    
    

                            </div>
                            <div id="CsvPaths.current_matcher" class="classattr">
                                <div class="attr variable">
            <span class="name">current_matcher</span><span class="annotation">: csvpath.csvpath.CsvPath</span>

        
    </div>
    <a class="headerlink" href="#CsvPaths.current_matcher"></a>
    
    

                            </div>
                            <div id="CsvPaths.logger" class="classattr">
                                <div class="attr variable">
            <span class="name">logger</span>

        
    </div>
    <a class="headerlink" href="#CsvPaths.logger"></a>
    
    

                            </div>
                            <div id="CsvPaths.named_paths_name" class="classattr">
                                <div class="attr variable">
            <span class="name">named_paths_name</span>

        
    </div>
    <a class="headerlink" href="#CsvPaths.named_paths_name"></a>
    
    

                            </div>
                            <div id="CsvPaths.named_file_name" class="classattr">
                                <div class="attr variable">
            <span class="name">named_file_name</span>

        
    </div>
    <a class="headerlink" href="#CsvPaths.named_file_name"></a>
    
    

                            </div>
                            <div id="CsvPaths.metrics" class="classattr">
                                <div class="attr variable">
            <span class="name">metrics</span>

        
    </div>
    <a class="headerlink" href="#CsvPaths.metrics"></a>
    
    

                            </div>
                            <div id="CsvPaths.error_manager" class="classattr">
                                        <input id="CsvPaths.error_manager-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">error_manager</span><span class="annotation">: csvpath.managers.errors.error_manager.ErrorManager</span>

                <label class="view-source-button" for="CsvPaths.error_manager-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPaths.error_manager"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPaths.error_manager-203"><a href="#CsvPaths.error_manager-203"><span class="linenos">203</span></a>    <span class="nd">@property</span>
</span><span id="CsvPaths.error_manager-204"><a href="#CsvPaths.error_manager-204"><span class="linenos">204</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">error_manager</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ErrorManager</span><span class="p">:</span>
</span><span id="CsvPaths.error_manager-205"><a href="#CsvPaths.error_manager-205"><span class="linenos">205</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_error_manager</span>
</span></pre></div>


    

                            </div>
                            <div id="CsvPaths.run_time_str" class="classattr">
                                        <input id="CsvPaths.run_time_str-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">run_time_str</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">pathsname</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="CsvPaths.run_time_str-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPaths.run_time_str"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPaths.run_time_str-213"><a href="#CsvPaths.run_time_str-213"><span class="linenos">213</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">run_time_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pathsname</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="CsvPaths.run_time_str-214"><a href="#CsvPaths.run_time_str-214"><span class="linenos">214</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;adds the stringified current run time to the named-paths</span>
</span><span id="CsvPaths.run_time_str-215"><a href="#CsvPaths.run_time_str-215"><span class="linenos">215</span></a><span class="sd">        group home_dir to create the run_dir&quot;&quot;&quot;</span>
</span><span id="CsvPaths.run_time_str-216"><a href="#CsvPaths.run_time_str-216"><span class="linenos">216</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_time_str</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">pathsname</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPaths.run_time_str-217"><a href="#CsvPaths.run_time_str-217"><span class="linenos">217</span></a>            <span class="k">raise</span> <span class="n">CsvPathsException</span><span class="p">(</span>
</span><span id="CsvPaths.run_time_str-218"><a href="#CsvPaths.run_time_str-218"><span class="linenos">218</span></a>                <span class="s2">&quot;Cannot have None in both run_time_str and pathsname&quot;</span>
</span><span id="CsvPaths.run_time_str-219"><a href="#CsvPaths.run_time_str-219"><span class="linenos">219</span></a>            <span class="p">)</span>
</span><span id="CsvPaths.run_time_str-220"><a href="#CsvPaths.run_time_str-220"><span class="linenos">220</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_time_str</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPaths.run_time_str-221"><a href="#CsvPaths.run_time_str-221"><span class="linenos">221</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_run_time_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">get_run_time_str</span><span class="p">(</span>
</span><span id="CsvPaths.run_time_str-222"><a href="#CsvPaths.run_time_str-222"><span class="linenos">222</span></a>                <span class="n">pathsname</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_run_time</span>
</span><span id="CsvPaths.run_time_str-223"><a href="#CsvPaths.run_time_str-223"><span class="linenos">223</span></a>            <span class="p">)</span>
</span><span id="CsvPaths.run_time_str-224"><a href="#CsvPaths.run_time_str-224"><span class="linenos">224</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_time_str</span>
</span></pre></div>


            <div class="docstring"><p>adds the stringified current run time to the named-paths
group home_dir to create the run_dir</p>
</div>


                            </div>
                            <div id="CsvPaths.current_run_time" class="classattr">
                                        <input id="CsvPaths.current_run_time-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">current_run_time</span><span class="annotation">: datetime.datetime</span>

                <label class="view-source-button" for="CsvPaths.current_run_time-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPaths.current_run_time"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPaths.current_run_time-226"><a href="#CsvPaths.current_run_time-226"><span class="linenos">226</span></a>    <span class="nd">@property</span>
</span><span id="CsvPaths.current_run_time-227"><a href="#CsvPaths.current_run_time-227"><span class="linenos">227</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">current_run_time</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datetime</span><span class="p">:</span>
</span><span id="CsvPaths.current_run_time-228"><a href="#CsvPaths.current_run_time-228"><span class="linenos">228</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;gets the time marking the start of the run. used to create the run home directory.&quot;&quot;&quot;</span>
</span><span id="CsvPaths.current_run_time-229"><a href="#CsvPaths.current_run_time-229"><span class="linenos">229</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_run_time</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPaths.current_run_time-230"><a href="#CsvPaths.current_run_time-230"><span class="linenos">230</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_current_run_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
</span><span id="CsvPaths.current_run_time-231"><a href="#CsvPaths.current_run_time-231"><span class="linenos">231</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_run_time</span>
</span></pre></div>


            <div class="docstring"><p>gets the time marking the start of the run. used to create the run home directory.</p>
</div>


                            </div>
                            <div id="CsvPaths.clear_run_coordination" class="classattr">
                                        <input id="CsvPaths.clear_run_coordination-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">clear_run_coordination</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="CsvPaths.clear_run_coordination-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPaths.clear_run_coordination"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPaths.clear_run_coordination-233"><a href="#CsvPaths.clear_run_coordination-233"><span class="linenos">233</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">clear_run_coordination</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPaths.clear_run_coordination-234"><a href="#CsvPaths.clear_run_coordination-234"><span class="linenos">234</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;run coordination is the set of signals that csvpaths send to affect</span>
</span><span id="CsvPaths.clear_run_coordination-235"><a href="#CsvPaths.clear_run_coordination-235"><span class="linenos">235</span></a><span class="sd">        one another through the CsvPaths instance&quot;&quot;&quot;</span>
</span><span id="CsvPaths.clear_run_coordination-236"><a href="#CsvPaths.clear_run_coordination-236"><span class="linenos">236</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_stop_all</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CsvPaths.clear_run_coordination-237"><a href="#CsvPaths.clear_run_coordination-237"><span class="linenos">237</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_fail_all</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CsvPaths.clear_run_coordination-238"><a href="#CsvPaths.clear_run_coordination-238"><span class="linenos">238</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_skip_all</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CsvPaths.clear_run_coordination-239"><a href="#CsvPaths.clear_run_coordination-239"><span class="linenos">239</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_advance_all</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="CsvPaths.clear_run_coordination-240"><a href="#CsvPaths.clear_run_coordination-240"><span class="linenos">240</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_current_run_time</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPaths.clear_run_coordination-241"><a href="#CsvPaths.clear_run_coordination-241"><span class="linenos">241</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_run_time_str</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPaths.clear_run_coordination-242"><a href="#CsvPaths.clear_run_coordination-242"><span class="linenos">242</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Cleared run coordination&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>run coordination is the set of signals that csvpaths send to affect
one another through the CsvPaths instance</p>
</div>


                            </div>
                            <div id="CsvPaths.csvpath" class="classattr">
                                        <input id="CsvPaths.csvpath-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">csvpath</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">csvpath</span><span class="o">.</span><span class="n">csvpath</span><span class="o">.</span><span class="n">CsvPath</span>:</span></span>

                <label class="view-source-button" for="CsvPaths.csvpath-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPaths.csvpath"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPaths.csvpath-244"><a href="#CsvPaths.csvpath-244"><span class="linenos">244</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">csvpath</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CsvPath</span><span class="p">:</span>
</span><span id="CsvPaths.csvpath-245"><a href="#CsvPaths.csvpath-245"><span class="linenos">245</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="n">CsvPath</span><span class="p">(</span>
</span><span id="CsvPaths.csvpath-246"><a href="#CsvPaths.csvpath-246"><span class="linenos">246</span></a>            <span class="n">csvpaths</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
</span><span id="CsvPaths.csvpath-247"><a href="#CsvPaths.csvpath-247"><span class="linenos">247</span></a>            <span class="n">delimiter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">,</span>
</span><span id="CsvPaths.csvpath-248"><a href="#CsvPaths.csvpath-248"><span class="linenos">248</span></a>            <span class="n">quotechar</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">quotechar</span><span class="p">,</span>
</span><span id="CsvPaths.csvpath-249"><a href="#CsvPaths.csvpath-249"><span class="linenos">249</span></a>            <span class="n">skip_blank_lines</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">skip_blank_lines</span><span class="p">,</span>
</span><span id="CsvPaths.csvpath-250"><a href="#CsvPaths.csvpath-250"><span class="linenos">250</span></a>            <span class="c1">#</span>
</span><span id="CsvPaths.csvpath-251"><a href="#CsvPaths.csvpath-251"><span class="linenos">251</span></a>            <span class="c1"># in the usual case we don&#39;t want csvpaths and its csvpath children</span>
</span><span id="CsvPaths.csvpath-252"><a href="#CsvPaths.csvpath-252"><span class="linenos">252</span></a>            <span class="c1"># to share the same config. sharing doesn&#39;t offer much. the flexibility</span>
</span><span id="CsvPaths.csvpath-253"><a href="#CsvPaths.csvpath-253"><span class="linenos">253</span></a>            <span class="c1"># of having separate configs is valuable.</span>
</span><span id="CsvPaths.csvpath-254"><a href="#CsvPaths.csvpath-254"><span class="linenos">254</span></a>            <span class="c1">#</span>
</span><span id="CsvPaths.csvpath-255"><a href="#CsvPaths.csvpath-255"><span class="linenos">255</span></a>            <span class="n">config</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="CsvPaths.csvpath-256"><a href="#CsvPaths.csvpath-256"><span class="linenos">256</span></a>            <span class="n">print_default</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">print_default</span><span class="p">,</span>
</span><span id="CsvPaths.csvpath-257"><a href="#CsvPaths.csvpath-257"><span class="linenos">257</span></a>            <span class="n">error_manager</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">error_manager</span><span class="p">,</span>
</span><span id="CsvPaths.csvpath-258"><a href="#CsvPaths.csvpath-258"><span class="linenos">258</span></a>        <span class="p">)</span>
</span><span id="CsvPaths.csvpath-259"><a href="#CsvPaths.csvpath-259"><span class="linenos">259</span></a>        <span class="k">return</span> <span class="n">path</span>
</span></pre></div>


            <div class="docstring"><p>Gets a CsvPath object primed with a reference to this CsvPaths</p>
</div>


                            </div>
                            <div id="CsvPaths.errors" class="classattr">
                                        <input id="CsvPaths.errors-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">errors</span><span class="annotation">: List[csvpath.managers.errors.error.Error]</span>

                <label class="view-source-button" for="CsvPaths.errors-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPaths.errors"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPaths.errors-273"><a href="#CsvPaths.errors-273"><span class="linenos">273</span></a>    <span class="nd">@property</span>
</span><span id="CsvPaths.errors-274"><a href="#CsvPaths.errors-274"><span class="linenos">274</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">errors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Error</span><span class="p">]:</span>  <span class="c1"># pylint: disable=C0116</span>
</span><span id="CsvPaths.errors-275"><a href="#CsvPaths.errors-275"><span class="linenos">275</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span>
</span></pre></div>


    

                            </div>
                            <div id="CsvPaths.collect_error" class="classattr">
                                        <input id="CsvPaths.collect_error-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">collect_error</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">error</span><span class="p">:</span> <span class="n">csvpath</span><span class="o">.</span><span class="n">managers</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">Error</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="CsvPaths.collect_error-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPaths.collect_error"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPaths.collect_error-277"><a href="#CsvPaths.collect_error-277"><span class="linenos">277</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">collect_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">error</span><span class="p">:</span> <span class="n">Error</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pylint: disable=C0116</span>
</span><span id="CsvPaths.collect_error-278"><a href="#CsvPaths.collect_error-278"><span class="linenos">278</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="CsvPaths.has_errors" class="classattr">
                                        <input id="CsvPaths.has_errors-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">has_errors</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="CsvPaths.has_errors-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPaths.has_errors"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPaths.has_errors-280"><a href="#CsvPaths.has_errors-280"><span class="linenos">280</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">has_errors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>  <span class="c1"># pylint: disable=C0116</span>
</span><span id="CsvPaths.has_errors-281"><a href="#CsvPaths.has_errors-281"><span class="linenos">281</span></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_errors</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
</span></pre></div>


    

                            </div>
                            <div id="CsvPaths.config" class="classattr">
                                        <input id="CsvPaths.config-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">config</span><span class="annotation">: csvpath.util.config.Config</span>

                <label class="view-source-button" for="CsvPaths.config-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPaths.config"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPaths.config-283"><a href="#CsvPaths.config-283"><span class="linenos">283</span></a>    <span class="nd">@property</span>
</span><span id="CsvPaths.config-284"><a href="#CsvPaths.config-284"><span class="linenos">284</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Config</span><span class="p">:</span>  <span class="c1"># pylint: disable=C0116</span>
</span><span id="CsvPaths.config-285"><a href="#CsvPaths.config-285"><span class="linenos">285</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">:</span>
</span><span id="CsvPaths.config-286"><a href="#CsvPaths.config-286"><span class="linenos">286</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">()</span>  <span class="c1"># pragma: no cover</span>
</span><span id="CsvPaths.config-287"><a href="#CsvPaths.config-287"><span class="linenos">287</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config</span>
</span></pre></div>


    

                            </div>
                            <div id="CsvPaths.add_to_config" class="classattr">
                                        <input id="CsvPaths.add_to_config-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">add_to_config</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">section</span>, </span><span class="param"><span class="n">key</span>, </span><span class="param"><span class="n">value</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="CsvPaths.add_to_config-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPaths.add_to_config"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPaths.add_to_config-297"><a href="#CsvPaths.add_to_config-297"><span class="linenos">297</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">add_to_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">section</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPaths.add_to_config-298"><a href="#CsvPaths.add_to_config-298"><span class="linenos">298</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">add_to_config</span><span class="p">(</span><span class="n">section</span><span class="o">=</span><span class="n">section</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>
</span><span id="CsvPaths.add_to_config-299"><a href="#CsvPaths.add_to_config-299"><span class="linenos">299</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">save_config</span><span class="p">()</span>
</span><span id="CsvPaths.add_to_config-300"><a href="#CsvPaths.add_to_config-300"><span class="linenos">300</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">reload</span><span class="p">()</span>
</span><span id="CsvPaths.add_to_config-301"><a href="#CsvPaths.add_to_config-301"><span class="linenos">301</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_managers</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="CsvPaths.clean" class="classattr">
                                        <input id="CsvPaths.clean-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">clean</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span>, </span><span class="param"><span class="n">paths</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="CsvPaths.clean-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPaths.clean"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPaths.clean-303"><a href="#CsvPaths.clean-303"><span class="linenos">303</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">clean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">paths</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPaths.clean-304"><a href="#CsvPaths.clean-304"><span class="linenos">304</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;at this time we do not recommend reusing CsvPaths, but it is doable</span>
</span><span id="CsvPaths.clean-305"><a href="#CsvPaths.clean-305"><span class="linenos">305</span></a><span class="sd">        you should clean before reuse unless you want to accumulate results.&quot;&quot;&quot;</span>
</span><span id="CsvPaths.clean-306"><a href="#CsvPaths.clean-306"><span class="linenos">306</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">clean_named_results</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span>
</span><span id="CsvPaths.clean-307"><a href="#CsvPaths.clean-307"><span class="linenos">307</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clear_run_coordination</span><span class="p">()</span>
</span><span id="CsvPaths.clean-308"><a href="#CsvPaths.clean-308"><span class="linenos">308</span></a>        <span class="c1"># self.error_manager.reset()</span>
</span><span id="CsvPaths.clean-309"><a href="#CsvPaths.clean-309"><span class="linenos">309</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CsvPaths.clean-310"><a href="#CsvPaths.clean-310"><span class="linenos">310</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">named_paths_name</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPaths.clean-311"><a href="#CsvPaths.clean-311"><span class="linenos">311</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">named_file_name</span> <span class="o">=</span> <span class="kc">None</span>
</span></pre></div>


            <div class="docstring"><p>at this time we do not recommend reusing CsvPaths, but it is doable
you should clean before reuse unless you want to accumulate results.</p>
</div>


                            </div>
                            <div id="CsvPaths.collect_paths" class="classattr">
                                        <input id="CsvPaths.collect_paths-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">collect_paths</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span>, </span><span class="param"><span class="n">pathsname</span>, </span><span class="param"><span class="n">filename</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="CsvPaths.collect_paths-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPaths.collect_paths"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPaths.collect_paths-313"><a href="#CsvPaths.collect_paths-313"><span class="linenos">313</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">collect_paths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPaths.collect_paths-314"><a href="#CsvPaths.collect_paths-314"><span class="linenos">314</span></a>        <span class="n">paths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">paths_manager</span><span class="o">.</span><span class="n">get_named_paths</span><span class="p">(</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths.collect_paths-315"><a href="#CsvPaths.collect_paths-315"><span class="linenos">315</span></a>        <span class="k">if</span> <span class="n">paths</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPaths.collect_paths-316"><a href="#CsvPaths.collect_paths-316"><span class="linenos">316</span></a>            <span class="k">raise</span> <span class="n">InputException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No named-paths found for </span><span class="si">{</span><span class="n">pathsname</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="CsvPaths.collect_paths-317"><a href="#CsvPaths.collect_paths-317"><span class="linenos">317</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CsvPaths.collect_paths-318"><a href="#CsvPaths.collect_paths-318"><span class="linenos">318</span></a>            <span class="k">raise</span> <span class="n">InputException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Named-paths group </span><span class="si">{</span><span class="n">pathsname</span><span class="si">}</span><span class="s2"> is empty&quot;</span><span class="p">)</span>
</span><span id="CsvPaths.collect_paths-319"><a href="#CsvPaths.collect_paths-319"><span class="linenos">319</span></a>        <span class="k">if</span> <span class="s2">&quot;&quot;</span> <span class="ow">in</span> <span class="n">paths</span><span class="p">:</span>
</span><span id="CsvPaths.collect_paths-320"><a href="#CsvPaths.collect_paths-320"><span class="linenos">320</span></a>            <span class="k">raise</span> <span class="n">InputException</span><span class="p">(</span>
</span><span id="CsvPaths.collect_paths-321"><a href="#CsvPaths.collect_paths-321"><span class="linenos">321</span></a>                <span class="sa">f</span><span class="s2">&quot;Named-paths group </span><span class="si">{</span><span class="n">pathsname</span><span class="si">}</span><span class="s2"> has one or more empty csvpaths&quot;</span>
</span><span id="CsvPaths.collect_paths-322"><a href="#CsvPaths.collect_paths-322"><span class="linenos">322</span></a>            <span class="p">)</span>
</span><span id="CsvPaths.collect_paths-323"><a href="#CsvPaths.collect_paths-323"><span class="linenos">323</span></a>        <span class="n">file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_manager</span><span class="o">.</span><span class="n">get_named_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span><span id="CsvPaths.collect_paths-324"><a href="#CsvPaths.collect_paths-324"><span class="linenos">324</span></a>        <span class="k">if</span> <span class="n">file</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPaths.collect_paths-325"><a href="#CsvPaths.collect_paths-325"><span class="linenos">325</span></a>            <span class="k">raise</span> <span class="n">InputException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No named-file found for </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="CsvPaths.collect_paths-326"><a href="#CsvPaths.collect_paths-326"><span class="linenos">326</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Prepping </span><span class="si">%s</span><span class="s2"> and </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths.collect_paths-327"><a href="#CsvPaths.collect_paths-327"><span class="linenos">327</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clean</span><span class="p">(</span><span class="n">paths</span><span class="o">=</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths.collect_paths-328"><a href="#CsvPaths.collect_paths-328"><span class="linenos">328</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="CsvPaths.collect_paths-329"><a href="#CsvPaths.collect_paths-329"><span class="linenos">329</span></a>            <span class="s2">&quot;Beginning collect_paths </span><span class="si">%s</span><span class="s2"> with </span><span class="si">%s</span><span class="s2"> paths&quot;</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span>
</span><span id="CsvPaths.collect_paths-330"><a href="#CsvPaths.collect_paths-330"><span class="linenos">330</span></a>        <span class="p">)</span>
</span><span id="CsvPaths.collect_paths-331"><a href="#CsvPaths.collect_paths-331"><span class="linenos">331</span></a>        <span class="n">crt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_time_str</span><span class="p">(</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths.collect_paths-332"><a href="#CsvPaths.collect_paths-332"><span class="linenos">332</span></a>        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CsvPaths.collect_paths-333"><a href="#CsvPaths.collect_paths-333"><span class="linenos">333</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.collect_paths-334"><a href="#CsvPaths.collect_paths-334"><span class="linenos">334</span></a>        <span class="c1"># run starts here</span>
</span><span id="CsvPaths.collect_paths-335"><a href="#CsvPaths.collect_paths-335"><span class="linenos">335</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.collect_paths-336"><a href="#CsvPaths.collect_paths-336"><span class="linenos">336</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">start_run</span><span class="p">(</span>
</span><span id="CsvPaths.collect_paths-337"><a href="#CsvPaths.collect_paths-337"><span class="linenos">337</span></a>            <span class="n">run_dir</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span> <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span>
</span><span id="CsvPaths.collect_paths-338"><a href="#CsvPaths.collect_paths-338"><span class="linenos">338</span></a>        <span class="p">)</span>
</span><span id="CsvPaths.collect_paths-339"><a href="#CsvPaths.collect_paths-339"><span class="linenos">339</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.collect_paths-340"><a href="#CsvPaths.collect_paths-340"><span class="linenos">340</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.collect_paths-341"><a href="#CsvPaths.collect_paths-341"><span class="linenos">341</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.collect_paths-342"><a href="#CsvPaths.collect_paths-342"><span class="linenos">342</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">path</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">paths</span><span class="p">):</span>
</span><span id="CsvPaths.collect_paths-343"><a href="#CsvPaths.collect_paths-343"><span class="linenos">343</span></a>            <span class="n">csvpath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">csvpath</span><span class="p">()</span>
</span><span id="CsvPaths.collect_paths-344"><a href="#CsvPaths.collect_paths-344"><span class="linenos">344</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">csvpath</span><span class="o">.</span><span class="n">will_run</span><span class="p">:</span>
</span><span id="CsvPaths.collect_paths-345"><a href="#CsvPaths.collect_paths-345"><span class="linenos">345</span></a>                <span class="k">continue</span>
</span><span id="CsvPaths.collect_paths-346"><a href="#CsvPaths.collect_paths-346"><span class="linenos">346</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">Result</span><span class="p">(</span>
</span><span id="CsvPaths.collect_paths-347"><a href="#CsvPaths.collect_paths-347"><span class="linenos">347</span></a>                <span class="n">csvpath</span><span class="o">=</span><span class="n">csvpath</span><span class="p">,</span>
</span><span id="CsvPaths.collect_paths-348"><a href="#CsvPaths.collect_paths-348"><span class="linenos">348</span></a>                <span class="n">file_name</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths.collect_paths-349"><a href="#CsvPaths.collect_paths-349"><span class="linenos">349</span></a>                <span class="n">paths_name</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths.collect_paths-350"><a href="#CsvPaths.collect_paths-350"><span class="linenos">350</span></a>                <span class="n">run_index</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>
</span><span id="CsvPaths.collect_paths-351"><a href="#CsvPaths.collect_paths-351"><span class="linenos">351</span></a>                <span class="n">run_time</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_run_time</span><span class="p">,</span>
</span><span id="CsvPaths.collect_paths-352"><a href="#CsvPaths.collect_paths-352"><span class="linenos">352</span></a>                <span class="n">run_dir</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span>
</span><span id="CsvPaths.collect_paths-353"><a href="#CsvPaths.collect_paths-353"><span class="linenos">353</span></a>            <span class="p">)</span>
</span><span id="CsvPaths.collect_paths-354"><a href="#CsvPaths.collect_paths-354"><span class="linenos">354</span></a>            <span class="c1"># casting a broad net because if &quot;raise&quot; not in the error policy we</span>
</span><span id="CsvPaths.collect_paths-355"><a href="#CsvPaths.collect_paths-355"><span class="linenos">355</span></a>            <span class="c1"># want to never fail during a run</span>
</span><span id="CsvPaths.collect_paths-356"><a href="#CsvPaths.collect_paths-356"><span class="linenos">356</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="CsvPaths.collect_paths-357"><a href="#CsvPaths.collect_paths-357"><span class="linenos">357</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_load_csvpath</span><span class="p">(</span>
</span><span id="CsvPaths.collect_paths-358"><a href="#CsvPaths.collect_paths-358"><span class="linenos">358</span></a>                    <span class="n">csvpath</span><span class="o">=</span><span class="n">csvpath</span><span class="p">,</span>
</span><span id="CsvPaths.collect_paths-359"><a href="#CsvPaths.collect_paths-359"><span class="linenos">359</span></a>                    <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>
</span><span id="CsvPaths.collect_paths-360"><a href="#CsvPaths.collect_paths-360"><span class="linenos">360</span></a>                    <span class="n">file</span><span class="o">=</span><span class="n">file</span><span class="p">,</span>
</span><span id="CsvPaths.collect_paths-361"><a href="#CsvPaths.collect_paths-361"><span class="linenos">361</span></a>                    <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths.collect_paths-362"><a href="#CsvPaths.collect_paths-362"><span class="linenos">362</span></a>                    <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths.collect_paths-363"><a href="#CsvPaths.collect_paths-363"><span class="linenos">363</span></a>                    <span class="n">crt</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span>
</span><span id="CsvPaths.collect_paths-364"><a href="#CsvPaths.collect_paths-364"><span class="linenos">364</span></a>                <span class="p">)</span>
</span><span id="CsvPaths.collect_paths-365"><a href="#CsvPaths.collect_paths-365"><span class="linenos">365</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths.collect_paths-366"><a href="#CsvPaths.collect_paths-366"><span class="linenos">366</span></a>                <span class="c1"># if run-mode: no-run we skip ahead without saving results</span>
</span><span id="CsvPaths.collect_paths-367"><a href="#CsvPaths.collect_paths-367"><span class="linenos">367</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths.collect_paths-368"><a href="#CsvPaths.collect_paths-368"><span class="linenos">368</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">csvpath</span><span class="o">.</span><span class="n">will_run</span><span class="p">:</span>
</span><span id="CsvPaths.collect_paths-369"><a href="#CsvPaths.collect_paths-369"><span class="linenos">369</span></a>                    <span class="k">continue</span>
</span><span id="CsvPaths.collect_paths-370"><a href="#CsvPaths.collect_paths-370"><span class="linenos">370</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths.collect_paths-371"><a href="#CsvPaths.collect_paths-371"><span class="linenos">371</span></a>                <span class="c1"># the add has to come after _load_csvpath because we need the identity or index</span>
</span><span id="CsvPaths.collect_paths-372"><a href="#CsvPaths.collect_paths-372"><span class="linenos">372</span></a>                <span class="c1"># to be stable and the identity is found in load, if it exists.</span>
</span><span id="CsvPaths.collect_paths-373"><a href="#CsvPaths.collect_paths-373"><span class="linenos">373</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths.collect_paths-374"><a href="#CsvPaths.collect_paths-374"><span class="linenos">374</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">add_named_result</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths.collect_paths-375"><a href="#CsvPaths.collect_paths-375"><span class="linenos">375</span></a>                <span class="n">lines</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">lines</span>
</span><span id="CsvPaths.collect_paths-376"><a href="#CsvPaths.collect_paths-376"><span class="linenos">376</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Collecting lines using a </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">lines</span><span class="p">))</span>
</span><span id="CsvPaths.collect_paths-377"><a href="#CsvPaths.collect_paths-377"><span class="linenos">377</span></a>                <span class="n">csvpath</span><span class="o">.</span><span class="n">collect</span><span class="p">(</span><span class="n">lines</span><span class="o">=</span><span class="n">lines</span><span class="p">)</span>
</span><span id="CsvPaths.collect_paths-378"><a href="#CsvPaths.collect_paths-378"><span class="linenos">378</span></a>                <span class="k">if</span> <span class="n">lines</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPaths.collect_paths-379"><a href="#CsvPaths.collect_paths-379"><span class="linenos">379</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>  <span class="c1"># pragma: no cover</span>
</span><span id="CsvPaths.collect_paths-380"><a href="#CsvPaths.collect_paths-380"><span class="linenos">380</span></a>                        <span class="s2">&quot;Unexpected None for lines after collect_paths: file: </span><span class="si">%s</span><span class="s2">, match: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="CsvPaths.collect_paths-381"><a href="#CsvPaths.collect_paths-381"><span class="linenos">381</span></a>                        <span class="n">file</span><span class="p">,</span>
</span><span id="CsvPaths.collect_paths-382"><a href="#CsvPaths.collect_paths-382"><span class="linenos">382</span></a>                        <span class="n">csvpath</span><span class="o">.</span><span class="n">match</span><span class="p">,</span>
</span><span id="CsvPaths.collect_paths-383"><a href="#CsvPaths.collect_paths-383"><span class="linenos">383</span></a>                    <span class="p">)</span>
</span><span id="CsvPaths.collect_paths-384"><a href="#CsvPaths.collect_paths-384"><span class="linenos">384</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths.collect_paths-385"><a href="#CsvPaths.collect_paths-385"><span class="linenos">385</span></a>                <span class="c1"># this is obviously not a good idea for very large files!</span>
</span><span id="CsvPaths.collect_paths-386"><a href="#CsvPaths.collect_paths-386"><span class="linenos">386</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths.collect_paths-387"><a href="#CsvPaths.collect_paths-387"><span class="linenos">387</span></a>                <span class="n">result</span><span class="o">.</span><span class="n">unmatched</span> <span class="o">=</span> <span class="n">csvpath</span><span class="o">.</span><span class="n">unmatched</span>
</span><span id="CsvPaths.collect_paths-388"><a href="#CsvPaths.collect_paths-388"><span class="linenos">388</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>  <span class="c1"># pylint: disable=W0718</span>
</span><span id="CsvPaths.collect_paths-389"><a href="#CsvPaths.collect_paths-389"><span class="linenos">389</span></a>                <span class="c1"># ex.trace = traceback.format_exc()</span>
</span><span id="CsvPaths.collect_paths-390"><a href="#CsvPaths.collect_paths-390"><span class="linenos">390</span></a>                <span class="c1"># ex.source = self</span>
</span><span id="CsvPaths.collect_paths-391"><a href="#CsvPaths.collect_paths-391"><span class="linenos">391</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">error_manager</span><span class="o">.</span><span class="n">csvpaths</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPaths.collect_paths-392"><a href="#CsvPaths.collect_paths-392"><span class="linenos">392</span></a>                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;ErrorManager&#39;s CsvPaths cannot be None&quot;</span><span class="p">)</span>
</span><span id="CsvPaths.collect_paths-393"><a href="#CsvPaths.collect_paths-393"><span class="linenos">393</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">error_manager</span><span class="o">.</span><span class="n">handle_error</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="CsvPaths.collect_paths-394"><a href="#CsvPaths.collect_paths-394"><span class="linenos">394</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ecoms</span><span class="o">.</span><span class="n">do_i_raise</span><span class="p">():</span>
</span><span id="CsvPaths.collect_paths-395"><a href="#CsvPaths.collect_paths-395"><span class="linenos">395</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths.collect_paths-396"><a href="#CsvPaths.collect_paths-396"><span class="linenos">396</span></a>                    <span class="k">raise</span>
</span><span id="CsvPaths.collect_paths-397"><a href="#CsvPaths.collect_paths-397"><span class="linenos">397</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths.collect_paths-398"><a href="#CsvPaths.collect_paths-398"><span class="linenos">398</span></a>            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths.collect_paths-399"><a href="#CsvPaths.collect_paths-399"><span class="linenos">399</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.collect_paths-400"><a href="#CsvPaths.collect_paths-400"><span class="linenos">400</span></a>        <span class="c1"># run ends here</span>
</span><span id="CsvPaths.collect_paths-401"><a href="#CsvPaths.collect_paths-401"><span class="linenos">401</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.collect_paths-402"><a href="#CsvPaths.collect_paths-402"><span class="linenos">402</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">complete_run</span><span class="p">(</span>
</span><span id="CsvPaths.collect_paths-403"><a href="#CsvPaths.collect_paths-403"><span class="linenos">403</span></a>            <span class="n">run_dir</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span> <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span>
</span><span id="CsvPaths.collect_paths-404"><a href="#CsvPaths.collect_paths-404"><span class="linenos">404</span></a>        <span class="p">)</span>
</span><span id="CsvPaths.collect_paths-405"><a href="#CsvPaths.collect_paths-405"><span class="linenos">405</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.collect_paths-406"><a href="#CsvPaths.collect_paths-406"><span class="linenos">406</span></a>        <span class="c1"># update/write run manifests here</span>
</span><span id="CsvPaths.collect_paths-407"><a href="#CsvPaths.collect_paths-407"><span class="linenos">407</span></a>        <span class="c1">#  - validity (are all paths valid)</span>
</span><span id="CsvPaths.collect_paths-408"><a href="#CsvPaths.collect_paths-408"><span class="linenos">408</span></a>        <span class="c1">#  - paths-completeness (did they all run and complete)</span>
</span><span id="CsvPaths.collect_paths-409"><a href="#CsvPaths.collect_paths-409"><span class="linenos">409</span></a>        <span class="c1">#  - method (collect, fast_forward, next)</span>
</span><span id="CsvPaths.collect_paths-410"><a href="#CsvPaths.collect_paths-410"><span class="linenos">410</span></a>        <span class="c1">#  - timestamp</span>
</span><span id="CsvPaths.collect_paths-411"><a href="#CsvPaths.collect_paths-411"><span class="linenos">411</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.collect_paths-412"><a href="#CsvPaths.collect_paths-412"><span class="linenos">412</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clear_run_coordination</span><span class="p">()</span>
</span><span id="CsvPaths.collect_paths-413"><a href="#CsvPaths.collect_paths-413"><span class="linenos">413</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="CsvPaths.collect_paths-414"><a href="#CsvPaths.collect_paths-414"><span class="linenos">414</span></a>            <span class="s2">&quot;Completed collect_paths </span><span class="si">%s</span><span class="s2"> with </span><span class="si">%s</span><span class="s2"> paths&quot;</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span>
</span><span id="CsvPaths.collect_paths-415"><a href="#CsvPaths.collect_paths-415"><span class="linenos">415</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Sequentially does a CsvPath.collect() on filename for every named path. lines are collected into results.</p>
</div>


                            </div>
                            <div id="CsvPaths.fast_forward_paths" class="classattr">
                                        <input id="CsvPaths.fast_forward_paths-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fast_forward_paths</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span>, </span><span class="param"><span class="n">pathsname</span>, </span><span class="param"><span class="n">filename</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="CsvPaths.fast_forward_paths-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPaths.fast_forward_paths"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPaths.fast_forward_paths-514"><a href="#CsvPaths.fast_forward_paths-514"><span class="linenos">514</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fast_forward_paths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
</span><span id="CsvPaths.fast_forward_paths-515"><a href="#CsvPaths.fast_forward_paths-515"><span class="linenos">515</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;runs the named-paths group named without collecting matches.&quot;&quot;&quot;</span>
</span><span id="CsvPaths.fast_forward_paths-516"><a href="#CsvPaths.fast_forward_paths-516"><span class="linenos">516</span></a>        <span class="n">paths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">paths_manager</span><span class="o">.</span><span class="n">get_named_paths</span><span class="p">(</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths.fast_forward_paths-517"><a href="#CsvPaths.fast_forward_paths-517"><span class="linenos">517</span></a>        <span class="n">file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_manager</span><span class="o">.</span><span class="n">get_named_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span><span id="CsvPaths.fast_forward_paths-518"><a href="#CsvPaths.fast_forward_paths-518"><span class="linenos">518</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Prepping </span><span class="si">%s</span><span class="s2"> and </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths.fast_forward_paths-519"><a href="#CsvPaths.fast_forward_paths-519"><span class="linenos">519</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clean</span><span class="p">(</span><span class="n">paths</span><span class="o">=</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths.fast_forward_paths-520"><a href="#CsvPaths.fast_forward_paths-520"><span class="linenos">520</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="CsvPaths.fast_forward_paths-521"><a href="#CsvPaths.fast_forward_paths-521"><span class="linenos">521</span></a>            <span class="s2">&quot;Beginning FF </span><span class="si">%s</span><span class="s2"> with </span><span class="si">%s</span><span class="s2"> paths against file </span><span class="si">%s</span><span class="s2">. No match results will be held.&quot;</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_paths-522"><a href="#CsvPaths.fast_forward_paths-522"><span class="linenos">522</span></a>            <span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_paths-523"><a href="#CsvPaths.fast_forward_paths-523"><span class="linenos">523</span></a>            <span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">),</span>
</span><span id="CsvPaths.fast_forward_paths-524"><a href="#CsvPaths.fast_forward_paths-524"><span class="linenos">524</span></a>            <span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_paths-525"><a href="#CsvPaths.fast_forward_paths-525"><span class="linenos">525</span></a>        <span class="p">)</span>
</span><span id="CsvPaths.fast_forward_paths-526"><a href="#CsvPaths.fast_forward_paths-526"><span class="linenos">526</span></a>        <span class="n">crt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_time_str</span><span class="p">(</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths.fast_forward_paths-527"><a href="#CsvPaths.fast_forward_paths-527"><span class="linenos">527</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.fast_forward_paths-528"><a href="#CsvPaths.fast_forward_paths-528"><span class="linenos">528</span></a>        <span class="c1"># run starts here</span>
</span><span id="CsvPaths.fast_forward_paths-529"><a href="#CsvPaths.fast_forward_paths-529"><span class="linenos">529</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.fast_forward_paths-530"><a href="#CsvPaths.fast_forward_paths-530"><span class="linenos">530</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">start_run</span><span class="p">(</span>
</span><span id="CsvPaths.fast_forward_paths-531"><a href="#CsvPaths.fast_forward_paths-531"><span class="linenos">531</span></a>            <span class="n">run_dir</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span> <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span>
</span><span id="CsvPaths.fast_forward_paths-532"><a href="#CsvPaths.fast_forward_paths-532"><span class="linenos">532</span></a>        <span class="p">)</span>
</span><span id="CsvPaths.fast_forward_paths-533"><a href="#CsvPaths.fast_forward_paths-533"><span class="linenos">533</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.fast_forward_paths-534"><a href="#CsvPaths.fast_forward_paths-534"><span class="linenos">534</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.fast_forward_paths-535"><a href="#CsvPaths.fast_forward_paths-535"><span class="linenos">535</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.fast_forward_paths-536"><a href="#CsvPaths.fast_forward_paths-536"><span class="linenos">536</span></a>        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CsvPaths.fast_forward_paths-537"><a href="#CsvPaths.fast_forward_paths-537"><span class="linenos">537</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">path</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">paths</span><span class="p">):</span>
</span><span id="CsvPaths.fast_forward_paths-538"><a href="#CsvPaths.fast_forward_paths-538"><span class="linenos">538</span></a>            <span class="n">csvpath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">csvpath</span><span class="p">()</span>
</span><span id="CsvPaths.fast_forward_paths-539"><a href="#CsvPaths.fast_forward_paths-539"><span class="linenos">539</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Beginning to FF CsvPath instance: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">csvpath</span><span class="p">)</span>
</span><span id="CsvPaths.fast_forward_paths-540"><a href="#CsvPaths.fast_forward_paths-540"><span class="linenos">540</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">Result</span><span class="p">(</span>
</span><span id="CsvPaths.fast_forward_paths-541"><a href="#CsvPaths.fast_forward_paths-541"><span class="linenos">541</span></a>                <span class="n">csvpath</span><span class="o">=</span><span class="n">csvpath</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_paths-542"><a href="#CsvPaths.fast_forward_paths-542"><span class="linenos">542</span></a>                <span class="n">file_name</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_paths-543"><a href="#CsvPaths.fast_forward_paths-543"><span class="linenos">543</span></a>                <span class="n">paths_name</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_paths-544"><a href="#CsvPaths.fast_forward_paths-544"><span class="linenos">544</span></a>                <span class="n">run_index</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_paths-545"><a href="#CsvPaths.fast_forward_paths-545"><span class="linenos">545</span></a>                <span class="n">run_time</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_run_time</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_paths-546"><a href="#CsvPaths.fast_forward_paths-546"><span class="linenos">546</span></a>                <span class="n">run_dir</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_paths-547"><a href="#CsvPaths.fast_forward_paths-547"><span class="linenos">547</span></a>            <span class="p">)</span>
</span><span id="CsvPaths.fast_forward_paths-548"><a href="#CsvPaths.fast_forward_paths-548"><span class="linenos">548</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="CsvPaths.fast_forward_paths-549"><a href="#CsvPaths.fast_forward_paths-549"><span class="linenos">549</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_load_csvpath</span><span class="p">(</span>
</span><span id="CsvPaths.fast_forward_paths-550"><a href="#CsvPaths.fast_forward_paths-550"><span class="linenos">550</span></a>                    <span class="n">csvpath</span><span class="o">=</span><span class="n">csvpath</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_paths-551"><a href="#CsvPaths.fast_forward_paths-551"><span class="linenos">551</span></a>                    <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_paths-552"><a href="#CsvPaths.fast_forward_paths-552"><span class="linenos">552</span></a>                    <span class="n">file</span><span class="o">=</span><span class="n">file</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_paths-553"><a href="#CsvPaths.fast_forward_paths-553"><span class="linenos">553</span></a>                    <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_paths-554"><a href="#CsvPaths.fast_forward_paths-554"><span class="linenos">554</span></a>                    <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_paths-555"><a href="#CsvPaths.fast_forward_paths-555"><span class="linenos">555</span></a>                    <span class="n">crt</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_paths-556"><a href="#CsvPaths.fast_forward_paths-556"><span class="linenos">556</span></a>                <span class="p">)</span>
</span><span id="CsvPaths.fast_forward_paths-557"><a href="#CsvPaths.fast_forward_paths-557"><span class="linenos">557</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths.fast_forward_paths-558"><a href="#CsvPaths.fast_forward_paths-558"><span class="linenos">558</span></a>                <span class="c1"># if run-mode: no-run we skip ahead without saving results</span>
</span><span id="CsvPaths.fast_forward_paths-559"><a href="#CsvPaths.fast_forward_paths-559"><span class="linenos">559</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths.fast_forward_paths-560"><a href="#CsvPaths.fast_forward_paths-560"><span class="linenos">560</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">csvpath</span><span class="o">.</span><span class="n">will_run</span><span class="p">:</span>
</span><span id="CsvPaths.fast_forward_paths-561"><a href="#CsvPaths.fast_forward_paths-561"><span class="linenos">561</span></a>                    <span class="k">continue</span>
</span><span id="CsvPaths.fast_forward_paths-562"><a href="#CsvPaths.fast_forward_paths-562"><span class="linenos">562</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths.fast_forward_paths-563"><a href="#CsvPaths.fast_forward_paths-563"><span class="linenos">563</span></a>                <span class="c1"># the add has to come after _load_csvpath because we need the identity or index</span>
</span><span id="CsvPaths.fast_forward_paths-564"><a href="#CsvPaths.fast_forward_paths-564"><span class="linenos">564</span></a>                <span class="c1"># to be stable and the identity is found in load, if it exists.</span>
</span><span id="CsvPaths.fast_forward_paths-565"><a href="#CsvPaths.fast_forward_paths-565"><span class="linenos">565</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths.fast_forward_paths-566"><a href="#CsvPaths.fast_forward_paths-566"><span class="linenos">566</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">add_named_result</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths.fast_forward_paths-567"><a href="#CsvPaths.fast_forward_paths-567"><span class="linenos">567</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="CsvPaths.fast_forward_paths-568"><a href="#CsvPaths.fast_forward_paths-568"><span class="linenos">568</span></a>                    <span class="s2">&quot;Parsed csvpath </span><span class="si">%s</span><span class="s2"> pointed at </span><span class="si">%s</span><span class="s2"> and starting to fast-forward&quot;</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_paths-569"><a href="#CsvPaths.fast_forward_paths-569"><span class="linenos">569</span></a>                    <span class="n">i</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_paths-570"><a href="#CsvPaths.fast_forward_paths-570"><span class="linenos">570</span></a>                    <span class="n">file</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_paths-571"><a href="#CsvPaths.fast_forward_paths-571"><span class="linenos">571</span></a>                <span class="p">)</span>
</span><span id="CsvPaths.fast_forward_paths-572"><a href="#CsvPaths.fast_forward_paths-572"><span class="linenos">572</span></a>                <span class="n">csvpath</span><span class="o">.</span><span class="n">fast_forward</span><span class="p">()</span>
</span><span id="CsvPaths.fast_forward_paths-573"><a href="#CsvPaths.fast_forward_paths-573"><span class="linenos">573</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="CsvPaths.fast_forward_paths-574"><a href="#CsvPaths.fast_forward_paths-574"><span class="linenos">574</span></a>                    <span class="s2">&quot;Completed fast forward of csvpath </span><span class="si">%s</span><span class="s2"> against </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">file</span>
</span><span id="CsvPaths.fast_forward_paths-575"><a href="#CsvPaths.fast_forward_paths-575"><span class="linenos">575</span></a>                <span class="p">)</span>
</span><span id="CsvPaths.fast_forward_paths-576"><a href="#CsvPaths.fast_forward_paths-576"><span class="linenos">576</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>  <span class="c1"># pylint: disable=W0718</span>
</span><span id="CsvPaths.fast_forward_paths-577"><a href="#CsvPaths.fast_forward_paths-577"><span class="linenos">577</span></a>                <span class="c1"># ex.trace = traceback.format_exc()</span>
</span><span id="CsvPaths.fast_forward_paths-578"><a href="#CsvPaths.fast_forward_paths-578"><span class="linenos">578</span></a>                <span class="c1"># ex.source = self</span>
</span><span id="CsvPaths.fast_forward_paths-579"><a href="#CsvPaths.fast_forward_paths-579"><span class="linenos">579</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">error_manager</span><span class="o">.</span><span class="n">handle_error</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="CsvPaths.fast_forward_paths-580"><a href="#CsvPaths.fast_forward_paths-580"><span class="linenos">580</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ecoms</span><span class="o">.</span><span class="n">do_i_raise</span><span class="p">():</span>
</span><span id="CsvPaths.fast_forward_paths-581"><a href="#CsvPaths.fast_forward_paths-581"><span class="linenos">581</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths.fast_forward_paths-582"><a href="#CsvPaths.fast_forward_paths-582"><span class="linenos">582</span></a>                    <span class="k">raise</span>
</span><span id="CsvPaths.fast_forward_paths-583"><a href="#CsvPaths.fast_forward_paths-583"><span class="linenos">583</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths.fast_forward_paths-584"><a href="#CsvPaths.fast_forward_paths-584"><span class="linenos">584</span></a>            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths.fast_forward_paths-585"><a href="#CsvPaths.fast_forward_paths-585"><span class="linenos">585</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.fast_forward_paths-586"><a href="#CsvPaths.fast_forward_paths-586"><span class="linenos">586</span></a>        <span class="c1"># run ends here</span>
</span><span id="CsvPaths.fast_forward_paths-587"><a href="#CsvPaths.fast_forward_paths-587"><span class="linenos">587</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.fast_forward_paths-588"><a href="#CsvPaths.fast_forward_paths-588"><span class="linenos">588</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">complete_run</span><span class="p">(</span>
</span><span id="CsvPaths.fast_forward_paths-589"><a href="#CsvPaths.fast_forward_paths-589"><span class="linenos">589</span></a>            <span class="n">run_dir</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span> <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span>
</span><span id="CsvPaths.fast_forward_paths-590"><a href="#CsvPaths.fast_forward_paths-590"><span class="linenos">590</span></a>        <span class="p">)</span>
</span><span id="CsvPaths.fast_forward_paths-591"><a href="#CsvPaths.fast_forward_paths-591"><span class="linenos">591</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clear_run_coordination</span><span class="p">()</span>
</span><span id="CsvPaths.fast_forward_paths-592"><a href="#CsvPaths.fast_forward_paths-592"><span class="linenos">592</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="CsvPaths.fast_forward_paths-593"><a href="#CsvPaths.fast_forward_paths-593"><span class="linenos">593</span></a>            <span class="s2">&quot;Completed fast_forward_paths </span><span class="si">%s</span><span class="s2"> with </span><span class="si">%s</span><span class="s2"> paths&quot;</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span>
</span><span id="CsvPaths.fast_forward_paths-594"><a href="#CsvPaths.fast_forward_paths-594"><span class="linenos">594</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>runs the named-paths group named without collecting matches.</p>
</div>


                            </div>
                            <div id="CsvPaths.next_paths" class="classattr">
                                        <input id="CsvPaths.next_paths-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">next_paths</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span>, </span><span class="param"><span class="n">pathsname</span>, </span><span class="param"><span class="n">filename</span>, </span><span class="param"><span class="n">collect</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="CsvPaths.next_paths-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPaths.next_paths"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPaths.next_paths-596"><a href="#CsvPaths.next_paths-596"><span class="linenos">596</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">next_paths</span><span class="p">(</span>
</span><span id="CsvPaths.next_paths-597"><a href="#CsvPaths.next_paths-597"><span class="linenos">597</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">collect</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CsvPaths.next_paths-598"><a href="#CsvPaths.next_paths-598"><span class="linenos">598</span></a>    <span class="p">):</span>  <span class="c1"># pylint: disable=R0914</span>
</span><span id="CsvPaths.next_paths-599"><a href="#CsvPaths.next_paths-599"><span class="linenos">599</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;appends the Result for each CsvPath to the end of</span>
</span><span id="CsvPaths.next_paths-600"><a href="#CsvPaths.next_paths-600"><span class="linenos">600</span></a><span class="sd">        each line it produces. this is so that the caller can easily</span>
</span><span id="CsvPaths.next_paths-601"><a href="#CsvPaths.next_paths-601"><span class="linenos">601</span></a><span class="sd">        interrogate the CsvPath for its path parts, file, etc.&quot;&quot;&quot;</span>
</span><span id="CsvPaths.next_paths-602"><a href="#CsvPaths.next_paths-602"><span class="linenos">602</span></a>        <span class="n">paths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">paths_manager</span><span class="o">.</span><span class="n">get_named_paths</span><span class="p">(</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths.next_paths-603"><a href="#CsvPaths.next_paths-603"><span class="linenos">603</span></a>        <span class="n">file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_manager</span><span class="o">.</span><span class="n">get_named_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span><span id="CsvPaths.next_paths-604"><a href="#CsvPaths.next_paths-604"><span class="linenos">604</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Prepping </span><span class="si">%s</span><span class="s2"> and </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths.next_paths-605"><a href="#CsvPaths.next_paths-605"><span class="linenos">605</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clean</span><span class="p">(</span><span class="n">paths</span><span class="o">=</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths.next_paths-606"><a href="#CsvPaths.next_paths-606"><span class="linenos">606</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Beginning next_paths with </span><span class="si">%s</span><span class="s2"> paths&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">))</span>
</span><span id="CsvPaths.next_paths-607"><a href="#CsvPaths.next_paths-607"><span class="linenos">607</span></a>        <span class="n">crt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_time_str</span><span class="p">(</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths.next_paths-608"><a href="#CsvPaths.next_paths-608"><span class="linenos">608</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.next_paths-609"><a href="#CsvPaths.next_paths-609"><span class="linenos">609</span></a>        <span class="c1"># run starts here</span>
</span><span id="CsvPaths.next_paths-610"><a href="#CsvPaths.next_paths-610"><span class="linenos">610</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.next_paths-611"><a href="#CsvPaths.next_paths-611"><span class="linenos">611</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">start_run</span><span class="p">(</span>
</span><span id="CsvPaths.next_paths-612"><a href="#CsvPaths.next_paths-612"><span class="linenos">612</span></a>            <span class="n">run_dir</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span> <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span>
</span><span id="CsvPaths.next_paths-613"><a href="#CsvPaths.next_paths-613"><span class="linenos">613</span></a>        <span class="p">)</span>
</span><span id="CsvPaths.next_paths-614"><a href="#CsvPaths.next_paths-614"><span class="linenos">614</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.next_paths-615"><a href="#CsvPaths.next_paths-615"><span class="linenos">615</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.next_paths-616"><a href="#CsvPaths.next_paths-616"><span class="linenos">616</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.next_paths-617"><a href="#CsvPaths.next_paths-617"><span class="linenos">617</span></a>        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CsvPaths.next_paths-618"><a href="#CsvPaths.next_paths-618"><span class="linenos">618</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">path</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">paths</span><span class="p">):</span>
</span><span id="CsvPaths.next_paths-619"><a href="#CsvPaths.next_paths-619"><span class="linenos">619</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_skip_all</span><span class="p">:</span>
</span><span id="CsvPaths.next_paths-620"><a href="#CsvPaths.next_paths-620"><span class="linenos">620</span></a>                <span class="n">skip_err</span> <span class="o">=</span> <span class="s2">&quot;Found the skip-all signal set. skip_all() is&quot;</span>
</span><span id="CsvPaths.next_paths-621"><a href="#CsvPaths.next_paths-621"><span class="linenos">621</span></a>                <span class="n">skip_err</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">skip_err</span><span class="si">}</span><span class="s2"> only for breadth-first runs using the&quot;</span>
</span><span id="CsvPaths.next_paths-622"><a href="#CsvPaths.next_paths-622"><span class="linenos">622</span></a>                <span class="n">skip_err</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">skip_err</span><span class="si">}</span><span class="s2"> &#39;_by_line&#39; methods. It has the same&quot;</span>
</span><span id="CsvPaths.next_paths-623"><a href="#CsvPaths.next_paths-623"><span class="linenos">623</span></a>                <span class="n">skip_err</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">skip_err</span><span class="si">}</span><span class="s2"> effect as skip() in a&quot;</span>
</span><span id="CsvPaths.next_paths-624"><a href="#CsvPaths.next_paths-624"><span class="linenos">624</span></a>                <span class="n">skip_err</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">skip_err</span><span class="si">}</span><span class="s2"> serial run like this one.&quot;</span>
</span><span id="CsvPaths.next_paths-625"><a href="#CsvPaths.next_paths-625"><span class="linenos">625</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">skip_err</span><span class="p">)</span>
</span><span id="CsvPaths.next_paths-626"><a href="#CsvPaths.next_paths-626"><span class="linenos">626</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stop_all</span><span class="p">:</span>
</span><span id="CsvPaths.next_paths-627"><a href="#CsvPaths.next_paths-627"><span class="linenos">627</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Stop-all set. Shutting down run.&quot;</span><span class="p">)</span>
</span><span id="CsvPaths.next_paths-628"><a href="#CsvPaths.next_paths-628"><span class="linenos">628</span></a>                <span class="k">break</span>
</span><span id="CsvPaths.next_paths-629"><a href="#CsvPaths.next_paths-629"><span class="linenos">629</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_advance_all</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CsvPaths.next_paths-630"><a href="#CsvPaths.next_paths-630"><span class="linenos">630</span></a>                <span class="n">advance_err</span> <span class="o">=</span> <span class="s2">&quot;Found the advance-all signal set. advance_all() is&quot;</span>
</span><span id="CsvPaths.next_paths-631"><a href="#CsvPaths.next_paths-631"><span class="linenos">631</span></a>                <span class="n">advance_err</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">advance_err</span><span class="si">}</span><span class="s2"> only for breadth-first runs using the&quot;</span>
</span><span id="CsvPaths.next_paths-632"><a href="#CsvPaths.next_paths-632"><span class="linenos">632</span></a>                <span class="n">advance_err</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">advance_err</span><span class="si">}</span><span class="s2"> &#39;_by_line&#39; methods. It has the same&quot;</span>
</span><span id="CsvPaths.next_paths-633"><a href="#CsvPaths.next_paths-633"><span class="linenos">633</span></a>                <span class="n">advance_err</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">advance_err</span><span class="si">}</span><span class="s2"> effect as advance() in a&quot;</span>
</span><span id="CsvPaths.next_paths-634"><a href="#CsvPaths.next_paths-634"><span class="linenos">634</span></a>                <span class="n">advance_err</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">advance_err</span><span class="si">}</span><span class="s2"> serial run like this one.&quot;</span>
</span><span id="CsvPaths.next_paths-635"><a href="#CsvPaths.next_paths-635"><span class="linenos">635</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">advance_err</span><span class="p">)</span>
</span><span id="CsvPaths.next_paths-636"><a href="#CsvPaths.next_paths-636"><span class="linenos">636</span></a>            <span class="n">csvpath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">csvpath</span><span class="p">()</span>
</span><span id="CsvPaths.next_paths-637"><a href="#CsvPaths.next_paths-637"><span class="linenos">637</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">Result</span><span class="p">(</span>
</span><span id="CsvPaths.next_paths-638"><a href="#CsvPaths.next_paths-638"><span class="linenos">638</span></a>                <span class="n">csvpath</span><span class="o">=</span><span class="n">csvpath</span><span class="p">,</span>
</span><span id="CsvPaths.next_paths-639"><a href="#CsvPaths.next_paths-639"><span class="linenos">639</span></a>                <span class="n">file_name</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths.next_paths-640"><a href="#CsvPaths.next_paths-640"><span class="linenos">640</span></a>                <span class="n">paths_name</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths.next_paths-641"><a href="#CsvPaths.next_paths-641"><span class="linenos">641</span></a>                <span class="n">run_index</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>
</span><span id="CsvPaths.next_paths-642"><a href="#CsvPaths.next_paths-642"><span class="linenos">642</span></a>                <span class="n">run_time</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_run_time</span><span class="p">,</span>
</span><span id="CsvPaths.next_paths-643"><a href="#CsvPaths.next_paths-643"><span class="linenos">643</span></a>                <span class="n">run_dir</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span>
</span><span id="CsvPaths.next_paths-644"><a href="#CsvPaths.next_paths-644"><span class="linenos">644</span></a>            <span class="p">)</span>
</span><span id="CsvPaths.next_paths-645"><a href="#CsvPaths.next_paths-645"><span class="linenos">645</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fail_all</span><span class="p">:</span>
</span><span id="CsvPaths.next_paths-646"><a href="#CsvPaths.next_paths-646"><span class="linenos">646</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="CsvPaths.next_paths-647"><a href="#CsvPaths.next_paths-647"><span class="linenos">647</span></a>                    <span class="s2">&quot;Fail-all set. Failing all remaining CsvPath instances in the run.&quot;</span>
</span><span id="CsvPaths.next_paths-648"><a href="#CsvPaths.next_paths-648"><span class="linenos">648</span></a>                <span class="p">)</span>
</span><span id="CsvPaths.next_paths-649"><a href="#CsvPaths.next_paths-649"><span class="linenos">649</span></a>                <span class="n">csvpath</span><span class="o">.</span><span class="n">is_valid</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CsvPaths.next_paths-650"><a href="#CsvPaths.next_paths-650"><span class="linenos">650</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="CsvPaths.next_paths-651"><a href="#CsvPaths.next_paths-651"><span class="linenos">651</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_load_csvpath</span><span class="p">(</span>
</span><span id="CsvPaths.next_paths-652"><a href="#CsvPaths.next_paths-652"><span class="linenos">652</span></a>                    <span class="n">csvpath</span><span class="o">=</span><span class="n">csvpath</span><span class="p">,</span>
</span><span id="CsvPaths.next_paths-653"><a href="#CsvPaths.next_paths-653"><span class="linenos">653</span></a>                    <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>
</span><span id="CsvPaths.next_paths-654"><a href="#CsvPaths.next_paths-654"><span class="linenos">654</span></a>                    <span class="n">file</span><span class="o">=</span><span class="n">file</span><span class="p">,</span>
</span><span id="CsvPaths.next_paths-655"><a href="#CsvPaths.next_paths-655"><span class="linenos">655</span></a>                    <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths.next_paths-656"><a href="#CsvPaths.next_paths-656"><span class="linenos">656</span></a>                    <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths.next_paths-657"><a href="#CsvPaths.next_paths-657"><span class="linenos">657</span></a>                    <span class="n">crt</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span>
</span><span id="CsvPaths.next_paths-658"><a href="#CsvPaths.next_paths-658"><span class="linenos">658</span></a>                <span class="p">)</span>
</span><span id="CsvPaths.next_paths-659"><a href="#CsvPaths.next_paths-659"><span class="linenos">659</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths.next_paths-660"><a href="#CsvPaths.next_paths-660"><span class="linenos">660</span></a>                <span class="c1"># if run-mode: no-run we skip ahead without saving results</span>
</span><span id="CsvPaths.next_paths-661"><a href="#CsvPaths.next_paths-661"><span class="linenos">661</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths.next_paths-662"><a href="#CsvPaths.next_paths-662"><span class="linenos">662</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">csvpath</span><span class="o">.</span><span class="n">will_run</span><span class="p">:</span>
</span><span id="CsvPaths.next_paths-663"><a href="#CsvPaths.next_paths-663"><span class="linenos">663</span></a>                    <span class="k">continue</span>
</span><span id="CsvPaths.next_paths-664"><a href="#CsvPaths.next_paths-664"><span class="linenos">664</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths.next_paths-665"><a href="#CsvPaths.next_paths-665"><span class="linenos">665</span></a>                <span class="c1"># the add has to come after _load_csvpath because we need the identity or index</span>
</span><span id="CsvPaths.next_paths-666"><a href="#CsvPaths.next_paths-666"><span class="linenos">666</span></a>                <span class="c1"># to be stable and the identity is found in load, if it exists.</span>
</span><span id="CsvPaths.next_paths-667"><a href="#CsvPaths.next_paths-667"><span class="linenos">667</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths.next_paths-668"><a href="#CsvPaths.next_paths-668"><span class="linenos">668</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">add_named_result</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths.next_paths-669"><a href="#CsvPaths.next_paths-669"><span class="linenos">669</span></a>                <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">csvpath</span><span class="o">.</span><span class="n">next</span><span class="p">():</span>
</span><span id="CsvPaths.next_paths-670"><a href="#CsvPaths.next_paths-670"><span class="linenos">670</span></a>                    <span class="c1">#</span>
</span><span id="CsvPaths.next_paths-671"><a href="#CsvPaths.next_paths-671"><span class="linenos">671</span></a>                    <span class="c1"># removed dec 1. why was this? it doesn&#39;t seem to make sense and</span>
</span><span id="CsvPaths.next_paths-672"><a href="#CsvPaths.next_paths-672"><span class="linenos">672</span></a>                    <span class="c1"># removing it doesn&#39;t break any unit tests. was it a mistake?</span>
</span><span id="CsvPaths.next_paths-673"><a href="#CsvPaths.next_paths-673"><span class="linenos">673</span></a>                    <span class="c1">#</span>
</span><span id="CsvPaths.next_paths-674"><a href="#CsvPaths.next_paths-674"><span class="linenos">674</span></a>                    <span class="c1"># line.append(result)</span>
</span><span id="CsvPaths.next_paths-675"><a href="#CsvPaths.next_paths-675"><span class="linenos">675</span></a>                    <span class="k">if</span> <span class="n">collect</span><span class="p">:</span>
</span><span id="CsvPaths.next_paths-676"><a href="#CsvPaths.next_paths-676"><span class="linenos">676</span></a>                        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="CsvPaths.next_paths-677"><a href="#CsvPaths.next_paths-677"><span class="linenos">677</span></a>                        <span class="n">result</span><span class="o">.</span><span class="n">unmatched</span> <span class="o">=</span> <span class="n">csvpath</span><span class="o">.</span><span class="n">unmatched</span>
</span><span id="CsvPaths.next_paths-678"><a href="#CsvPaths.next_paths-678"><span class="linenos">678</span></a>                    <span class="k">yield</span> <span class="n">line</span>
</span><span id="CsvPaths.next_paths-679"><a href="#CsvPaths.next_paths-679"><span class="linenos">679</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>  <span class="c1"># pylint: disable=W0718</span>
</span><span id="CsvPaths.next_paths-680"><a href="#CsvPaths.next_paths-680"><span class="linenos">680</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">error_manager</span><span class="o">.</span><span class="n">handle_error</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="CsvPaths.next_paths-681"><a href="#CsvPaths.next_paths-681"><span class="linenos">681</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ecoms</span><span class="o">.</span><span class="n">do_i_raise</span><span class="p">():</span>
</span><span id="CsvPaths.next_paths-682"><a href="#CsvPaths.next_paths-682"><span class="linenos">682</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths.next_paths-683"><a href="#CsvPaths.next_paths-683"><span class="linenos">683</span></a>                    <span class="k">raise</span>
</span><span id="CsvPaths.next_paths-684"><a href="#CsvPaths.next_paths-684"><span class="linenos">684</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths.next_paths-685"><a href="#CsvPaths.next_paths-685"><span class="linenos">685</span></a>            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths.next_paths-686"><a href="#CsvPaths.next_paths-686"><span class="linenos">686</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.next_paths-687"><a href="#CsvPaths.next_paths-687"><span class="linenos">687</span></a>        <span class="c1"># run ends here</span>
</span><span id="CsvPaths.next_paths-688"><a href="#CsvPaths.next_paths-688"><span class="linenos">688</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.next_paths-689"><a href="#CsvPaths.next_paths-689"><span class="linenos">689</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">complete_run</span><span class="p">(</span>
</span><span id="CsvPaths.next_paths-690"><a href="#CsvPaths.next_paths-690"><span class="linenos">690</span></a>            <span class="n">run_dir</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span> <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span>
</span><span id="CsvPaths.next_paths-691"><a href="#CsvPaths.next_paths-691"><span class="linenos">691</span></a>        <span class="p">)</span>
</span><span id="CsvPaths.next_paths-692"><a href="#CsvPaths.next_paths-692"><span class="linenos">692</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clear_run_coordination</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>appends the Result for each CsvPath to the end of
each line it produces. this is so that the caller can easily
interrogate the CsvPath for its path parts, file, etc.</p>
</div>


                            </div>
                            <div id="CsvPaths.collect_by_line" class="classattr">
                                        <input id="CsvPaths.collect_by_line-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">collect_by_line</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">pathsname</span>,</span><span class="param">	<span class="n">filename</span>,</span><span class="param">	<span class="n">if_all_agree</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">collect_when_not_matched</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="CsvPaths.collect_by_line-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPaths.collect_by_line"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPaths.collect_by_line-696"><a href="#CsvPaths.collect_by_line-696"><span class="linenos">696</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">collect_by_line</span><span class="p">(</span>
</span><span id="CsvPaths.collect_by_line-697"><a href="#CsvPaths.collect_by_line-697"><span class="linenos">697</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">if_all_agree</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">collect_when_not_matched</span><span class="o">=</span><span class="kc">False</span>
</span><span id="CsvPaths.collect_by_line-698"><a href="#CsvPaths.collect_by_line-698"><span class="linenos">698</span></a>    <span class="p">):</span>
</span><span id="CsvPaths.collect_by_line-699"><a href="#CsvPaths.collect_by_line-699"><span class="linenos">699</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="CsvPaths.collect_by_line-700"><a href="#CsvPaths.collect_by_line-700"><span class="linenos">700</span></a>            <span class="s2">&quot;Starting collect_by_line for paths: </span><span class="si">%s</span><span class="s2"> and file: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span>
</span><span id="CsvPaths.collect_by_line-701"><a href="#CsvPaths.collect_by_line-701"><span class="linenos">701</span></a>        <span class="p">)</span>
</span><span id="CsvPaths.collect_by_line-702"><a href="#CsvPaths.collect_by_line-702"><span class="linenos">702</span></a>        <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CsvPaths.collect_by_line-703"><a href="#CsvPaths.collect_by_line-703"><span class="linenos">703</span></a>        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">next_by_line</span><span class="p">(</span>  <span class="c1"># pylint: disable=W0612</span>
</span><span id="CsvPaths.collect_by_line-704"><a href="#CsvPaths.collect_by_line-704"><span class="linenos">704</span></a>            <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths.collect_by_line-705"><a href="#CsvPaths.collect_by_line-705"><span class="linenos">705</span></a>            <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths.collect_by_line-706"><a href="#CsvPaths.collect_by_line-706"><span class="linenos">706</span></a>            <span class="n">collect</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="CsvPaths.collect_by_line-707"><a href="#CsvPaths.collect_by_line-707"><span class="linenos">707</span></a>            <span class="n">if_all_agree</span><span class="o">=</span><span class="n">if_all_agree</span><span class="p">,</span>
</span><span id="CsvPaths.collect_by_line-708"><a href="#CsvPaths.collect_by_line-708"><span class="linenos">708</span></a>            <span class="n">collect_when_not_matched</span><span class="o">=</span><span class="n">collect_when_not_matched</span><span class="p">,</span>
</span><span id="CsvPaths.collect_by_line-709"><a href="#CsvPaths.collect_by_line-709"><span class="linenos">709</span></a>        <span class="p">):</span>
</span><span id="CsvPaths.collect_by_line-710"><a href="#CsvPaths.collect_by_line-710"><span class="linenos">710</span></a>            <span class="c1"># re: W0612: we need &#39;line&#39; in order to do the iteration. we have to iterate.</span>
</span><span id="CsvPaths.collect_by_line-711"><a href="#CsvPaths.collect_by_line-711"><span class="linenos">711</span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="CsvPaths.collect_by_line-712"><a href="#CsvPaths.collect_by_line-712"><span class="linenos">712</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="CsvPaths.collect_by_line-713"><a href="#CsvPaths.collect_by_line-713"><span class="linenos">713</span></a>            <span class="s2">&quot;Completed collect_by_line for paths: </span><span class="si">%s</span><span class="s2"> and file: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span>
</span><span id="CsvPaths.collect_by_line-714"><a href="#CsvPaths.collect_by_line-714"><span class="linenos">714</span></a>        <span class="p">)</span>
</span><span id="CsvPaths.collect_by_line-715"><a href="#CsvPaths.collect_by_line-715"><span class="linenos">715</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.collect_by_line-716"><a href="#CsvPaths.collect_by_line-716"><span class="linenos">716</span></a>        <span class="c1"># the results have all the lines according to what CsvPath captured them, but</span>
</span><span id="CsvPaths.collect_by_line-717"><a href="#CsvPaths.collect_by_line-717"><span class="linenos">717</span></a>        <span class="c1"># since we&#39;re doing if_all_agree T/F we should return the union here. for some</span>
</span><span id="CsvPaths.collect_by_line-718"><a href="#CsvPaths.collect_by_line-718"><span class="linenos">718</span></a>        <span class="c1"># files this obviously makes the data in memory problem even bigger, but it&#39;s</span>
</span><span id="CsvPaths.collect_by_line-719"><a href="#CsvPaths.collect_by_line-719"><span class="linenos">719</span></a>        <span class="c1"># operator&#39;s responsibility to know if that will be a problem for their use</span>
</span><span id="CsvPaths.collect_by_line-720"><a href="#CsvPaths.collect_by_line-720"><span class="linenos">720</span></a>        <span class="c1"># case.</span>
</span><span id="CsvPaths.collect_by_line-721"><a href="#CsvPaths.collect_by_line-721"><span class="linenos">721</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.collect_by_line-722"><a href="#CsvPaths.collect_by_line-722"><span class="linenos">722</span></a>        <span class="k">return</span> <span class="n">lines</span>
</span></pre></div>


            <div class="docstring"><p>Does a CsvPath.collect() on filename where each row is considered
by every named path before the next row starts</p>

<p>next_by_line for if_all_agree and collect_when_not_matched.</p>
</div>


                            </div>
                            <div id="CsvPaths.fast_forward_by_line" class="classattr">
                                        <input id="CsvPaths.fast_forward_by_line-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fast_forward_by_line</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">pathsname</span>,</span><span class="param">	<span class="n">filename</span>,</span><span class="param">	<span class="n">if_all_agree</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">collect_when_not_matched</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="CsvPaths.fast_forward_by_line-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPaths.fast_forward_by_line"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPaths.fast_forward_by_line-724"><a href="#CsvPaths.fast_forward_by_line-724"><span class="linenos">724</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fast_forward_by_line</span><span class="p">(</span>
</span><span id="CsvPaths.fast_forward_by_line-725"><a href="#CsvPaths.fast_forward_by_line-725"><span class="linenos">725</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">if_all_agree</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">collect_when_not_matched</span><span class="o">=</span><span class="kc">False</span>
</span><span id="CsvPaths.fast_forward_by_line-726"><a href="#CsvPaths.fast_forward_by_line-726"><span class="linenos">726</span></a>    <span class="p">):</span>
</span><span id="CsvPaths.fast_forward_by_line-727"><a href="#CsvPaths.fast_forward_by_line-727"><span class="linenos">727</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="CsvPaths.fast_forward_by_line-728"><a href="#CsvPaths.fast_forward_by_line-728"><span class="linenos">728</span></a>            <span class="s2">&quot;Starting fast_forward_by_line for paths: </span><span class="si">%s</span><span class="s2"> and file: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_by_line-729"><a href="#CsvPaths.fast_forward_by_line-729"><span class="linenos">729</span></a>            <span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_by_line-730"><a href="#CsvPaths.fast_forward_by_line-730"><span class="linenos">730</span></a>            <span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_by_line-731"><a href="#CsvPaths.fast_forward_by_line-731"><span class="linenos">731</span></a>        <span class="p">)</span>
</span><span id="CsvPaths.fast_forward_by_line-732"><a href="#CsvPaths.fast_forward_by_line-732"><span class="linenos">732</span></a>        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">next_by_line</span><span class="p">(</span>  <span class="c1"># pylint: disable=W0612</span>
</span><span id="CsvPaths.fast_forward_by_line-733"><a href="#CsvPaths.fast_forward_by_line-733"><span class="linenos">733</span></a>            <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_by_line-734"><a href="#CsvPaths.fast_forward_by_line-734"><span class="linenos">734</span></a>            <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_by_line-735"><a href="#CsvPaths.fast_forward_by_line-735"><span class="linenos">735</span></a>            <span class="n">collect</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_by_line-736"><a href="#CsvPaths.fast_forward_by_line-736"><span class="linenos">736</span></a>            <span class="n">if_all_agree</span><span class="o">=</span><span class="n">if_all_agree</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_by_line-737"><a href="#CsvPaths.fast_forward_by_line-737"><span class="linenos">737</span></a>            <span class="n">collect_when_not_matched</span><span class="o">=</span><span class="n">collect_when_not_matched</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_by_line-738"><a href="#CsvPaths.fast_forward_by_line-738"><span class="linenos">738</span></a>        <span class="p">):</span>
</span><span id="CsvPaths.fast_forward_by_line-739"><a href="#CsvPaths.fast_forward_by_line-739"><span class="linenos">739</span></a>            <span class="c1"># re: W0612: we need &#39;line&#39; in order to do the iteration. we have to iterate.</span>
</span><span id="CsvPaths.fast_forward_by_line-740"><a href="#CsvPaths.fast_forward_by_line-740"><span class="linenos">740</span></a>            <span class="k">pass</span>
</span><span id="CsvPaths.fast_forward_by_line-741"><a href="#CsvPaths.fast_forward_by_line-741"><span class="linenos">741</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="CsvPaths.fast_forward_by_line-742"><a href="#CsvPaths.fast_forward_by_line-742"><span class="linenos">742</span></a>            <span class="s2">&quot;Completed fast_forward_by_line for paths: </span><span class="si">%s</span><span class="s2"> and file: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_by_line-743"><a href="#CsvPaths.fast_forward_by_line-743"><span class="linenos">743</span></a>            <span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_by_line-744"><a href="#CsvPaths.fast_forward_by_line-744"><span class="linenos">744</span></a>            <span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_by_line-745"><a href="#CsvPaths.fast_forward_by_line-745"><span class="linenos">745</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Does a CsvPath.fast_forward() on filename where each row is
considered by every named path before the next row starts</p>

<p>next_by_line for if_all_agree and collect_when_not_matched.</p>
</div>


                            </div>
                            <div id="CsvPaths.next_by_line" class="classattr">
                                        <input id="CsvPaths.next_by_line-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">next_by_line</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">pathsname</span>,</span><span class="param">	<span class="n">filename</span>,</span><span class="param">	<span class="n">collect</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">if_all_agree</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">collect_when_not_matched</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">) -> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="CsvPaths.next_by_line-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPaths.next_by_line"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPaths.next_by_line-747"><a href="#CsvPaths.next_by_line-747"><span class="linenos">747</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">next_by_line</span><span class="p">(</span>  <span class="c1"># pylint: disable=R0912,R0915,R0914</span>
</span><span id="CsvPaths.next_by_line-748"><a href="#CsvPaths.next_by_line-748"><span class="linenos">748</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="CsvPaths.next_by_line-749"><a href="#CsvPaths.next_by_line-749"><span class="linenos">749</span></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="CsvPaths.next_by_line-750"><a href="#CsvPaths.next_by_line-750"><span class="linenos">750</span></a>        <span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths.next_by_line-751"><a href="#CsvPaths.next_by_line-751"><span class="linenos">751</span></a>        <span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths.next_by_line-752"><a href="#CsvPaths.next_by_line-752"><span class="linenos">752</span></a>        <span class="n">collect</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="CsvPaths.next_by_line-753"><a href="#CsvPaths.next_by_line-753"><span class="linenos">753</span></a>        <span class="n">if_all_agree</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="CsvPaths.next_by_line-754"><a href="#CsvPaths.next_by_line-754"><span class="linenos">754</span></a>        <span class="n">collect_when_not_matched</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="CsvPaths.next_by_line-755"><a href="#CsvPaths.next_by_line-755"><span class="linenos">755</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
</span><span id="CsvPaths.next_by_line-756"><a href="#CsvPaths.next_by_line-756"><span class="linenos">756</span></a>        <span class="c1"># re: R0912 -- absolutely. plan to refactor.</span>
</span><span id="CsvPaths.next_by_line-757"><a href="#CsvPaths.next_by_line-757"><span class="linenos">757</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Prepping </span><span class="si">%s</span><span class="s2"> and </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths.next_by_line-758"><a href="#CsvPaths.next_by_line-758"><span class="linenos">758</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clean</span><span class="p">(</span><span class="n">paths</span><span class="o">=</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths.next_by_line-759"><a href="#CsvPaths.next_by_line-759"><span class="linenos">759</span></a>        <span class="n">fn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_manager</span><span class="o">.</span><span class="n">get_named_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span><span id="CsvPaths.next_by_line-760"><a href="#CsvPaths.next_by_line-760"><span class="linenos">760</span></a>        <span class="n">paths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">paths_manager</span><span class="o">.</span><span class="n">get_named_paths</span><span class="p">(</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths.next_by_line-761"><a href="#CsvPaths.next_by_line-761"><span class="linenos">761</span></a>        <span class="k">if</span> <span class="p">(</span>
</span><span id="CsvPaths.next_by_line-762"><a href="#CsvPaths.next_by_line-762"><span class="linenos">762</span></a>            <span class="n">paths</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">paths</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
</span><span id="CsvPaths.next_by_line-763"><a href="#CsvPaths.next_by_line-763"><span class="linenos">763</span></a>        <span class="p">):</span>  <span class="c1"># pragma: no cover</span>
</span><span id="CsvPaths.next_by_line-764"><a href="#CsvPaths.next_by_line-764"><span class="linenos">764</span></a>            <span class="k">raise</span> <span class="n">InputException</span><span class="p">(</span>
</span><span id="CsvPaths.next_by_line-765"><a href="#CsvPaths.next_by_line-765"><span class="linenos">765</span></a>                <span class="sa">f</span><span class="s2">&quot;Pathsname &#39;</span><span class="si">{</span><span class="n">pathsname</span><span class="si">}</span><span class="s2">&#39; must name a list of csvpaths&quot;</span>
</span><span id="CsvPaths.next_by_line-766"><a href="#CsvPaths.next_by_line-766"><span class="linenos">766</span></a>            <span class="p">)</span>
</span><span id="CsvPaths.next_by_line-767"><a href="#CsvPaths.next_by_line-767"><span class="linenos">767</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.next_by_line-768"><a href="#CsvPaths.next_by_line-768"><span class="linenos">768</span></a>        <span class="c1"># experiment!</span>
</span><span id="CsvPaths.next_by_line-769"><a href="#CsvPaths.next_by_line-769"><span class="linenos">769</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.next_by_line-770"><a href="#CsvPaths.next_by_line-770"><span class="linenos">770</span></a>        <span class="n">crt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_time_str</span><span class="p">(</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths.next_by_line-771"><a href="#CsvPaths.next_by_line-771"><span class="linenos">771</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.next_by_line-772"><a href="#CsvPaths.next_by_line-772"><span class="linenos">772</span></a>        <span class="c1"># also use of crt below</span>
</span><span id="CsvPaths.next_by_line-773"><a href="#CsvPaths.next_by_line-773"><span class="linenos">773</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.next_by_line-774"><a href="#CsvPaths.next_by_line-774"><span class="linenos">774</span></a>        <span class="n">csvpath_objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_csvpath_objects</span><span class="p">(</span>
</span><span id="CsvPaths.next_by_line-775"><a href="#CsvPaths.next_by_line-775"><span class="linenos">775</span></a>            <span class="n">paths</span><span class="o">=</span><span class="n">paths</span><span class="p">,</span>
</span><span id="CsvPaths.next_by_line-776"><a href="#CsvPaths.next_by_line-776"><span class="linenos">776</span></a>            <span class="n">named_file</span><span class="o">=</span><span class="n">fn</span><span class="p">,</span>
</span><span id="CsvPaths.next_by_line-777"><a href="#CsvPaths.next_by_line-777"><span class="linenos">777</span></a>            <span class="n">collect_when_not_matched</span><span class="o">=</span><span class="n">collect_when_not_matched</span><span class="p">,</span>
</span><span id="CsvPaths.next_by_line-778"><a href="#CsvPaths.next_by_line-778"><span class="linenos">778</span></a>            <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths.next_by_line-779"><a href="#CsvPaths.next_by_line-779"><span class="linenos">779</span></a>            <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths.next_by_line-780"><a href="#CsvPaths.next_by_line-780"><span class="linenos">780</span></a>            <span class="n">crt</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span>
</span><span id="CsvPaths.next_by_line-781"><a href="#CsvPaths.next_by_line-781"><span class="linenos">781</span></a>        <span class="p">)</span>
</span><span id="CsvPaths.next_by_line-782"><a href="#CsvPaths.next_by_line-782"><span class="linenos">782</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.next_by_line-783"><a href="#CsvPaths.next_by_line-783"><span class="linenos">783</span></a>        <span class="c1"># prep has to come after _load_csvpath_objects because we need the identity or</span>
</span><span id="CsvPaths.next_by_line-784"><a href="#CsvPaths.next_by_line-784"><span class="linenos">784</span></a>        <span class="c1"># indexes to be stable and the identity is found in the load, if it exists.</span>
</span><span id="CsvPaths.next_by_line-785"><a href="#CsvPaths.next_by_line-785"><span class="linenos">785</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.next_by_line-786"><a href="#CsvPaths.next_by_line-786"><span class="linenos">786</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_prep_csvpath_results</span><span class="p">(</span>
</span><span id="CsvPaths.next_by_line-787"><a href="#CsvPaths.next_by_line-787"><span class="linenos">787</span></a>            <span class="n">csvpath_objects</span><span class="o">=</span><span class="n">csvpath_objects</span><span class="p">,</span>
</span><span id="CsvPaths.next_by_line-788"><a href="#CsvPaths.next_by_line-788"><span class="linenos">788</span></a>            <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths.next_by_line-789"><a href="#CsvPaths.next_by_line-789"><span class="linenos">789</span></a>            <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths.next_by_line-790"><a href="#CsvPaths.next_by_line-790"><span class="linenos">790</span></a>            <span class="n">crt</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span>
</span><span id="CsvPaths.next_by_line-791"><a href="#CsvPaths.next_by_line-791"><span class="linenos">791</span></a>        <span class="p">)</span>
</span><span id="CsvPaths.next_by_line-792"><a href="#CsvPaths.next_by_line-792"><span class="linenos">792</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.next_by_line-793"><a href="#CsvPaths.next_by_line-793"><span class="linenos">793</span></a>        <span class="c1"># setting fn into the csvpath is less obviously useful at CsvPaths</span>
</span><span id="CsvPaths.next_by_line-794"><a href="#CsvPaths.next_by_line-794"><span class="linenos">794</span></a>        <span class="c1"># but we&#39;ll do it for consistency.</span>
</span><span id="CsvPaths.next_by_line-795"><a href="#CsvPaths.next_by_line-795"><span class="linenos">795</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.next_by_line-796"><a href="#CsvPaths.next_by_line-796"><span class="linenos">796</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Beginning next_by_line with </span><span class="si">%s</span><span class="s2"> paths&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">csvpath_objects</span><span class="p">))</span>
</span><span id="CsvPaths.next_by_line-797"><a href="#CsvPaths.next_by_line-797"><span class="linenos">797</span></a>        <span class="n">reader</span> <span class="o">=</span> <span class="n">FileManager</span><span class="o">.</span><span class="n">get_reader</span><span class="p">(</span>
</span><span id="CsvPaths.next_by_line-798"><a href="#CsvPaths.next_by_line-798"><span class="linenos">798</span></a>            <span class="n">fn</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">,</span> <span class="n">quotechar</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">quotechar</span>
</span><span id="CsvPaths.next_by_line-799"><a href="#CsvPaths.next_by_line-799"><span class="linenos">799</span></a>        <span class="p">)</span>
</span><span id="CsvPaths.next_by_line-800"><a href="#CsvPaths.next_by_line-800"><span class="linenos">800</span></a>        <span class="n">stopped_count</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CsvPaths.next_by_line-801"><a href="#CsvPaths.next_by_line-801"><span class="linenos">801</span></a>        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">reader</span><span class="o">.</span><span class="n">next</span><span class="p">():</span>
</span><span id="CsvPaths.next_by_line-802"><a href="#CsvPaths.next_by_line-802"><span class="linenos">802</span></a>            <span class="c1"># for line in reader:  # pylint: disable=R1702</span>
</span><span id="CsvPaths.next_by_line-803"><a href="#CsvPaths.next_by_line-803"><span class="linenos">803</span></a>            <span class="c1"># question to self: should this default be in a central place</span>
</span><span id="CsvPaths.next_by_line-804"><a href="#CsvPaths.next_by_line-804"><span class="linenos">804</span></a>            <span class="c1"># so that we can switch to OR, in part by changing the default?</span>
</span><span id="CsvPaths.next_by_line-805"><a href="#CsvPaths.next_by_line-805"><span class="linenos">805</span></a>            <span class="n">keep</span> <span class="o">=</span> <span class="n">if_all_agree</span>
</span><span id="CsvPaths.next_by_line-806"><a href="#CsvPaths.next_by_line-806"><span class="linenos">806</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_skip_all</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CsvPaths.next_by_line-807"><a href="#CsvPaths.next_by_line-807"><span class="linenos">807</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_advance_all</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="CsvPaths.next_by_line-808"><a href="#CsvPaths.next_by_line-808"><span class="linenos">808</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="CsvPaths.next_by_line-809"><a href="#CsvPaths.next_by_line-809"><span class="linenos">809</span></a>                <span class="c1"># p is a (CsvPath, List[List[str]]) where the second item is</span>
</span><span id="CsvPaths.next_by_line-810"><a href="#CsvPaths.next_by_line-810"><span class="linenos">810</span></a>                <span class="c1"># the line-by-line results of the first item&#39;s matching</span>
</span><span id="CsvPaths.next_by_line-811"><a href="#CsvPaths.next_by_line-811"><span class="linenos">811</span></a>                <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">csvpath_objects</span><span class="p">:</span>
</span><span id="CsvPaths.next_by_line-812"><a href="#CsvPaths.next_by_line-812"><span class="linenos">812</span></a>                    <span class="c1">#</span>
</span><span id="CsvPaths.next_by_line-813"><a href="#CsvPaths.next_by_line-813"><span class="linenos">813</span></a>                    <span class="c1"># if run-mode: no-run we skip ahead without saving results</span>
</span><span id="CsvPaths.next_by_line-814"><a href="#CsvPaths.next_by_line-814"><span class="linenos">814</span></a>                    <span class="c1">#</span>
</span><span id="CsvPaths.next_by_line-815"><a href="#CsvPaths.next_by_line-815"><span class="linenos">815</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">will_run</span><span class="p">:</span>
</span><span id="CsvPaths.next_by_line-816"><a href="#CsvPaths.next_by_line-816"><span class="linenos">816</span></a>                        <span class="k">continue</span>
</span><span id="CsvPaths.next_by_line-817"><a href="#CsvPaths.next_by_line-817"><span class="linenos">817</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="CsvPaths.next_by_line-818"><a href="#CsvPaths.next_by_line-818"><span class="linenos">818</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fail_all</span><span class="p">:</span>
</span><span id="CsvPaths.next_by_line-819"><a href="#CsvPaths.next_by_line-819"><span class="linenos">819</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="CsvPaths.next_by_line-820"><a href="#CsvPaths.next_by_line-820"><span class="linenos">820</span></a>                            <span class="s2">&quot;Fail-all set. Setting CsvPath is_valid to False.&quot;</span>
</span><span id="CsvPaths.next_by_line-821"><a href="#CsvPaths.next_by_line-821"><span class="linenos">821</span></a>                        <span class="p">)</span>
</span><span id="CsvPaths.next_by_line-822"><a href="#CsvPaths.next_by_line-822"><span class="linenos">822</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">is_valid</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CsvPaths.next_by_line-823"><a href="#CsvPaths.next_by_line-823"><span class="linenos">823</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stop_all</span><span class="p">:</span>
</span><span id="CsvPaths.next_by_line-824"><a href="#CsvPaths.next_by_line-824"><span class="linenos">824</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Stop-all set. Shutting down run.&quot;</span><span class="p">)</span>
</span><span id="CsvPaths.next_by_line-825"><a href="#CsvPaths.next_by_line-825"><span class="linenos">825</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">stopped</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="CsvPaths.next_by_line-826"><a href="#CsvPaths.next_by_line-826"><span class="linenos">826</span></a>                        <span class="k">continue</span>
</span><span id="CsvPaths.next_by_line-827"><a href="#CsvPaths.next_by_line-827"><span class="linenos">827</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_skip_all</span><span class="p">:</span>
</span><span id="CsvPaths.next_by_line-828"><a href="#CsvPaths.next_by_line-828"><span class="linenos">828</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Skip-all set. Continuing to next.&quot;</span><span class="p">)</span>
</span><span id="CsvPaths.next_by_line-829"><a href="#CsvPaths.next_by_line-829"><span class="linenos">829</span></a>                        <span class="c1">#</span>
</span><span id="CsvPaths.next_by_line-830"><a href="#CsvPaths.next_by_line-830"><span class="linenos">830</span></a>                        <span class="c1"># all following CsvPaths must have their</span>
</span><span id="CsvPaths.next_by_line-831"><a href="#CsvPaths.next_by_line-831"><span class="linenos">831</span></a>                        <span class="c1"># line_monitors incremented</span>
</span><span id="CsvPaths.next_by_line-832"><a href="#CsvPaths.next_by_line-832"><span class="linenos">832</span></a>                        <span class="c1">#</span>
</span><span id="CsvPaths.next_by_line-833"><a href="#CsvPaths.next_by_line-833"><span class="linenos">833</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">track_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="CsvPaths.next_by_line-834"><a href="#CsvPaths.next_by_line-834"><span class="linenos">834</span></a>                        <span class="k">continue</span>
</span><span id="CsvPaths.next_by_line-835"><a href="#CsvPaths.next_by_line-835"><span class="linenos">835</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_advance_all</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CsvPaths.next_by_line-836"><a href="#CsvPaths.next_by_line-836"><span class="linenos">836</span></a>                        <span class="n">logtxt</span> <span class="o">=</span> <span class="s2">&quot;Advance-all set. Setting advance. &quot;</span>
</span><span id="CsvPaths.next_by_line-837"><a href="#CsvPaths.next_by_line-837"><span class="linenos">837</span></a>                        <span class="n">logtxt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">logtxt</span><span class="si">}</span><span class="s2">CsvPath and its Matcher will handle the advancing.&quot;</span>
</span><span id="CsvPaths.next_by_line-838"><a href="#CsvPaths.next_by_line-838"><span class="linenos">838</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">logtxt</span><span class="p">)</span>
</span><span id="CsvPaths.next_by_line-839"><a href="#CsvPaths.next_by_line-839"><span class="linenos">839</span></a>                        <span class="c1">#</span>
</span><span id="CsvPaths.next_by_line-840"><a href="#CsvPaths.next_by_line-840"><span class="linenos">840</span></a>                        <span class="c1"># CsvPath will handle advancing so we don&#39;t need to do</span>
</span><span id="CsvPaths.next_by_line-841"><a href="#CsvPaths.next_by_line-841"><span class="linenos">841</span></a>                        <span class="c1"># anything, including track_line(line). we just need to</span>
</span><span id="CsvPaths.next_by_line-842"><a href="#CsvPaths.next_by_line-842"><span class="linenos">842</span></a>                        <span class="c1"># see if we&#39;re setting advance or increasing it.</span>
</span><span id="CsvPaths.next_by_line-843"><a href="#CsvPaths.next_by_line-843"><span class="linenos">843</span></a>                        <span class="c1">#</span>
</span><span id="CsvPaths.next_by_line-844"><a href="#CsvPaths.next_by_line-844"><span class="linenos">844</span></a>                        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">advance_count</span>
</span><span id="CsvPaths.next_by_line-845"><a href="#CsvPaths.next_by_line-845"><span class="linenos">845</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_advance_all</span> <span class="o">&gt;</span> <span class="n">a</span><span class="p">:</span>
</span><span id="CsvPaths.next_by_line-846"><a href="#CsvPaths.next_by_line-846"><span class="linenos">846</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">advance_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_advance_all</span>
</span><span id="CsvPaths.next_by_line-847"><a href="#CsvPaths.next_by_line-847"><span class="linenos">847</span></a>                        <span class="c1">#</span>
</span><span id="CsvPaths.next_by_line-848"><a href="#CsvPaths.next_by_line-848"><span class="linenos">848</span></a>                        <span class="c1"># all following CsvPaths must have their</span>
</span><span id="CsvPaths.next_by_line-849"><a href="#CsvPaths.next_by_line-849"><span class="linenos">849</span></a>                        <span class="c1"># advance incremented -- with the advance not being simply</span>
</span><span id="CsvPaths.next_by_line-850"><a href="#CsvPaths.next_by_line-850"><span class="linenos">850</span></a>                        <span class="c1"># additive, have to be mindful of any existing advance</span>
</span><span id="CsvPaths.next_by_line-851"><a href="#CsvPaths.next_by_line-851"><span class="linenos">851</span></a>                        <span class="c1"># count!</span>
</span><span id="CsvPaths.next_by_line-852"><a href="#CsvPaths.next_by_line-852"><span class="linenos">852</span></a>                        <span class="c1">#</span>
</span><span id="CsvPaths.next_by_line-853"><a href="#CsvPaths.next_by_line-853"><span class="linenos">853</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">stopped</span><span class="p">:</span>  <span class="c1"># pylint: disable=R1724</span>
</span><span id="CsvPaths.next_by_line-854"><a href="#CsvPaths.next_by_line-854"><span class="linenos">854</span></a>                        <span class="k">continue</span>
</span><span id="CsvPaths.next_by_line-855"><a href="#CsvPaths.next_by_line-855"><span class="linenos">855</span></a>
</span><span id="CsvPaths.next_by_line-856"><a href="#CsvPaths.next_by_line-856"><span class="linenos">856</span></a>                    <span class="c1">#</span>
</span><span id="CsvPaths.next_by_line-857"><a href="#CsvPaths.next_by_line-857"><span class="linenos">857</span></a>                    <span class="c1"># allowing the match to happen regardless of keep</span>
</span><span id="CsvPaths.next_by_line-858"><a href="#CsvPaths.next_by_line-858"><span class="linenos">858</span></a>                    <span class="c1"># because we may want side-effects or to have different</span>
</span><span id="CsvPaths.next_by_line-859"><a href="#CsvPaths.next_by_line-859"><span class="linenos">859</span></a>                    <span class="c1"># results in different named-results, as well as the</span>
</span><span id="CsvPaths.next_by_line-860"><a href="#CsvPaths.next_by_line-860"><span class="linenos">860</span></a>                    <span class="c1"># union</span>
</span><span id="CsvPaths.next_by_line-861"><a href="#CsvPaths.next_by_line-861"><span class="linenos">861</span></a>                    <span class="c1">#</span>
</span><span id="CsvPaths.next_by_line-862"><a href="#CsvPaths.next_by_line-862"><span class="linenos">862</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="CsvPaths.next_by_line-863"><a href="#CsvPaths.next_by_line-863"><span class="linenos">863</span></a>                        <span class="s2">&quot;considering line with csvpath identified as: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="CsvPaths.next_by_line-864"><a href="#CsvPaths.next_by_line-864"><span class="linenos">864</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">identity</span><span class="p">,</span>
</span><span id="CsvPaths.next_by_line-865"><a href="#CsvPaths.next_by_line-865"><span class="linenos">865</span></a>                    <span class="p">)</span>
</span><span id="CsvPaths.next_by_line-866"><a href="#CsvPaths.next_by_line-866"><span class="linenos">866</span></a>                    <span class="n">matched</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CsvPaths.next_by_line-867"><a href="#CsvPaths.next_by_line-867"><span class="linenos">867</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">track_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="CsvPaths.next_by_line-868"><a href="#CsvPaths.next_by_line-868"><span class="linenos">868</span></a>                    <span class="c1">#</span>
</span><span id="CsvPaths.next_by_line-869"><a href="#CsvPaths.next_by_line-869"><span class="linenos">869</span></a>                    <span class="c1"># re: W0212: treating _consider_line something like package private</span>
</span><span id="CsvPaths.next_by_line-870"><a href="#CsvPaths.next_by_line-870"><span class="linenos">870</span></a>                    <span class="c1">#</span>
</span><span id="CsvPaths.next_by_line-871"><a href="#CsvPaths.next_by_line-871"><span class="linenos">871</span></a>                    <span class="n">matched</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="CsvPaths.next_by_line-872"><a href="#CsvPaths.next_by_line-872"><span class="linenos">872</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">_consider_line</span><span class="p">(</span>  <span class="c1"># pylint:disable=W0212</span>
</span><span id="CsvPaths.next_by_line-873"><a href="#CsvPaths.next_by_line-873"><span class="linenos">873</span></a>                            <span class="n">line</span>
</span><span id="CsvPaths.next_by_line-874"><a href="#CsvPaths.next_by_line-874"><span class="linenos">874</span></a>                        <span class="p">)</span>
</span><span id="CsvPaths.next_by_line-875"><a href="#CsvPaths.next_by_line-875"><span class="linenos">875</span></a>                    <span class="p">)</span>
</span><span id="CsvPaths.next_by_line-876"><a href="#CsvPaths.next_by_line-876"><span class="linenos">876</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">stopped</span><span class="p">:</span>
</span><span id="CsvPaths.next_by_line-877"><a href="#CsvPaths.next_by_line-877"><span class="linenos">877</span></a>                        <span class="n">stopped_count</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="CsvPaths.next_by_line-878"><a href="#CsvPaths.next_by_line-878"><span class="linenos">878</span></a>                    <span class="k">if</span> <span class="n">if_all_agree</span><span class="p">:</span>
</span><span id="CsvPaths.next_by_line-879"><a href="#CsvPaths.next_by_line-879"><span class="linenos">879</span></a>                        <span class="n">keep</span> <span class="o">=</span> <span class="n">keep</span> <span class="ow">and</span> <span class="n">matched</span>
</span><span id="CsvPaths.next_by_line-880"><a href="#CsvPaths.next_by_line-880"><span class="linenos">880</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="CsvPaths.next_by_line-881"><a href="#CsvPaths.next_by_line-881"><span class="linenos">881</span></a>                        <span class="n">keep</span> <span class="o">=</span> <span class="n">keep</span> <span class="ow">or</span> <span class="n">matched</span>
</span><span id="CsvPaths.next_by_line-882"><a href="#CsvPaths.next_by_line-882"><span class="linenos">882</span></a>                    <span class="c1">#</span>
</span><span id="CsvPaths.next_by_line-883"><a href="#CsvPaths.next_by_line-883"><span class="linenos">883</span></a>                    <span class="c1"># not doing continue if we have if_all_agree and not keep as we</span>
</span><span id="CsvPaths.next_by_line-884"><a href="#CsvPaths.next_by_line-884"><span class="linenos">884</span></a>                    <span class="c1"># used to do allows individual results to have lines that in</span>
</span><span id="CsvPaths.next_by_line-885"><a href="#CsvPaths.next_by_line-885"><span class="linenos">885</span></a>                    <span class="c1"># aggregate we do not keep.</span>
</span><span id="CsvPaths.next_by_line-886"><a href="#CsvPaths.next_by_line-886"><span class="linenos">886</span></a>                    <span class="c1">#</span>
</span><span id="CsvPaths.next_by_line-887"><a href="#CsvPaths.next_by_line-887"><span class="linenos">887</span></a>                    <span class="k">if</span> <span class="n">matched</span> <span class="ow">and</span> <span class="n">collect</span><span class="p">:</span>
</span><span id="CsvPaths.next_by_line-888"><a href="#CsvPaths.next_by_line-888"><span class="linenos">888</span></a>                        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">limit_collection</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="CsvPaths.next_by_line-889"><a href="#CsvPaths.next_by_line-889"><span class="linenos">889</span></a>                        <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="CsvPaths.next_by_line-890"><a href="#CsvPaths.next_by_line-890"><span class="linenos">890</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>  <span class="c1"># pylint: disable=W0718</span>
</span><span id="CsvPaths.next_by_line-891"><a href="#CsvPaths.next_by_line-891"><span class="linenos">891</span></a>                <span class="c1"># ex.trace = traceback.format_exc()</span>
</span><span id="CsvPaths.next_by_line-892"><a href="#CsvPaths.next_by_line-892"><span class="linenos">892</span></a>                <span class="c1"># ex.source = self</span>
</span><span id="CsvPaths.next_by_line-893"><a href="#CsvPaths.next_by_line-893"><span class="linenos">893</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">error_manager</span><span class="o">.</span><span class="n">handle_error</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="CsvPaths.next_by_line-894"><a href="#CsvPaths.next_by_line-894"><span class="linenos">894</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ecoms</span><span class="o">.</span><span class="n">do_i_raise</span><span class="p">():</span>
</span><span id="CsvPaths.next_by_line-895"><a href="#CsvPaths.next_by_line-895"><span class="linenos">895</span></a>                    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">csvpath_objects</span><span class="p">:</span>
</span><span id="CsvPaths.next_by_line-896"><a href="#CsvPaths.next_by_line-896"><span class="linenos">896</span></a>                        <span class="n">result</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="CsvPaths.next_by_line-897"><a href="#CsvPaths.next_by_line-897"><span class="linenos">897</span></a>                        <span class="n">result</span><span class="o">.</span><span class="n">unmatched</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">unmatched</span>
</span><span id="CsvPaths.next_by_line-898"><a href="#CsvPaths.next_by_line-898"><span class="linenos">898</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths.next_by_line-899"><a href="#CsvPaths.next_by_line-899"><span class="linenos">899</span></a>                    <span class="k">raise</span>
</span><span id="CsvPaths.next_by_line-900"><a href="#CsvPaths.next_by_line-900"><span class="linenos">900</span></a>            <span class="c1"># we yield even if we stopped in this iteration.</span>
</span><span id="CsvPaths.next_by_line-901"><a href="#CsvPaths.next_by_line-901"><span class="linenos">901</span></a>            <span class="c1"># caller needs to see what we stopped on.</span>
</span><span id="CsvPaths.next_by_line-902"><a href="#CsvPaths.next_by_line-902"><span class="linenos">902</span></a>            <span class="c1">#</span>
</span><span id="CsvPaths.next_by_line-903"><a href="#CsvPaths.next_by_line-903"><span class="linenos">903</span></a>            <span class="c1"># ! we only yield if keep is True</span>
</span><span id="CsvPaths.next_by_line-904"><a href="#CsvPaths.next_by_line-904"><span class="linenos">904</span></a>            <span class="c1">#</span>
</span><span id="CsvPaths.next_by_line-905"><a href="#CsvPaths.next_by_line-905"><span class="linenos">905</span></a>            <span class="k">if</span> <span class="n">keep</span><span class="p">:</span>
</span><span id="CsvPaths.next_by_line-906"><a href="#CsvPaths.next_by_line-906"><span class="linenos">906</span></a>                <span class="k">yield</span> <span class="n">line</span>
</span><span id="CsvPaths.next_by_line-907"><a href="#CsvPaths.next_by_line-907"><span class="linenos">907</span></a>            <span class="k">if</span> <span class="nb">sum</span><span class="p">(</span><span class="n">stopped_count</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">csvpath_objects</span><span class="p">):</span>
</span><span id="CsvPaths.next_by_line-908"><a href="#CsvPaths.next_by_line-908"><span class="linenos">908</span></a>                <span class="k">break</span>
</span><span id="CsvPaths.next_by_line-909"><a href="#CsvPaths.next_by_line-909"><span class="linenos">909</span></a>        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CsvPaths.next_by_line-910"><a href="#CsvPaths.next_by_line-910"><span class="linenos">910</span></a>        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">csvpath_objects</span><span class="p">:</span>
</span><span id="CsvPaths.next_by_line-911"><a href="#CsvPaths.next_by_line-911"><span class="linenos">911</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="CsvPaths.next_by_line-912"><a href="#CsvPaths.next_by_line-912"><span class="linenos">912</span></a>            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths.next_by_line-913"><a href="#CsvPaths.next_by_line-913"><span class="linenos">913</span></a>            <span class="n">result</span><span class="o">.</span><span class="n">unmatched</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">unmatched</span>
</span><span id="CsvPaths.next_by_line-914"><a href="#CsvPaths.next_by_line-914"><span class="linenos">914</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths.next_by_line-915"><a href="#CsvPaths.next_by_line-915"><span class="linenos">915</span></a>
</span><span id="CsvPaths.next_by_line-916"><a href="#CsvPaths.next_by_line-916"><span class="linenos">916</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.next_by_line-917"><a href="#CsvPaths.next_by_line-917"><span class="linenos">917</span></a>        <span class="c1"># run ends here</span>
</span><span id="CsvPaths.next_by_line-918"><a href="#CsvPaths.next_by_line-918"><span class="linenos">918</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.next_by_line-919"><a href="#CsvPaths.next_by_line-919"><span class="linenos">919</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">complete_run</span><span class="p">(</span>
</span><span id="CsvPaths.next_by_line-920"><a href="#CsvPaths.next_by_line-920"><span class="linenos">920</span></a>            <span class="n">run_dir</span><span class="o">=</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">run_dir</span><span class="p">,</span> <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span>
</span><span id="CsvPaths.next_by_line-921"><a href="#CsvPaths.next_by_line-921"><span class="linenos">921</span></a>        <span class="p">)</span>
</span><span id="CsvPaths.next_by_line-922"><a href="#CsvPaths.next_by_line-922"><span class="linenos">922</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clear_run_coordination</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Does a CsvPath.next() on filename where each row is considered
by every named path before the next row starts.</p>

<p>if_all_agree=True means all the CsvPath instances must match for
the line to be kept. However, every CsvPath instance will keep its
own matches in its results regardless of if every line kept was
returned to the caller by CsvPaths.</p>

<p>collect_when_not_matched=True inverts the match so that lines
which did not match are returned, rather than the default behavior.</p>
</div>


                            </div>
                </section>
    </main>
</body>
</html>