<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 15.0.1"/>
    <title>csvpath API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>

            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#CsvPath">CsvPath</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#CsvPath.__init__">CsvPath</a>
                        </li>
                        <li>
                                <a class="variable" href="#CsvPath.error_manager">error_manager</a>
                        </li>
                        <li>
                                <a class="variable" href="#CsvPath.variables">variables</a>
                        </li>
                        <li>
                                <a class="variable" href="#CsvPath.delimiter">delimiter</a>
                        </li>
                        <li>
                                <a class="variable" href="#CsvPath.quotechar">quotechar</a>
                        </li>
                        <li>
                                <a class="variable" href="#CsvPath.skip_blank_lines">skip_blank_lines</a>
                        </li>
                        <li>
                                <a class="variable" href="#CsvPath.scan_count">scan_count</a>
                        </li>
                        <li>
                                <a class="variable" href="#CsvPath.match_count">match_count</a>
                        </li>
                        <li>
                                <a class="variable" href="#CsvPath.stopped">stopped</a>
                        </li>
                        <li>
                                <a class="variable" href="#CsvPath.metadata">metadata</a>
                        </li>
                        <li>
                                <a class="variable" href="#CsvPath.AND">AND</a>
                        </li>
                        <li>
                                <a class="variable" href="#CsvPath.OR">OR</a>
                        </li>
                        <li>
                                <a class="variable" href="#CsvPath.identity">identity</a>
                        </li>
                        <li>
                                <a class="variable" href="#CsvPath.errors">errors</a>
                        </li>
                        <li>
                                <a class="variable" href="#CsvPath.errors_count">errors_count</a>
                        </li>
                        <li>
                                <a class="function" href="#CsvPath.has_errors">has_errors</a>
                        </li>
                        <li>
                                <a class="variable" href="#CsvPath.is_valid">is_valid</a>
                        </li>
                        <li>
                                <a class="variable" href="#CsvPath.completed">completed</a>
                        </li>
                        <li>
                                <a class="function" href="#CsvPath.collect">collect</a>
                        </li>
                        <li>
                                <a class="function" href="#CsvPath.fast_forward">fast_forward</a>
                        </li>
                        <li>
                                <a class="function" href="#CsvPath.next">next</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#CsvPaths">CsvPaths</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#CsvPaths.__init__">CsvPaths</a>
                        </li>
                        <li>
                                <a class="variable" href="#CsvPaths.file_manager">file_manager</a>
                        </li>
                        <li>
                                <a class="variable" href="#CsvPaths.results_manager">results_manager</a>
                        </li>
                        <li>
                                <a class="variable" href="#CsvPaths.paths_manager">paths_manager</a>
                        </li>
                        <li>
                                <a class="variable" href="#CsvPaths.error_manager">error_manager</a>
                        </li>
                        <li>
                                <a class="function" href="#CsvPaths.csvpath">csvpath</a>
                        </li>
                        <li>
                                <a class="function" href="#CsvPaths.collect_paths">collect_paths</a>
                        </li>
                        <li>
                                <a class="function" href="#CsvPaths.fast_forward_paths">fast_forward_paths</a>
                        </li>
                        <li>
                                <a class="function" href="#CsvPaths.next_paths">next_paths</a>
                        </li>
                        <li>
                                <a class="function" href="#CsvPaths.collect_by_line">collect_by_line</a>
                        </li>
                        <li>
                                <a class="function" href="#CsvPaths.fast_forward_by_line">fast_forward_by_line</a>
                        </li>
                        <li>
                                <a class="function" href="#CsvPaths.next_by_line">next_by_line</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
csvpath    </h1>

                        <div class="docstring"><p>The CsvPath Framework makes it easy to pre-board external data files. It sits between Managed File Transfer and the data lake or applications. CsvPath provides durable dataset identification, validation and canonicalization, and stages data for internal use as a known-good raw data source. The goal is to automate the pre-boarding process.</p>

<p>CsvPath Language is the core validation and canonicalization engine of the Framework. The validation files can be developed without coding using the CLI. When you are ready to automate pre-boarding you will use the classes documented here, in particular <a href="#CsvPath">csvpath.CsvPath</a>, <a href="#CsvPaths">csvpath.CsvPaths</a>, and the managers in csvpath.managers:</p>

<ul>
<li><a href="csvpath/managers/files/file_manager.html">csvpath.managers.files.file_manager</a></li>
<li><a href="csvpath/managers/paths/paths_manager.html">csvpath.managers.paths.paths_manager</a></li>
<li><a href="csvpath/managers/results/results_manager.html">csvpath.managers.results.results_manager</a></li>
</ul>

<p>You access the managers from a <a href="#CsvPaths">csvpath.CsvPaths</a> instance. You should not construct your own.</p>

<p>There are many other classes you could potentially use in some specific and narrow cases, such as building a new integration, a new function, or a new type of printer. But for 99% of automation use cases these classes are all you need.</p>
</div>

                        <input id="mod-csvpath-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-csvpath-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos"> 1</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos"> 2</span></a><span class="sd">    The CsvPath Framework makes it easy to pre-board external data files. It sits between Managed File Transfer and the data lake or applications. CsvPath provides durable dataset identification, validation and canonicalization, and stages data for internal use as a known-good raw data source. The goal is to automate the pre-boarding process.</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos"> 3</span></a>
</span><span id="L-4"><a href="#L-4"><span class="linenos"> 4</span></a><span class="sd">CsvPath Language is the core validation and canonicalization engine of the Framework. The validation files can be developed without coding using the CLI. When you are ready to automate pre-boarding you will use the classes documented here, in particular csvpath.CsvPath, csvpath.CsvPaths, and the managers in csvpath.managers:</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos"> 5</span></a>
</span><span id="L-6"><a href="#L-6"><span class="linenos"> 6</span></a><span class="sd">- csvpath.managers.files.file_manager</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos"> 7</span></a><span class="sd">- csvpath.managers.paths.paths_manager</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos"> 8</span></a><span class="sd">- csvpath.managers.results.results_manager</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos"> 9</span></a>
</span><span id="L-10"><a href="#L-10"><span class="linenos">10</span></a><span class="sd">You access the managers from a csvpath.CsvPaths instance. You should not construct your own.</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos">11</span></a>
</span><span id="L-12"><a href="#L-12"><span class="linenos">12</span></a><span class="sd">There are many other classes you could potentially use in some specific and narrow cases, such as building a new integration, a new function, or a new type of printer. But for 99% of automation use cases these classes are all you need.</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos">13</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos">14</span></a>
</span><span id="L-15"><a href="#L-15"><span class="linenos">15</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">csvpath.csvpath</span><span class="w"> </span><span class="kn">import</span> <span class="n">CsvPath</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos">16</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">csvpath.csvpaths</span><span class="w"> </span><span class="kn">import</span> <span class="n">CsvPaths</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos">17</span></a>
</span><span id="L-18"><a href="#L-18"><span class="linenos">18</span></a><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;CsvPath&quot;</span><span class="p">,</span> <span class="s2">&quot;CsvPaths&quot;</span><span class="p">]</span>
</span></pre></div>


            </section>
                <section id="CsvPath">
                            <input id="CsvPath-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">CsvPath</span><wbr>(<span class="base">csvpath.managers.errors.error_collector.ErrorCollector</span>, <span class="base">csvpath.util.printer.Printer</span>):

                <label class="view-source-button" for="CsvPath-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPath"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPath-39"><a href="#CsvPath-39"><span class="linenos">  39</span></a><span class="k">class</span><span class="w"> </span><span class="nc">CsvPath</span><span class="p">(</span><span class="n">ErrorCollector</span><span class="p">,</span> <span class="n">Printer</span><span class="p">):</span>  <span class="c1"># pylint: disable=R0902, R0904</span>
</span><span id="CsvPath-40"><a href="#CsvPath-40"><span class="linenos">  40</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;CsvPath represents a csvpath string that contains a reference to</span>
</span><span id="CsvPath-41"><a href="#CsvPath-41"><span class="linenos">  41</span></a><span class="sd">    a file, scanning instructions, and rules for matching lines.</span>
</span><span id="CsvPath-42"><a href="#CsvPath-42"><span class="linenos">  42</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="CsvPath-43"><a href="#CsvPath-43"><span class="linenos">  43</span></a>
</span><span id="CsvPath-44"><a href="#CsvPath-44"><span class="linenos">  44</span></a>    <span class="c1"># re R0902, R0904: reasonable, but not a priority</span>
</span><span id="CsvPath-45"><a href="#CsvPath-45"><span class="linenos">  45</span></a>
</span><span id="CsvPath-46"><a href="#CsvPath-46"><span class="linenos">  46</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>  <span class="c1"># pylint: disable=R0913</span>
</span><span id="CsvPath-47"><a href="#CsvPath-47"><span class="linenos">  47</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="CsvPath-48"><a href="#CsvPath-48"><span class="linenos">  48</span></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="CsvPath-49"><a href="#CsvPath-49"><span class="linenos">  49</span></a>        <span class="n">csvpaths</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="CsvPath-50"><a href="#CsvPath-50"><span class="linenos">  50</span></a>        <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span>
</span><span id="CsvPath-51"><a href="#CsvPath-51"><span class="linenos">  51</span></a>        <span class="n">quotechar</span><span class="o">=</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span>
</span><span id="CsvPath-52"><a href="#CsvPath-52"><span class="linenos">  52</span></a>        <span class="n">skip_blank_lines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="CsvPath-53"><a href="#CsvPath-53"><span class="linenos">  53</span></a>        <span class="n">print_default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="CsvPath-54"><a href="#CsvPath-54"><span class="linenos">  54</span></a>        <span class="n">config</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="CsvPath-55"><a href="#CsvPath-55"><span class="linenos">  55</span></a>        <span class="n">error_manager</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="CsvPath-56"><a href="#CsvPath-56"><span class="linenos">  56</span></a>    <span class="p">):</span>
</span><span id="CsvPath-57"><a href="#CsvPath-57"><span class="linenos">  57</span></a>        <span class="c1"># re: R0913: all reasonable pass-ins with sensible defaults</span>
</span><span id="CsvPath-58"><a href="#CsvPath-58"><span class="linenos">  58</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-59"><a href="#CsvPath-59"><span class="linenos">  59</span></a>        <span class="c1"># the config.ini file loaded as a ConfigParser instance</span>
</span><span id="CsvPath-60"><a href="#CsvPath-60"><span class="linenos">  60</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-61"><a href="#CsvPath-61"><span class="linenos">  61</span></a>        <span class="c1"># definitely do not want this coming from CsvPaths because</span>
</span><span id="CsvPath-62"><a href="#CsvPath-62"><span class="linenos">  62</span></a>        <span class="c1"># we want to be able to override config.ini specifically for</span>
</span><span id="CsvPath-63"><a href="#CsvPath-63"><span class="linenos">  63</span></a>        <span class="c1"># this instance, if needed; however, we do want to be able</span>
</span><span id="CsvPath-64"><a href="#CsvPath-64"><span class="linenos">  64</span></a>        <span class="c1"># to pass in a config object that has been configured in some</span>
</span><span id="CsvPath-65"><a href="#CsvPath-65"><span class="linenos">  65</span></a>        <span class="c1"># way.</span>
</span><span id="CsvPath-66"><a href="#CsvPath-66"><span class="linenos">  66</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_config</span> <span class="o">=</span> <span class="n">config</span>
</span><span id="CsvPath-67"><a href="#CsvPath-67"><span class="linenos">  67</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scanner</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPath-68"><a href="#CsvPath-68"><span class="linenos">  68</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="CsvPath-69"><a href="#CsvPath-69"><span class="linenos">  69</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">matcher</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPath-70"><a href="#CsvPath-70"><span class="linenos">  70</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="CsvPath-71"><a href="#CsvPath-71"><span class="linenos">  71</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-72"><a href="#CsvPath-72"><span class="linenos">  72</span></a>        <span class="c1"># a parent CsvPaths may manage a CsvPath instance. if so, it will enable</span>
</span><span id="CsvPath-73"><a href="#CsvPath-73"><span class="linenos">  73</span></a>        <span class="c1"># the use of named files and named paths, print capture, error handling,</span>
</span><span id="CsvPath-74"><a href="#CsvPath-74"><span class="linenos">  74</span></a>        <span class="c1"># results collection, reference handling, etc. if a CsvPaths is not present</span>
</span><span id="CsvPath-75"><a href="#CsvPath-75"><span class="linenos">  75</span></a>        <span class="c1"># the CsvPath instance is responsible for all its own upkeep and does not</span>
</span><span id="CsvPath-76"><a href="#CsvPath-76"><span class="linenos">  76</span></a>        <span class="c1"># have some of those capabilities.</span>
</span><span id="CsvPath-77"><a href="#CsvPath-77"><span class="linenos">  77</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-78"><a href="#CsvPath-78"><span class="linenos">  78</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">csvpaths</span> <span class="o">=</span> <span class="n">csvpaths</span>
</span><span id="CsvPath-79"><a href="#CsvPath-79"><span class="linenos">  79</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="CsvPath-80"><a href="#CsvPath-80"><span class="linenos">  80</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-81"><a href="#CsvPath-81"><span class="linenos">  81</span></a>        <span class="c1"># there are two logger components one for CsvPath and one for CsvPaths.</span>
</span><span id="CsvPath-82"><a href="#CsvPath-82"><span class="linenos">  82</span></a>        <span class="c1"># the default levels are set in config.ini. to change the levels pass LogUtility</span>
</span><span id="CsvPath-83"><a href="#CsvPath-83"><span class="linenos">  83</span></a>        <span class="c1"># your component instance and the logging level. e.g.:</span>
</span><span id="CsvPath-84"><a href="#CsvPath-84"><span class="linenos">  84</span></a>        <span class="c1"># LogUtility.logger(csvpath, &quot;debug&quot;)</span>
</span><span id="CsvPath-85"><a href="#CsvPath-85"><span class="linenos">  85</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-86"><a href="#CsvPath-86"><span class="linenos">  86</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">LogUtility</span><span class="o">.</span><span class="n">logger</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="CsvPath-87"><a href="#CsvPath-87"><span class="linenos">  87</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="CsvPath-88"><a href="#CsvPath-88"><span class="linenos">  88</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;initialized CsvPath&quot;</span><span class="p">)</span>
</span><span id="CsvPath-89"><a href="#CsvPath-89"><span class="linenos">  89</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-90"><a href="#CsvPath-90"><span class="linenos">  90</span></a>        <span class="c1"># if we don&#39;t have a csvpaths these will both be None</span>
</span><span id="CsvPath-91"><a href="#CsvPath-91"><span class="linenos">  91</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-92"><a href="#CsvPath-92"><span class="linenos">  92</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">named_paths_name</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPath-93"><a href="#CsvPath-93"><span class="linenos">  93</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="CsvPath-94"><a href="#CsvPath-94"><span class="linenos">  94</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">named_file_name</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPath-95"><a href="#CsvPath-95"><span class="linenos">  95</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="CsvPath-96"><a href="#CsvPath-96"><span class="linenos">  96</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-97"><a href="#CsvPath-97"><span class="linenos">  97</span></a>        <span class="c1"># all errors come to our manager if they occur during matching. we use</span>
</span><span id="CsvPath-98"><a href="#CsvPath-98"><span class="linenos">  98</span></a>        <span class="c1"># the CsvPaths manager if possible. Otherwise, we just make our own that</span>
</span><span id="CsvPath-99"><a href="#CsvPath-99"><span class="linenos">  99</span></a>        <span class="c1"># only knows how to collect errors, not distribute them.</span>
</span><span id="CsvPath-100"><a href="#CsvPath-100"><span class="linenos"> 100</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-101"><a href="#CsvPath-101"><span class="linenos"> 101</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ecoms</span> <span class="o">=</span> <span class="n">ErrorCommunications</span><span class="p">(</span><span class="n">csvpath</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="CsvPath-102"><a href="#CsvPath-102"><span class="linenos"> 102</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="CsvPath-103"><a href="#CsvPath-103"><span class="linenos"> 103</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">error_manager</span> <span class="o">=</span> <span class="n">ErrorManager</span><span class="p">(</span><span class="n">csvpath</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="CsvPath-104"><a href="#CsvPath-104"><span class="linenos"> 104</span></a>        <span class="k">if</span> <span class="n">csvpaths</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-105"><a href="#CsvPath-105"><span class="linenos"> 105</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">error_manager</span><span class="o">.</span><span class="n">add_internal_listener</span><span class="p">(</span><span class="n">csvpaths</span><span class="o">.</span><span class="n">error_manager</span><span class="p">)</span>
</span><span id="CsvPath-106"><a href="#CsvPath-106"><span class="linenos"> 106</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-107"><a href="#CsvPath-107"><span class="linenos"> 107</span></a>        <span class="c1"># modes are set in external comments</span>
</span><span id="CsvPath-108"><a href="#CsvPath-108"><span class="linenos"> 108</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-109"><a href="#CsvPath-109"><span class="linenos"> 109</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">modes</span> <span class="o">=</span> <span class="n">ModeController</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="CsvPath-110"><a href="#CsvPath-110"><span class="linenos"> 110</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="CsvPath-111"><a href="#CsvPath-111"><span class="linenos"> 111</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-112"><a href="#CsvPath-112"><span class="linenos"> 112</span></a>        <span class="c1"># captures the number of lines up front and tracks line stats as the</span>
</span><span id="CsvPath-113"><a href="#CsvPath-113"><span class="linenos"> 113</span></a>        <span class="c1"># run progresses</span>
</span><span id="CsvPath-114"><a href="#CsvPath-114"><span class="linenos"> 114</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-115"><a href="#CsvPath-115"><span class="linenos"> 115</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_line_monitor</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPath-116"><a href="#CsvPath-116"><span class="linenos"> 116</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-117"><a href="#CsvPath-117"><span class="linenos"> 117</span></a>        <span class="c1"># the scanning part of the csvpath. e.g. $test.csv[*]</span>
</span><span id="CsvPath-118"><a href="#CsvPath-118"><span class="linenos"> 118</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-119"><a href="#CsvPath-119"><span class="linenos"> 119</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scan</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPath-120"><a href="#CsvPath-120"><span class="linenos"> 120</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="CsvPath-121"><a href="#CsvPath-121"><span class="linenos"> 121</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-122"><a href="#CsvPath-122"><span class="linenos"> 122</span></a>        <span class="c1"># the matching part of the csvpath. e.g. [yes()]</span>
</span><span id="CsvPath-123"><a href="#CsvPath-123"><span class="linenos"> 123</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-124"><a href="#CsvPath-124"><span class="linenos"> 124</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">match</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPath-125"><a href="#CsvPath-125"><span class="linenos"> 125</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="CsvPath-126"><a href="#CsvPath-126"><span class="linenos"> 126</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-127"><a href="#CsvPath-127"><span class="linenos"> 127</span></a>        <span class="c1"># when True the lines that do not match are returned from next()</span>
</span><span id="CsvPath-128"><a href="#CsvPath-128"><span class="linenos"> 128</span></a>        <span class="c1"># and collect(). this effectively switches CsvPath from being an</span>
</span><span id="CsvPath-129"><a href="#CsvPath-129"><span class="linenos"> 129</span></a>        <span class="c1"># create an OR expression in this case. in the default, we say:</span>
</span><span id="CsvPath-130"><a href="#CsvPath-130"><span class="linenos"> 130</span></a>        <span class="c1">#     are all of these things true?</span>
</span><span id="CsvPath-131"><a href="#CsvPath-131"><span class="linenos"> 131</span></a>        <span class="c1"># but when collect_when_not_matched is True we ask:</span>
</span><span id="CsvPath-132"><a href="#CsvPath-132"><span class="linenos"> 132</span></a>        <span class="c1">#     are any of these things not true?</span>
</span><span id="CsvPath-133"><a href="#CsvPath-133"><span class="linenos"> 133</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-134"><a href="#CsvPath-134"><span class="linenos"> 134</span></a>        <span class="c1"># self._when_not_matched = False</span>
</span><span id="CsvPath-135"><a href="#CsvPath-135"><span class="linenos"> 135</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_headers</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPath-136"><a href="#CsvPath-136"><span class="linenos"> 136</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="CsvPath-137"><a href="#CsvPath-137"><span class="linenos"> 137</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span> <span class="o">=</span> <span class="n">delimiter</span>
</span><span id="CsvPath-138"><a href="#CsvPath-138"><span class="linenos"> 138</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">quotechar</span> <span class="o">=</span> <span class="n">quotechar</span>
</span><span id="CsvPath-139"><a href="#CsvPath-139"><span class="linenos"> 139</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-140"><a href="#CsvPath-140"><span class="linenos"> 140</span></a>        <span class="c1"># a blank line has no headers. it has no data. physically it is 2 \n with</span>
</span><span id="CsvPath-141"><a href="#CsvPath-141"><span class="linenos"> 141</span></a>        <span class="c1"># nothing but whitespace between them. any data or any delimiters would make</span>
</span><span id="CsvPath-142"><a href="#CsvPath-142"><span class="linenos"> 142</span></a>        <span class="c1"># the line non-blank.</span>
</span><span id="CsvPath-143"><a href="#CsvPath-143"><span class="linenos"> 143</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-144"><a href="#CsvPath-144"><span class="linenos"> 144</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">skip_blank_lines</span> <span class="o">=</span> <span class="n">skip_blank_lines</span>
</span><span id="CsvPath-145"><a href="#CsvPath-145"><span class="linenos"> 145</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-146"><a href="#CsvPath-146"><span class="linenos"> 146</span></a>        <span class="c1"># in the case of a [*] scan where the last line is blank we would miss firing</span>
</span><span id="CsvPath-147"><a href="#CsvPath-147"><span class="linenos"> 147</span></a>        <span class="c1"># last() unless we take steps. instead, we allow that line to match, but we</span>
</span><span id="CsvPath-148"><a href="#CsvPath-148"><span class="linenos"> 148</span></a>        <span class="c1"># do not return a line to the caller of next() and we freeze the variables</span>
</span><span id="CsvPath-149"><a href="#CsvPath-149"><span class="linenos"> 149</span></a>        <span class="c1"># there is room for side effects make changes, but that a reasonable compromise</span>
</span><span id="CsvPath-150"><a href="#CsvPath-150"><span class="linenos"> 150</span></a>        <span class="c1"># between missing last and allowing unwanted changes. we definitely do not</span>
</span><span id="CsvPath-151"><a href="#CsvPath-151"><span class="linenos"> 151</span></a>        <span class="c1"># freeze is_valid or stop, which can be useful signaling, even in an</span>
</span><span id="CsvPath-152"><a href="#CsvPath-152"><span class="linenos"> 152</span></a>        <span class="c1"># inconsistent state.</span>
</span><span id="CsvPath-153"><a href="#CsvPath-153"><span class="linenos"> 153</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-154"><a href="#CsvPath-154"><span class="linenos"> 154</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_freeze_path</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CsvPath-155"><a href="#CsvPath-155"><span class="linenos"> 155</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-156"><a href="#CsvPath-156"><span class="linenos"> 156</span></a>        <span class="c1"># counts are 1-based</span>
</span><span id="CsvPath-157"><a href="#CsvPath-157"><span class="linenos"> 157</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-158"><a href="#CsvPath-158"><span class="linenos"> 158</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scan_count</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="CsvPath-159"><a href="#CsvPath-159"><span class="linenos"> 159</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">match_count</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="CsvPath-160"><a href="#CsvPath-160"><span class="linenos"> 160</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-161"><a href="#CsvPath-161"><span class="linenos"> 161</span></a>        <span class="c1"># used by stop() and advance(). a stopped CsvPath halts without finishing</span>
</span><span id="CsvPath-162"><a href="#CsvPath-162"><span class="linenos"> 162</span></a>        <span class="c1"># its run. an advancing CsvPath doesn&#39;t consider the match part of the</span>
</span><span id="CsvPath-163"><a href="#CsvPath-163"><span class="linenos"> 163</span></a>        <span class="c1"># csvpath and does not incur any side effects as it progresses through the</span>
</span><span id="CsvPath-164"><a href="#CsvPath-164"><span class="linenos"> 164</span></a>        <span class="c1"># rows the advance skips. the skip() function has the same effect as</span>
</span><span id="CsvPath-165"><a href="#CsvPath-165"><span class="linenos"> 165</span></a>        <span class="c1"># advance(1) but without any guarantee that the other match components on</span>
</span><span id="CsvPath-166"><a href="#CsvPath-166"><span class="linenos"> 166</span></a>        <span class="c1"># the line will be considered before skipping ahead. there are likely</span>
</span><span id="CsvPath-167"><a href="#CsvPath-167"><span class="linenos"> 167</span></a>        <span class="c1"># corner cases where an onmatch qualifier or some other constraint will</span>
</span><span id="CsvPath-168"><a href="#CsvPath-168"><span class="linenos"> 168</span></a>        <span class="c1"># trigger match components that would otherwise be skipped so the ability</span>
</span><span id="CsvPath-169"><a href="#CsvPath-169"><span class="linenos"> 169</span></a>        <span class="c1"># to shortcut some of the match should not be relied on for anything</span>
</span><span id="CsvPath-170"><a href="#CsvPath-170"><span class="linenos"> 170</span></a>        <span class="c1"># critical.</span>
</span><span id="CsvPath-171"><a href="#CsvPath-171"><span class="linenos"> 171</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-172"><a href="#CsvPath-172"><span class="linenos"> 172</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stopped</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CsvPath-173"><a href="#CsvPath-173"><span class="linenos"> 173</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_advance</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="CsvPath-174"><a href="#CsvPath-174"><span class="linenos"> 174</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-175"><a href="#CsvPath-175"><span class="linenos"> 175</span></a>        <span class="c1"># the lines var will hold a reference to a LineSpooler instance during a</span>
</span><span id="CsvPath-176"><a href="#CsvPath-176"><span class="linenos"> 176</span></a>        <span class="c1"># run, if lines are being collected by the collect() method. if the user</span>
</span><span id="CsvPath-177"><a href="#CsvPath-177"><span class="linenos"> 177</span></a>        <span class="c1"># is using this CsvPath instance directly the LineSpooler is only there</span>
</span><span id="CsvPath-178"><a href="#CsvPath-178"><span class="linenos"> 178</span></a>        <span class="c1"># as a proxy to the list of lines being collected -- we don&#39;t spool to</span>
</span><span id="CsvPath-179"><a href="#CsvPath-179"><span class="linenos"> 179</span></a>        <span class="c1"># disk, at least atm.</span>
</span><span id="CsvPath-180"><a href="#CsvPath-180"><span class="linenos"> 180</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-181"><a href="#CsvPath-181"><span class="linenos"> 181</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">lines</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPath-182"><a href="#CsvPath-182"><span class="linenos"> 182</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="CsvPath-183"><a href="#CsvPath-183"><span class="linenos"> 183</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-184"><a href="#CsvPath-184"><span class="linenos"> 184</span></a>        <span class="c1"># set by fail()</span>
</span><span id="CsvPath-185"><a href="#CsvPath-185"><span class="linenos"> 185</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-186"><a href="#CsvPath-186"><span class="linenos"> 186</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_is_valid</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="CsvPath-187"><a href="#CsvPath-187"><span class="linenos"> 187</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-188"><a href="#CsvPath-188"><span class="linenos"> 188</span></a>        <span class="c1"># basic timing for the CsvPath instance only. if the CsvPath is managed</span>
</span><span id="CsvPath-189"><a href="#CsvPath-189"><span class="linenos"> 189</span></a>        <span class="c1"># by a CsvPaths the timings for a run may include time spent by other</span>
</span><span id="CsvPath-190"><a href="#CsvPath-190"><span class="linenos"> 190</span></a>        <span class="c1"># CsvPath instances.</span>
</span><span id="CsvPath-191"><a href="#CsvPath-191"><span class="linenos"> 191</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-192"><a href="#CsvPath-192"><span class="linenos"> 192</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">last_row_time</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="CsvPath-193"><a href="#CsvPath-193"><span class="linenos"> 193</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="CsvPath-194"><a href="#CsvPath-194"><span class="linenos"> 194</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rows_time</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="CsvPath-195"><a href="#CsvPath-195"><span class="linenos"> 195</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="CsvPath-196"><a href="#CsvPath-196"><span class="linenos"> 196</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">total_iteration_time</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="CsvPath-197"><a href="#CsvPath-197"><span class="linenos"> 197</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="CsvPath-198"><a href="#CsvPath-198"><span class="linenos"> 198</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-199"><a href="#CsvPath-199"><span class="linenos"> 199</span></a>        <span class="c1"># limiting collection means returning fewer headers (values in the</span>
</span><span id="CsvPath-200"><a href="#CsvPath-200"><span class="linenos"> 200</span></a>        <span class="c1"># line, a.k.a columns) then are available. limiting headers returned</span>
</span><span id="CsvPath-201"><a href="#CsvPath-201"><span class="linenos"> 201</span></a>        <span class="c1"># can impact named results, reset_headers(), and other considerations.</span>
</span><span id="CsvPath-202"><a href="#CsvPath-202"><span class="linenos"> 202</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-203"><a href="#CsvPath-203"><span class="linenos"> 203</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_limit_collection_to</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CsvPath-204"><a href="#CsvPath-204"><span class="linenos"> 204</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-205"><a href="#CsvPath-205"><span class="linenos"> 205</span></a>        <span class="c1"># error collecting is at the CsvPath instance by default. CsvPath</span>
</span><span id="CsvPath-206"><a href="#CsvPath-206"><span class="linenos"> 206</span></a>        <span class="c1"># instances that are managed by a CsvPaths have their errors collected</span>
</span><span id="CsvPath-207"><a href="#CsvPath-207"><span class="linenos"> 207</span></a>        <span class="c1"># by their Results as well. Result handles persistence.</span>
</span><span id="CsvPath-208"><a href="#CsvPath-208"><span class="linenos"> 208</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-209"><a href="#CsvPath-209"><span class="linenos"> 209</span></a>        <span class="c1"># errors policies are set in config.ini at CsvPath and CsvPaths levels.</span>
</span><span id="CsvPath-210"><a href="#CsvPath-210"><span class="linenos"> 210</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-211"><a href="#CsvPath-211"><span class="linenos"> 211</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Error</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CsvPath-212"><a href="#CsvPath-212"><span class="linenos"> 212</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-213"><a href="#CsvPath-213"><span class="linenos"> 213</span></a>        <span class="c1"># saves the scan and match parts of paths for reference. mainly helpful</span>
</span><span id="CsvPath-214"><a href="#CsvPath-214"><span class="linenos"> 214</span></a>        <span class="c1"># for testing the CsvPath library itself; not used end users. the run</span>
</span><span id="CsvPath-215"><a href="#CsvPath-215"><span class="linenos"> 215</span></a>        <span class="c1"># name becomes the file name of the saved path parts.</span>
</span><span id="CsvPath-216"><a href="#CsvPath-216"><span class="linenos"> 216</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-217"><a href="#CsvPath-217"><span class="linenos"> 217</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_save_scan_dir</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPath-218"><a href="#CsvPath-218"><span class="linenos"> 218</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_save_match_dir</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPath-219"><a href="#CsvPath-219"><span class="linenos"> 219</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_run_name</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPath-220"><a href="#CsvPath-220"><span class="linenos"> 220</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-221"><a href="#CsvPath-221"><span class="linenos"> 221</span></a>        <span class="c1"># metadata is collected from &quot;outer&quot; csvpath comments. outer comments</span>
</span><span id="CsvPath-222"><a href="#CsvPath-222"><span class="linenos"> 222</span></a>        <span class="c1"># separate from the comments within the match part of the csvpath.</span>
</span><span id="CsvPath-223"><a href="#CsvPath-223"><span class="linenos"> 223</span></a>        <span class="c1"># the keys are words with colons. e.g. ~ name: my new csvpath ~</span>
</span><span id="CsvPath-224"><a href="#CsvPath-224"><span class="linenos"> 224</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-225"><a href="#CsvPath-225"><span class="linenos"> 225</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="CsvPath-226"><a href="#CsvPath-226"><span class="linenos"> 226</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-227"><a href="#CsvPath-227"><span class="linenos"> 227</span></a>        <span class="c1"># holds the current match count while we&#39;re in the middle of a match</span>
</span><span id="CsvPath-228"><a href="#CsvPath-228"><span class="linenos"> 228</span></a>        <span class="c1"># so that anyone who wants to can increase the match count using</span>
</span><span id="CsvPath-229"><a href="#CsvPath-229"><span class="linenos"> 229</span></a>        <span class="c1"># raise_match_count_if(). it is important to do the raise asap so that</span>
</span><span id="CsvPath-230"><a href="#CsvPath-230"><span class="linenos"> 230</span></a>        <span class="c1"># components that are onmatched have the right match count available.</span>
</span><span id="CsvPath-231"><a href="#CsvPath-231"><span class="linenos"> 231</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-232"><a href="#CsvPath-232"><span class="linenos"> 232</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_current_match_count</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="CsvPath-233"><a href="#CsvPath-233"><span class="linenos"> 233</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-234"><a href="#CsvPath-234"><span class="linenos"> 234</span></a>        <span class="c1"># printers receive print lines from the print function. the default</span>
</span><span id="CsvPath-235"><a href="#CsvPath-235"><span class="linenos"> 235</span></a>        <span class="c1"># printer prints to standard out. a CsvPath that is managed by a</span>
</span><span id="CsvPath-236"><a href="#CsvPath-236"><span class="linenos"> 236</span></a>        <span class="c1"># CsvPaths has its Results as a printer, as well as having</span>
</span><span id="CsvPath-237"><a href="#CsvPath-237"><span class="linenos"> 237</span></a>        <span class="c1"># the default printer.</span>
</span><span id="CsvPath-238"><a href="#CsvPath-238"><span class="linenos"> 238</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-239"><a href="#CsvPath-239"><span class="linenos"> 239</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">printers</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CsvPath-240"><a href="#CsvPath-240"><span class="linenos"> 240</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="CsvPath-241"><a href="#CsvPath-241"><span class="linenos"> 241</span></a>        <span class="k">if</span> <span class="n">print_default</span><span class="p">:</span>
</span><span id="CsvPath-242"><a href="#CsvPath-242"><span class="linenos"> 242</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">printers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StdOutPrinter</span><span class="p">())</span>
</span><span id="CsvPath-243"><a href="#CsvPath-243"><span class="linenos"> 243</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-244"><a href="#CsvPath-244"><span class="linenos"> 244</span></a>        <span class="c1"># _function_times_match collects the time a function spends doing its matches()</span>
</span><span id="CsvPath-245"><a href="#CsvPath-245"><span class="linenos"> 245</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-246"><a href="#CsvPath-246"><span class="linenos"> 246</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_function_times_match</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="CsvPath-247"><a href="#CsvPath-247"><span class="linenos"> 247</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-248"><a href="#CsvPath-248"><span class="linenos"> 248</span></a>        <span class="c1"># _function_times_value collects the time a function spends doing its to_value()</span>
</span><span id="CsvPath-249"><a href="#CsvPath-249"><span class="linenos"> 249</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-250"><a href="#CsvPath-250"><span class="linenos"> 250</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_function_times_value</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="CsvPath-251"><a href="#CsvPath-251"><span class="linenos"> 251</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_created_at</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
</span><span id="CsvPath-252"><a href="#CsvPath-252"><span class="linenos"> 252</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_run_started_at</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPath-253"><a href="#CsvPath-253"><span class="linenos"> 253</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_collecting</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CsvPath-254"><a href="#CsvPath-254"><span class="linenos"> 254</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-255"><a href="#CsvPath-255"><span class="linenos"> 255</span></a>        <span class="c1"># holds the unmatched lines when lines are being collected and</span>
</span><span id="CsvPath-256"><a href="#CsvPath-256"><span class="linenos"> 256</span></a>        <span class="c1"># _unmatched_available is True. it is analogous to the lines returned</span>
</span><span id="CsvPath-257"><a href="#CsvPath-257"><span class="linenos"> 257</span></a>        <span class="c1"># by collect(), but is the lines not returned by collect().</span>
</span><span id="CsvPath-258"><a href="#CsvPath-258"><span class="linenos"> 258</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-259"><a href="#CsvPath-259"><span class="linenos"> 259</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPath-260"><a href="#CsvPath-260"><span class="linenos"> 260</span></a>
</span><span id="CsvPath-261"><a href="#CsvPath-261"><span class="linenos"> 261</span></a>    <span class="c1">#</span>
</span><span id="CsvPath-262"><a href="#CsvPath-262"><span class="linenos"> 262</span></a>    <span class="c1"># this method saves and reloads the config. if you don&#39;t want that use</span>
</span><span id="CsvPath-263"><a href="#CsvPath-263"><span class="linenos"> 263</span></a>    <span class="c1"># CsvPath.config.save_to_config().</span>
</span><span id="CsvPath-264"><a href="#CsvPath-264"><span class="linenos"> 264</span></a>    <span class="c1">#</span>
</span><span id="CsvPath-265"><a href="#CsvPath-265"><span class="linenos"> 265</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">add_to_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">section</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-266"><a href="#CsvPath-266"><span class="linenos"> 266</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-267"><a href="#CsvPath-267"><span class="linenos"> 267</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">add_to_config</span><span class="p">(</span><span class="n">section</span><span class="o">=</span><span class="n">section</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>
</span><span id="CsvPath-268"><a href="#CsvPath-268"><span class="linenos"> 268</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">save_config</span><span class="p">()</span>
</span><span id="CsvPath-269"><a href="#CsvPath-269"><span class="linenos"> 269</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">reload</span><span class="p">()</span>
</span><span id="CsvPath-270"><a href="#CsvPath-270"><span class="linenos"> 270</span></a>
</span><span id="CsvPath-271"><a href="#CsvPath-271"><span class="linenos"> 271</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-272"><a href="#CsvPath-272"><span class="linenos"> 272</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">data_from_preceding</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="CsvPath-273"><a href="#CsvPath-273"><span class="linenos"> 273</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-274"><a href="#CsvPath-274"><span class="linenos"> 274</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">modes</span><span class="o">.</span><span class="n">source_mode</span><span class="o">.</span><span class="n">value</span>
</span><span id="CsvPath-275"><a href="#CsvPath-275"><span class="linenos"> 275</span></a>
</span><span id="CsvPath-276"><a href="#CsvPath-276"><span class="linenos"> 276</span></a>    <span class="nd">@data_from_preceding</span><span class="o">.</span><span class="n">setter</span>
</span><span id="CsvPath-277"><a href="#CsvPath-277"><span class="linenos"> 277</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">data_from_preceding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dfp</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-278"><a href="#CsvPath-278"><span class="linenos"> 278</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-279"><a href="#CsvPath-279"><span class="linenos"> 279</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">modes</span><span class="o">.</span><span class="n">source_mode</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">dfp</span>
</span><span id="CsvPath-280"><a href="#CsvPath-280"><span class="linenos"> 280</span></a>
</span><span id="CsvPath-281"><a href="#CsvPath-281"><span class="linenos"> 281</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-282"><a href="#CsvPath-282"><span class="linenos"> 282</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">unmatched</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">]]:</span>
</span><span id="CsvPath-283"><a href="#CsvPath-283"><span class="linenos"> 283</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-284"><a href="#CsvPath-284"><span class="linenos"> 284</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched</span>
</span><span id="CsvPath-285"><a href="#CsvPath-285"><span class="linenos"> 285</span></a>
</span><span id="CsvPath-286"><a href="#CsvPath-286"><span class="linenos"> 286</span></a>    <span class="nd">@unmatched</span><span class="o">.</span><span class="n">setter</span>
</span><span id="CsvPath-287"><a href="#CsvPath-287"><span class="linenos"> 287</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">unmatched</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lines</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-288"><a href="#CsvPath-288"><span class="linenos"> 288</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-289"><a href="#CsvPath-289"><span class="linenos"> 289</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched</span> <span class="o">=</span> <span class="n">lines</span>
</span><span id="CsvPath-290"><a href="#CsvPath-290"><span class="linenos"> 290</span></a>
</span><span id="CsvPath-291"><a href="#CsvPath-291"><span class="linenos"> 291</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-292"><a href="#CsvPath-292"><span class="linenos"> 292</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">collecting</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="CsvPath-293"><a href="#CsvPath-293"><span class="linenos"> 293</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-294"><a href="#CsvPath-294"><span class="linenos"> 294</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collecting</span>
</span><span id="CsvPath-295"><a href="#CsvPath-295"><span class="linenos"> 295</span></a>
</span><span id="CsvPath-296"><a href="#CsvPath-296"><span class="linenos"> 296</span></a>    <span class="nd">@collecting</span><span class="o">.</span><span class="n">setter</span>
</span><span id="CsvPath-297"><a href="#CsvPath-297"><span class="linenos"> 297</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">collecting</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-298"><a href="#CsvPath-298"><span class="linenos"> 298</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-299"><a href="#CsvPath-299"><span class="linenos"> 299</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_collecting</span> <span class="o">=</span> <span class="n">c</span>
</span><span id="CsvPath-300"><a href="#CsvPath-300"><span class="linenos"> 300</span></a>
</span><span id="CsvPath-301"><a href="#CsvPath-301"><span class="linenos"> 301</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-302"><a href="#CsvPath-302"><span class="linenos"> 302</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">unmatched_available</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="CsvPath-303"><a href="#CsvPath-303"><span class="linenos"> 303</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-304"><a href="#CsvPath-304"><span class="linenos"> 304</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">modes</span><span class="o">.</span><span class="n">unmatched_mode</span><span class="o">.</span><span class="n">value</span>
</span><span id="CsvPath-305"><a href="#CsvPath-305"><span class="linenos"> 305</span></a>
</span><span id="CsvPath-306"><a href="#CsvPath-306"><span class="linenos"> 306</span></a>    <span class="nd">@unmatched_available</span><span class="o">.</span><span class="n">setter</span>
</span><span id="CsvPath-307"><a href="#CsvPath-307"><span class="linenos"> 307</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">unmatched_available</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ua</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-308"><a href="#CsvPath-308"><span class="linenos"> 308</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-309"><a href="#CsvPath-309"><span class="linenos"> 309</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">modes</span><span class="o">.</span><span class="n">unmatched_mode</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">ua</span>
</span><span id="CsvPath-310"><a href="#CsvPath-310"><span class="linenos"> 310</span></a>
</span><span id="CsvPath-311"><a href="#CsvPath-311"><span class="linenos"> 311</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-312"><a href="#CsvPath-312"><span class="linenos"> 312</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">created_at</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datetime</span><span class="p">:</span>
</span><span id="CsvPath-313"><a href="#CsvPath-313"><span class="linenos"> 313</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-314"><a href="#CsvPath-314"><span class="linenos"> 314</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_created_at</span>
</span><span id="CsvPath-315"><a href="#CsvPath-315"><span class="linenos"> 315</span></a>
</span><span id="CsvPath-316"><a href="#CsvPath-316"><span class="linenos"> 316</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-317"><a href="#CsvPath-317"><span class="linenos"> 317</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">run_started_at</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datetime</span><span class="p">:</span>
</span><span id="CsvPath-318"><a href="#CsvPath-318"><span class="linenos"> 318</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-319"><a href="#CsvPath-319"><span class="linenos"> 319</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_started_at</span>
</span><span id="CsvPath-320"><a href="#CsvPath-320"><span class="linenos"> 320</span></a>
</span><span id="CsvPath-321"><a href="#CsvPath-321"><span class="linenos"> 321</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-322"><a href="#CsvPath-322"><span class="linenos"> 322</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">will_run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="CsvPath-323"><a href="#CsvPath-323"><span class="linenos"> 323</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-324"><a href="#CsvPath-324"><span class="linenos"> 324</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">modes</span><span class="o">.</span><span class="n">run_mode</span><span class="o">.</span><span class="n">value</span>
</span><span id="CsvPath-325"><a href="#CsvPath-325"><span class="linenos"> 325</span></a>
</span><span id="CsvPath-326"><a href="#CsvPath-326"><span class="linenos"> 326</span></a>    <span class="nd">@will_run</span><span class="o">.</span><span class="n">setter</span>
</span><span id="CsvPath-327"><a href="#CsvPath-327"><span class="linenos"> 327</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">will_run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-328"><a href="#CsvPath-328"><span class="linenos"> 328</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-329"><a href="#CsvPath-329"><span class="linenos"> 329</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">modes</span><span class="o">.</span><span class="n">run_mode</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">mode</span>
</span><span id="CsvPath-330"><a href="#CsvPath-330"><span class="linenos"> 330</span></a>
</span><span id="CsvPath-331"><a href="#CsvPath-331"><span class="linenos"> 331</span></a>    <span class="c1">#</span>
</span><span id="CsvPath-332"><a href="#CsvPath-332"><span class="linenos"> 332</span></a>    <span class="c1"># increases the total accumulated time spent doing c.matches() by t</span>
</span><span id="CsvPath-333"><a href="#CsvPath-333"><span class="linenos"> 333</span></a>    <span class="c1">#</span>
</span><span id="CsvPath-334"><a href="#CsvPath-334"><span class="linenos"> 334</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">up_function_time_match</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-335"><a href="#CsvPath-335"><span class="linenos"> 335</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-336"><a href="#CsvPath-336"><span class="linenos"> 336</span></a>        <span class="k">if</span> <span class="n">c</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">function_times_match</span><span class="p">:</span>
</span><span id="CsvPath-337"><a href="#CsvPath-337"><span class="linenos"> 337</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">function_times_match</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="CsvPath-338"><a href="#CsvPath-338"><span class="linenos"> 338</span></a>        <span class="n">st</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">function_times_match</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
</span><span id="CsvPath-339"><a href="#CsvPath-339"><span class="linenos"> 339</span></a>        <span class="n">st</span> <span class="o">+=</span> <span class="n">t</span>
</span><span id="CsvPath-340"><a href="#CsvPath-340"><span class="linenos"> 340</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">function_times_match</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">st</span>
</span><span id="CsvPath-341"><a href="#CsvPath-341"><span class="linenos"> 341</span></a>
</span><span id="CsvPath-342"><a href="#CsvPath-342"><span class="linenos"> 342</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-343"><a href="#CsvPath-343"><span class="linenos"> 343</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">function_times_match</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="CsvPath-344"><a href="#CsvPath-344"><span class="linenos"> 344</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-345"><a href="#CsvPath-345"><span class="linenos"> 345</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_function_times_match</span>
</span><span id="CsvPath-346"><a href="#CsvPath-346"><span class="linenos"> 346</span></a>
</span><span id="CsvPath-347"><a href="#CsvPath-347"><span class="linenos"> 347</span></a>    <span class="c1">#</span>
</span><span id="CsvPath-348"><a href="#CsvPath-348"><span class="linenos"> 348</span></a>    <span class="c1"># increases the total accumulated time spent doing c.to_value() by t</span>
</span><span id="CsvPath-349"><a href="#CsvPath-349"><span class="linenos"> 349</span></a>    <span class="c1">#</span>
</span><span id="CsvPath-350"><a href="#CsvPath-350"><span class="linenos"> 350</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">up_function_time_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-351"><a href="#CsvPath-351"><span class="linenos"> 351</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-352"><a href="#CsvPath-352"><span class="linenos"> 352</span></a>        <span class="k">if</span> <span class="n">c</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">function_times_value</span><span class="p">:</span>
</span><span id="CsvPath-353"><a href="#CsvPath-353"><span class="linenos"> 353</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">function_times_value</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="CsvPath-354"><a href="#CsvPath-354"><span class="linenos"> 354</span></a>        <span class="n">st</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">function_times_value</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
</span><span id="CsvPath-355"><a href="#CsvPath-355"><span class="linenos"> 355</span></a>        <span class="n">st</span> <span class="o">+=</span> <span class="n">t</span>
</span><span id="CsvPath-356"><a href="#CsvPath-356"><span class="linenos"> 356</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">function_times_value</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">st</span>
</span><span id="CsvPath-357"><a href="#CsvPath-357"><span class="linenos"> 357</span></a>
</span><span id="CsvPath-358"><a href="#CsvPath-358"><span class="linenos"> 358</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-359"><a href="#CsvPath-359"><span class="linenos"> 359</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">function_times_value</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="CsvPath-360"><a href="#CsvPath-360"><span class="linenos"> 360</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-361"><a href="#CsvPath-361"><span class="linenos"> 361</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_function_times_value</span>
</span><span id="CsvPath-362"><a href="#CsvPath-362"><span class="linenos"> 362</span></a>
</span><span id="CsvPath-363"><a href="#CsvPath-363"><span class="linenos"> 363</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">do_i_raise</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="CsvPath-364"><a href="#CsvPath-364"><span class="linenos"> 364</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-365"><a href="#CsvPath-365"><span class="linenos"> 365</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ecoms</span><span class="o">.</span><span class="n">do_i_raise</span><span class="p">()</span>
</span><span id="CsvPath-366"><a href="#CsvPath-366"><span class="linenos"> 366</span></a>
</span><span id="CsvPath-367"><a href="#CsvPath-367"><span class="linenos"> 367</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-368"><a href="#CsvPath-368"><span class="linenos"> 368</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">advance_count</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
</span><span id="CsvPath-369"><a href="#CsvPath-369"><span class="linenos"> 369</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-370"><a href="#CsvPath-370"><span class="linenos"> 370</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_advance</span>
</span><span id="CsvPath-371"><a href="#CsvPath-371"><span class="linenos"> 371</span></a>
</span><span id="CsvPath-372"><a href="#CsvPath-372"><span class="linenos"> 372</span></a>    <span class="nd">@advance_count</span><span class="o">.</span><span class="n">setter</span>
</span><span id="CsvPath-373"><a href="#CsvPath-373"><span class="linenos"> 373</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">advance_count</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lines</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-374"><a href="#CsvPath-374"><span class="linenos"> 374</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-375"><a href="#CsvPath-375"><span class="linenos"> 375</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_advance</span> <span class="o">=</span> <span class="n">lines</span>
</span><span id="CsvPath-376"><a href="#CsvPath-376"><span class="linenos"> 376</span></a>
</span><span id="CsvPath-377"><a href="#CsvPath-377"><span class="linenos"> 377</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-378"><a href="#CsvPath-378"><span class="linenos"> 378</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">headers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="CsvPath-379"><a href="#CsvPath-379"><span class="linenos"> 379</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-380"><a href="#CsvPath-380"><span class="linenos"> 380</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_headers</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-381"><a href="#CsvPath-381"><span class="linenos"> 381</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">get_total_lines_and_headers</span><span class="p">()</span>
</span><span id="CsvPath-382"><a href="#CsvPath-382"><span class="linenos"> 382</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_headers</span>
</span><span id="CsvPath-383"><a href="#CsvPath-383"><span class="linenos"> 383</span></a>
</span><span id="CsvPath-384"><a href="#CsvPath-384"><span class="linenos"> 384</span></a>    <span class="nd">@headers</span><span class="o">.</span><span class="n">setter</span>
</span><span id="CsvPath-385"><a href="#CsvPath-385"><span class="linenos"> 385</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">headers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">headers</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-386"><a href="#CsvPath-386"><span class="linenos"> 386</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-387"><a href="#CsvPath-387"><span class="linenos"> 387</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_headers</span> <span class="o">=</span> <span class="n">headers</span>
</span><span id="CsvPath-388"><a href="#CsvPath-388"><span class="linenos"> 388</span></a>
</span><span id="CsvPath-389"><a href="#CsvPath-389"><span class="linenos"> 389</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-390"><a href="#CsvPath-390"><span class="linenos"> 390</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">line_monitor</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LineMonitor</span><span class="p">:</span>
</span><span id="CsvPath-391"><a href="#CsvPath-391"><span class="linenos"> 391</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-392"><a href="#CsvPath-392"><span class="linenos"> 392</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_line_monitor</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-393"><a href="#CsvPath-393"><span class="linenos"> 393</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">get_total_lines_and_headers</span><span class="p">()</span>
</span><span id="CsvPath-394"><a href="#CsvPath-394"><span class="linenos"> 394</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_line_monitor</span>
</span><span id="CsvPath-395"><a href="#CsvPath-395"><span class="linenos"> 395</span></a>
</span><span id="CsvPath-396"><a href="#CsvPath-396"><span class="linenos"> 396</span></a>    <span class="nd">@line_monitor</span><span class="o">.</span><span class="n">setter</span>
</span><span id="CsvPath-397"><a href="#CsvPath-397"><span class="linenos"> 397</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">line_monitor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lm</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-398"><a href="#CsvPath-398"><span class="linenos"> 398</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-399"><a href="#CsvPath-399"><span class="linenos"> 399</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_line_monitor</span> <span class="o">=</span> <span class="n">lm</span>
</span><span id="CsvPath-400"><a href="#CsvPath-400"><span class="linenos"> 400</span></a>
</span><span id="CsvPath-401"><a href="#CsvPath-401"><span class="linenos"> 401</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-402"><a href="#CsvPath-402"><span class="linenos"> 402</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">AND</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>  <span class="c1"># pylint: disable=C0103</span>
</span><span id="CsvPath-403"><a href="#CsvPath-403"><span class="linenos"> 403</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">modes</span><span class="o">.</span><span class="n">logic_mode</span><span class="o">.</span><span class="n">value</span>
</span><span id="CsvPath-404"><a href="#CsvPath-404"><span class="linenos"> 404</span></a>
</span><span id="CsvPath-405"><a href="#CsvPath-405"><span class="linenos"> 405</span></a>    <span class="nd">@AND</span><span class="o">.</span><span class="n">setter</span>
</span><span id="CsvPath-406"><a href="#CsvPath-406"><span class="linenos"> 406</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">AND</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>  <span class="c1"># pylint: disable=C0103</span>
</span><span id="CsvPath-407"><a href="#CsvPath-407"><span class="linenos"> 407</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">modes</span><span class="o">.</span><span class="n">logic_mode</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">a</span>
</span><span id="CsvPath-408"><a href="#CsvPath-408"><span class="linenos"> 408</span></a>
</span><span id="CsvPath-409"><a href="#CsvPath-409"><span class="linenos"> 409</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-410"><a href="#CsvPath-410"><span class="linenos"> 410</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">OR</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>  <span class="c1"># pylint: disable=C0103</span>
</span><span id="CsvPath-411"><a href="#CsvPath-411"><span class="linenos"> 411</span></a>        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">modes</span><span class="o">.</span><span class="n">logic_mode</span><span class="o">.</span><span class="n">value</span>
</span><span id="CsvPath-412"><a href="#CsvPath-412"><span class="linenos"> 412</span></a>
</span><span id="CsvPath-413"><a href="#CsvPath-413"><span class="linenos"> 413</span></a>    <span class="nd">@OR</span><span class="o">.</span><span class="n">setter</span>
</span><span id="CsvPath-414"><a href="#CsvPath-414"><span class="linenos"> 414</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">OR</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>  <span class="c1"># pylint: disable=C0103</span>
</span><span id="CsvPath-415"><a href="#CsvPath-415"><span class="linenos"> 415</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">modes</span><span class="o">.</span><span class="n">logic_mode</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">a</span>
</span><span id="CsvPath-416"><a href="#CsvPath-416"><span class="linenos"> 416</span></a>
</span><span id="CsvPath-417"><a href="#CsvPath-417"><span class="linenos"> 417</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-418"><a href="#CsvPath-418"><span class="linenos"> 418</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">identity</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="CsvPath-419"><a href="#CsvPath-419"><span class="linenos"> 419</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;returns id or name if found in metadata.</span>
</span><span id="CsvPath-420"><a href="#CsvPath-420"><span class="linenos"> 420</span></a>
</span><span id="CsvPath-421"><a href="#CsvPath-421"><span class="linenos"> 421</span></a><span class="sd">        the id or name gets into metadata primarily if found</span>
</span><span id="CsvPath-422"><a href="#CsvPath-422"><span class="linenos"> 422</span></a><span class="sd">        in an &quot;external&quot; comment in the csvpath. &quot;external&quot;</span>
</span><span id="CsvPath-423"><a href="#CsvPath-423"><span class="linenos"> 423</span></a><span class="sd">        meaning outside the []s. comments are keyword:comment.</span>
</span><span id="CsvPath-424"><a href="#CsvPath-424"><span class="linenos"> 424</span></a><span class="sd">        we take id, Id, ID and name, Name, NAME.</span>
</span><span id="CsvPath-425"><a href="#CsvPath-425"><span class="linenos"> 425</span></a>
</span><span id="CsvPath-426"><a href="#CsvPath-426"><span class="linenos"> 426</span></a><span class="sd">        id is preferred over name. E.g. in:</span>
</span><span id="CsvPath-427"><a href="#CsvPath-427"><span class="linenos"> 427</span></a><span class="sd">        ~ name: my path description: an example id: this value wins ~</span>
</span><span id="CsvPath-428"><a href="#CsvPath-428"><span class="linenos"> 428</span></a><span class="sd">        the id becomes the identity of the instance.</span>
</span><span id="CsvPath-429"><a href="#CsvPath-429"><span class="linenos"> 429</span></a>
</span><span id="CsvPath-430"><a href="#CsvPath-430"><span class="linenos"> 430</span></a><span class="sd">        we prefer in this order: all-lower most, Initial-caps,</span>
</span><span id="CsvPath-431"><a href="#CsvPath-431"><span class="linenos"> 431</span></a><span class="sd">        ALL-CAPS least</span>
</span><span id="CsvPath-432"><a href="#CsvPath-432"><span class="linenos"> 432</span></a>
</span><span id="CsvPath-433"><a href="#CsvPath-433"><span class="linenos"> 433</span></a><span class="sd">        the ordering is relied on in Result and possibly</span>
</span><span id="CsvPath-434"><a href="#CsvPath-434"><span class="linenos"> 434</span></a><span class="sd">        elsewhere.</span>
</span><span id="CsvPath-435"><a href="#CsvPath-435"><span class="linenos"> 435</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CsvPath-436"><a href="#CsvPath-436"><span class="linenos"> 436</span></a>        <span class="n">ret</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPath-437"><a href="#CsvPath-437"><span class="linenos"> 437</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">:</span>
</span><span id="CsvPath-438"><a href="#CsvPath-438"><span class="linenos"> 438</span></a>            <span class="n">ret</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="CsvPath-439"><a href="#CsvPath-439"><span class="linenos"> 439</span></a>        <span class="k">if</span> <span class="s2">&quot;NAME&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">:</span>
</span><span id="CsvPath-440"><a href="#CsvPath-440"><span class="linenos"> 440</span></a>            <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;NAME&quot;</span><span class="p">]</span>
</span><span id="CsvPath-441"><a href="#CsvPath-441"><span class="linenos"> 441</span></a>        <span class="k">if</span> <span class="s2">&quot;Name&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">:</span>
</span><span id="CsvPath-442"><a href="#CsvPath-442"><span class="linenos"> 442</span></a>            <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]</span>
</span><span id="CsvPath-443"><a href="#CsvPath-443"><span class="linenos"> 443</span></a>        <span class="k">if</span> <span class="s2">&quot;name&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">:</span>
</span><span id="CsvPath-444"><a href="#CsvPath-444"><span class="linenos"> 444</span></a>            <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
</span><span id="CsvPath-445"><a href="#CsvPath-445"><span class="linenos"> 445</span></a>        <span class="k">if</span> <span class="s2">&quot;ID&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">:</span>
</span><span id="CsvPath-446"><a href="#CsvPath-446"><span class="linenos"> 446</span></a>            <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;ID&quot;</span><span class="p">]</span>
</span><span id="CsvPath-447"><a href="#CsvPath-447"><span class="linenos"> 447</span></a>        <span class="k">if</span> <span class="s2">&quot;Id&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">:</span>
</span><span id="CsvPath-448"><a href="#CsvPath-448"><span class="linenos"> 448</span></a>            <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;Id&quot;</span><span class="p">]</span>
</span><span id="CsvPath-449"><a href="#CsvPath-449"><span class="linenos"> 449</span></a>        <span class="k">if</span> <span class="s2">&quot;id&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">:</span>
</span><span id="CsvPath-450"><a href="#CsvPath-450"><span class="linenos"> 450</span></a>            <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
</span><span id="CsvPath-451"><a href="#CsvPath-451"><span class="linenos"> 451</span></a>        <span class="k">return</span> <span class="n">ret</span>
</span><span id="CsvPath-452"><a href="#CsvPath-452"><span class="linenos"> 452</span></a>
</span><span id="CsvPath-453"><a href="#CsvPath-453"><span class="linenos"> 453</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-454"><a href="#CsvPath-454"><span class="linenos"> 454</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Config</span><span class="p">:</span>  <span class="c1"># pylint: disable=C0116</span>
</span><span id="CsvPath-455"><a href="#CsvPath-455"><span class="linenos"> 455</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-456"><a href="#CsvPath-456"><span class="linenos"> 456</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">:</span>
</span><span id="CsvPath-457"><a href="#CsvPath-457"><span class="linenos"> 457</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">()</span>
</span><span id="CsvPath-458"><a href="#CsvPath-458"><span class="linenos"> 458</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config</span>
</span><span id="CsvPath-459"><a href="#CsvPath-459"><span class="linenos"> 459</span></a>
</span><span id="CsvPath-460"><a href="#CsvPath-460"><span class="linenos"> 460</span></a>    <span class="c1"># ==========================</span>
</span><span id="CsvPath-461"><a href="#CsvPath-461"><span class="linenos"> 461</span></a>    <span class="c1"># Errors</span>
</span><span id="CsvPath-462"><a href="#CsvPath-462"><span class="linenos"> 462</span></a>    <span class="c1"># &lt;thinking&gt; if we have a csvpaths people should look at the result to find errors</span>
</span><span id="CsvPath-463"><a href="#CsvPath-463"><span class="linenos"> 463</span></a>    <span class="c1"># but we give access to metadata, vars, etc. from the csvpath, so we should</span>
</span><span id="CsvPath-464"><a href="#CsvPath-464"><span class="linenos"> 464</span></a>    <span class="c1"># give errors too. that means we need to have our own listener. ultimately we&#39;d</span>
</span><span id="CsvPath-465"><a href="#CsvPath-465"><span class="linenos"> 465</span></a>    <span class="c1"># just be adding pointers, not dup the original error data.</span>
</span><span id="CsvPath-466"><a href="#CsvPath-466"><span class="linenos"> 466</span></a>    <span class="c1">#</span>
</span><span id="CsvPath-467"><a href="#CsvPath-467"><span class="linenos"> 467</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">metadata_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mdata</span><span class="p">:</span> <span class="n">Metadata</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-468"><a href="#CsvPath-468"><span class="linenos"> 468</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-469"><a href="#CsvPath-469"><span class="linenos"> 469</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mdata</span><span class="p">,</span> <span class="n">Error</span><span class="p">):</span>
</span><span id="CsvPath-470"><a href="#CsvPath-470"><span class="linenos"> 470</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">collect_error</span><span class="p">(</span><span class="n">mdata</span><span class="p">)</span>
</span><span id="CsvPath-471"><a href="#CsvPath-471"><span class="linenos"> 471</span></a>
</span><span id="CsvPath-472"><a href="#CsvPath-472"><span class="linenos"> 472</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-473"><a href="#CsvPath-473"><span class="linenos"> 473</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">errors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Error</span><span class="p">]:</span>  <span class="c1"># pylint: disable=C0116</span>
</span><span id="CsvPath-474"><a href="#CsvPath-474"><span class="linenos"> 474</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span>
</span><span id="CsvPath-475"><a href="#CsvPath-475"><span class="linenos"> 475</span></a>
</span><span id="CsvPath-476"><a href="#CsvPath-476"><span class="linenos"> 476</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-477"><a href="#CsvPath-477"><span class="linenos"> 477</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">errors_count</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>  <span class="c1"># pylint: disable=C0116</span>
</span><span id="CsvPath-478"><a href="#CsvPath-478"><span class="linenos"> 478</span></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">)</span>
</span><span id="CsvPath-479"><a href="#CsvPath-479"><span class="linenos"> 479</span></a>
</span><span id="CsvPath-480"><a href="#CsvPath-480"><span class="linenos"> 480</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">collect_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">error</span><span class="p">:</span> <span class="n">Error</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pylint: disable=C0116</span>
</span><span id="CsvPath-481"><a href="#CsvPath-481"><span class="linenos"> 481</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-482"><a href="#CsvPath-482"><span class="linenos"> 482</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
</span><span id="CsvPath-483"><a href="#CsvPath-483"><span class="linenos"> 483</span></a>
</span><span id="CsvPath-484"><a href="#CsvPath-484"><span class="linenos"> 484</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">has_errors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="CsvPath-485"><a href="#CsvPath-485"><span class="linenos"> 485</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">errors_count</span> <span class="o">&gt;</span> <span class="mi">0</span>
</span><span id="CsvPath-486"><a href="#CsvPath-486"><span class="linenos"> 486</span></a>
</span><span id="CsvPath-487"><a href="#CsvPath-487"><span class="linenos"> 487</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-488"><a href="#CsvPath-488"><span class="linenos"> 488</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">stop_on_validation_errors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="CsvPath-489"><a href="#CsvPath-489"><span class="linenos"> 489</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-490"><a href="#CsvPath-490"><span class="linenos"> 490</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">modes</span><span class="o">.</span><span class="n">validation_mode</span><span class="o">.</span><span class="n">stop_on_validation_errors</span>
</span><span id="CsvPath-491"><a href="#CsvPath-491"><span class="linenos"> 491</span></a>
</span><span id="CsvPath-492"><a href="#CsvPath-492"><span class="linenos"> 492</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-493"><a href="#CsvPath-493"><span class="linenos"> 493</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fail_on_validation_errors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="CsvPath-494"><a href="#CsvPath-494"><span class="linenos"> 494</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-495"><a href="#CsvPath-495"><span class="linenos"> 495</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">modes</span><span class="o">.</span><span class="n">validation_mode</span><span class="o">.</span><span class="n">fail_on_validation_errors</span>
</span><span id="CsvPath-496"><a href="#CsvPath-496"><span class="linenos"> 496</span></a>
</span><span id="CsvPath-497"><a href="#CsvPath-497"><span class="linenos"> 497</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-498"><a href="#CsvPath-498"><span class="linenos"> 498</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">print_validation_errors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="CsvPath-499"><a href="#CsvPath-499"><span class="linenos"> 499</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-500"><a href="#CsvPath-500"><span class="linenos"> 500</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">modes</span><span class="o">.</span><span class="n">validation_mode</span><span class="o">.</span><span class="n">print_validation_errors</span>
</span><span id="CsvPath-501"><a href="#CsvPath-501"><span class="linenos"> 501</span></a>
</span><span id="CsvPath-502"><a href="#CsvPath-502"><span class="linenos"> 502</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-503"><a href="#CsvPath-503"><span class="linenos"> 503</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">log_validation_errors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="CsvPath-504"><a href="#CsvPath-504"><span class="linenos"> 504</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-505"><a href="#CsvPath-505"><span class="linenos"> 505</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">modes</span><span class="o">.</span><span class="n">validation_mode</span><span class="o">.</span><span class="n">log_validation_errors</span>
</span><span id="CsvPath-506"><a href="#CsvPath-506"><span class="linenos"> 506</span></a>
</span><span id="CsvPath-507"><a href="#CsvPath-507"><span class="linenos"> 507</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-508"><a href="#CsvPath-508"><span class="linenos"> 508</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">raise_validation_errors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="CsvPath-509"><a href="#CsvPath-509"><span class="linenos"> 509</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-510"><a href="#CsvPath-510"><span class="linenos"> 510</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">modes</span><span class="o">.</span><span class="n">validation_mode</span><span class="o">.</span><span class="n">raise_validation_errors</span>
</span><span id="CsvPath-511"><a href="#CsvPath-511"><span class="linenos"> 511</span></a>
</span><span id="CsvPath-512"><a href="#CsvPath-512"><span class="linenos"> 512</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-513"><a href="#CsvPath-513"><span class="linenos"> 513</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">match_validation_errors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="CsvPath-514"><a href="#CsvPath-514"><span class="linenos"> 514</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-515"><a href="#CsvPath-515"><span class="linenos"> 515</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">modes</span><span class="o">.</span><span class="n">validation_mode</span><span class="o">.</span><span class="n">match_validation_errors</span>
</span><span id="CsvPath-516"><a href="#CsvPath-516"><span class="linenos"> 516</span></a>
</span><span id="CsvPath-517"><a href="#CsvPath-517"><span class="linenos"> 517</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-518"><a href="#CsvPath-518"><span class="linenos"> 518</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">collect_validation_errors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="CsvPath-519"><a href="#CsvPath-519"><span class="linenos"> 519</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-520"><a href="#CsvPath-520"><span class="linenos"> 520</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">modes</span><span class="o">.</span><span class="n">validation_mode</span><span class="o">.</span><span class="n">collect_validation_errors</span>
</span><span id="CsvPath-521"><a href="#CsvPath-521"><span class="linenos"> 521</span></a>
</span><span id="CsvPath-522"><a href="#CsvPath-522"><span class="linenos"> 522</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">add_printer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">printer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pylint: disable=C0116</span>
</span><span id="CsvPath-523"><a href="#CsvPath-523"><span class="linenos"> 523</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-524"><a href="#CsvPath-524"><span class="linenos"> 524</span></a>        <span class="k">if</span> <span class="n">printer</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">printers</span><span class="p">:</span>
</span><span id="CsvPath-525"><a href="#CsvPath-525"><span class="linenos"> 525</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">printers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">printer</span><span class="p">)</span>
</span><span id="CsvPath-526"><a href="#CsvPath-526"><span class="linenos"> 526</span></a>
</span><span id="CsvPath-527"><a href="#CsvPath-527"><span class="linenos"> 527</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_printers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">printers</span><span class="p">:</span> <span class="n">List</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pylint: disable=C0116</span>
</span><span id="CsvPath-528"><a href="#CsvPath-528"><span class="linenos"> 528</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-529"><a href="#CsvPath-529"><span class="linenos"> 529</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">printers</span> <span class="o">=</span> <span class="n">printers</span>
</span><span id="CsvPath-530"><a href="#CsvPath-530"><span class="linenos"> 530</span></a>
</span><span id="CsvPath-531"><a href="#CsvPath-531"><span class="linenos"> 531</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-532"><a href="#CsvPath-532"><span class="linenos"> 532</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">has_default_printer</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="CsvPath-533"><a href="#CsvPath-533"><span class="linenos"> 533</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-534"><a href="#CsvPath-534"><span class="linenos"> 534</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">printers</span><span class="p">:</span>
</span><span id="CsvPath-535"><a href="#CsvPath-535"><span class="linenos"> 535</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">printers</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CsvPath-536"><a href="#CsvPath-536"><span class="linenos"> 536</span></a>        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">printers</span><span class="p">:</span>
</span><span id="CsvPath-537"><a href="#CsvPath-537"><span class="linenos"> 537</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">StdOutPrinter</span><span class="p">):</span>
</span><span id="CsvPath-538"><a href="#CsvPath-538"><span class="linenos"> 538</span></a>                <span class="k">return</span> <span class="kc">True</span>
</span><span id="CsvPath-539"><a href="#CsvPath-539"><span class="linenos"> 539</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="CsvPath-540"><a href="#CsvPath-540"><span class="linenos"> 540</span></a>
</span><span id="CsvPath-541"><a href="#CsvPath-541"><span class="linenos"> 541</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">print</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">string</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pylint: disable=C0116</span>
</span><span id="CsvPath-542"><a href="#CsvPath-542"><span class="linenos"> 542</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-543"><a href="#CsvPath-543"><span class="linenos"> 543</span></a>        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">printers</span><span class="p">:</span>
</span><span id="CsvPath-544"><a href="#CsvPath-544"><span class="linenos"> 544</span></a>            <span class="n">p</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
</span><span id="CsvPath-545"><a href="#CsvPath-545"><span class="linenos"> 545</span></a>
</span><span id="CsvPath-546"><a href="#CsvPath-546"><span class="linenos"> 546</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">print_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">string</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-547"><a href="#CsvPath-547"><span class="linenos"> 547</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-548"><a href="#CsvPath-548"><span class="linenos"> 548</span></a>        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">printers</span><span class="p">:</span>
</span><span id="CsvPath-549"><a href="#CsvPath-549"><span class="linenos"> 549</span></a>            <span class="n">p</span><span class="o">.</span><span class="n">print_to</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">string</span><span class="p">)</span>
</span><span id="CsvPath-550"><a href="#CsvPath-550"><span class="linenos"> 550</span></a>
</span><span id="CsvPath-551"><a href="#CsvPath-551"><span class="linenos"> 551</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-552"><a href="#CsvPath-552"><span class="linenos"> 552</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">last_line</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="CsvPath-553"><a href="#CsvPath-553"><span class="linenos"> 553</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private</span>
</span><span id="CsvPath-554"><a href="#CsvPath-554"><span class="linenos"> 554</span></a><span class="sd">        this method only returns the default printer&#39;s last_line&quot;&quot;&quot;</span>
</span><span id="CsvPath-555"><a href="#CsvPath-555"><span class="linenos"> 555</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">printers</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">printers</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CsvPath-556"><a href="#CsvPath-556"><span class="linenos"> 556</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="CsvPath-557"><a href="#CsvPath-557"><span class="linenos"> 557</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">printers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">last_line</span>
</span><span id="CsvPath-558"><a href="#CsvPath-558"><span class="linenos"> 558</span></a>
</span><span id="CsvPath-559"><a href="#CsvPath-559"><span class="linenos"> 559</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-560"><a href="#CsvPath-560"><span class="linenos"> 560</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">lines_printed</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="CsvPath-561"><a href="#CsvPath-561"><span class="linenos"> 561</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private</span>
</span><span id="CsvPath-562"><a href="#CsvPath-562"><span class="linenos"> 562</span></a><span class="sd">        this method only returns the default printer&#39;s lines printed&quot;&quot;&quot;</span>
</span><span id="CsvPath-563"><a href="#CsvPath-563"><span class="linenos"> 563</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">printers</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">printers</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CsvPath-564"><a href="#CsvPath-564"><span class="linenos"> 564</span></a>            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="CsvPath-565"><a href="#CsvPath-565"><span class="linenos"> 565</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">printers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lines_printed</span>
</span><span id="CsvPath-566"><a href="#CsvPath-566"><span class="linenos"> 566</span></a>
</span><span id="CsvPath-567"><a href="#CsvPath-567"><span class="linenos"> 567</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-568"><a href="#CsvPath-568"><span class="linenos"> 568</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_frozen</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="CsvPath-569"><a href="#CsvPath-569"><span class="linenos"> 569</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private</span>
</span><span id="CsvPath-570"><a href="#CsvPath-570"><span class="linenos"> 570</span></a><span class="sd">        True if the instance is matching on its last row only to</span>
</span><span id="CsvPath-571"><a href="#CsvPath-571"><span class="linenos"> 571</span></a><span class="sd">        allow last()s to run; in which case, no variable updates</span>
</span><span id="CsvPath-572"><a href="#CsvPath-572"><span class="linenos"> 572</span></a><span class="sd">        are allowed, along with other limitations.&quot;&quot;&quot;</span>
</span><span id="CsvPath-573"><a href="#CsvPath-573"><span class="linenos"> 573</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_freeze_path</span>
</span><span id="CsvPath-574"><a href="#CsvPath-574"><span class="linenos"> 574</span></a>
</span><span id="CsvPath-575"><a href="#CsvPath-575"><span class="linenos"> 575</span></a>    <span class="nd">@is_frozen</span><span class="o">.</span><span class="n">setter</span>
</span><span id="CsvPath-576"><a href="#CsvPath-576"><span class="linenos"> 576</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_frozen</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">freeze</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-577"><a href="#CsvPath-577"><span class="linenos"> 577</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-578"><a href="#CsvPath-578"><span class="linenos"> 578</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_freeze_path</span> <span class="o">=</span> <span class="n">freeze</span>
</span><span id="CsvPath-579"><a href="#CsvPath-579"><span class="linenos"> 579</span></a>
</span><span id="CsvPath-580"><a href="#CsvPath-580"><span class="linenos"> 580</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-581"><a href="#CsvPath-581"><span class="linenos"> 581</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">explain</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="CsvPath-582"><a href="#CsvPath-582"><span class="linenos"> 582</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private</span>
</span><span id="CsvPath-583"><a href="#CsvPath-583"><span class="linenos"> 583</span></a><span class="sd">        when this property is True CsvPath dumps a match explaination</span>
</span><span id="CsvPath-584"><a href="#CsvPath-584"><span class="linenos"> 584</span></a><span class="sd">        to INFO. this can be expensive. a 25% performance hit wouldn&#39;t</span>
</span><span id="CsvPath-585"><a href="#CsvPath-585"><span class="linenos"> 585</span></a><span class="sd">        be unexpected.</span>
</span><span id="CsvPath-586"><a href="#CsvPath-586"><span class="linenos"> 586</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CsvPath-587"><a href="#CsvPath-587"><span class="linenos"> 587</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">modes</span><span class="o">.</span><span class="n">explain_mode</span><span class="o">.</span><span class="n">value</span>
</span><span id="CsvPath-588"><a href="#CsvPath-588"><span class="linenos"> 588</span></a>
</span><span id="CsvPath-589"><a href="#CsvPath-589"><span class="linenos"> 589</span></a>    <span class="nd">@explain</span><span class="o">.</span><span class="n">setter</span>
</span><span id="CsvPath-590"><a href="#CsvPath-590"><span class="linenos"> 590</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">explain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">yesno</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-591"><a href="#CsvPath-591"><span class="linenos"> 591</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-592"><a href="#CsvPath-592"><span class="linenos"> 592</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">modes</span><span class="o">.</span><span class="n">explain_mode</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">yesno</span>
</span><span id="CsvPath-593"><a href="#CsvPath-593"><span class="linenos"> 593</span></a>
</span><span id="CsvPath-594"><a href="#CsvPath-594"><span class="linenos"> 594</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-595"><a href="#CsvPath-595"><span class="linenos"> 595</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">collect_when_not_matched</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="CsvPath-596"><a href="#CsvPath-596"><span class="linenos"> 596</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private</span>
</span><span id="CsvPath-597"><a href="#CsvPath-597"><span class="linenos"> 597</span></a><span class="sd">        when this property is True CsvPath returns the lines that do not</span>
</span><span id="CsvPath-598"><a href="#CsvPath-598"><span class="linenos"> 598</span></a><span class="sd">        match the matchers match components&quot;&quot;&quot;</span>
</span><span id="CsvPath-599"><a href="#CsvPath-599"><span class="linenos"> 599</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">modes</span><span class="o">.</span><span class="n">return_mode</span><span class="o">.</span><span class="n">collect_when_not_matched</span>
</span><span id="CsvPath-600"><a href="#CsvPath-600"><span class="linenos"> 600</span></a>
</span><span id="CsvPath-601"><a href="#CsvPath-601"><span class="linenos"> 601</span></a>    <span class="nd">@collect_when_not_matched</span><span class="o">.</span><span class="n">setter</span>
</span><span id="CsvPath-602"><a href="#CsvPath-602"><span class="linenos"> 602</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">collect_when_not_matched</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">yesno</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-603"><a href="#CsvPath-603"><span class="linenos"> 603</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private</span>
</span><span id="CsvPath-604"><a href="#CsvPath-604"><span class="linenos"> 604</span></a><span class="sd">        when c ollect_when_not_matched is True we return the lines that failed</span>
</span><span id="CsvPath-605"><a href="#CsvPath-605"><span class="linenos"> 605</span></a><span class="sd">        to match, rather than the default behavior of returning the matches.</span>
</span><span id="CsvPath-606"><a href="#CsvPath-606"><span class="linenos"> 606</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CsvPath-607"><a href="#CsvPath-607"><span class="linenos"> 607</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">modes</span><span class="o">.</span><span class="n">return_mode</span><span class="o">.</span><span class="n">collect_when_not_matched</span> <span class="o">=</span> <span class="n">yesno</span>
</span><span id="CsvPath-608"><a href="#CsvPath-608"><span class="linenos"> 608</span></a>
</span><span id="CsvPath-609"><a href="#CsvPath-609"><span class="linenos"> 609</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">csvpath</span><span class="p">,</span> <span class="n">disposably</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="CsvPath-610"><a href="#CsvPath-610"><span class="linenos"> 610</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private</span>
</span><span id="CsvPath-611"><a href="#CsvPath-611"><span class="linenos"> 611</span></a><span class="sd">        displosably is True when a Matcher is needed for some purpose other than</span>
</span><span id="CsvPath-612"><a href="#CsvPath-612"><span class="linenos"> 612</span></a><span class="sd">        the run we were created to do. could be that a match component wanted a</span>
</span><span id="CsvPath-613"><a href="#CsvPath-613"><span class="linenos"> 613</span></a><span class="sd">        parsed csvpath for its own purposes. when True, we create and return the</span>
</span><span id="CsvPath-614"><a href="#CsvPath-614"><span class="linenos"> 614</span></a><span class="sd">        Matcher, but then forget it ever existed.</span>
</span><span id="CsvPath-615"><a href="#CsvPath-615"><span class="linenos"> 615</span></a>
</span><span id="CsvPath-616"><a href="#CsvPath-616"><span class="linenos"> 616</span></a><span class="sd">        when disposably is False we build the scanner and return that</span>
</span><span id="CsvPath-617"><a href="#CsvPath-617"><span class="linenos"> 617</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CsvPath-618"><a href="#CsvPath-618"><span class="linenos"> 618</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-619"><a href="#CsvPath-619"><span class="linenos"> 619</span></a>        <span class="c1"># strip off any comments and collect any metadata</span>
</span><span id="CsvPath-620"><a href="#CsvPath-620"><span class="linenos"> 620</span></a>        <span class="c1"># CsvPaths will do this earlier but it stripped off</span>
</span><span id="CsvPath-621"><a href="#CsvPath-621"><span class="linenos"> 621</span></a>        <span class="c1"># the comments so we won&#39;t find them again</span>
</span><span id="CsvPath-622"><a href="#CsvPath-622"><span class="linenos"> 622</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-623"><a href="#CsvPath-623"><span class="linenos"> 623</span></a>        <span class="n">csvpath</span> <span class="o">=</span> <span class="n">MetadataParser</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">extract_metadata</span><span class="p">(</span><span class="n">instance</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">csvpath</span><span class="o">=</span><span class="n">csvpath</span><span class="p">)</span>
</span><span id="CsvPath-624"><a href="#CsvPath-624"><span class="linenos"> 624</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_settings_from_metadata</span><span class="p">()</span>
</span><span id="CsvPath-625"><a href="#CsvPath-625"><span class="linenos"> 625</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-626"><a href="#CsvPath-626"><span class="linenos"> 626</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-627"><a href="#CsvPath-627"><span class="linenos"> 627</span></a>        <span class="c1"># exp!</span>
</span><span id="CsvPath-628"><a href="#CsvPath-628"><span class="linenos"> 628</span></a>        <span class="k">if</span> <span class="n">disposably</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="CsvPath-629"><a href="#CsvPath-629"><span class="linenos"> 629</span></a>            <span class="n">csvpath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_file_path</span><span class="p">(</span><span class="n">csvpath</span><span class="p">)</span>
</span><span id="CsvPath-630"><a href="#CsvPath-630"><span class="linenos"> 630</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-631"><a href="#CsvPath-631"><span class="linenos"> 631</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-632"><a href="#CsvPath-632"><span class="linenos"> 632</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-633"><a href="#CsvPath-633"><span class="linenos"> 633</span></a>        <span class="n">s</span><span class="p">,</span> <span class="n">mat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_scan_and_match_parts</span><span class="p">(</span><span class="n">csvpath</span><span class="p">)</span>
</span><span id="CsvPath-634"><a href="#CsvPath-634"><span class="linenos"> 634</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-635"><a href="#CsvPath-635"><span class="linenos"> 635</span></a>        <span class="c1"># a disposable matcher still needs the match part</span>
</span><span id="CsvPath-636"><a href="#CsvPath-636"><span class="linenos"> 636</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-637"><a href="#CsvPath-637"><span class="linenos"> 637</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">match</span> <span class="o">=</span> <span class="n">mat</span>
</span><span id="CsvPath-638"><a href="#CsvPath-638"><span class="linenos"> 638</span></a>        <span class="k">if</span> <span class="n">disposably</span><span class="p">:</span>
</span><span id="CsvPath-639"><a href="#CsvPath-639"><span class="linenos"> 639</span></a>            <span class="k">pass</span>
</span><span id="CsvPath-640"><a href="#CsvPath-640"><span class="linenos"> 640</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="CsvPath-641"><a href="#CsvPath-641"><span class="linenos"> 641</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scan</span> <span class="o">=</span> <span class="n">s</span>
</span><span id="CsvPath-642"><a href="#CsvPath-642"><span class="linenos"> 642</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scanner</span> <span class="o">=</span> <span class="n">Scanner</span><span class="p">(</span><span class="n">csvpath</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="CsvPath-643"><a href="#CsvPath-643"><span class="linenos"> 643</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scanner</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="CsvPath-644"><a href="#CsvPath-644"><span class="linenos"> 644</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-645"><a href="#CsvPath-645"><span class="linenos"> 645</span></a>        <span class="c1"># we build a matcher to see if it builds without error.</span>
</span><span id="CsvPath-646"><a href="#CsvPath-646"><span class="linenos"> 646</span></a>        <span class="c1"># in principle we could keep this as the actual matcher.</span>
</span><span id="CsvPath-647"><a href="#CsvPath-647"><span class="linenos"> 647</span></a>        <span class="c1"># atm, tho, just create a dry-run copy. in some possible</span>
</span><span id="CsvPath-648"><a href="#CsvPath-648"><span class="linenos"> 648</span></a>        <span class="c1"># unit tests we may not have a parsable match part.</span>
</span><span id="CsvPath-649"><a href="#CsvPath-649"><span class="linenos"> 649</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-650"><a href="#CsvPath-650"><span class="linenos"> 650</span></a>        <span class="k">if</span> <span class="n">disposably</span><span class="p">:</span>
</span><span id="CsvPath-651"><a href="#CsvPath-651"><span class="linenos"> 651</span></a>            <span class="n">matcher</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPath-652"><a href="#CsvPath-652"><span class="linenos"> 652</span></a>            <span class="k">if</span> <span class="n">mat</span><span class="p">:</span>
</span><span id="CsvPath-653"><a href="#CsvPath-653"><span class="linenos"> 653</span></a>                <span class="n">matcher</span> <span class="o">=</span> <span class="n">Matcher</span><span class="p">(</span><span class="n">csvpath</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">mat</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</span><span id="CsvPath-654"><a href="#CsvPath-654"><span class="linenos"> 654</span></a>            <span class="c1">#</span>
</span><span id="CsvPath-655"><a href="#CsvPath-655"><span class="linenos"> 655</span></a>            <span class="c1"># if the matcher was requested for some reason beyond our own needs</span>
</span><span id="CsvPath-656"><a href="#CsvPath-656"><span class="linenos"> 656</span></a>            <span class="c1"># we just return it and forget it existed.</span>
</span><span id="CsvPath-657"><a href="#CsvPath-657"><span class="linenos"> 657</span></a>            <span class="c1">#</span>
</span><span id="CsvPath-658"><a href="#CsvPath-658"><span class="linenos"> 658</span></a>            <span class="k">return</span> <span class="n">matcher</span>
</span><span id="CsvPath-659"><a href="#CsvPath-659"><span class="linenos"> 659</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanner</span><span class="o">.</span><span class="n">filename</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-660"><a href="#CsvPath-660"><span class="linenos"> 660</span></a>            <span class="k">raise</span> <span class="n">FileException</span><span class="p">(</span><span class="s2">&quot;Cannot proceed without a filename&quot;</span><span class="p">)</span>
</span><span id="CsvPath-661"><a href="#CsvPath-661"><span class="linenos"> 661</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">get_total_lines_and_headers</span><span class="p">()</span>
</span><span id="CsvPath-662"><a href="#CsvPath-662"><span class="linenos"> 662</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="CsvPath-663"><a href="#CsvPath-663"><span class="linenos"> 663</span></a>
</span><span id="CsvPath-664"><a href="#CsvPath-664"><span class="linenos"> 664</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_settings_from_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-665"><a href="#CsvPath-665"><span class="linenos"> 665</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-666"><a href="#CsvPath-666"><span class="linenos"> 666</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-667"><a href="#CsvPath-667"><span class="linenos"> 667</span></a>        <span class="c1"># settings:</span>
</span><span id="CsvPath-668"><a href="#CsvPath-668"><span class="linenos"> 668</span></a>        <span class="c1">#   - logic-mode: AND | OR</span>
</span><span id="CsvPath-669"><a href="#CsvPath-669"><span class="linenos"> 669</span></a>        <span class="c1">#   - return-mode: matches | no-matches</span>
</span><span id="CsvPath-670"><a href="#CsvPath-670"><span class="linenos"> 670</span></a>        <span class="c1">#   - print-mode: default | no-default</span>
</span><span id="CsvPath-671"><a href="#CsvPath-671"><span class="linenos"> 671</span></a>        <span class="c1">#   - validation-mode: (no-)print | log | (no-)raise | quiet | (no-)match</span>
</span><span id="CsvPath-672"><a href="#CsvPath-672"><span class="linenos"> 672</span></a>        <span class="c1">#   - run-mode: no-run | run</span>
</span><span id="CsvPath-673"><a href="#CsvPath-673"><span class="linenos"> 673</span></a>        <span class="c1">#   - unmatched-mode: no-keep | keep</span>
</span><span id="CsvPath-674"><a href="#CsvPath-674"><span class="linenos"> 674</span></a>        <span class="c1">#   - source-mode: preceding | origin</span>
</span><span id="CsvPath-675"><a href="#CsvPath-675"><span class="linenos"> 675</span></a>        <span class="c1">#   - files-mode: all | no-data | no-unmatched | no-printouts | data | unmatched | errors | meta | vars | printouts</span>
</span><span id="CsvPath-676"><a href="#CsvPath-676"><span class="linenos"> 676</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-677"><a href="#CsvPath-677"><span class="linenos"> 677</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">modes</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</span><span id="CsvPath-678"><a href="#CsvPath-678"><span class="linenos"> 678</span></a>
</span><span id="CsvPath-679"><a href="#CsvPath-679"><span class="linenos"> 679</span></a>    <span class="c1"># =====================</span>
</span><span id="CsvPath-680"><a href="#CsvPath-680"><span class="linenos"> 680</span></a>    <span class="c1"># in principle the modes should come through the mode controller like:</span>
</span><span id="CsvPath-681"><a href="#CsvPath-681"><span class="linenos"> 681</span></a>    <span class="c1">#      self.modes.transfer_mode.value</span>
</span><span id="CsvPath-682"><a href="#CsvPath-682"><span class="linenos"> 682</span></a>    <span class="c1"># not wading into that today. low value.</span>
</span><span id="CsvPath-683"><a href="#CsvPath-683"><span class="linenos"> 683</span></a>    <span class="c1">#</span>
</span><span id="CsvPath-684"><a href="#CsvPath-684"><span class="linenos"> 684</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-685"><a href="#CsvPath-685"><span class="linenos"> 685</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">transfer_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="CsvPath-686"><a href="#CsvPath-686"><span class="linenos"> 686</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-687"><a href="#CsvPath-687"><span class="linenos"> 687</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;transfer-mode&quot;</span><span class="p">)</span>
</span><span id="CsvPath-688"><a href="#CsvPath-688"><span class="linenos"> 688</span></a>
</span><span id="CsvPath-689"><a href="#CsvPath-689"><span class="linenos"> 689</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-690"><a href="#CsvPath-690"><span class="linenos"> 690</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">source_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="CsvPath-691"><a href="#CsvPath-691"><span class="linenos"> 691</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-692"><a href="#CsvPath-692"><span class="linenos"> 692</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;source-mode&quot;</span><span class="p">)</span>
</span><span id="CsvPath-693"><a href="#CsvPath-693"><span class="linenos"> 693</span></a>
</span><span id="CsvPath-694"><a href="#CsvPath-694"><span class="linenos"> 694</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-695"><a href="#CsvPath-695"><span class="linenos"> 695</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">error_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="CsvPath-696"><a href="#CsvPath-696"><span class="linenos"> 696</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-697"><a href="#CsvPath-697"><span class="linenos"> 697</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;error-mode&quot;</span><span class="p">)</span>
</span><span id="CsvPath-698"><a href="#CsvPath-698"><span class="linenos"> 698</span></a>
</span><span id="CsvPath-699"><a href="#CsvPath-699"><span class="linenos"> 699</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-700"><a href="#CsvPath-700"><span class="linenos"> 700</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">files_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="CsvPath-701"><a href="#CsvPath-701"><span class="linenos"> 701</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-702"><a href="#CsvPath-702"><span class="linenos"> 702</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;files-mode&quot;</span><span class="p">)</span>
</span><span id="CsvPath-703"><a href="#CsvPath-703"><span class="linenos"> 703</span></a>
</span><span id="CsvPath-704"><a href="#CsvPath-704"><span class="linenos"> 704</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-705"><a href="#CsvPath-705"><span class="linenos"> 705</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validation_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="CsvPath-706"><a href="#CsvPath-706"><span class="linenos"> 706</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-707"><a href="#CsvPath-707"><span class="linenos"> 707</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;validation-mode&quot;</span><span class="p">)</span>
</span><span id="CsvPath-708"><a href="#CsvPath-708"><span class="linenos"> 708</span></a>
</span><span id="CsvPath-709"><a href="#CsvPath-709"><span class="linenos"> 709</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-710"><a href="#CsvPath-710"><span class="linenos"> 710</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">run_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="CsvPath-711"><a href="#CsvPath-711"><span class="linenos"> 711</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-712"><a href="#CsvPath-712"><span class="linenos"> 712</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;run-mode&quot;</span><span class="p">)</span>
</span><span id="CsvPath-713"><a href="#CsvPath-713"><span class="linenos"> 713</span></a>
</span><span id="CsvPath-714"><a href="#CsvPath-714"><span class="linenos"> 714</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-715"><a href="#CsvPath-715"><span class="linenos"> 715</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">logic_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="CsvPath-716"><a href="#CsvPath-716"><span class="linenos"> 716</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-717"><a href="#CsvPath-717"><span class="linenos"> 717</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;logic-mode&quot;</span><span class="p">)</span>
</span><span id="CsvPath-718"><a href="#CsvPath-718"><span class="linenos"> 718</span></a>
</span><span id="CsvPath-719"><a href="#CsvPath-719"><span class="linenos"> 719</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-720"><a href="#CsvPath-720"><span class="linenos"> 720</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">return_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="CsvPath-721"><a href="#CsvPath-721"><span class="linenos"> 721</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-722"><a href="#CsvPath-722"><span class="linenos"> 722</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">modes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;return-mode&quot;</span><span class="p">)</span>
</span><span id="CsvPath-723"><a href="#CsvPath-723"><span class="linenos"> 723</span></a>
</span><span id="CsvPath-724"><a href="#CsvPath-724"><span class="linenos"> 724</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-725"><a href="#CsvPath-725"><span class="linenos"> 725</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">explain_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="CsvPath-726"><a href="#CsvPath-726"><span class="linenos"> 726</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-727"><a href="#CsvPath-727"><span class="linenos"> 727</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;explain-mode&quot;</span><span class="p">)</span>
</span><span id="CsvPath-728"><a href="#CsvPath-728"><span class="linenos"> 728</span></a>
</span><span id="CsvPath-729"><a href="#CsvPath-729"><span class="linenos"> 729</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-730"><a href="#CsvPath-730"><span class="linenos"> 730</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">print_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="CsvPath-731"><a href="#CsvPath-731"><span class="linenos"> 731</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-732"><a href="#CsvPath-732"><span class="linenos"> 732</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;print-mode&quot;</span><span class="p">)</span>
</span><span id="CsvPath-733"><a href="#CsvPath-733"><span class="linenos"> 733</span></a>
</span><span id="CsvPath-734"><a href="#CsvPath-734"><span class="linenos"> 734</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-735"><a href="#CsvPath-735"><span class="linenos"> 735</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">unmatched_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="CsvPath-736"><a href="#CsvPath-736"><span class="linenos"> 736</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-737"><a href="#CsvPath-737"><span class="linenos"> 737</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;unmatched-mode&quot;</span><span class="p">)</span>
</span><span id="CsvPath-738"><a href="#CsvPath-738"><span class="linenos"> 738</span></a>
</span><span id="CsvPath-739"><a href="#CsvPath-739"><span class="linenos"> 739</span></a>    <span class="c1"># =====================</span>
</span><span id="CsvPath-740"><a href="#CsvPath-740"><span class="linenos"> 740</span></a>
</span><span id="CsvPath-741"><a href="#CsvPath-741"><span class="linenos"> 741</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-742"><a href="#CsvPath-742"><span class="linenos"> 742</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">transfers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
</span><span id="CsvPath-743"><a href="#CsvPath-743"><span class="linenos"> 743</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-744"><a href="#CsvPath-744"><span class="linenos"> 744</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">modes</span><span class="o">.</span><span class="n">transfer_mode</span><span class="o">.</span><span class="n">transfers</span>
</span><span id="CsvPath-745"><a href="#CsvPath-745"><span class="linenos"> 745</span></a>
</span><span id="CsvPath-746"><a href="#CsvPath-746"><span class="linenos"> 746</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-747"><a href="#CsvPath-747"><span class="linenos"> 747</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">all_expected_files</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="CsvPath-748"><a href="#CsvPath-748"><span class="linenos"> 748</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-749"><a href="#CsvPath-749"><span class="linenos"> 749</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">modes</span><span class="o">.</span><span class="n">files_mode</span><span class="o">.</span><span class="n">all_expected_files</span>
</span><span id="CsvPath-750"><a href="#CsvPath-750"><span class="linenos"> 750</span></a>
</span><span id="CsvPath-751"><a href="#CsvPath-751"><span class="linenos"> 751</span></a>    <span class="nd">@all_expected_files</span><span class="o">.</span><span class="n">setter</span>
</span><span id="CsvPath-752"><a href="#CsvPath-752"><span class="linenos"> 752</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">all_expected_files</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">efs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-753"><a href="#CsvPath-753"><span class="linenos"> 753</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-754"><a href="#CsvPath-754"><span class="linenos"> 754</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">modes</span><span class="o">.</span><span class="n">files_mode</span><span class="o">.</span><span class="n">all_expected_files</span> <span class="o">=</span> <span class="n">efs</span>
</span><span id="CsvPath-755"><a href="#CsvPath-755"><span class="linenos"> 755</span></a>
</span><span id="CsvPath-756"><a href="#CsvPath-756"><span class="linenos"> 756</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_pick_named_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">specific</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="CsvPath-757"><a href="#CsvPath-757"><span class="linenos"> 757</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-758"><a href="#CsvPath-758"><span class="linenos"> 758</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">csvpaths</span><span class="p">:</span>
</span><span id="CsvPath-759"><a href="#CsvPath-759"><span class="linenos"> 759</span></a>            <span class="k">raise</span> <span class="n">CsvPathsException</span><span class="p">(</span><span class="s2">&quot;No CsvPaths object available&quot;</span><span class="p">)</span>
</span><span id="CsvPath-760"><a href="#CsvPath-760"><span class="linenos"> 760</span></a>        <span class="n">np</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">csvpaths</span><span class="o">.</span><span class="n">paths_manager</span><span class="o">.</span><span class="n">get_named_paths</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="CsvPath-761"><a href="#CsvPath-761"><span class="linenos"> 761</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="p">:</span>
</span><span id="CsvPath-762"><a href="#CsvPath-762"><span class="linenos"> 762</span></a>            <span class="k">raise</span> <span class="n">CsvPathsException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Named-paths &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; not found&quot;</span><span class="p">)</span>
</span><span id="CsvPath-763"><a href="#CsvPath-763"><span class="linenos"> 763</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CsvPath-764"><a href="#CsvPath-764"><span class="linenos"> 764</span></a>            <span class="k">raise</span> <span class="n">CsvPathsException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Named-paths &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; has no csvpaths&quot;</span><span class="p">)</span>
</span><span id="CsvPath-765"><a href="#CsvPath-765"><span class="linenos"> 765</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="CsvPath-766"><a href="#CsvPath-766"><span class="linenos"> 766</span></a>            <span class="k">return</span> <span class="n">np</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="CsvPath-767"><a href="#CsvPath-767"><span class="linenos"> 767</span></a>        <span class="k">if</span> <span class="n">specific</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-768"><a href="#CsvPath-768"><span class="linenos"> 768</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="CsvPath-769"><a href="#CsvPath-769"><span class="linenos"> 769</span></a>                <span class="s2">&quot;Parse_named_path </span><span class="si">%s</span><span class="s2"> has </span><span class="si">%s</span><span class="s2"> csvpaths. Using just the first one.&quot;</span><span class="p">,</span>
</span><span id="CsvPath-770"><a href="#CsvPath-770"><span class="linenos"> 770</span></a>                <span class="n">name</span><span class="p">,</span>
</span><span id="CsvPath-771"><a href="#CsvPath-771"><span class="linenos"> 771</span></a>                <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="p">),</span>
</span><span id="CsvPath-772"><a href="#CsvPath-772"><span class="linenos"> 772</span></a>            <span class="p">)</span>
</span><span id="CsvPath-773"><a href="#CsvPath-773"><span class="linenos"> 773</span></a>            <span class="k">return</span> <span class="n">np</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="CsvPath-774"><a href="#CsvPath-774"><span class="linenos"> 774</span></a>        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">np</span><span class="p">:</span>
</span><span id="CsvPath-775"><a href="#CsvPath-775"><span class="linenos"> 775</span></a>            <span class="c1"># this ends up being redundant to the caller. we do it 1x so it&#39;s not</span>
</span><span id="CsvPath-776"><a href="#CsvPath-776"><span class="linenos"> 776</span></a>            <span class="c1"># a big lift and is consistent.</span>
</span><span id="CsvPath-777"><a href="#CsvPath-777"><span class="linenos"> 777</span></a>            <span class="n">c</span> <span class="o">=</span> <span class="n">CsvPath</span><span class="p">(</span><span class="n">csvpaths</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">csvpaths</span><span class="p">)</span>
</span><span id="CsvPath-778"><a href="#CsvPath-778"><span class="linenos"> 778</span></a>            <span class="n">MetadataParser</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">extract_metadata</span><span class="p">(</span><span class="n">instance</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">csvpath</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
</span><span id="CsvPath-779"><a href="#CsvPath-779"><span class="linenos"> 779</span></a>            <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">identity</span> <span class="o">==</span> <span class="n">specific</span><span class="p">:</span>
</span><span id="CsvPath-780"><a href="#CsvPath-780"><span class="linenos"> 780</span></a>                <span class="k">return</span> <span class="n">p</span>
</span><span id="CsvPath-781"><a href="#CsvPath-781"><span class="linenos"> 781</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="CsvPath-782"><a href="#CsvPath-782"><span class="linenos"> 782</span></a>            <span class="s2">&quot;Cannot find csvpath identified as </span><span class="si">%s</span><span class="s2"> in named-paths </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">specific</span><span class="p">,</span> <span class="n">name</span>
</span><span id="CsvPath-783"><a href="#CsvPath-783"><span class="linenos"> 783</span></a>        <span class="p">)</span>
</span><span id="CsvPath-784"><a href="#CsvPath-784"><span class="linenos"> 784</span></a>        <span class="k">raise</span> <span class="n">ParsingException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot find path &#39;</span><span class="si">{</span><span class="n">specific</span><span class="si">}</span><span class="s2">&#39; in named-paths &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</span><span id="CsvPath-785"><a href="#CsvPath-785"><span class="linenos"> 785</span></a>
</span><span id="CsvPath-786"><a href="#CsvPath-786"><span class="linenos"> 786</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parse_named_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">disposably</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">specific</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="CsvPath-787"><a href="#CsvPath-787"><span class="linenos"> 787</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private</span>
</span><span id="CsvPath-788"><a href="#CsvPath-788"><span class="linenos"> 788</span></a><span class="sd">        disposably is True when a Matcher is needed for some purpose other than</span>
</span><span id="CsvPath-789"><a href="#CsvPath-789"><span class="linenos"> 789</span></a><span class="sd">        the run we were created to do. could be that a match component wanted a</span>
</span><span id="CsvPath-790"><a href="#CsvPath-790"><span class="linenos"> 790</span></a><span class="sd">        parsed csvpath for its own purposes. import() uses this method.</span>
</span><span id="CsvPath-791"><a href="#CsvPath-791"><span class="linenos"> 791</span></a><span class="sd">        when True, we create and return the Matcher, but then forget it ever existed.</span>
</span><span id="CsvPath-792"><a href="#CsvPath-792"><span class="linenos"> 792</span></a><span class="sd">        also note: the path must have a name or full filename. $[*] is not enough.</span>
</span><span id="CsvPath-793"><a href="#CsvPath-793"><span class="linenos"> 793</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CsvPath-794"><a href="#CsvPath-794"><span class="linenos"> 794</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">csvpaths</span><span class="p">:</span>
</span><span id="CsvPath-795"><a href="#CsvPath-795"><span class="linenos"> 795</span></a>            <span class="k">raise</span> <span class="n">CsvPathsException</span><span class="p">(</span><span class="s2">&quot;No CsvPaths object available&quot;</span><span class="p">)</span>
</span><span id="CsvPath-796"><a href="#CsvPath-796"><span class="linenos"> 796</span></a>
</span><span id="CsvPath-797"><a href="#CsvPath-797"><span class="linenos"> 797</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pick_named_path</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">specific</span><span class="o">=</span><span class="n">specific</span><span class="p">)</span>
</span><span id="CsvPath-798"><a href="#CsvPath-798"><span class="linenos"> 798</span></a>        <span class="n">c</span> <span class="o">=</span> <span class="n">CsvPath</span><span class="p">(</span><span class="n">csvpaths</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">csvpaths</span><span class="p">)</span>
</span><span id="CsvPath-799"><a href="#CsvPath-799"><span class="linenos"> 799</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="n">MetadataParser</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">extract_metadata</span><span class="p">(</span><span class="n">instance</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">csvpath</span><span class="o">=</span><span class="n">path</span><span class="p">)</span>
</span><span id="CsvPath-800"><a href="#CsvPath-800"><span class="linenos"> 800</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-801"><a href="#CsvPath-801"><span class="linenos"> 801</span></a>        <span class="c1"># exp. oddly this seems to be superfluous</span>
</span><span id="CsvPath-802"><a href="#CsvPath-802"><span class="linenos"> 802</span></a>        <span class="c1"># if disposably is False:</span>
</span><span id="CsvPath-803"><a href="#CsvPath-803"><span class="linenos"> 803</span></a>        <span class="c1">#    path = c._update_file_path(path)</span>
</span><span id="CsvPath-804"><a href="#CsvPath-804"><span class="linenos"> 804</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-805"><a href="#CsvPath-805"><span class="linenos"> 805</span></a>        <span class="n">dis</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">disposably</span><span class="o">=</span><span class="n">disposably</span><span class="p">)</span>
</span><span id="CsvPath-806"><a href="#CsvPath-806"><span class="linenos"> 806</span></a>        <span class="k">if</span> <span class="n">disposably</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="CsvPath-807"><a href="#CsvPath-807"><span class="linenos"> 807</span></a>            <span class="k">return</span> <span class="n">dis</span>
</span><span id="CsvPath-808"><a href="#CsvPath-808"><span class="linenos"> 808</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="CsvPath-809"><a href="#CsvPath-809"><span class="linenos"> 809</span></a>
</span><span id="CsvPath-810"><a href="#CsvPath-810"><span class="linenos"> 810</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_update_file_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="CsvPath-811"><a href="#CsvPath-811"><span class="linenos"> 811</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private</span>
</span><span id="CsvPath-812"><a href="#CsvPath-812"><span class="linenos"> 812</span></a><span class="sd">        this method replaces a name (i.e. name in: $name[*[][yes()]) with</span>
</span><span id="CsvPath-813"><a href="#CsvPath-813"><span class="linenos"> 813</span></a><span class="sd">        a file system path, if that name is registered with csvpaths&#39;s file</span>
</span><span id="CsvPath-814"><a href="#CsvPath-814"><span class="linenos"> 814</span></a><span class="sd">        manager. if there is no csvpaths no replace happens. if there is a</span>
</span><span id="CsvPath-815"><a href="#CsvPath-815"><span class="linenos"> 815</span></a><span class="sd">        csvpaths but the file manager doesn&#39;t know the name, no replace</span>
</span><span id="CsvPath-816"><a href="#CsvPath-816"><span class="linenos"> 816</span></a><span class="sd">        happens.</span>
</span><span id="CsvPath-817"><a href="#CsvPath-817"><span class="linenos"> 817</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CsvPath-818"><a href="#CsvPath-818"><span class="linenos"> 818</span></a>        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-819"><a href="#CsvPath-819"><span class="linenos"> 819</span></a>            <span class="k">raise</span> <span class="n">InputException</span><span class="p">(</span><span class="s2">&quot;The csvpath string cannot be None&quot;</span><span class="p">)</span>
</span><span id="CsvPath-820"><a href="#CsvPath-820"><span class="linenos"> 820</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">csvpaths</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-821"><a href="#CsvPath-821"><span class="linenos"> 821</span></a>            <span class="k">return</span> <span class="n">data</span>
</span><span id="CsvPath-822"><a href="#CsvPath-822"><span class="linenos"> 822</span></a>        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_name</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="CsvPath-823"><a href="#CsvPath-823"><span class="linenos"> 823</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">csvpaths</span><span class="o">.</span><span class="n">file_manager</span><span class="o">.</span><span class="n">get_named_file</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="CsvPath-824"><a href="#CsvPath-824"><span class="linenos"> 824</span></a>        <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-825"><a href="#CsvPath-825"><span class="linenos"> 825</span></a>            <span class="k">return</span> <span class="n">data</span>
</span><span id="CsvPath-826"><a href="#CsvPath-826"><span class="linenos"> 826</span></a>        <span class="k">if</span> <span class="n">path</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
</span><span id="CsvPath-827"><a href="#CsvPath-827"><span class="linenos"> 827</span></a>            <span class="k">return</span> <span class="n">data</span>
</span><span id="CsvPath-828"><a href="#CsvPath-828"><span class="linenos"> 828</span></a>        <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
</span><span id="CsvPath-829"><a href="#CsvPath-829"><span class="linenos"> 829</span></a>
</span><span id="CsvPath-830"><a href="#CsvPath-830"><span class="linenos"> 830</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_get_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="CsvPath-831"><a href="#CsvPath-831"><span class="linenos"> 831</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">csvpaths</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-832"><a href="#CsvPath-832"><span class="linenos"> 832</span></a>            <span class="k">return</span> <span class="n">data</span>
</span><span id="CsvPath-833"><a href="#CsvPath-833"><span class="linenos"> 833</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="CsvPath-834"><a href="#CsvPath-834"><span class="linenos"> 834</span></a>        <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;$&quot;</span><span class="p">:</span>
</span><span id="CsvPath-835"><a href="#CsvPath-835"><span class="linenos"> 835</span></a>            <span class="n">name</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span> <span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">)]</span>
</span><span id="CsvPath-836"><a href="#CsvPath-836"><span class="linenos"> 836</span></a>            <span class="k">return</span> <span class="n">name</span>
</span><span id="CsvPath-837"><a href="#CsvPath-837"><span class="linenos"> 837</span></a>        <span class="k">raise</span> <span class="n">FormatException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Must start with &#39;$&#39;, not </span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="CsvPath-838"><a href="#CsvPath-838"><span class="linenos"> 838</span></a>
</span><span id="CsvPath-839"><a href="#CsvPath-839"><span class="linenos"> 839</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_find_scan_and_match_parts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span><span id="CsvPath-840"><a href="#CsvPath-840"><span class="linenos"> 840</span></a>        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="CsvPath-841"><a href="#CsvPath-841"><span class="linenos"> 841</span></a>            <span class="k">raise</span> <span class="n">InputException</span><span class="p">(</span><span class="s2">&quot;Not a csvpath string&quot;</span><span class="p">)</span>
</span><span id="CsvPath-842"><a href="#CsvPath-842"><span class="linenos"> 842</span></a>        <span class="n">scan</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="CsvPath-843"><a href="#CsvPath-843"><span class="linenos"> 843</span></a>        <span class="n">matches</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="CsvPath-844"><a href="#CsvPath-844"><span class="linenos"> 844</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="CsvPath-845"><a href="#CsvPath-845"><span class="linenos"> 845</span></a>        <span class="n">i</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">)</span>
</span><span id="CsvPath-846"><a href="#CsvPath-846"><span class="linenos"> 846</span></a>        <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CsvPath-847"><a href="#CsvPath-847"><span class="linenos"> 847</span></a>            <span class="k">raise</span> <span class="n">InputException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot find the scan part of this csvpath: </span><span class="si">{</span><span class="n">data</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="CsvPath-848"><a href="#CsvPath-848"><span class="linenos"> 848</span></a>        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="CsvPath-849"><a href="#CsvPath-849"><span class="linenos"> 849</span></a>            <span class="k">raise</span> <span class="n">InputException</span><span class="p">(</span>
</span><span id="CsvPath-850"><a href="#CsvPath-850"><span class="linenos"> 850</span></a>                <span class="sa">f</span><span class="s2">&quot;The scan part of this csvpath cannot be last: </span><span class="si">{</span><span class="n">data</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="CsvPath-851"><a href="#CsvPath-851"><span class="linenos"> 851</span></a>            <span class="p">)</span>
</span><span id="CsvPath-852"><a href="#CsvPath-852"><span class="linenos"> 852</span></a>
</span><span id="CsvPath-853"><a href="#CsvPath-853"><span class="linenos"> 853</span></a>        <span class="n">scan</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span> <span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="CsvPath-854"><a href="#CsvPath-854"><span class="linenos"> 854</span></a>        <span class="n">scan</span> <span class="o">=</span> <span class="n">scan</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="CsvPath-855"><a href="#CsvPath-855"><span class="linenos"> 855</span></a>
</span><span id="CsvPath-856"><a href="#CsvPath-856"><span class="linenos"> 856</span></a>        <span class="n">ndata</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span>
</span><span id="CsvPath-857"><a href="#CsvPath-857"><span class="linenos"> 857</span></a>        <span class="n">ndata</span> <span class="o">=</span> <span class="n">ndata</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="CsvPath-858"><a href="#CsvPath-858"><span class="linenos"> 858</span></a>
</span><span id="CsvPath-859"><a href="#CsvPath-859"><span class="linenos"> 859</span></a>        <span class="k">if</span> <span class="n">ndata</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
</span><span id="CsvPath-860"><a href="#CsvPath-860"><span class="linenos"> 860</span></a>            <span class="k">raise</span> <span class="n">InputException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;There must be a match part of this csvpath: </span><span class="si">{</span><span class="n">data</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="CsvPath-861"><a href="#CsvPath-861"><span class="linenos"> 861</span></a>        <span class="k">if</span> <span class="n">ndata</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;[&quot;</span><span class="p">:</span>
</span><span id="CsvPath-862"><a href="#CsvPath-862"><span class="linenos"> 862</span></a>            <span class="k">raise</span> <span class="n">InputException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot find the match part of this csvpath: </span><span class="si">{</span><span class="n">data</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="CsvPath-863"><a href="#CsvPath-863"><span class="linenos"> 863</span></a>        <span class="k">if</span> <span class="n">ndata</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">ndata</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;]&quot;</span><span class="p">:</span>
</span><span id="CsvPath-864"><a href="#CsvPath-864"><span class="linenos"> 864</span></a>            <span class="k">raise</span> <span class="n">InputException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The match part of this csvpath is incorrect: </span><span class="si">{</span><span class="n">data</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="CsvPath-865"><a href="#CsvPath-865"><span class="linenos"> 865</span></a>        <span class="n">matches</span> <span class="o">=</span> <span class="n">ndata</span>
</span><span id="CsvPath-866"><a href="#CsvPath-866"><span class="linenos"> 866</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-867"><a href="#CsvPath-867"><span class="linenos"> 867</span></a>        <span class="c1"># if we&#39;re given directory(s) to save to, save the parts</span>
</span><span id="CsvPath-868"><a href="#CsvPath-868"><span class="linenos"> 868</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-869"><a href="#CsvPath-869"><span class="linenos"> 869</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_save_parts_if</span><span class="p">(</span><span class="n">scan</span><span class="p">,</span> <span class="n">matches</span><span class="p">)</span>
</span><span id="CsvPath-870"><a href="#CsvPath-870"><span class="linenos"> 870</span></a>        <span class="k">return</span> <span class="n">scan</span><span class="p">,</span> <span class="n">matches</span>
</span><span id="CsvPath-871"><a href="#CsvPath-871"><span class="linenos"> 871</span></a>
</span><span id="CsvPath-872"><a href="#CsvPath-872"><span class="linenos"> 872</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_save_parts_if</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scan</span><span class="p">,</span> <span class="n">match</span><span class="p">):</span>
</span><span id="CsvPath-873"><a href="#CsvPath-873"><span class="linenos"> 873</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_save_scan_dir</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_name</span><span class="p">:</span>
</span><span id="CsvPath-874"><a href="#CsvPath-874"><span class="linenos"> 874</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span>
</span><span id="CsvPath-875"><a href="#CsvPath-875"><span class="linenos"> 875</span></a>                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_save_scan_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_run_name</span><span class="si">}</span><span class="s2">.txt&quot;</span><span class="p">),</span>
</span><span id="CsvPath-876"><a href="#CsvPath-876"><span class="linenos"> 876</span></a>                <span class="s2">&quot;w&quot;</span><span class="p">,</span>
</span><span id="CsvPath-877"><a href="#CsvPath-877"><span class="linenos"> 877</span></a>                <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span>
</span><span id="CsvPath-878"><a href="#CsvPath-878"><span class="linenos"> 878</span></a>            <span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="CsvPath-879"><a href="#CsvPath-879"><span class="linenos"> 879</span></a>                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">scan</span><span class="p">)</span>
</span><span id="CsvPath-880"><a href="#CsvPath-880"><span class="linenos"> 880</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_save_match_dir</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_name</span><span class="p">:</span>
</span><span id="CsvPath-881"><a href="#CsvPath-881"><span class="linenos"> 881</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span>
</span><span id="CsvPath-882"><a href="#CsvPath-882"><span class="linenos"> 882</span></a>                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_save_match_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_run_name</span><span class="si">}</span><span class="s2">.txt&quot;</span><span class="p">),</span>
</span><span id="CsvPath-883"><a href="#CsvPath-883"><span class="linenos"> 883</span></a>                <span class="s2">&quot;w&quot;</span><span class="p">,</span>
</span><span id="CsvPath-884"><a href="#CsvPath-884"><span class="linenos"> 884</span></a>                <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span>
</span><span id="CsvPath-885"><a href="#CsvPath-885"><span class="linenos"> 885</span></a>            <span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="CsvPath-886"><a href="#CsvPath-886"><span class="linenos"> 886</span></a>                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">match</span><span class="p">)</span>
</span><span id="CsvPath-887"><a href="#CsvPath-887"><span class="linenos"> 887</span></a>
</span><span id="CsvPath-888"><a href="#CsvPath-888"><span class="linenos"> 888</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="CsvPath-889"><a href="#CsvPath-889"><span class="linenos"> 889</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="CsvPath-890"><a href="#CsvPath-890"><span class="linenos"> 890</span></a><span class="s2">            path: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">scanner</span><span class="o">.</span><span class="n">path</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">scanner</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="kc">None</span><span class="si">}</span>
</span><span id="CsvPath-891"><a href="#CsvPath-891"><span class="linenos"> 891</span></a><span class="s2">            identity: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">identity</span><span class="si">}</span>
</span><span id="CsvPath-892"><a href="#CsvPath-892"><span class="linenos"> 892</span></a><span class="s2">            parsers: [scanner=Ply, matcher=Lark, print=Lark]</span>
</span><span id="CsvPath-893"><a href="#CsvPath-893"><span class="linenos"> 893</span></a><span class="s2">            from_line: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">scanner</span><span class="o">.</span><span class="n">from_line</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">scanner</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="kc">None</span><span class="si">}</span>
</span><span id="CsvPath-894"><a href="#CsvPath-894"><span class="linenos"> 894</span></a><span class="s2">            to_line: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">scanner</span><span class="o">.</span><span class="n">to_line</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">scanner</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="kc">None</span><span class="si">}</span>
</span><span id="CsvPath-895"><a href="#CsvPath-895"><span class="linenos"> 895</span></a><span class="s2">            all_lines: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">scanner</span><span class="o">.</span><span class="n">all_lines</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">scanner</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="kc">None</span><span class="si">}</span>
</span><span id="CsvPath-896"><a href="#CsvPath-896"><span class="linenos"> 896</span></a><span class="s2">            these: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">scanner</span><span class="o">.</span><span class="n">these</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">scanner</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="kc">None</span><span class="si">}</span>
</span><span id="CsvPath-897"><a href="#CsvPath-897"><span class="linenos"> 897</span></a><span class="s2">            matcher: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">matcher</span><span class="si">}</span>
</span><span id="CsvPath-898"><a href="#CsvPath-898"><span class="linenos"> 898</span></a><span class="s2">            variables: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">)</span><span class="si">}</span>
</span><span id="CsvPath-899"><a href="#CsvPath-899"><span class="linenos"> 899</span></a><span class="s2">            metadata: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">)</span><span class="si">}</span>
</span><span id="CsvPath-900"><a href="#CsvPath-900"><span class="linenos"> 900</span></a><span class="s2">        &quot;&quot;&quot;</span>
</span><span id="CsvPath-901"><a href="#CsvPath-901"><span class="linenos"> 901</span></a>
</span><span id="CsvPath-902"><a href="#CsvPath-902"><span class="linenos"> 902</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-903"><a href="#CsvPath-903"><span class="linenos"> 903</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
</span><span id="CsvPath-904"><a href="#CsvPath-904"><span class="linenos"> 904</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Csvpaths can flag a CSV file as invalid using the fail() function&quot;&quot;&quot;</span>
</span><span id="CsvPath-905"><a href="#CsvPath-905"><span class="linenos"> 905</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_valid</span>
</span><span id="CsvPath-906"><a href="#CsvPath-906"><span class="linenos"> 906</span></a>
</span><span id="CsvPath-907"><a href="#CsvPath-907"><span class="linenos"> 907</span></a>    <span class="nd">@is_valid</span><span class="o">.</span><span class="n">setter</span>
</span><span id="CsvPath-908"><a href="#CsvPath-908"><span class="linenos"> 908</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tf</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-909"><a href="#CsvPath-909"><span class="linenos"> 909</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_is_valid</span> <span class="o">=</span> <span class="n">tf</span>
</span><span id="CsvPath-910"><a href="#CsvPath-910"><span class="linenos"> 910</span></a>
</span><span id="CsvPath-911"><a href="#CsvPath-911"><span class="linenos"> 911</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-912"><a href="#CsvPath-912"><span class="linenos"> 912</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">completed</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="CsvPath-913"><a href="#CsvPath-913"><span class="linenos"> 913</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanner</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_monitor</span><span class="p">:</span>
</span><span id="CsvPath-914"><a href="#CsvPath-914"><span class="linenos"> 914</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="CsvPath-915"><a href="#CsvPath-915"><span class="linenos"> 915</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanner</span><span class="o">.</span><span class="n">is_last</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">line_monitor</span><span class="o">.</span><span class="n">physical_line_number</span><span class="p">):</span>
</span><span id="CsvPath-916"><a href="#CsvPath-916"><span class="linenos"> 916</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="CsvPath-917"><a href="#CsvPath-917"><span class="linenos"> 917</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="CsvPath-918"><a href="#CsvPath-918"><span class="linenos"> 918</span></a>
</span><span id="CsvPath-919"><a href="#CsvPath-919"><span class="linenos"> 919</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-920"><a href="#CsvPath-920"><span class="linenos"> 920</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">from_line</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># pragma: no cover pylint: disable=C0116</span>
</span><span id="CsvPath-921"><a href="#CsvPath-921"><span class="linenos"> 921</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-922"><a href="#CsvPath-922"><span class="linenos"> 922</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanner</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-923"><a href="#CsvPath-923"><span class="linenos"> 923</span></a>            <span class="k">raise</span> <span class="n">ParsingException</span><span class="p">(</span><span class="s2">&quot;No scanner available. Have you parsed a csvpath?&quot;</span><span class="p">)</span>
</span><span id="CsvPath-924"><a href="#CsvPath-924"><span class="linenos"> 924</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanner</span><span class="o">.</span><span class="n">from_line</span>
</span><span id="CsvPath-925"><a href="#CsvPath-925"><span class="linenos"> 925</span></a>
</span><span id="CsvPath-926"><a href="#CsvPath-926"><span class="linenos"> 926</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-927"><a href="#CsvPath-927"><span class="linenos"> 927</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_line</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># pragma: no cover pylint: disable=C0116</span>
</span><span id="CsvPath-928"><a href="#CsvPath-928"><span class="linenos"> 928</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-929"><a href="#CsvPath-929"><span class="linenos"> 929</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanner</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-930"><a href="#CsvPath-930"><span class="linenos"> 930</span></a>            <span class="k">raise</span> <span class="n">ParsingException</span><span class="p">(</span><span class="s2">&quot;No scanner available. Have you parsed a csvpath?&quot;</span><span class="p">)</span>
</span><span id="CsvPath-931"><a href="#CsvPath-931"><span class="linenos"> 931</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanner</span><span class="o">.</span><span class="n">to_line</span>
</span><span id="CsvPath-932"><a href="#CsvPath-932"><span class="linenos"> 932</span></a>
</span><span id="CsvPath-933"><a href="#CsvPath-933"><span class="linenos"> 933</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-934"><a href="#CsvPath-934"><span class="linenos"> 934</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">all_lines</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># pragma: no cover pylint: disable=C0116</span>
</span><span id="CsvPath-935"><a href="#CsvPath-935"><span class="linenos"> 935</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-936"><a href="#CsvPath-936"><span class="linenos"> 936</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanner</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-937"><a href="#CsvPath-937"><span class="linenos"> 937</span></a>            <span class="k">raise</span> <span class="n">ParsingException</span><span class="p">(</span><span class="s2">&quot;No scanner available. Have you parsed a csvpath?&quot;</span><span class="p">)</span>
</span><span id="CsvPath-938"><a href="#CsvPath-938"><span class="linenos"> 938</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanner</span><span class="o">.</span><span class="n">all_lines</span>
</span><span id="CsvPath-939"><a href="#CsvPath-939"><span class="linenos"> 939</span></a>
</span><span id="CsvPath-940"><a href="#CsvPath-940"><span class="linenos"> 940</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-941"><a href="#CsvPath-941"><span class="linenos"> 941</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># pragma: no cover pylint: disable=C0116</span>
</span><span id="CsvPath-942"><a href="#CsvPath-942"><span class="linenos"> 942</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-943"><a href="#CsvPath-943"><span class="linenos"> 943</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanner</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-944"><a href="#CsvPath-944"><span class="linenos"> 944</span></a>            <span class="k">raise</span> <span class="n">ParsingException</span><span class="p">(</span><span class="s2">&quot;No scanner available. Have you parsed a csvpath?&quot;</span><span class="p">)</span>
</span><span id="CsvPath-945"><a href="#CsvPath-945"><span class="linenos"> 945</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanner</span><span class="o">.</span><span class="n">path</span>
</span><span id="CsvPath-946"><a href="#CsvPath-946"><span class="linenos"> 946</span></a>
</span><span id="CsvPath-947"><a href="#CsvPath-947"><span class="linenos"> 947</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-948"><a href="#CsvPath-948"><span class="linenos"> 948</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">these</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># pragma: no cover pylint: disable=C0116</span>
</span><span id="CsvPath-949"><a href="#CsvPath-949"><span class="linenos"> 949</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-950"><a href="#CsvPath-950"><span class="linenos"> 950</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanner</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-951"><a href="#CsvPath-951"><span class="linenos"> 951</span></a>            <span class="k">raise</span> <span class="n">ParsingException</span><span class="p">(</span><span class="s2">&quot;No scanner available. Have you parsed a csvpath?&quot;</span><span class="p">)</span>
</span><span id="CsvPath-952"><a href="#CsvPath-952"><span class="linenos"> 952</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanner</span><span class="o">.</span><span class="n">these</span>
</span><span id="CsvPath-953"><a href="#CsvPath-953"><span class="linenos"> 953</span></a>
</span><span id="CsvPath-954"><a href="#CsvPath-954"><span class="linenos"> 954</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-955"><a href="#CsvPath-955"><span class="linenos"> 955</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">limit_collection_to</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="CsvPath-956"><a href="#CsvPath-956"><span class="linenos"> 956</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private</span>
</span><span id="CsvPath-957"><a href="#CsvPath-957"><span class="linenos"> 957</span></a><span class="sd">        returns the list of headers to collect when a line matches. by default</span>
</span><span id="CsvPath-958"><a href="#CsvPath-958"><span class="linenos"> 958</span></a><span class="sd">        this list is empty and all headers are collected.</span>
</span><span id="CsvPath-959"><a href="#CsvPath-959"><span class="linenos"> 959</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CsvPath-960"><a href="#CsvPath-960"><span class="linenos"> 960</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_limit_collection_to</span>
</span><span id="CsvPath-961"><a href="#CsvPath-961"><span class="linenos"> 961</span></a>
</span><span id="CsvPath-962"><a href="#CsvPath-962"><span class="linenos"> 962</span></a>    <span class="nd">@limit_collection_to</span><span class="o">.</span><span class="n">setter</span>
</span><span id="CsvPath-963"><a href="#CsvPath-963"><span class="linenos"> 963</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">limit_collection_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indexes</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-964"><a href="#CsvPath-964"><span class="linenos"> 964</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-965"><a href="#CsvPath-965"><span class="linenos"> 965</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_limit_collection_to</span> <span class="o">=</span> <span class="n">indexes</span>
</span><span id="CsvPath-966"><a href="#CsvPath-966"><span class="linenos"> 966</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Setting a limit on headers collected: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indexes</span><span class="p">)</span>
</span><span id="CsvPath-967"><a href="#CsvPath-967"><span class="linenos"> 967</span></a>
</span><span id="CsvPath-968"><a href="#CsvPath-968"><span class="linenos"> 968</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-969"><a href="#CsvPath-969"><span class="linenos"> 969</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-970"><a href="#CsvPath-970"><span class="linenos"> 970</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stopped</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="CsvPath-971"><a href="#CsvPath-971"><span class="linenos"> 971</span></a>
</span><span id="CsvPath-972"><a href="#CsvPath-972"><span class="linenos"> 972</span></a>    <span class="c1">#</span>
</span><span id="CsvPath-973"><a href="#CsvPath-973"><span class="linenos"> 973</span></a>    <span class="c1">#</span>
</span><span id="CsvPath-974"><a href="#CsvPath-974"><span class="linenos"> 974</span></a>    <span class="c1"># collect(), fast_forward(), and next() are the central methods of CsvPath.</span>
</span><span id="CsvPath-975"><a href="#CsvPath-975"><span class="linenos"> 975</span></a>    <span class="c1">#</span>
</span><span id="CsvPath-976"><a href="#CsvPath-976"><span class="linenos"> 976</span></a>    <span class="c1"># remember that since next() is a public method and collect() and fast_forward()</span>
</span><span id="CsvPath-977"><a href="#CsvPath-977"><span class="linenos"> 977</span></a>    <span class="c1"># rely on it, we have to cut off exceptions at next(). users will not see</span>
</span><span id="CsvPath-978"><a href="#CsvPath-978"><span class="linenos"> 978</span></a>    <span class="c1"># fast_forward and collect in the stack trace. probably that&#39;s not a big deal.</span>
</span><span id="CsvPath-979"><a href="#CsvPath-979"><span class="linenos"> 979</span></a>    <span class="c1"># if it seems confusing we can work around the problem.</span>
</span><span id="CsvPath-980"><a href="#CsvPath-980"><span class="linenos"> 980</span></a>    <span class="c1">#</span>
</span><span id="CsvPath-981"><a href="#CsvPath-981"><span class="linenos"> 981</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">collect</span><span class="p">(</span>
</span><span id="CsvPath-982"><a href="#CsvPath-982"><span class="linenos"> 982</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">csvpath</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">nexts</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">lines</span><span class="o">=</span><span class="kc">None</span>
</span><span id="CsvPath-983"><a href="#CsvPath-983"><span class="linenos"> 983</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]]</span> <span class="o">|</span> <span class="n">LineSpooler</span><span class="p">:</span>
</span><span id="CsvPath-984"><a href="#CsvPath-984"><span class="linenos"> 984</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Runs the csvpath forward and returns the matching lines seen as</span>
</span><span id="CsvPath-985"><a href="#CsvPath-985"><span class="linenos"> 985</span></a><span class="sd">        a list of lists. this method does not holds lines locally, not as</span>
</span><span id="CsvPath-986"><a href="#CsvPath-986"><span class="linenos"> 986</span></a><span class="sd">        accessible attributes. lines are not kept after the run completes</span>
</span><span id="CsvPath-987"><a href="#CsvPath-987"><span class="linenos"> 987</span></a><span class="sd">        and the collected lines are returned.</span>
</span><span id="CsvPath-988"><a href="#CsvPath-988"><span class="linenos"> 988</span></a>
</span><span id="CsvPath-989"><a href="#CsvPath-989"><span class="linenos"> 989</span></a><span class="sd">        the optional lines argument may be an instance of any class that has an append(obj)</span>
</span><span id="CsvPath-990"><a href="#CsvPath-990"><span class="linenos"> 990</span></a><span class="sd">        method. if lines is None, a list is returned.</span>
</span><span id="CsvPath-991"><a href="#CsvPath-991"><span class="linenos"> 991</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CsvPath-992"><a href="#CsvPath-992"><span class="linenos"> 992</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanner</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">csvpath</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-993"><a href="#CsvPath-993"><span class="linenos"> 993</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">csvpath</span><span class="p">)</span>
</span><span id="CsvPath-994"><a href="#CsvPath-994"><span class="linenos"> 994</span></a>        <span class="k">if</span> <span class="n">nexts</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span><span id="CsvPath-995"><a href="#CsvPath-995"><span class="linenos"> 995</span></a>            <span class="k">raise</span> <span class="n">ProcessingException</span><span class="p">(</span>
</span><span id="CsvPath-996"><a href="#CsvPath-996"><span class="linenos"> 996</span></a>                <span class="s2">&quot;Input must be &gt;= -1. -1 means collect to the end of the file.&quot;</span>
</span><span id="CsvPath-997"><a href="#CsvPath-997"><span class="linenos"> 997</span></a>            <span class="p">)</span>
</span><span id="CsvPath-998"><a href="#CsvPath-998"><span class="linenos"> 998</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">collecting</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="CsvPath-999"><a href="#CsvPath-999"><span class="linenos"> 999</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-1000"><a href="#CsvPath-1000"><span class="linenos">1000</span></a>        <span class="c1"># we&#39;re going to use the passed in lines object. if it exists</span>
</span><span id="CsvPath-1001"><a href="#CsvPath-1001"><span class="linenos">1001</span></a>        <span class="c1"># it is a LineSpooler (we presume). we&#39;ll associate it with the</span>
</span><span id="CsvPath-1002"><a href="#CsvPath-1002"><span class="linenos">1002</span></a>        <span class="c1"># csvpath temporarily so anyone interested can get it. if it</span>
</span><span id="CsvPath-1003"><a href="#CsvPath-1003"><span class="linenos">1003</span></a>        <span class="c1"># doesn&#39;t exist we create a list for the lines var. we create a</span>
</span><span id="CsvPath-1004"><a href="#CsvPath-1004"><span class="linenos">1004</span></a>        <span class="c1"># list LinesSpooler to handle any inquiries during the run we</span>
</span><span id="CsvPath-1005"><a href="#CsvPath-1005"><span class="linenos">1005</span></a>        <span class="c1"># do all our line collecting busness with the local lines var</span>
</span><span id="CsvPath-1006"><a href="#CsvPath-1006"><span class="linenos">1006</span></a>        <span class="c1"># which has an append method regardless of if it is list or</span>
</span><span id="CsvPath-1007"><a href="#CsvPath-1007"><span class="linenos">1007</span></a>        <span class="c1"># LineSpooler. when we&#39;re done we break the link with the csvpath</span>
</span><span id="CsvPath-1008"><a href="#CsvPath-1008"><span class="linenos">1008</span></a>        <span class="c1"># and return the local variable. if it is a list it is going to</span>
</span><span id="CsvPath-1009"><a href="#CsvPath-1009"><span class="linenos">1009</span></a>        <span class="c1"># a csvpath user. if it is a LineSpooler it is going to a</span>
</span><span id="CsvPath-1010"><a href="#CsvPath-1010"><span class="linenos">1010</span></a>        <span class="c1"># CsvPaths instance.</span>
</span><span id="CsvPath-1011"><a href="#CsvPath-1011"><span class="linenos">1011</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-1012"><a href="#CsvPath-1012"><span class="linenos">1012</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">lines</span> <span class="o">=</span> <span class="n">lines</span>
</span><span id="CsvPath-1013"><a href="#CsvPath-1013"><span class="linenos">1013</span></a>        <span class="k">if</span> <span class="n">lines</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-1014"><a href="#CsvPath-1014"><span class="linenos">1014</span></a>            <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CsvPath-1015"><a href="#CsvPath-1015"><span class="linenos">1015</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">lines</span> <span class="o">=</span> <span class="n">ListLineSpooler</span><span class="p">(</span><span class="n">lines</span><span class="o">=</span><span class="n">lines</span><span class="p">)</span>
</span><span id="CsvPath-1016"><a href="#CsvPath-1016"><span class="linenos">1016</span></a>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">():</span>
</span><span id="CsvPath-1017"><a href="#CsvPath-1017"><span class="linenos">1017</span></a>            <span class="n">_</span> <span class="o">=</span> <span class="n">_</span><span class="p">[:]</span>
</span><span id="CsvPath-1018"><a href="#CsvPath-1018"><span class="linenos">1018</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
</span><span id="CsvPath-1019"><a href="#CsvPath-1019"><span class="linenos">1019</span></a>            <span class="k">if</span> <span class="n">nexts</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span><span id="CsvPath-1020"><a href="#CsvPath-1020"><span class="linenos">1020</span></a>                <span class="k">continue</span>
</span><span id="CsvPath-1021"><a href="#CsvPath-1021"><span class="linenos">1021</span></a>            <span class="k">if</span> <span class="n">nexts</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="CsvPath-1022"><a href="#CsvPath-1022"><span class="linenos">1022</span></a>                <span class="n">nexts</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="CsvPath-1023"><a href="#CsvPath-1023"><span class="linenos">1023</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="CsvPath-1024"><a href="#CsvPath-1024"><span class="linenos">1024</span></a>                <span class="k">break</span>
</span><span id="CsvPath-1025"><a href="#CsvPath-1025"><span class="linenos">1025</span></a>        <span class="c1"># we don&#39;t want to hold on to data more than needed. but</span>
</span><span id="CsvPath-1026"><a href="#CsvPath-1026"><span class="linenos">1026</span></a>        <span class="c1"># we do want to return data if we&#39;re not spooling. the</span>
</span><span id="CsvPath-1027"><a href="#CsvPath-1027"><span class="linenos">1027</span></a>        <span class="c1"># way we do that is to keep the local var available with the</span>
</span><span id="CsvPath-1028"><a href="#CsvPath-1028"><span class="linenos">1028</span></a>        <span class="c1"># list and/or the spooler. the caller needs to be aware of</span>
</span><span id="CsvPath-1029"><a href="#CsvPath-1029"><span class="linenos">1029</span></a>        <span class="c1"># both possibilities, but both offer __len__ and append.</span>
</span><span id="CsvPath-1030"><a href="#CsvPath-1030"><span class="linenos">1030</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-1031"><a href="#CsvPath-1031"><span class="linenos">1031</span></a>        <span class="c1"># we keep the self.lines if it is not a list because that</span>
</span><span id="CsvPath-1032"><a href="#CsvPath-1032"><span class="linenos">1032</span></a>        <span class="c1"># makes it available to the runtime data collector so we can</span>
</span><span id="CsvPath-1033"><a href="#CsvPath-1033"><span class="linenos">1033</span></a>        <span class="c1"># see the line count in the metadata, saving opening a</span>
</span><span id="CsvPath-1034"><a href="#CsvPath-1034"><span class="linenos">1034</span></a>        <span class="c1"># potentially large data.csv to find out how many lines.</span>
</span><span id="CsvPath-1035"><a href="#CsvPath-1035"><span class="linenos">1035</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="CsvPath-1036"><a href="#CsvPath-1036"><span class="linenos">1036</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">lines</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPath-1037"><a href="#CsvPath-1037"><span class="linenos">1037</span></a>        <span class="k">return</span> <span class="n">lines</span>
</span><span id="CsvPath-1038"><a href="#CsvPath-1038"><span class="linenos">1038</span></a>
</span><span id="CsvPath-1039"><a href="#CsvPath-1039"><span class="linenos">1039</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fast_forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">csvpath</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="CsvPath-1040"><a href="#CsvPath-1040"><span class="linenos">1040</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Scans to the end of the CSV file. All scanned rows will be</span>
</span><span id="CsvPath-1041"><a href="#CsvPath-1041"><span class="linenos">1041</span></a><span class="sd">        considered for match and variables and side effects will happen,</span>
</span><span id="CsvPath-1042"><a href="#CsvPath-1042"><span class="linenos">1042</span></a><span class="sd">        but no rows will be returned or stored. -1 means to the end of</span>
</span><span id="CsvPath-1043"><a href="#CsvPath-1043"><span class="linenos">1043</span></a><span class="sd">        the file. If you do not pass the csvpath string here you must first</span>
</span><span id="CsvPath-1044"><a href="#CsvPath-1044"><span class="linenos">1044</span></a><span class="sd">        use the parse method.&quot;&quot;&quot;</span>
</span><span id="CsvPath-1045"><a href="#CsvPath-1045"><span class="linenos">1045</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanner</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">csvpath</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-1046"><a href="#CsvPath-1046"><span class="linenos">1046</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">csvpath</span><span class="p">)</span>
</span><span id="CsvPath-1047"><a href="#CsvPath-1047"><span class="linenos">1047</span></a>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">():</span>
</span><span id="CsvPath-1048"><a href="#CsvPath-1048"><span class="linenos">1048</span></a>            <span class="k">pass</span>
</span><span id="CsvPath-1049"><a href="#CsvPath-1049"><span class="linenos">1049</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="CsvPath-1050"><a href="#CsvPath-1050"><span class="linenos">1050</span></a>
</span><span id="CsvPath-1051"><a href="#CsvPath-1051"><span class="linenos">1051</span></a>    <span class="c1">#</span>
</span><span id="CsvPath-1052"><a href="#CsvPath-1052"><span class="linenos">1052</span></a>    <span class="c1"># dont_raise is for the use of fast_forward and collect who</span>
</span><span id="CsvPath-1053"><a href="#CsvPath-1053"><span class="linenos">1053</span></a>    <span class="c1"># may want to handle raising errors themselves.</span>
</span><span id="CsvPath-1054"><a href="#CsvPath-1054"><span class="linenos">1054</span></a>    <span class="c1">#</span>
</span><span id="CsvPath-1055"><a href="#CsvPath-1055"><span class="linenos">1055</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">next</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">csvpath</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="CsvPath-1056"><a href="#CsvPath-1056"><span class="linenos">1056</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;A generator function that steps through the CSV file returning</span>
</span><span id="CsvPath-1057"><a href="#CsvPath-1057"><span class="linenos">1057</span></a><span class="sd">        matching rows.&quot;&quot;&quot;</span>
</span><span id="CsvPath-1058"><a href="#CsvPath-1058"><span class="linenos">1058</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="CsvPath-1059"><a href="#CsvPath-1059"><span class="linenos">1059</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanner</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">csvpath</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-1060"><a href="#CsvPath-1060"><span class="linenos">1060</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">csvpath</span><span class="p">)</span>
</span><span id="CsvPath-1061"><a href="#CsvPath-1061"><span class="linenos">1061</span></a>            <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="CsvPath-1062"><a href="#CsvPath-1062"><span class="linenos">1062</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">will_run</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="CsvPath-1063"><a href="#CsvPath-1063"><span class="linenos">1063</span></a>                <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_line</span><span class="p">():</span>
</span><span id="CsvPath-1064"><a href="#CsvPath-1064"><span class="linenos">1064</span></a>                    <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_consider_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="CsvPath-1065"><a href="#CsvPath-1065"><span class="linenos">1065</span></a>                    <span class="k">if</span> <span class="n">b</span><span class="p">:</span>
</span><span id="CsvPath-1066"><a href="#CsvPath-1066"><span class="linenos">1066</span></a>                        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">limit_collection</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="CsvPath-1067"><a href="#CsvPath-1067"><span class="linenos">1067</span></a>                        <span class="k">if</span> <span class="n">line</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-1068"><a href="#CsvPath-1068"><span class="linenos">1068</span></a>                            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Line cannot be None&quot;</span>
</span><span id="CsvPath-1069"><a href="#CsvPath-1069"><span class="linenos">1069</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="CsvPath-1070"><a href="#CsvPath-1070"><span class="linenos">1070</span></a>                            <span class="k">raise</span> <span class="n">MatchException</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="CsvPath-1071"><a href="#CsvPath-1071"><span class="linenos">1071</span></a>                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CsvPath-1072"><a href="#CsvPath-1072"><span class="linenos">1072</span></a>                            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Line cannot be len() == 0&quot;</span>
</span><span id="CsvPath-1073"><a href="#CsvPath-1073"><span class="linenos">1073</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="CsvPath-1074"><a href="#CsvPath-1074"><span class="linenos">1074</span></a>                            <span class="k">raise</span> <span class="n">MatchException</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="CsvPath-1075"><a href="#CsvPath-1075"><span class="linenos">1075</span></a>                        <span class="k">yield</span> <span class="n">line</span>
</span><span id="CsvPath-1076"><a href="#CsvPath-1076"><span class="linenos">1076</span></a>                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">collecting</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">unmatched_available</span><span class="p">:</span>
</span><span id="CsvPath-1077"><a href="#CsvPath-1077"><span class="linenos">1077</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">unmatched</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-1078"><a href="#CsvPath-1078"><span class="linenos">1078</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">unmatched</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CsvPath-1079"><a href="#CsvPath-1079"><span class="linenos">1079</span></a>                        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">limit_collection</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="CsvPath-1080"><a href="#CsvPath-1080"><span class="linenos">1080</span></a>                        <span class="c1"># we aren&#39;t None and 0 checking as above. needed?</span>
</span><span id="CsvPath-1081"><a href="#CsvPath-1081"><span class="linenos">1081</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">unmatched</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="CsvPath-1082"><a href="#CsvPath-1082"><span class="linenos">1082</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stopped</span><span class="p">:</span>
</span><span id="CsvPath-1083"><a href="#CsvPath-1083"><span class="linenos">1083</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="CsvPath-1084"><a href="#CsvPath-1084"><span class="linenos">1084</span></a>                            <span class="s2">&quot;CsvPath has been stopped at line </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="CsvPath-1085"><a href="#CsvPath-1085"><span class="linenos">1085</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">line_monitor</span><span class="o">.</span><span class="n">physical_line_number</span><span class="p">,</span>
</span><span id="CsvPath-1086"><a href="#CsvPath-1086"><span class="linenos">1086</span></a>                        <span class="p">)</span>
</span><span id="CsvPath-1087"><a href="#CsvPath-1087"><span class="linenos">1087</span></a>                        <span class="k">break</span>
</span><span id="CsvPath-1088"><a href="#CsvPath-1088"><span class="linenos">1088</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="CsvPath-1089"><a href="#CsvPath-1089"><span class="linenos">1089</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="CsvPath-1090"><a href="#CsvPath-1090"><span class="linenos">1090</span></a>                    <span class="s2">&quot;Csvpath identified as </span><span class="si">{self.identity}</span><span class="s2"> is disabled by run-mode:no-run&quot;</span>
</span><span id="CsvPath-1091"><a href="#CsvPath-1091"><span class="linenos">1091</span></a>                <span class="p">)</span>
</span><span id="CsvPath-1092"><a href="#CsvPath-1092"><span class="linenos">1092</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>
</span><span id="CsvPath-1093"><a href="#CsvPath-1093"><span class="linenos">1093</span></a>            <span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="CsvPath-1094"><a href="#CsvPath-1094"><span class="linenos">1094</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">total_iteration_time</span> <span class="o">=</span> <span class="n">end</span> <span class="o">-</span> <span class="n">start</span>
</span><span id="CsvPath-1095"><a href="#CsvPath-1095"><span class="linenos">1095</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Run against </span><span class="si">%s</span><span class="s2"> is complete.&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanner</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
</span><span id="CsvPath-1096"><a href="#CsvPath-1096"><span class="linenos">1096</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="CsvPath-1097"><a href="#CsvPath-1097"><span class="linenos">1097</span></a>                <span class="s2">&quot;Iteration time was </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">total_iteration_time</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="CsvPath-1098"><a href="#CsvPath-1098"><span class="linenos">1098</span></a>            <span class="p">)</span>
</span><span id="CsvPath-1099"><a href="#CsvPath-1099"><span class="linenos">1099</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="CsvPath-1100"><a href="#CsvPath-1100"><span class="linenos">1100</span></a>                <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> per line&quot;</span><span class="p">,</span>
</span><span id="CsvPath-1101"><a href="#CsvPath-1101"><span class="linenos">1101</span></a>                <span class="nb">round</span><span class="p">(</span>
</span><span id="CsvPath-1102"><a href="#CsvPath-1102"><span class="linenos">1102</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">total_iteration_time</span>
</span><span id="CsvPath-1103"><a href="#CsvPath-1103"><span class="linenos">1103</span></a>                    <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_monitor</span><span class="o">.</span><span class="n">physical_end_line_count</span><span class="p">,</span>
</span><span id="CsvPath-1104"><a href="#CsvPath-1104"><span class="linenos">1104</span></a>                    <span class="mi">2</span><span class="p">,</span>
</span><span id="CsvPath-1105"><a href="#CsvPath-1105"><span class="linenos">1105</span></a>                <span class="p">),</span>
</span><span id="CsvPath-1106"><a href="#CsvPath-1106"><span class="linenos">1106</span></a>            <span class="p">)</span>
</span><span id="CsvPath-1107"><a href="#CsvPath-1107"><span class="linenos">1107</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="CsvPath-1108"><a href="#CsvPath-1108"><span class="linenos">1108</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ecoms</span><span class="o">.</span><span class="n">do_i_quiet</span><span class="p">():</span>
</span><span id="CsvPath-1109"><a href="#CsvPath-1109"><span class="linenos">1109</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">exc_info</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="CsvPath-1110"><a href="#CsvPath-1110"><span class="linenos">1110</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ecoms</span><span class="o">.</span><span class="n">do_i_raise</span><span class="p">():</span>
</span><span id="CsvPath-1111"><a href="#CsvPath-1111"><span class="linenos">1111</span></a>                <span class="k">raise</span>
</span><span id="CsvPath-1112"><a href="#CsvPath-1112"><span class="linenos">1112</span></a>
</span><span id="CsvPath-1113"><a href="#CsvPath-1113"><span class="linenos">1113</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_next_line</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
</span><span id="CsvPath-1114"><a href="#CsvPath-1114"><span class="linenos">1114</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-1115"><a href="#CsvPath-1115"><span class="linenos">1115</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;beginning to scan file: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanner</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
</span><span id="CsvPath-1116"><a href="#CsvPath-1116"><span class="linenos">1116</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-1117"><a href="#CsvPath-1117"><span class="linenos">1117</span></a>        <span class="c1"># this exception will blow up a standalone CsvPath but should be</span>
</span><span id="CsvPath-1118"><a href="#CsvPath-1118"><span class="linenos">1118</span></a>        <span class="c1"># caught and handled if there is a CsvPaths.</span>
</span><span id="CsvPath-1119"><a href="#CsvPath-1119"><span class="linenos">1119</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-1120"><a href="#CsvPath-1120"><span class="linenos">1120</span></a>        <span class="c1"># but when would it happen? shouldn&#39;t we just let Python&#39;s exception</span>
</span><span id="CsvPath-1121"><a href="#CsvPath-1121"><span class="linenos">1121</span></a>        <span class="c1"># handle it should it really occur?</span>
</span><span id="CsvPath-1122"><a href="#CsvPath-1122"><span class="linenos">1122</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-1123"><a href="#CsvPath-1123"><span class="linenos">1123</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanner</span><span class="o">.</span><span class="n">filename</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-1124"><a href="#CsvPath-1124"><span class="linenos">1124</span></a>            <span class="k">raise</span> <span class="n">FileException</span><span class="p">(</span><span class="s2">&quot;There is no filename&quot;</span><span class="p">)</span>
</span><span id="CsvPath-1125"><a href="#CsvPath-1125"><span class="linenos">1125</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-1126"><a href="#CsvPath-1126"><span class="linenos">1126</span></a>        <span class="c1"># DataFileReader is abstract. instantiating it results in a concrete subclass.</span>
</span><span id="CsvPath-1127"><a href="#CsvPath-1127"><span class="linenos">1127</span></a>        <span class="c1"># pylint doesn&#39;t like that just because it doesn&#39;t see what we&#39;re doing.</span>
</span><span id="CsvPath-1128"><a href="#CsvPath-1128"><span class="linenos">1128</span></a>        <span class="c1"># otoh, is this a bad way to do it? not sure but it works fine.</span>
</span><span id="CsvPath-1129"><a href="#CsvPath-1129"><span class="linenos">1129</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-1130"><a href="#CsvPath-1130"><span class="linenos">1130</span></a>        <span class="n">reader</span> <span class="o">=</span> <span class="n">DataFileReader</span><span class="p">(</span>  <span class="c1"># pylint: disable=E0110</span>
</span><span id="CsvPath-1131"><a href="#CsvPath-1131"><span class="linenos">1131</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scanner</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">,</span> <span class="n">quotechar</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">quotechar</span>
</span><span id="CsvPath-1132"><a href="#CsvPath-1132"><span class="linenos">1132</span></a>        <span class="p">)</span>
</span><span id="CsvPath-1133"><a href="#CsvPath-1133"><span class="linenos">1133</span></a>        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">reader</span><span class="o">.</span><span class="n">next</span><span class="p">():</span>
</span><span id="CsvPath-1134"><a href="#CsvPath-1134"><span class="linenos">1134</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">track_line</span><span class="p">(</span><span class="n">line</span><span class="o">=</span><span class="n">line</span><span class="p">)</span>
</span><span id="CsvPath-1135"><a href="#CsvPath-1135"><span class="linenos">1135</span></a>            <span class="k">yield</span> <span class="n">line</span>
</span><span id="CsvPath-1136"><a href="#CsvPath-1136"><span class="linenos">1136</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>
</span><span id="CsvPath-1137"><a href="#CsvPath-1137"><span class="linenos">1137</span></a>
</span><span id="CsvPath-1138"><a href="#CsvPath-1138"><span class="linenos">1138</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">finalize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-1139"><a href="#CsvPath-1139"><span class="linenos">1139</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private</span>
</span><span id="CsvPath-1140"><a href="#CsvPath-1140"><span class="linenos">1140</span></a><span class="sd">        clears caches, etc. this is an internal method, but not _ because</span>
</span><span id="CsvPath-1141"><a href="#CsvPath-1141"><span class="linenos">1141</span></a><span class="sd">        it is part of the lifecycle and we might find a reason to call it</span>
</span><span id="CsvPath-1142"><a href="#CsvPath-1142"><span class="linenos">1142</span></a><span class="sd">        from higher up.</span>
</span><span id="CsvPath-1143"><a href="#CsvPath-1143"><span class="linenos">1143</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CsvPath-1144"><a href="#CsvPath-1144"><span class="linenos">1144</span></a>        <span class="c1"># this method can run multiple times w/np, but that</span>
</span><span id="CsvPath-1145"><a href="#CsvPath-1145"><span class="linenos">1145</span></a>        <span class="c1"># shouldn&#39;t happen anyway.</span>
</span><span id="CsvPath-1146"><a href="#CsvPath-1146"><span class="linenos">1146</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_freeze_path</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="CsvPath-1147"><a href="#CsvPath-1147"><span class="linenos">1147</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">matcher</span><span class="p">:</span>
</span><span id="CsvPath-1148"><a href="#CsvPath-1148"><span class="linenos">1148</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">matcher</span><span class="o">.</span><span class="n">clear_caches</span><span class="p">()</span>
</span><span id="CsvPath-1149"><a href="#CsvPath-1149"><span class="linenos">1149</span></a>
</span><span id="CsvPath-1150"><a href="#CsvPath-1150"><span class="linenos">1150</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">track_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-1151"><a href="#CsvPath-1151"><span class="linenos">1151</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private</span>
</span><span id="CsvPath-1152"><a href="#CsvPath-1152"><span class="linenos">1152</span></a><span class="sd">        csvpaths needs to handle some of the iteration logic, and we don&#39;t want</span>
</span><span id="CsvPath-1153"><a href="#CsvPath-1153"><span class="linenos">1153</span></a><span class="sd">        to lose track of line number monitoring or repeat the code up there,</span>
</span><span id="CsvPath-1154"><a href="#CsvPath-1154"><span class="linenos">1154</span></a><span class="sd">        so we need this method to give csvpaths a way to tap in.</span>
</span><span id="CsvPath-1155"><a href="#CsvPath-1155"><span class="linenos">1155</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CsvPath-1156"><a href="#CsvPath-1156"><span class="linenos">1156</span></a>        <span class="n">last_line</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPath-1157"><a href="#CsvPath-1157"><span class="linenos">1157</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">matcher</span><span class="p">:</span>
</span><span id="CsvPath-1158"><a href="#CsvPath-1158"><span class="linenos">1158</span></a>            <span class="n">last_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matcher</span><span class="o">.</span><span class="n">line</span>
</span><span id="CsvPath-1159"><a href="#CsvPath-1159"><span class="linenos">1159</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">line_monitor</span><span class="o">.</span><span class="n">next_line</span><span class="p">(</span><span class="n">last_line</span><span class="o">=</span><span class="n">last_line</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">line</span><span class="p">)</span>
</span><span id="CsvPath-1160"><a href="#CsvPath-1160"><span class="linenos">1160</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_monitor</span><span class="o">.</span><span class="n">physical_line_number</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CsvPath-1161"><a href="#CsvPath-1161"><span class="linenos">1161</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_run_started_at</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
</span><span id="CsvPath-1162"><a href="#CsvPath-1162"><span class="linenos">1162</span></a>
</span><span id="CsvPath-1163"><a href="#CsvPath-1163"><span class="linenos">1163</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_consider_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">):</span>  <span class="c1"># pylint: disable=R0912, R0911</span>
</span><span id="CsvPath-1164"><a href="#CsvPath-1164"><span class="linenos">1164</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-1165"><a href="#CsvPath-1165"><span class="linenos">1165</span></a>        <span class="c1"># re: R0912: this method has already been refactored but maybe</span>
</span><span id="CsvPath-1166"><a href="#CsvPath-1166"><span class="linenos">1166</span></a>        <span class="c1"># there is more we can do?</span>
</span><span id="CsvPath-1167"><a href="#CsvPath-1167"><span class="linenos">1167</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-1168"><a href="#CsvPath-1168"><span class="linenos">1168</span></a>        <span class="c1"># we always look at the last line so that last() has a</span>
</span><span id="CsvPath-1169"><a href="#CsvPath-1169"><span class="linenos">1169</span></a>        <span class="c1"># chance to run</span>
</span><span id="CsvPath-1170"><a href="#CsvPath-1170"><span class="linenos">1170</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-1171"><a href="#CsvPath-1171"><span class="linenos">1171</span></a>        <span class="c1"># if we&#39;re empty, but last, we need to make sure the</span>
</span><span id="CsvPath-1172"><a href="#CsvPath-1172"><span class="linenos">1172</span></a>        <span class="c1"># matcher runs a final time so that any last() can run.</span>
</span><span id="CsvPath-1173"><a href="#CsvPath-1173"><span class="linenos">1173</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-1174"><a href="#CsvPath-1174"><span class="linenos">1174</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_monitor</span><span class="o">.</span><span class="n">is_last_line_and_blank</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
</span><span id="CsvPath-1175"><a href="#CsvPath-1175"><span class="linenos">1175</span></a>            <span class="c1"># if self.line_monitor.is_last_line_and_empty(line):</span>
</span><span id="CsvPath-1176"><a href="#CsvPath-1176"><span class="linenos">1176</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;last line is empty. freezing, matching, returning false&quot;</span><span class="p">)</span>
</span><span id="CsvPath-1177"><a href="#CsvPath-1177"><span class="linenos">1177</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_freeze_path</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="CsvPath-1178"><a href="#CsvPath-1178"><span class="linenos">1178</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">matches</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="CsvPath-1179"><a href="#CsvPath-1179"><span class="linenos">1179</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="CsvPath-1180"><a href="#CsvPath-1180"><span class="linenos">1180</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_blank_lines</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CsvPath-1181"><a href="#CsvPath-1181"><span class="linenos">1181</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="CsvPath-1182"><a href="#CsvPath-1182"><span class="linenos">1182</span></a>                <span class="s2">&quot;Skipping line </span><span class="si">%s</span><span class="s2"> because blank&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_monitor</span><span class="o">.</span><span class="n">physical_line_number</span>
</span><span id="CsvPath-1183"><a href="#CsvPath-1183"><span class="linenos">1183</span></a>            <span class="p">)</span>
</span><span id="CsvPath-1184"><a href="#CsvPath-1184"><span class="linenos">1184</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="CsvPath-1185"><a href="#CsvPath-1185"><span class="linenos">1185</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanner</span><span class="o">.</span><span class="n">includes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">line_monitor</span><span class="o">.</span><span class="n">physical_line_number</span><span class="p">):</span>
</span><span id="CsvPath-1186"><a href="#CsvPath-1186"><span class="linenos">1186</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Scanner includes line&quot;</span><span class="p">)</span>
</span><span id="CsvPath-1187"><a href="#CsvPath-1187"><span class="linenos">1187</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scan_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scan_count</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="CsvPath-1188"><a href="#CsvPath-1188"><span class="linenos">1188</span></a>            <span class="n">matches</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPath-1189"><a href="#CsvPath-1189"><span class="linenos">1189</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_current_match_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">match_count</span>
</span><span id="CsvPath-1190"><a href="#CsvPath-1190"><span class="linenos">1190</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">advance_count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CsvPath-1191"><a href="#CsvPath-1191"><span class="linenos">1191</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">advance_count</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="CsvPath-1192"><a href="#CsvPath-1192"><span class="linenos">1192</span></a>                <span class="n">matches</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CsvPath-1193"><a href="#CsvPath-1193"><span class="linenos">1193</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="CsvPath-1194"><a href="#CsvPath-1194"><span class="linenos">1194</span></a>                    <span class="s2">&quot;Advancing one line with </span><span class="si">{self.advance_count}</span><span class="s2"> more skips to go&quot;</span>
</span><span id="CsvPath-1195"><a href="#CsvPath-1195"><span class="linenos">1195</span></a>                <span class="p">)</span>
</span><span id="CsvPath-1196"><a href="#CsvPath-1196"><span class="linenos">1196</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="CsvPath-1197"><a href="#CsvPath-1197"><span class="linenos">1197</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Starting matching&quot;</span><span class="p">)</span>
</span><span id="CsvPath-1198"><a href="#CsvPath-1198"><span class="linenos">1198</span></a>                <span class="n">startmatch</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter_ns</span><span class="p">()</span>
</span><span id="CsvPath-1199"><a href="#CsvPath-1199"><span class="linenos">1199</span></a>                <span class="n">matches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matches</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="CsvPath-1200"><a href="#CsvPath-1200"><span class="linenos">1200</span></a>                <span class="n">endmatch</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter_ns</span><span class="p">()</span>
</span><span id="CsvPath-1201"><a href="#CsvPath-1201"><span class="linenos">1201</span></a>                <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">endmatch</span> <span class="o">-</span> <span class="n">startmatch</span><span class="p">)</span> <span class="o">/</span> <span class="mi">1000000</span>
</span><span id="CsvPath-1202"><a href="#CsvPath-1202"><span class="linenos">1202</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">last_row_time</span> <span class="o">=</span> <span class="n">t</span>
</span><span id="CsvPath-1203"><a href="#CsvPath-1203"><span class="linenos">1203</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">rows_time</span> <span class="o">+=</span> <span class="n">t</span>
</span><span id="CsvPath-1204"><a href="#CsvPath-1204"><span class="linenos">1204</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="CsvPath-1205"><a href="#CsvPath-1205"><span class="linenos">1205</span></a>                    <span class="s2">&quot;CsvPath.matches:703: </span><span class="si">%s</span><span class="s2">: matches: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">identity</span><span class="p">,</span> <span class="n">matches</span>
</span><span id="CsvPath-1206"><a href="#CsvPath-1206"><span class="linenos">1206</span></a>                <span class="p">)</span>
</span><span id="CsvPath-1207"><a href="#CsvPath-1207"><span class="linenos">1207</span></a>            <span class="c1">#</span>
</span><span id="CsvPath-1208"><a href="#CsvPath-1208"><span class="linenos">1208</span></a>            <span class="c1"># if we are done scanning we can stop</span>
</span><span id="CsvPath-1209"><a href="#CsvPath-1209"><span class="linenos">1209</span></a>            <span class="c1">#</span>
</span><span id="CsvPath-1210"><a href="#CsvPath-1210"><span class="linenos">1210</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanner</span><span class="o">.</span><span class="n">is_last</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">line_monitor</span><span class="o">.</span><span class="n">physical_line_number</span><span class="p">):</span>
</span><span id="CsvPath-1211"><a href="#CsvPath-1211"><span class="linenos">1211</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</span><span id="CsvPath-1212"><a href="#CsvPath-1212"><span class="linenos">1212</span></a>            <span class="k">if</span> <span class="n">matches</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="CsvPath-1213"><a href="#CsvPath-1213"><span class="linenos">1213</span></a>                <span class="c1">#</span>
</span><span id="CsvPath-1214"><a href="#CsvPath-1214"><span class="linenos">1214</span></a>                <span class="c1"># _current_match_count is a placeholder that</span>
</span><span id="CsvPath-1215"><a href="#CsvPath-1215"><span class="linenos">1215</span></a>                <span class="c1"># allows anyone to call a match early and update</span>
</span><span id="CsvPath-1216"><a href="#CsvPath-1216"><span class="linenos">1216</span></a>                <span class="c1"># the count. this is important when there is</span>
</span><span id="CsvPath-1217"><a href="#CsvPath-1217"><span class="linenos">1217</span></a>                <span class="c1"># an onmatch component that needs to use the</span>
</span><span id="CsvPath-1218"><a href="#CsvPath-1218"><span class="linenos">1218</span></a>                <span class="c1"># match_count. e.g. an onmatch print statement.</span>
</span><span id="CsvPath-1219"><a href="#CsvPath-1219"><span class="linenos">1219</span></a>                <span class="c1"># we would want the onmatch to propagate asap. we</span>
</span><span id="CsvPath-1220"><a href="#CsvPath-1220"><span class="linenos">1220</span></a>                <span class="c1"># can accept that there could be a variable set to</span>
</span><span id="CsvPath-1221"><a href="#CsvPath-1221"><span class="linenos">1221</span></a>                <span class="c1"># match count prior to the onmatch upping the</span>
</span><span id="CsvPath-1222"><a href="#CsvPath-1222"><span class="linenos">1222</span></a>                <span class="c1"># count. that wouldn&#39;t be great for explainability,</span>
</span><span id="CsvPath-1223"><a href="#CsvPath-1223"><span class="linenos">1223</span></a>                <span class="c1"># but order is important -- match components</span>
</span><span id="CsvPath-1224"><a href="#CsvPath-1224"><span class="linenos">1224</span></a>                <span class="c1"># impact each other left to right, top to bottom.</span>
</span><span id="CsvPath-1225"><a href="#CsvPath-1225"><span class="linenos">1225</span></a>                <span class="c1">#</span>
</span><span id="CsvPath-1226"><a href="#CsvPath-1226"><span class="linenos">1226</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">raise_match_count_if</span><span class="p">()</span>
</span><span id="CsvPath-1227"><a href="#CsvPath-1227"><span class="linenos">1227</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">collect_when_not_matched</span><span class="p">:</span>
</span><span id="CsvPath-1228"><a href="#CsvPath-1228"><span class="linenos">1228</span></a>                    <span class="k">return</span> <span class="kc">False</span>
</span><span id="CsvPath-1229"><a href="#CsvPath-1229"><span class="linenos">1229</span></a>                <span class="k">return</span> <span class="kc">True</span>
</span><span id="CsvPath-1230"><a href="#CsvPath-1230"><span class="linenos">1230</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">collect_when_not_matched</span><span class="p">:</span>
</span><span id="CsvPath-1231"><a href="#CsvPath-1231"><span class="linenos">1231</span></a>                <span class="k">return</span> <span class="kc">True</span>
</span><span id="CsvPath-1232"><a href="#CsvPath-1232"><span class="linenos">1232</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="CsvPath-1233"><a href="#CsvPath-1233"><span class="linenos">1233</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="CsvPath-1234"><a href="#CsvPath-1234"><span class="linenos">1234</span></a>
</span><span id="CsvPath-1235"><a href="#CsvPath-1235"><span class="linenos">1235</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">raise_match_count_if</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="CsvPath-1236"><a href="#CsvPath-1236"><span class="linenos">1236</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private</span>
</span><span id="CsvPath-1237"><a href="#CsvPath-1237"><span class="linenos">1237</span></a><span class="sd">        if the match count has already been raised earlier in the matching</span>
</span><span id="CsvPath-1238"><a href="#CsvPath-1238"><span class="linenos">1238</span></a><span class="sd">        process than the caller we don&#39;t raise it; otherwise, we raise.&quot;&quot;&quot;</span>
</span><span id="CsvPath-1239"><a href="#CsvPath-1239"><span class="linenos">1239</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_match_count</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">match_count</span><span class="p">:</span>
</span><span id="CsvPath-1240"><a href="#CsvPath-1240"><span class="linenos">1240</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">match_count</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="CsvPath-1241"><a href="#CsvPath-1241"><span class="linenos">1241</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="CsvPath-1242"><a href="#CsvPath-1242"><span class="linenos">1242</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Match count was already raised, so not doing it again&quot;</span><span class="p">)</span>
</span><span id="CsvPath-1243"><a href="#CsvPath-1243"><span class="linenos">1243</span></a>
</span><span id="CsvPath-1244"><a href="#CsvPath-1244"><span class="linenos">1244</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">limit_collection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
</span><span id="CsvPath-1245"><a href="#CsvPath-1245"><span class="linenos">1245</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private</span>
</span><span id="CsvPath-1246"><a href="#CsvPath-1246"><span class="linenos">1246</span></a><span class="sd">        this method creates a line based on the given line that holds only the headers</span>
</span><span id="CsvPath-1247"><a href="#CsvPath-1247"><span class="linenos">1247</span></a><span class="sd">        that the csvpath says to collect. headers for collection are indicated using</span>
</span><span id="CsvPath-1248"><a href="#CsvPath-1248"><span class="linenos">1248</span></a><span class="sd">        the collect() function.</span>
</span><span id="CsvPath-1249"><a href="#CsvPath-1249"><span class="linenos">1249</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CsvPath-1250"><a href="#CsvPath-1250"><span class="linenos">1250</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">limit_collection_to</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CsvPath-1251"><a href="#CsvPath-1251"><span class="linenos">1251</span></a>            <span class="k">return</span> <span class="n">line</span>
</span><span id="CsvPath-1252"><a href="#CsvPath-1252"><span class="linenos">1252</span></a>        <span class="n">ls</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CsvPath-1253"><a href="#CsvPath-1253"><span class="linenos">1253</span></a>        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">limit_collection_to</span><span class="p">:</span>
</span><span id="CsvPath-1254"><a href="#CsvPath-1254"><span class="linenos">1254</span></a>            <span class="k">if</span> <span class="n">k</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">k</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
</span><span id="CsvPath-1255"><a href="#CsvPath-1255"><span class="linenos">1255</span></a>                <span class="k">raise</span> <span class="n">InputException</span><span class="p">(</span>
</span><span id="CsvPath-1256"><a href="#CsvPath-1256"><span class="linenos">1256</span></a>                    <span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">identity</span><span class="si">}</span><span class="s2">] Line </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">line_monitor</span><span class="o">.</span><span class="n">physical_line_number</span><span class="si">}</span><span class="s2">: unknown header name: </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="CsvPath-1257"><a href="#CsvPath-1257"><span class="linenos">1257</span></a>                <span class="p">)</span>
</span><span id="CsvPath-1258"><a href="#CsvPath-1258"><span class="linenos">1258</span></a>            <span class="n">ls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
</span><span id="CsvPath-1259"><a href="#CsvPath-1259"><span class="linenos">1259</span></a>        <span class="k">return</span> <span class="n">ls</span>
</span><span id="CsvPath-1260"><a href="#CsvPath-1260"><span class="linenos">1260</span></a>
</span><span id="CsvPath-1261"><a href="#CsvPath-1261"><span class="linenos">1261</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">advance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ff</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-1262"><a href="#CsvPath-1262"><span class="linenos">1262</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private</span>
</span><span id="CsvPath-1263"><a href="#CsvPath-1263"><span class="linenos">1263</span></a><span class="sd">        Advances the iteration by ff rows. The rows will be seen but not matched.&quot;&quot;&quot;</span>
</span><span id="CsvPath-1264"><a href="#CsvPath-1264"><span class="linenos">1264</span></a>        <span class="k">if</span> <span class="n">ff</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-1265"><a href="#CsvPath-1265"><span class="linenos">1265</span></a>            <span class="k">raise</span> <span class="n">InputException</span><span class="p">(</span><span class="s2">&quot;Input to advance must not be None&quot;</span><span class="p">)</span>
</span><span id="CsvPath-1266"><a href="#CsvPath-1266"><span class="linenos">1266</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_monitor</span><span class="o">.</span><span class="n">physical_end_line_number</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-1267"><a href="#CsvPath-1267"><span class="linenos">1267</span></a>            <span class="k">raise</span> <span class="n">ProcessingException</span><span class="p">(</span>
</span><span id="CsvPath-1268"><a href="#CsvPath-1268"><span class="linenos">1268</span></a>                <span class="s2">&quot;The last line number must be known (physical_end_line_number)&quot;</span>
</span><span id="CsvPath-1269"><a href="#CsvPath-1269"><span class="linenos">1269</span></a>            <span class="p">)</span>
</span><span id="CsvPath-1270"><a href="#CsvPath-1270"><span class="linenos">1270</span></a>        <span class="k">if</span> <span class="n">ff</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span><span id="CsvPath-1271"><a href="#CsvPath-1271"><span class="linenos">1271</span></a>            <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">advance_count</span>
</span><span id="CsvPath-1272"><a href="#CsvPath-1272"><span class="linenos">1272</span></a>            <span class="n">a</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="CsvPath-1273"><a href="#CsvPath-1273"><span class="linenos">1273</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">line_monitor</span><span class="o">.</span><span class="n">physical_end_line_number</span>
</span><span id="CsvPath-1274"><a href="#CsvPath-1274"><span class="linenos">1274</span></a>                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_monitor</span><span class="o">.</span><span class="n">physical_line_number</span>
</span><span id="CsvPath-1275"><a href="#CsvPath-1275"><span class="linenos">1275</span></a>                <span class="o">-</span> <span class="n">a</span>
</span><span id="CsvPath-1276"><a href="#CsvPath-1276"><span class="linenos">1276</span></a>            <span class="p">)</span>
</span><span id="CsvPath-1277"><a href="#CsvPath-1277"><span class="linenos">1277</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">advance_count</span> <span class="o">=</span> <span class="n">a</span>
</span><span id="CsvPath-1278"><a href="#CsvPath-1278"><span class="linenos">1278</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="CsvPath-1279"><a href="#CsvPath-1279"><span class="linenos">1279</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">advance_count</span> <span class="o">+=</span> <span class="n">ff</span>
</span><span id="CsvPath-1280"><a href="#CsvPath-1280"><span class="linenos">1280</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">advance_count</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span>
</span><span id="CsvPath-1281"><a href="#CsvPath-1281"><span class="linenos">1281</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">advance_count</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_monitor</span><span class="o">.</span><span class="n">physical_end_line_number</span>
</span><span id="CsvPath-1282"><a href="#CsvPath-1282"><span class="linenos">1282</span></a>        <span class="p">)</span>
</span><span id="CsvPath-1283"><a href="#CsvPath-1283"><span class="linenos">1283</span></a>
</span><span id="CsvPath-1284"><a href="#CsvPath-1284"><span class="linenos">1284</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_total_lines</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>  <span class="c1"># pylint: disable=C0116</span>
</span><span id="CsvPath-1285"><a href="#CsvPath-1285"><span class="linenos">1285</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-1286"><a href="#CsvPath-1286"><span class="linenos">1286</span></a>        <span class="k">if</span> <span class="p">(</span>
</span><span id="CsvPath-1287"><a href="#CsvPath-1287"><span class="linenos">1287</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">line_monitor</span><span class="o">.</span><span class="n">physical_end_line_number</span> <span class="ow">is</span> <span class="kc">None</span>
</span><span id="CsvPath-1288"><a href="#CsvPath-1288"><span class="linenos">1288</span></a>            <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_monitor</span><span class="o">.</span><span class="n">physical_end_line_number</span> <span class="o">==</span> <span class="mi">0</span>
</span><span id="CsvPath-1289"><a href="#CsvPath-1289"><span class="linenos">1289</span></a>        <span class="p">):</span>
</span><span id="CsvPath-1290"><a href="#CsvPath-1290"><span class="linenos">1290</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">get_total_lines_and_headers</span><span class="p">()</span>
</span><span id="CsvPath-1291"><a href="#CsvPath-1291"><span class="linenos">1291</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_monitor</span><span class="o">.</span><span class="n">physical_end_line_number</span>
</span><span id="CsvPath-1292"><a href="#CsvPath-1292"><span class="linenos">1292</span></a>
</span><span id="CsvPath-1293"><a href="#CsvPath-1293"><span class="linenos">1293</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_total_lines_and_headers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pylint: disable=C0116</span>
</span><span id="CsvPath-1294"><a href="#CsvPath-1294"><span class="linenos">1294</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-1295"><a href="#CsvPath-1295"><span class="linenos">1295</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanner</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanner</span><span class="o">.</span><span class="n">filename</span><span class="p">:</span>
</span><span id="CsvPath-1296"><a href="#CsvPath-1296"><span class="linenos">1296</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="CsvPath-1297"><a href="#CsvPath-1297"><span class="linenos">1297</span></a>                <span class="s2">&quot;Csvpath identified as </span><span class="si">%s</span><span class="s2"> has no filename. Since we could be error handling an exception is not raised.&quot;</span><span class="p">,</span>
</span><span id="CsvPath-1298"><a href="#CsvPath-1298"><span class="linenos">1298</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">identity</span><span class="p">,</span>
</span><span id="CsvPath-1299"><a href="#CsvPath-1299"><span class="linenos">1299</span></a>            <span class="p">)</span>
</span><span id="CsvPath-1300"><a href="#CsvPath-1300"><span class="linenos">1300</span></a>            <span class="c1"># exp</span>
</span><span id="CsvPath-1301"><a href="#CsvPath-1301"><span class="linenos">1301</span></a>            <span class="k">return</span>
</span><span id="CsvPath-1302"><a href="#CsvPath-1302"><span class="linenos">1302</span></a>            <span class="c1"># end exp</span>
</span><span id="CsvPath-1303"><a href="#CsvPath-1303"><span class="linenos">1303</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-1304"><a href="#CsvPath-1304"><span class="linenos">1304</span></a>        <span class="c1"># there are times, e.g. when using Lambda, when it may be better to</span>
</span><span id="CsvPath-1305"><a href="#CsvPath-1305"><span class="linenos">1305</span></a>        <span class="c1"># not use a cache. in the case of Lambda the reason is to avoid working</span>
</span><span id="CsvPath-1306"><a href="#CsvPath-1306"><span class="linenos">1306</span></a>        <span class="c1"># around the read-only filesystem.</span>
</span><span id="CsvPath-1307"><a href="#CsvPath-1307"><span class="linenos">1307</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-1308"><a href="#CsvPath-1308"><span class="linenos">1308</span></a>        <span class="n">use_cache</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">csvpaths</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="CsvPath-1309"><a href="#CsvPath-1309"><span class="linenos">1309</span></a>        <span class="k">if</span> <span class="n">use_cache</span><span class="p">:</span>
</span><span id="CsvPath-1310"><a href="#CsvPath-1310"><span class="linenos">1310</span></a>            <span class="n">uc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">csvpaths</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">section</span><span class="o">=</span><span class="s2">&quot;cache&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;use_cache&quot;</span><span class="p">)</span>
</span><span id="CsvPath-1311"><a href="#CsvPath-1311"><span class="linenos">1311</span></a>            <span class="n">use_cache</span> <span class="o">=</span> <span class="n">uc</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">uc</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">!=</span> <span class="s2">&quot;no&quot;</span>
</span><span id="CsvPath-1312"><a href="#CsvPath-1312"><span class="linenos">1312</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">csvpaths</span> <span class="ow">and</span> <span class="n">use_cache</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="CsvPath-1313"><a href="#CsvPath-1313"><span class="linenos">1313</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">line_monitor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">csvpaths</span><span class="o">.</span><span class="n">file_manager</span><span class="o">.</span><span class="n">cacher</span><span class="o">.</span><span class="n">get_new_line_monitor</span><span class="p">(</span>
</span><span id="CsvPath-1314"><a href="#CsvPath-1314"><span class="linenos">1314</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">scanner</span><span class="o">.</span><span class="n">filename</span>
</span><span id="CsvPath-1315"><a href="#CsvPath-1315"><span class="linenos">1315</span></a>            <span class="p">)</span>
</span><span id="CsvPath-1316"><a href="#CsvPath-1316"><span class="linenos">1316</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">headers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">csvpaths</span><span class="o">.</span><span class="n">file_manager</span><span class="o">.</span><span class="n">cacher</span><span class="o">.</span><span class="n">get_original_headers</span><span class="p">(</span>
</span><span id="CsvPath-1317"><a href="#CsvPath-1317"><span class="linenos">1317</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">scanner</span><span class="o">.</span><span class="n">filename</span>
</span><span id="CsvPath-1318"><a href="#CsvPath-1318"><span class="linenos">1318</span></a>            <span class="p">)</span>
</span><span id="CsvPath-1319"><a href="#CsvPath-1319"><span class="linenos">1319</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="CsvPath-1320"><a href="#CsvPath-1320"><span class="linenos">1320</span></a>            <span class="n">lc</span> <span class="o">=</span> <span class="n">LineCounter</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="CsvPath-1321"><a href="#CsvPath-1321"><span class="linenos">1321</span></a>            <span class="n">lm</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="n">lc</span><span class="o">.</span><span class="n">get_lines_and_headers</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scanner</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
</span><span id="CsvPath-1322"><a href="#CsvPath-1322"><span class="linenos">1322</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">line_monitor</span> <span class="o">=</span> <span class="n">lm</span>
</span><span id="CsvPath-1323"><a href="#CsvPath-1323"><span class="linenos">1323</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">headers</span> <span class="o">=</span> <span class="n">headers</span>
</span><span id="CsvPath-1324"><a href="#CsvPath-1324"><span class="linenos">1324</span></a>
</span><span id="CsvPath-1325"><a href="#CsvPath-1325"><span class="linenos">1325</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-1326"><a href="#CsvPath-1326"><span class="linenos">1326</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">current_scan_count</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>  <span class="c1"># pylint: disable=C0116</span>
</span><span id="CsvPath-1327"><a href="#CsvPath-1327"><span class="linenos">1327</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-1328"><a href="#CsvPath-1328"><span class="linenos">1328</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scan_count</span>
</span><span id="CsvPath-1329"><a href="#CsvPath-1329"><span class="linenos">1329</span></a>
</span><span id="CsvPath-1330"><a href="#CsvPath-1330"><span class="linenos">1330</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath-1331"><a href="#CsvPath-1331"><span class="linenos">1331</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">current_match_count</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>  <span class="c1"># pylint: disable=C0116</span>
</span><span id="CsvPath-1332"><a href="#CsvPath-1332"><span class="linenos">1332</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-1333"><a href="#CsvPath-1333"><span class="linenos">1333</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">match_count</span>
</span><span id="CsvPath-1334"><a href="#CsvPath-1334"><span class="linenos">1334</span></a>
</span><span id="CsvPath-1335"><a href="#CsvPath-1335"><span class="linenos">1335</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">matches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>  <span class="c1"># pylint: disable=C0116</span>
</span><span id="CsvPath-1336"><a href="#CsvPath-1336"><span class="linenos">1336</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-1337"><a href="#CsvPath-1337"><span class="linenos">1337</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">match</span><span class="p">:</span>
</span><span id="CsvPath-1338"><a href="#CsvPath-1338"><span class="linenos">1338</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="CsvPath-1339"><a href="#CsvPath-1339"><span class="linenos">1339</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-1340"><a href="#CsvPath-1340"><span class="linenos">1340</span></a>        <span class="c1"># when we first consider a line we don&#39;t have a matcher. we build</span>
</span><span id="CsvPath-1341"><a href="#CsvPath-1341"><span class="linenos">1341</span></a>        <span class="c1"># it on the fly. later, we just reset the matcher for the new lines.</span>
</span><span id="CsvPath-1342"><a href="#CsvPath-1342"><span class="linenos">1342</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-1343"><a href="#CsvPath-1343"><span class="linenos">1343</span></a>        <span class="c1"># when we originally call parse we&#39;re just parsing for the scanner:</span>
</span><span id="CsvPath-1344"><a href="#CsvPath-1344"><span class="linenos">1344</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-1345"><a href="#CsvPath-1345"><span class="linenos">1345</span></a>        <span class="c1">#   path = CsvPath()</span>
</span><span id="CsvPath-1346"><a href="#CsvPath-1346"><span class="linenos">1346</span></a>        <span class="c1">#   path.parse (&quot;$file[*][yes()]&quot;)</span>
</span><span id="CsvPath-1347"><a href="#CsvPath-1347"><span class="linenos">1347</span></a>        <span class="c1">#   path.fast_forward()</span>
</span><span id="CsvPath-1348"><a href="#CsvPath-1348"><span class="linenos">1348</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-1349"><a href="#CsvPath-1349"><span class="linenos">1349</span></a>        <span class="c1"># &quot;find_file&quot; would be a more intuitive method name. we don&#39;t create</span>
</span><span id="CsvPath-1350"><a href="#CsvPath-1350"><span class="linenos">1350</span></a>        <span class="c1"># the path&#39;s matcher until the 3rd line. by then we&#39;re on the 3rd parser</span>
</span><span id="CsvPath-1351"><a href="#CsvPath-1351"><span class="linenos">1351</span></a>        <span class="c1"># and 4 parse.</span>
</span><span id="CsvPath-1352"><a href="#CsvPath-1352"><span class="linenos">1352</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-1353"><a href="#CsvPath-1353"><span class="linenos">1353</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">matcher</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-1354"><a href="#CsvPath-1354"><span class="linenos">1354</span></a>            <span class="n">h</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">match</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
</span><span id="CsvPath-1355"><a href="#CsvPath-1355"><span class="linenos">1355</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Loading matcher with data. match part hash: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
</span><span id="CsvPath-1356"><a href="#CsvPath-1356"><span class="linenos">1356</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">matcher</span> <span class="o">=</span> <span class="n">Matcher</span><span class="p">(</span>
</span><span id="CsvPath-1357"><a href="#CsvPath-1357"><span class="linenos">1357</span></a>                <span class="n">csvpath</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">match</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="n">line</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span> <span class="n">myid</span><span class="o">=</span><span class="n">h</span>
</span><span id="CsvPath-1358"><a href="#CsvPath-1358"><span class="linenos">1358</span></a>            <span class="p">)</span>
</span><span id="CsvPath-1359"><a href="#CsvPath-1359"><span class="linenos">1359</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">matcher</span><span class="o">.</span><span class="n">AND</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">AND</span>
</span><span id="CsvPath-1360"><a href="#CsvPath-1360"><span class="linenos">1360</span></a>            <span class="c1">#</span>
</span><span id="CsvPath-1361"><a href="#CsvPath-1361"><span class="linenos">1361</span></a>            <span class="c1"># we need to register all the Expressions as error listeners. not</span>
</span><span id="CsvPath-1362"><a href="#CsvPath-1362"><span class="linenos">1362</span></a>            <span class="c1"># sure it matters if we do it here or allow the Matcher to do it.</span>
</span><span id="CsvPath-1363"><a href="#CsvPath-1363"><span class="linenos">1363</span></a>            <span class="c1"># since the Matcher is responsible for its Expressions, has a handle</span>
</span><span id="CsvPath-1364"><a href="#CsvPath-1364"><span class="linenos">1364</span></a>            <span class="c1"># this CsvPath, and through it has the error_manager let&#39;s let it</span>
</span><span id="CsvPath-1365"><a href="#CsvPath-1365"><span class="linenos">1365</span></a>            <span class="c1"># register the expressions.</span>
</span><span id="CsvPath-1366"><a href="#CsvPath-1366"><span class="linenos">1366</span></a>            <span class="c1">#</span>
</span><span id="CsvPath-1367"><a href="#CsvPath-1367"><span class="linenos">1367</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="CsvPath-1368"><a href="#CsvPath-1368"><span class="linenos">1368</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Resetting and reloading matcher&quot;</span><span class="p">)</span>
</span><span id="CsvPath-1369"><a href="#CsvPath-1369"><span class="linenos">1369</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">matcher</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
</span><span id="CsvPath-1370"><a href="#CsvPath-1370"><span class="linenos">1370</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">matcher</span><span class="o">.</span><span class="n">line</span> <span class="o">=</span> <span class="n">line</span>
</span><span id="CsvPath-1371"><a href="#CsvPath-1371"><span class="linenos">1371</span></a>        <span class="n">matched</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matcher</span><span class="o">.</span><span class="n">matches</span><span class="p">()</span>
</span><span id="CsvPath-1372"><a href="#CsvPath-1372"><span class="linenos">1372</span></a>        <span class="k">return</span> <span class="n">matched</span>
</span><span id="CsvPath-1373"><a href="#CsvPath-1373"><span class="linenos">1373</span></a>
</span><span id="CsvPath-1374"><a href="#CsvPath-1374"><span class="linenos">1374</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_variable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">tracking</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-1375"><a href="#CsvPath-1375"><span class="linenos">1375</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private</span>
</span><span id="CsvPath-1376"><a href="#CsvPath-1376"><span class="linenos">1376</span></a><span class="sd">        sets a variable and the tracking variable as a key within</span>
</span><span id="CsvPath-1377"><a href="#CsvPath-1377"><span class="linenos">1377</span></a><span class="sd">        it, if a tracking value is provided.&quot;&quot;&quot;</span>
</span><span id="CsvPath-1378"><a href="#CsvPath-1378"><span class="linenos">1378</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_freeze_path</span><span class="p">:</span>
</span><span id="CsvPath-1379"><a href="#CsvPath-1379"><span class="linenos">1379</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="CsvPath-1380"><a href="#CsvPath-1380"><span class="linenos">1380</span></a>                <span class="s2">&quot;Run is ending, variables are frozen. Cannot set </span><span class="si">%s</span><span class="s2"> to </span><span class="si">%s</span><span class="s2">.&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span>
</span><span id="CsvPath-1381"><a href="#CsvPath-1381"><span class="linenos">1381</span></a>            <span class="p">)</span>
</span><span id="CsvPath-1382"><a href="#CsvPath-1382"><span class="linenos">1382</span></a>            <span class="k">return</span>
</span><span id="CsvPath-1383"><a href="#CsvPath-1383"><span class="linenos">1383</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span><span class="p">:</span>
</span><span id="CsvPath-1384"><a href="#CsvPath-1384"><span class="linenos">1384</span></a>            <span class="k">raise</span> <span class="n">VariableException</span><span class="p">(</span>
</span><span id="CsvPath-1385"><a href="#CsvPath-1385"><span class="linenos">1385</span></a>                <span class="sa">f</span><span class="s2">&quot;Name cannot be None: name: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">, tracking: </span><span class="si">{</span><span class="n">tracking</span><span class="si">}</span><span class="s2">, value: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="CsvPath-1386"><a href="#CsvPath-1386"><span class="linenos">1386</span></a>            <span class="p">)</span>
</span><span id="CsvPath-1387"><a href="#CsvPath-1387"><span class="linenos">1387</span></a>        <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
</span><span id="CsvPath-1388"><a href="#CsvPath-1388"><span class="linenos">1388</span></a>            <span class="k">raise</span> <span class="n">VariableException</span><span class="p">(</span>
</span><span id="CsvPath-1389"><a href="#CsvPath-1389"><span class="linenos">1389</span></a>                <span class="sa">f</span><span class="s2">&quot;&quot;&quot;Name cannot be the empty string:</span>
</span><span id="CsvPath-1390"><a href="#CsvPath-1390"><span class="linenos">1390</span></a><span class="s2">                    name: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">, tracking: </span><span class="si">{</span><span class="n">tracking</span><span class="si">}</span><span class="s2">, value: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="CsvPath-1391"><a href="#CsvPath-1391"><span class="linenos">1391</span></a>            <span class="p">)</span>
</span><span id="CsvPath-1392"><a href="#CsvPath-1392"><span class="linenos">1392</span></a>        <span class="k">if</span> <span class="n">tracking</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tracking</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
</span><span id="CsvPath-1393"><a href="#CsvPath-1393"><span class="linenos">1393</span></a>            <span class="k">raise</span> <span class="n">VariableException</span><span class="p">(</span>
</span><span id="CsvPath-1394"><a href="#CsvPath-1394"><span class="linenos">1394</span></a>                <span class="sa">f</span><span class="s2">&quot;&quot;&quot;Tracking value cannot be empty.</span>
</span><span id="CsvPath-1395"><a href="#CsvPath-1395"><span class="linenos">1395</span></a><span class="s2">                    name: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">, tracking: </span><span class="si">{</span><span class="n">tracking</span><span class="si">}</span><span class="s2">, value: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="CsvPath-1396"><a href="#CsvPath-1396"><span class="linenos">1396</span></a>            <span class="p">)</span>
</span><span id="CsvPath-1397"><a href="#CsvPath-1397"><span class="linenos">1397</span></a>        <span class="k">if</span> <span class="n">tracking</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-1398"><a href="#CsvPath-1398"><span class="linenos">1398</span></a>            <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">:</span>
</span><span id="CsvPath-1399"><a href="#CsvPath-1399"><span class="linenos">1399</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="CsvPath-1400"><a href="#CsvPath-1400"><span class="linenos">1400</span></a>            <span class="n">instances</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
</span><span id="CsvPath-1401"><a href="#CsvPath-1401"><span class="linenos">1401</span></a>            <span class="n">instances</span><span class="p">[</span><span class="n">tracking</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="CsvPath-1402"><a href="#CsvPath-1402"><span class="linenos">1402</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="CsvPath-1403"><a href="#CsvPath-1403"><span class="linenos">1403</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="CsvPath-1404"><a href="#CsvPath-1404"><span class="linenos">1404</span></a>
</span><span id="CsvPath-1405"><a href="#CsvPath-1405"><span class="linenos">1405</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_variable</span><span class="p">(</span>  <span class="c1"># pylint: disable=R0912</span>
</span><span id="CsvPath-1406"><a href="#CsvPath-1406"><span class="linenos">1406</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">tracking</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">set_if_none</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPath-1407"><a href="#CsvPath-1407"><span class="linenos">1407</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
</span><span id="CsvPath-1408"><a href="#CsvPath-1408"><span class="linenos">1408</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private</span>
</span><span id="CsvPath-1409"><a href="#CsvPath-1409"><span class="linenos">1409</span></a><span class="sd">        gets a variable by name. uses the tracking value as a key to get</span>
</span><span id="CsvPath-1410"><a href="#CsvPath-1410"><span class="linenos">1410</span></a><span class="sd">        the value if the variable is a dictionary.&quot;&quot;&quot;</span>
</span><span id="CsvPath-1411"><a href="#CsvPath-1411"><span class="linenos">1411</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-1412"><a href="#CsvPath-1412"><span class="linenos">1412</span></a>        <span class="c1"># re: R0912: totally true. this is a scary method. plan to refactor.</span>
</span><span id="CsvPath-1413"><a href="#CsvPath-1413"><span class="linenos">1413</span></a>        <span class="c1">#</span>
</span><span id="CsvPath-1414"><a href="#CsvPath-1414"><span class="linenos">1414</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span><span class="p">:</span>
</span><span id="CsvPath-1415"><a href="#CsvPath-1415"><span class="linenos">1415</span></a>            <span class="k">raise</span> <span class="n">VariableException</span><span class="p">(</span><span class="s2">&quot;Name cannot be None&quot;</span><span class="p">)</span>
</span><span id="CsvPath-1416"><a href="#CsvPath-1416"><span class="linenos">1416</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_freeze_path</span><span class="p">:</span>
</span><span id="CsvPath-1417"><a href="#CsvPath-1417"><span class="linenos">1417</span></a>            <span class="c1">#</span>
</span><span id="CsvPath-1418"><a href="#CsvPath-1418"><span class="linenos">1418</span></a>            <span class="c1"># run is ending, no more changes</span>
</span><span id="CsvPath-1419"><a href="#CsvPath-1419"><span class="linenos">1419</span></a>            <span class="c1">#</span>
</span><span id="CsvPath-1420"><a href="#CsvPath-1420"><span class="linenos">1420</span></a>            <span class="n">set_if_none</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPath-1421"><a href="#CsvPath-1421"><span class="linenos">1421</span></a>        <span class="n">thevalue</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPath-1422"><a href="#CsvPath-1422"><span class="linenos">1422</span></a>        <span class="k">if</span> <span class="n">tracking</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-1423"><a href="#CsvPath-1423"><span class="linenos">1423</span></a>            <span class="n">thedict</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPath-1424"><a href="#CsvPath-1424"><span class="linenos">1424</span></a>            <span class="n">thevalue</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPath-1425"><a href="#CsvPath-1425"><span class="linenos">1425</span></a>            <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">:</span>
</span><span id="CsvPath-1426"><a href="#CsvPath-1426"><span class="linenos">1426</span></a>                <span class="n">thedict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
</span><span id="CsvPath-1427"><a href="#CsvPath-1427"><span class="linenos">1427</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">thedict</span><span class="p">:</span>
</span><span id="CsvPath-1428"><a href="#CsvPath-1428"><span class="linenos">1428</span></a>                    <span class="n">thedict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="CsvPath-1429"><a href="#CsvPath-1429"><span class="linenos">1429</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">thedict</span>
</span><span id="CsvPath-1430"><a href="#CsvPath-1430"><span class="linenos">1430</span></a>                    <span class="n">thedict</span><span class="p">[</span><span class="n">tracking</span><span class="p">]</span> <span class="o">=</span> <span class="n">set_if_none</span>
</span><span id="CsvPath-1431"><a href="#CsvPath-1431"><span class="linenos">1431</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="CsvPath-1432"><a href="#CsvPath-1432"><span class="linenos">1432</span></a>                <span class="n">thedict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="CsvPath-1433"><a href="#CsvPath-1433"><span class="linenos">1433</span></a>                <span class="n">thedict</span><span class="p">[</span><span class="n">tracking</span><span class="p">]</span> <span class="o">=</span> <span class="n">set_if_none</span>
</span><span id="CsvPath-1434"><a href="#CsvPath-1434"><span class="linenos">1434</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">thedict</span>
</span><span id="CsvPath-1435"><a href="#CsvPath-1435"><span class="linenos">1435</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">thedict</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="CsvPath-1436"><a href="#CsvPath-1436"><span class="linenos">1436</span></a>                <span class="n">thevalue</span> <span class="o">=</span> <span class="n">thedict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">tracking</span><span class="p">)</span>
</span><span id="CsvPath-1437"><a href="#CsvPath-1437"><span class="linenos">1437</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">thevalue</span> <span class="ow">and</span> <span class="n">set_if_none</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-1438"><a href="#CsvPath-1438"><span class="linenos">1438</span></a>                <span class="n">thedict</span><span class="p">[</span><span class="n">tracking</span><span class="p">]</span> <span class="o">=</span> <span class="n">set_if_none</span>
</span><span id="CsvPath-1439"><a href="#CsvPath-1439"><span class="linenos">1439</span></a>                <span class="n">thevalue</span> <span class="o">=</span> <span class="n">set_if_none</span>
</span><span id="CsvPath-1440"><a href="#CsvPath-1440"><span class="linenos">1440</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="CsvPath-1441"><a href="#CsvPath-1441"><span class="linenos">1441</span></a>            <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">:</span>
</span><span id="CsvPath-1442"><a href="#CsvPath-1442"><span class="linenos">1442</span></a>                <span class="k">if</span> <span class="n">set_if_none</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-1443"><a href="#CsvPath-1443"><span class="linenos">1443</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">set_if_none</span>
</span><span id="CsvPath-1444"><a href="#CsvPath-1444"><span class="linenos">1444</span></a>                    <span class="n">thevalue</span> <span class="o">=</span> <span class="n">set_if_none</span>
</span><span id="CsvPath-1445"><a href="#CsvPath-1445"><span class="linenos">1445</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="CsvPath-1446"><a href="#CsvPath-1446"><span class="linenos">1446</span></a>                <span class="n">thevalue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
</span><span id="CsvPath-1447"><a href="#CsvPath-1447"><span class="linenos">1447</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_freeze_path</span><span class="p">:</span>
</span><span id="CsvPath-1448"><a href="#CsvPath-1448"><span class="linenos">1448</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">thevalue</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="CsvPath-1449"><a href="#CsvPath-1449"><span class="linenos">1449</span></a>                <span class="c1">#</span>
</span><span id="CsvPath-1450"><a href="#CsvPath-1450"><span class="linenos">1450</span></a>                <span class="c1"># run is ending, no more changes</span>
</span><span id="CsvPath-1451"><a href="#CsvPath-1451"><span class="linenos">1451</span></a>                <span class="c1">#</span>
</span><span id="CsvPath-1452"><a href="#CsvPath-1452"><span class="linenos">1452</span></a>                <span class="n">thevalue</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">thevalue</span><span class="p">[:])</span>
</span><span id="CsvPath-1453"><a href="#CsvPath-1453"><span class="linenos">1453</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="CsvPath-1454"><a href="#CsvPath-1454"><span class="linenos">1454</span></a>                    <span class="s2">&quot;Returning </span><span class="si">%s</span><span class="s2"> for frozen variable </span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">thevalue</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">tracking</span>
</span><span id="CsvPath-1455"><a href="#CsvPath-1455"><span class="linenos">1455</span></a>                <span class="p">)</span>
</span><span id="CsvPath-1456"><a href="#CsvPath-1456"><span class="linenos">1456</span></a>        <span class="k">return</span> <span class="n">thevalue</span>
</span><span id="CsvPath-1457"><a href="#CsvPath-1457"><span class="linenos">1457</span></a>
</span><span id="CsvPath-1458"><a href="#CsvPath-1458"><span class="linenos">1458</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">line_numbers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="CsvPath-1459"><a href="#CsvPath-1459"><span class="linenos">1459</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private</span>
</span><span id="CsvPath-1460"><a href="#CsvPath-1460"><span class="linenos">1460</span></a><span class="sd">        returns all the line numbers the scanner will scan during</span>
</span><span id="CsvPath-1461"><a href="#CsvPath-1461"><span class="linenos">1461</span></a><span class="sd">        the run of a csvpath&quot;&quot;&quot;</span>
</span><span id="CsvPath-1462"><a href="#CsvPath-1462"><span class="linenos">1462</span></a>        <span class="n">these</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanner</span><span class="o">.</span><span class="n">these</span>
</span><span id="CsvPath-1463"><a href="#CsvPath-1463"><span class="linenos">1463</span></a>        <span class="n">from_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanner</span><span class="o">.</span><span class="n">from_line</span>
</span><span id="CsvPath-1464"><a href="#CsvPath-1464"><span class="linenos">1464</span></a>        <span class="n">to_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanner</span><span class="o">.</span><span class="n">to_line</span>
</span><span id="CsvPath-1465"><a href="#CsvPath-1465"><span class="linenos">1465</span></a>        <span class="n">all_lines</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanner</span><span class="o">.</span><span class="n">all_lines</span>
</span><span id="CsvPath-1466"><a href="#CsvPath-1466"><span class="linenos">1466</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_line_numbers</span><span class="p">(</span>
</span><span id="CsvPath-1467"><a href="#CsvPath-1467"><span class="linenos">1467</span></a>            <span class="n">these</span><span class="o">=</span><span class="n">these</span><span class="p">,</span> <span class="n">from_line</span><span class="o">=</span><span class="n">from_line</span><span class="p">,</span> <span class="n">to_line</span><span class="o">=</span><span class="n">to_line</span><span class="p">,</span> <span class="n">all_lines</span><span class="o">=</span><span class="n">all_lines</span>
</span><span id="CsvPath-1468"><a href="#CsvPath-1468"><span class="linenos">1468</span></a>        <span class="p">)</span>
</span><span id="CsvPath-1469"><a href="#CsvPath-1469"><span class="linenos">1469</span></a>
</span><span id="CsvPath-1470"><a href="#CsvPath-1470"><span class="linenos">1470</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_line_numbers</span><span class="p">(</span>
</span><span id="CsvPath-1471"><a href="#CsvPath-1471"><span class="linenos">1471</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="CsvPath-1472"><a href="#CsvPath-1472"><span class="linenos">1472</span></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="CsvPath-1473"><a href="#CsvPath-1473"><span class="linenos">1473</span></a>        <span class="n">these</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="CsvPath-1474"><a href="#CsvPath-1474"><span class="linenos">1474</span></a>        <span class="n">from_line</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="CsvPath-1475"><a href="#CsvPath-1475"><span class="linenos">1475</span></a>        <span class="n">to_line</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="CsvPath-1476"><a href="#CsvPath-1476"><span class="linenos">1476</span></a>        <span class="n">all_lines</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="CsvPath-1477"><a href="#CsvPath-1477"><span class="linenos">1477</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="CsvPath-1478"><a href="#CsvPath-1478"><span class="linenos">1478</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-1479"><a href="#CsvPath-1479"><span class="linenos">1479</span></a>        <span class="k">if</span> <span class="n">these</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-1480"><a href="#CsvPath-1480"><span class="linenos">1480</span></a>            <span class="n">these</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CsvPath-1481"><a href="#CsvPath-1481"><span class="linenos">1481</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">these</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CsvPath-1482"><a href="#CsvPath-1482"><span class="linenos">1482</span></a>            <span class="k">yield from</span> <span class="n">these</span>
</span><span id="CsvPath-1483"><a href="#CsvPath-1483"><span class="linenos">1483</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="CsvPath-1484"><a href="#CsvPath-1484"><span class="linenos">1484</span></a>            <span class="k">if</span> <span class="n">from_line</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">to_line</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">from_line</span> <span class="o">&gt;</span> <span class="n">to_line</span><span class="p">:</span>
</span><span id="CsvPath-1485"><a href="#CsvPath-1485"><span class="linenos">1485</span></a>                <span class="k">yield from</span> <span class="nb">range</span><span class="p">(</span><span class="n">to_line</span><span class="p">,</span> <span class="n">from_line</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="CsvPath-1486"><a href="#CsvPath-1486"><span class="linenos">1486</span></a>            <span class="k">elif</span> <span class="n">from_line</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">to_line</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-1487"><a href="#CsvPath-1487"><span class="linenos">1487</span></a>                <span class="k">yield from</span> <span class="nb">range</span><span class="p">(</span><span class="n">from_line</span><span class="p">,</span> <span class="n">to_line</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="CsvPath-1488"><a href="#CsvPath-1488"><span class="linenos">1488</span></a>            <span class="k">elif</span> <span class="n">from_line</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-1489"><a href="#CsvPath-1489"><span class="linenos">1489</span></a>                <span class="k">if</span> <span class="n">all_lines</span><span class="p">:</span>
</span><span id="CsvPath-1490"><a href="#CsvPath-1490"><span class="linenos">1490</span></a>                    <span class="k">yield</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">from_line</span><span class="si">}</span><span class="s2">...&quot;</span>
</span><span id="CsvPath-1491"><a href="#CsvPath-1491"><span class="linenos">1491</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="CsvPath-1492"><a href="#CsvPath-1492"><span class="linenos">1492</span></a>                    <span class="k">yield</span> <span class="n">from_line</span>
</span><span id="CsvPath-1493"><a href="#CsvPath-1493"><span class="linenos">1493</span></a>            <span class="k">elif</span> <span class="n">to_line</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-1494"><a href="#CsvPath-1494"><span class="linenos">1494</span></a>                <span class="k">yield</span> <span class="sa">f</span><span class="s2">&quot;0..</span><span class="si">{</span><span class="n">to_line</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="CsvPath-1495"><a href="#CsvPath-1495"><span class="linenos">1495</span></a>
</span><span id="CsvPath-1496"><a href="#CsvPath-1496"><span class="linenos">1496</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">collect_line_numbers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span><span class="p">]:</span>  <span class="c1"># pylint: disable=C0116</span>
</span><span id="CsvPath-1497"><a href="#CsvPath-1497"><span class="linenos">1497</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-1498"><a href="#CsvPath-1498"><span class="linenos">1498</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanner</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-1499"><a href="#CsvPath-1499"><span class="linenos">1499</span></a>            <span class="k">raise</span> <span class="n">ParsingException</span><span class="p">(</span><span class="s2">&quot;No scanner available. Have you parsed a csvpath?&quot;</span><span class="p">)</span>
</span><span id="CsvPath-1500"><a href="#CsvPath-1500"><span class="linenos">1500</span></a>        <span class="n">these</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanner</span><span class="o">.</span><span class="n">these</span>
</span><span id="CsvPath-1501"><a href="#CsvPath-1501"><span class="linenos">1501</span></a>        <span class="n">from_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanner</span><span class="o">.</span><span class="n">from_line</span>
</span><span id="CsvPath-1502"><a href="#CsvPath-1502"><span class="linenos">1502</span></a>        <span class="n">to_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanner</span><span class="o">.</span><span class="n">to_line</span>
</span><span id="CsvPath-1503"><a href="#CsvPath-1503"><span class="linenos">1503</span></a>        <span class="n">all_lines</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanner</span><span class="o">.</span><span class="n">all_lines</span>
</span><span id="CsvPath-1504"><a href="#CsvPath-1504"><span class="linenos">1504</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collect_line_numbers</span><span class="p">(</span>
</span><span id="CsvPath-1505"><a href="#CsvPath-1505"><span class="linenos">1505</span></a>            <span class="n">these</span><span class="o">=</span><span class="n">these</span><span class="p">,</span> <span class="n">from_line</span><span class="o">=</span><span class="n">from_line</span><span class="p">,</span> <span class="n">to_line</span><span class="o">=</span><span class="n">to_line</span><span class="p">,</span> <span class="n">all_lines</span><span class="o">=</span><span class="n">all_lines</span>
</span><span id="CsvPath-1506"><a href="#CsvPath-1506"><span class="linenos">1506</span></a>        <span class="p">)</span>
</span><span id="CsvPath-1507"><a href="#CsvPath-1507"><span class="linenos">1507</span></a>
</span><span id="CsvPath-1508"><a href="#CsvPath-1508"><span class="linenos">1508</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_collect_line_numbers</span><span class="p">(</span>
</span><span id="CsvPath-1509"><a href="#CsvPath-1509"><span class="linenos">1509</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="CsvPath-1510"><a href="#CsvPath-1510"><span class="linenos">1510</span></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="CsvPath-1511"><a href="#CsvPath-1511"><span class="linenos">1511</span></a>        <span class="n">these</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="CsvPath-1512"><a href="#CsvPath-1512"><span class="linenos">1512</span></a>        <span class="n">from_line</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="CsvPath-1513"><a href="#CsvPath-1513"><span class="linenos">1513</span></a>        <span class="n">to_line</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="CsvPath-1514"><a href="#CsvPath-1514"><span class="linenos">1514</span></a>        <span class="n">all_lines</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="CsvPath-1515"><a href="#CsvPath-1515"><span class="linenos">1515</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="CsvPath-1516"><a href="#CsvPath-1516"><span class="linenos">1516</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-1517"><a href="#CsvPath-1517"><span class="linenos">1517</span></a>        <span class="n">collect</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CsvPath-1518"><a href="#CsvPath-1518"><span class="linenos">1518</span></a>        <span class="k">if</span> <span class="n">these</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath-1519"><a href="#CsvPath-1519"><span class="linenos">1519</span></a>            <span class="n">these</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CsvPath-1520"><a href="#CsvPath-1520"><span class="linenos">1520</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_line_numbers</span><span class="p">(</span>
</span><span id="CsvPath-1521"><a href="#CsvPath-1521"><span class="linenos">1521</span></a>            <span class="n">these</span><span class="o">=</span><span class="n">these</span><span class="p">,</span> <span class="n">from_line</span><span class="o">=</span><span class="n">from_line</span><span class="p">,</span> <span class="n">to_line</span><span class="o">=</span><span class="n">to_line</span><span class="p">,</span> <span class="n">all_lines</span><span class="o">=</span><span class="n">all_lines</span>
</span><span id="CsvPath-1522"><a href="#CsvPath-1522"><span class="linenos">1522</span></a>        <span class="p">):</span>
</span><span id="CsvPath-1523"><a href="#CsvPath-1523"><span class="linenos">1523</span></a>            <span class="n">collect</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="CsvPath-1524"><a href="#CsvPath-1524"><span class="linenos">1524</span></a>        <span class="k">return</span> <span class="n">collect</span>
</span><span id="CsvPath-1525"><a href="#CsvPath-1525"><span class="linenos">1525</span></a>
</span><span id="CsvPath-1526"><a href="#CsvPath-1526"><span class="linenos">1526</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">header_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>  <span class="c1"># pylint: disable=C0116</span>
</span><span id="CsvPath-1527"><a href="#CsvPath-1527"><span class="linenos">1527</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPath-1528"><a href="#CsvPath-1528"><span class="linenos">1528</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">:</span>
</span><span id="CsvPath-1529"><a href="#CsvPath-1529"><span class="linenos">1529</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="CsvPath-1530"><a href="#CsvPath-1530"><span class="linenos">1530</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">):</span>
</span><span id="CsvPath-1531"><a href="#CsvPath-1531"><span class="linenos">1531</span></a>            <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
</span><span id="CsvPath-1532"><a href="#CsvPath-1532"><span class="linenos">1532</span></a>                <span class="k">return</span> <span class="n">i</span>
</span><span id="CsvPath-1533"><a href="#CsvPath-1533"><span class="linenos">1533</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span></pre></div>


            <div class="docstring"><p>CsvPath represents a csvpath string that contains a reference to
a file, scanning instructions, and rules for matching lines.</p>
</div>


                            <div id="CsvPath.__init__" class="classattr">
                                        <input id="CsvPath.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">CsvPath</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">csvpaths</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span>,</span><span class="param">	<span class="n">quotechar</span><span class="o">=</span><span class="s1">&#39;&quot;&#39;</span>,</span><span class="param">	<span class="n">skip_blank_lines</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">print_default</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">config</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">error_manager</span><span class="o">=</span><span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="CsvPath.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPath.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPath.__init__-46"><a href="#CsvPath.__init__-46"><span class="linenos"> 46</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>  <span class="c1"># pylint: disable=R0913</span>
</span><span id="CsvPath.__init__-47"><a href="#CsvPath.__init__-47"><span class="linenos"> 47</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="CsvPath.__init__-48"><a href="#CsvPath.__init__-48"><span class="linenos"> 48</span></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="CsvPath.__init__-49"><a href="#CsvPath.__init__-49"><span class="linenos"> 49</span></a>        <span class="n">csvpaths</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="CsvPath.__init__-50"><a href="#CsvPath.__init__-50"><span class="linenos"> 50</span></a>        <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span>
</span><span id="CsvPath.__init__-51"><a href="#CsvPath.__init__-51"><span class="linenos"> 51</span></a>        <span class="n">quotechar</span><span class="o">=</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span>
</span><span id="CsvPath.__init__-52"><a href="#CsvPath.__init__-52"><span class="linenos"> 52</span></a>        <span class="n">skip_blank_lines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="CsvPath.__init__-53"><a href="#CsvPath.__init__-53"><span class="linenos"> 53</span></a>        <span class="n">print_default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="CsvPath.__init__-54"><a href="#CsvPath.__init__-54"><span class="linenos"> 54</span></a>        <span class="n">config</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="CsvPath.__init__-55"><a href="#CsvPath.__init__-55"><span class="linenos"> 55</span></a>        <span class="n">error_manager</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="CsvPath.__init__-56"><a href="#CsvPath.__init__-56"><span class="linenos"> 56</span></a>    <span class="p">):</span>
</span><span id="CsvPath.__init__-57"><a href="#CsvPath.__init__-57"><span class="linenos"> 57</span></a>        <span class="c1"># re: R0913: all reasonable pass-ins with sensible defaults</span>
</span><span id="CsvPath.__init__-58"><a href="#CsvPath.__init__-58"><span class="linenos"> 58</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-59"><a href="#CsvPath.__init__-59"><span class="linenos"> 59</span></a>        <span class="c1"># the config.ini file loaded as a ConfigParser instance</span>
</span><span id="CsvPath.__init__-60"><a href="#CsvPath.__init__-60"><span class="linenos"> 60</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-61"><a href="#CsvPath.__init__-61"><span class="linenos"> 61</span></a>        <span class="c1"># definitely do not want this coming from CsvPaths because</span>
</span><span id="CsvPath.__init__-62"><a href="#CsvPath.__init__-62"><span class="linenos"> 62</span></a>        <span class="c1"># we want to be able to override config.ini specifically for</span>
</span><span id="CsvPath.__init__-63"><a href="#CsvPath.__init__-63"><span class="linenos"> 63</span></a>        <span class="c1"># this instance, if needed; however, we do want to be able</span>
</span><span id="CsvPath.__init__-64"><a href="#CsvPath.__init__-64"><span class="linenos"> 64</span></a>        <span class="c1"># to pass in a config object that has been configured in some</span>
</span><span id="CsvPath.__init__-65"><a href="#CsvPath.__init__-65"><span class="linenos"> 65</span></a>        <span class="c1"># way.</span>
</span><span id="CsvPath.__init__-66"><a href="#CsvPath.__init__-66"><span class="linenos"> 66</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_config</span> <span class="o">=</span> <span class="n">config</span>
</span><span id="CsvPath.__init__-67"><a href="#CsvPath.__init__-67"><span class="linenos"> 67</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scanner</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPath.__init__-68"><a href="#CsvPath.__init__-68"><span class="linenos"> 68</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="CsvPath.__init__-69"><a href="#CsvPath.__init__-69"><span class="linenos"> 69</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">matcher</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPath.__init__-70"><a href="#CsvPath.__init__-70"><span class="linenos"> 70</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="CsvPath.__init__-71"><a href="#CsvPath.__init__-71"><span class="linenos"> 71</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-72"><a href="#CsvPath.__init__-72"><span class="linenos"> 72</span></a>        <span class="c1"># a parent CsvPaths may manage a CsvPath instance. if so, it will enable</span>
</span><span id="CsvPath.__init__-73"><a href="#CsvPath.__init__-73"><span class="linenos"> 73</span></a>        <span class="c1"># the use of named files and named paths, print capture, error handling,</span>
</span><span id="CsvPath.__init__-74"><a href="#CsvPath.__init__-74"><span class="linenos"> 74</span></a>        <span class="c1"># results collection, reference handling, etc. if a CsvPaths is not present</span>
</span><span id="CsvPath.__init__-75"><a href="#CsvPath.__init__-75"><span class="linenos"> 75</span></a>        <span class="c1"># the CsvPath instance is responsible for all its own upkeep and does not</span>
</span><span id="CsvPath.__init__-76"><a href="#CsvPath.__init__-76"><span class="linenos"> 76</span></a>        <span class="c1"># have some of those capabilities.</span>
</span><span id="CsvPath.__init__-77"><a href="#CsvPath.__init__-77"><span class="linenos"> 77</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-78"><a href="#CsvPath.__init__-78"><span class="linenos"> 78</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">csvpaths</span> <span class="o">=</span> <span class="n">csvpaths</span>
</span><span id="CsvPath.__init__-79"><a href="#CsvPath.__init__-79"><span class="linenos"> 79</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="CsvPath.__init__-80"><a href="#CsvPath.__init__-80"><span class="linenos"> 80</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-81"><a href="#CsvPath.__init__-81"><span class="linenos"> 81</span></a>        <span class="c1"># there are two logger components one for CsvPath and one for CsvPaths.</span>
</span><span id="CsvPath.__init__-82"><a href="#CsvPath.__init__-82"><span class="linenos"> 82</span></a>        <span class="c1"># the default levels are set in config.ini. to change the levels pass LogUtility</span>
</span><span id="CsvPath.__init__-83"><a href="#CsvPath.__init__-83"><span class="linenos"> 83</span></a>        <span class="c1"># your component instance and the logging level. e.g.:</span>
</span><span id="CsvPath.__init__-84"><a href="#CsvPath.__init__-84"><span class="linenos"> 84</span></a>        <span class="c1"># LogUtility.logger(csvpath, &quot;debug&quot;)</span>
</span><span id="CsvPath.__init__-85"><a href="#CsvPath.__init__-85"><span class="linenos"> 85</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-86"><a href="#CsvPath.__init__-86"><span class="linenos"> 86</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">LogUtility</span><span class="o">.</span><span class="n">logger</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="CsvPath.__init__-87"><a href="#CsvPath.__init__-87"><span class="linenos"> 87</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="CsvPath.__init__-88"><a href="#CsvPath.__init__-88"><span class="linenos"> 88</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;initialized CsvPath&quot;</span><span class="p">)</span>
</span><span id="CsvPath.__init__-89"><a href="#CsvPath.__init__-89"><span class="linenos"> 89</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-90"><a href="#CsvPath.__init__-90"><span class="linenos"> 90</span></a>        <span class="c1"># if we don&#39;t have a csvpaths these will both be None</span>
</span><span id="CsvPath.__init__-91"><a href="#CsvPath.__init__-91"><span class="linenos"> 91</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-92"><a href="#CsvPath.__init__-92"><span class="linenos"> 92</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">named_paths_name</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPath.__init__-93"><a href="#CsvPath.__init__-93"><span class="linenos"> 93</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="CsvPath.__init__-94"><a href="#CsvPath.__init__-94"><span class="linenos"> 94</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">named_file_name</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPath.__init__-95"><a href="#CsvPath.__init__-95"><span class="linenos"> 95</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="CsvPath.__init__-96"><a href="#CsvPath.__init__-96"><span class="linenos"> 96</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-97"><a href="#CsvPath.__init__-97"><span class="linenos"> 97</span></a>        <span class="c1"># all errors come to our manager if they occur during matching. we use</span>
</span><span id="CsvPath.__init__-98"><a href="#CsvPath.__init__-98"><span class="linenos"> 98</span></a>        <span class="c1"># the CsvPaths manager if possible. Otherwise, we just make our own that</span>
</span><span id="CsvPath.__init__-99"><a href="#CsvPath.__init__-99"><span class="linenos"> 99</span></a>        <span class="c1"># only knows how to collect errors, not distribute them.</span>
</span><span id="CsvPath.__init__-100"><a href="#CsvPath.__init__-100"><span class="linenos">100</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-101"><a href="#CsvPath.__init__-101"><span class="linenos">101</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ecoms</span> <span class="o">=</span> <span class="n">ErrorCommunications</span><span class="p">(</span><span class="n">csvpath</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="CsvPath.__init__-102"><a href="#CsvPath.__init__-102"><span class="linenos">102</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="CsvPath.__init__-103"><a href="#CsvPath.__init__-103"><span class="linenos">103</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">error_manager</span> <span class="o">=</span> <span class="n">ErrorManager</span><span class="p">(</span><span class="n">csvpath</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="CsvPath.__init__-104"><a href="#CsvPath.__init__-104"><span class="linenos">104</span></a>        <span class="k">if</span> <span class="n">csvpaths</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath.__init__-105"><a href="#CsvPath.__init__-105"><span class="linenos">105</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">error_manager</span><span class="o">.</span><span class="n">add_internal_listener</span><span class="p">(</span><span class="n">csvpaths</span><span class="o">.</span><span class="n">error_manager</span><span class="p">)</span>
</span><span id="CsvPath.__init__-106"><a href="#CsvPath.__init__-106"><span class="linenos">106</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-107"><a href="#CsvPath.__init__-107"><span class="linenos">107</span></a>        <span class="c1"># modes are set in external comments</span>
</span><span id="CsvPath.__init__-108"><a href="#CsvPath.__init__-108"><span class="linenos">108</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-109"><a href="#CsvPath.__init__-109"><span class="linenos">109</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">modes</span> <span class="o">=</span> <span class="n">ModeController</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="CsvPath.__init__-110"><a href="#CsvPath.__init__-110"><span class="linenos">110</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="CsvPath.__init__-111"><a href="#CsvPath.__init__-111"><span class="linenos">111</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-112"><a href="#CsvPath.__init__-112"><span class="linenos">112</span></a>        <span class="c1"># captures the number of lines up front and tracks line stats as the</span>
</span><span id="CsvPath.__init__-113"><a href="#CsvPath.__init__-113"><span class="linenos">113</span></a>        <span class="c1"># run progresses</span>
</span><span id="CsvPath.__init__-114"><a href="#CsvPath.__init__-114"><span class="linenos">114</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-115"><a href="#CsvPath.__init__-115"><span class="linenos">115</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_line_monitor</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPath.__init__-116"><a href="#CsvPath.__init__-116"><span class="linenos">116</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-117"><a href="#CsvPath.__init__-117"><span class="linenos">117</span></a>        <span class="c1"># the scanning part of the csvpath. e.g. $test.csv[*]</span>
</span><span id="CsvPath.__init__-118"><a href="#CsvPath.__init__-118"><span class="linenos">118</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-119"><a href="#CsvPath.__init__-119"><span class="linenos">119</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scan</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPath.__init__-120"><a href="#CsvPath.__init__-120"><span class="linenos">120</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="CsvPath.__init__-121"><a href="#CsvPath.__init__-121"><span class="linenos">121</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-122"><a href="#CsvPath.__init__-122"><span class="linenos">122</span></a>        <span class="c1"># the matching part of the csvpath. e.g. [yes()]</span>
</span><span id="CsvPath.__init__-123"><a href="#CsvPath.__init__-123"><span class="linenos">123</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-124"><a href="#CsvPath.__init__-124"><span class="linenos">124</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">match</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPath.__init__-125"><a href="#CsvPath.__init__-125"><span class="linenos">125</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="CsvPath.__init__-126"><a href="#CsvPath.__init__-126"><span class="linenos">126</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-127"><a href="#CsvPath.__init__-127"><span class="linenos">127</span></a>        <span class="c1"># when True the lines that do not match are returned from next()</span>
</span><span id="CsvPath.__init__-128"><a href="#CsvPath.__init__-128"><span class="linenos">128</span></a>        <span class="c1"># and collect(). this effectively switches CsvPath from being an</span>
</span><span id="CsvPath.__init__-129"><a href="#CsvPath.__init__-129"><span class="linenos">129</span></a>        <span class="c1"># create an OR expression in this case. in the default, we say:</span>
</span><span id="CsvPath.__init__-130"><a href="#CsvPath.__init__-130"><span class="linenos">130</span></a>        <span class="c1">#     are all of these things true?</span>
</span><span id="CsvPath.__init__-131"><a href="#CsvPath.__init__-131"><span class="linenos">131</span></a>        <span class="c1"># but when collect_when_not_matched is True we ask:</span>
</span><span id="CsvPath.__init__-132"><a href="#CsvPath.__init__-132"><span class="linenos">132</span></a>        <span class="c1">#     are any of these things not true?</span>
</span><span id="CsvPath.__init__-133"><a href="#CsvPath.__init__-133"><span class="linenos">133</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-134"><a href="#CsvPath.__init__-134"><span class="linenos">134</span></a>        <span class="c1"># self._when_not_matched = False</span>
</span><span id="CsvPath.__init__-135"><a href="#CsvPath.__init__-135"><span class="linenos">135</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_headers</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPath.__init__-136"><a href="#CsvPath.__init__-136"><span class="linenos">136</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="CsvPath.__init__-137"><a href="#CsvPath.__init__-137"><span class="linenos">137</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span> <span class="o">=</span> <span class="n">delimiter</span>
</span><span id="CsvPath.__init__-138"><a href="#CsvPath.__init__-138"><span class="linenos">138</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">quotechar</span> <span class="o">=</span> <span class="n">quotechar</span>
</span><span id="CsvPath.__init__-139"><a href="#CsvPath.__init__-139"><span class="linenos">139</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-140"><a href="#CsvPath.__init__-140"><span class="linenos">140</span></a>        <span class="c1"># a blank line has no headers. it has no data. physically it is 2 \n with</span>
</span><span id="CsvPath.__init__-141"><a href="#CsvPath.__init__-141"><span class="linenos">141</span></a>        <span class="c1"># nothing but whitespace between them. any data or any delimiters would make</span>
</span><span id="CsvPath.__init__-142"><a href="#CsvPath.__init__-142"><span class="linenos">142</span></a>        <span class="c1"># the line non-blank.</span>
</span><span id="CsvPath.__init__-143"><a href="#CsvPath.__init__-143"><span class="linenos">143</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-144"><a href="#CsvPath.__init__-144"><span class="linenos">144</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">skip_blank_lines</span> <span class="o">=</span> <span class="n">skip_blank_lines</span>
</span><span id="CsvPath.__init__-145"><a href="#CsvPath.__init__-145"><span class="linenos">145</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-146"><a href="#CsvPath.__init__-146"><span class="linenos">146</span></a>        <span class="c1"># in the case of a [*] scan where the last line is blank we would miss firing</span>
</span><span id="CsvPath.__init__-147"><a href="#CsvPath.__init__-147"><span class="linenos">147</span></a>        <span class="c1"># last() unless we take steps. instead, we allow that line to match, but we</span>
</span><span id="CsvPath.__init__-148"><a href="#CsvPath.__init__-148"><span class="linenos">148</span></a>        <span class="c1"># do not return a line to the caller of next() and we freeze the variables</span>
</span><span id="CsvPath.__init__-149"><a href="#CsvPath.__init__-149"><span class="linenos">149</span></a>        <span class="c1"># there is room for side effects make changes, but that a reasonable compromise</span>
</span><span id="CsvPath.__init__-150"><a href="#CsvPath.__init__-150"><span class="linenos">150</span></a>        <span class="c1"># between missing last and allowing unwanted changes. we definitely do not</span>
</span><span id="CsvPath.__init__-151"><a href="#CsvPath.__init__-151"><span class="linenos">151</span></a>        <span class="c1"># freeze is_valid or stop, which can be useful signaling, even in an</span>
</span><span id="CsvPath.__init__-152"><a href="#CsvPath.__init__-152"><span class="linenos">152</span></a>        <span class="c1"># inconsistent state.</span>
</span><span id="CsvPath.__init__-153"><a href="#CsvPath.__init__-153"><span class="linenos">153</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-154"><a href="#CsvPath.__init__-154"><span class="linenos">154</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_freeze_path</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CsvPath.__init__-155"><a href="#CsvPath.__init__-155"><span class="linenos">155</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-156"><a href="#CsvPath.__init__-156"><span class="linenos">156</span></a>        <span class="c1"># counts are 1-based</span>
</span><span id="CsvPath.__init__-157"><a href="#CsvPath.__init__-157"><span class="linenos">157</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-158"><a href="#CsvPath.__init__-158"><span class="linenos">158</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scan_count</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="CsvPath.__init__-159"><a href="#CsvPath.__init__-159"><span class="linenos">159</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">match_count</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="CsvPath.__init__-160"><a href="#CsvPath.__init__-160"><span class="linenos">160</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-161"><a href="#CsvPath.__init__-161"><span class="linenos">161</span></a>        <span class="c1"># used by stop() and advance(). a stopped CsvPath halts without finishing</span>
</span><span id="CsvPath.__init__-162"><a href="#CsvPath.__init__-162"><span class="linenos">162</span></a>        <span class="c1"># its run. an advancing CsvPath doesn&#39;t consider the match part of the</span>
</span><span id="CsvPath.__init__-163"><a href="#CsvPath.__init__-163"><span class="linenos">163</span></a>        <span class="c1"># csvpath and does not incur any side effects as it progresses through the</span>
</span><span id="CsvPath.__init__-164"><a href="#CsvPath.__init__-164"><span class="linenos">164</span></a>        <span class="c1"># rows the advance skips. the skip() function has the same effect as</span>
</span><span id="CsvPath.__init__-165"><a href="#CsvPath.__init__-165"><span class="linenos">165</span></a>        <span class="c1"># advance(1) but without any guarantee that the other match components on</span>
</span><span id="CsvPath.__init__-166"><a href="#CsvPath.__init__-166"><span class="linenos">166</span></a>        <span class="c1"># the line will be considered before skipping ahead. there are likely</span>
</span><span id="CsvPath.__init__-167"><a href="#CsvPath.__init__-167"><span class="linenos">167</span></a>        <span class="c1"># corner cases where an onmatch qualifier or some other constraint will</span>
</span><span id="CsvPath.__init__-168"><a href="#CsvPath.__init__-168"><span class="linenos">168</span></a>        <span class="c1"># trigger match components that would otherwise be skipped so the ability</span>
</span><span id="CsvPath.__init__-169"><a href="#CsvPath.__init__-169"><span class="linenos">169</span></a>        <span class="c1"># to shortcut some of the match should not be relied on for anything</span>
</span><span id="CsvPath.__init__-170"><a href="#CsvPath.__init__-170"><span class="linenos">170</span></a>        <span class="c1"># critical.</span>
</span><span id="CsvPath.__init__-171"><a href="#CsvPath.__init__-171"><span class="linenos">171</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-172"><a href="#CsvPath.__init__-172"><span class="linenos">172</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stopped</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CsvPath.__init__-173"><a href="#CsvPath.__init__-173"><span class="linenos">173</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_advance</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="CsvPath.__init__-174"><a href="#CsvPath.__init__-174"><span class="linenos">174</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-175"><a href="#CsvPath.__init__-175"><span class="linenos">175</span></a>        <span class="c1"># the lines var will hold a reference to a LineSpooler instance during a</span>
</span><span id="CsvPath.__init__-176"><a href="#CsvPath.__init__-176"><span class="linenos">176</span></a>        <span class="c1"># run, if lines are being collected by the collect() method. if the user</span>
</span><span id="CsvPath.__init__-177"><a href="#CsvPath.__init__-177"><span class="linenos">177</span></a>        <span class="c1"># is using this CsvPath instance directly the LineSpooler is only there</span>
</span><span id="CsvPath.__init__-178"><a href="#CsvPath.__init__-178"><span class="linenos">178</span></a>        <span class="c1"># as a proxy to the list of lines being collected -- we don&#39;t spool to</span>
</span><span id="CsvPath.__init__-179"><a href="#CsvPath.__init__-179"><span class="linenos">179</span></a>        <span class="c1"># disk, at least atm.</span>
</span><span id="CsvPath.__init__-180"><a href="#CsvPath.__init__-180"><span class="linenos">180</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-181"><a href="#CsvPath.__init__-181"><span class="linenos">181</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">lines</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPath.__init__-182"><a href="#CsvPath.__init__-182"><span class="linenos">182</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="CsvPath.__init__-183"><a href="#CsvPath.__init__-183"><span class="linenos">183</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-184"><a href="#CsvPath.__init__-184"><span class="linenos">184</span></a>        <span class="c1"># set by fail()</span>
</span><span id="CsvPath.__init__-185"><a href="#CsvPath.__init__-185"><span class="linenos">185</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-186"><a href="#CsvPath.__init__-186"><span class="linenos">186</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_is_valid</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="CsvPath.__init__-187"><a href="#CsvPath.__init__-187"><span class="linenos">187</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-188"><a href="#CsvPath.__init__-188"><span class="linenos">188</span></a>        <span class="c1"># basic timing for the CsvPath instance only. if the CsvPath is managed</span>
</span><span id="CsvPath.__init__-189"><a href="#CsvPath.__init__-189"><span class="linenos">189</span></a>        <span class="c1"># by a CsvPaths the timings for a run may include time spent by other</span>
</span><span id="CsvPath.__init__-190"><a href="#CsvPath.__init__-190"><span class="linenos">190</span></a>        <span class="c1"># CsvPath instances.</span>
</span><span id="CsvPath.__init__-191"><a href="#CsvPath.__init__-191"><span class="linenos">191</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-192"><a href="#CsvPath.__init__-192"><span class="linenos">192</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">last_row_time</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="CsvPath.__init__-193"><a href="#CsvPath.__init__-193"><span class="linenos">193</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="CsvPath.__init__-194"><a href="#CsvPath.__init__-194"><span class="linenos">194</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rows_time</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="CsvPath.__init__-195"><a href="#CsvPath.__init__-195"><span class="linenos">195</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="CsvPath.__init__-196"><a href="#CsvPath.__init__-196"><span class="linenos">196</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">total_iteration_time</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="CsvPath.__init__-197"><a href="#CsvPath.__init__-197"><span class="linenos">197</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="CsvPath.__init__-198"><a href="#CsvPath.__init__-198"><span class="linenos">198</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-199"><a href="#CsvPath.__init__-199"><span class="linenos">199</span></a>        <span class="c1"># limiting collection means returning fewer headers (values in the</span>
</span><span id="CsvPath.__init__-200"><a href="#CsvPath.__init__-200"><span class="linenos">200</span></a>        <span class="c1"># line, a.k.a columns) then are available. limiting headers returned</span>
</span><span id="CsvPath.__init__-201"><a href="#CsvPath.__init__-201"><span class="linenos">201</span></a>        <span class="c1"># can impact named results, reset_headers(), and other considerations.</span>
</span><span id="CsvPath.__init__-202"><a href="#CsvPath.__init__-202"><span class="linenos">202</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-203"><a href="#CsvPath.__init__-203"><span class="linenos">203</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_limit_collection_to</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CsvPath.__init__-204"><a href="#CsvPath.__init__-204"><span class="linenos">204</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-205"><a href="#CsvPath.__init__-205"><span class="linenos">205</span></a>        <span class="c1"># error collecting is at the CsvPath instance by default. CsvPath</span>
</span><span id="CsvPath.__init__-206"><a href="#CsvPath.__init__-206"><span class="linenos">206</span></a>        <span class="c1"># instances that are managed by a CsvPaths have their errors collected</span>
</span><span id="CsvPath.__init__-207"><a href="#CsvPath.__init__-207"><span class="linenos">207</span></a>        <span class="c1"># by their Results as well. Result handles persistence.</span>
</span><span id="CsvPath.__init__-208"><a href="#CsvPath.__init__-208"><span class="linenos">208</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-209"><a href="#CsvPath.__init__-209"><span class="linenos">209</span></a>        <span class="c1"># errors policies are set in config.ini at CsvPath and CsvPaths levels.</span>
</span><span id="CsvPath.__init__-210"><a href="#CsvPath.__init__-210"><span class="linenos">210</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-211"><a href="#CsvPath.__init__-211"><span class="linenos">211</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Error</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CsvPath.__init__-212"><a href="#CsvPath.__init__-212"><span class="linenos">212</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-213"><a href="#CsvPath.__init__-213"><span class="linenos">213</span></a>        <span class="c1"># saves the scan and match parts of paths for reference. mainly helpful</span>
</span><span id="CsvPath.__init__-214"><a href="#CsvPath.__init__-214"><span class="linenos">214</span></a>        <span class="c1"># for testing the CsvPath library itself; not used end users. the run</span>
</span><span id="CsvPath.__init__-215"><a href="#CsvPath.__init__-215"><span class="linenos">215</span></a>        <span class="c1"># name becomes the file name of the saved path parts.</span>
</span><span id="CsvPath.__init__-216"><a href="#CsvPath.__init__-216"><span class="linenos">216</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-217"><a href="#CsvPath.__init__-217"><span class="linenos">217</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_save_scan_dir</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPath.__init__-218"><a href="#CsvPath.__init__-218"><span class="linenos">218</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_save_match_dir</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPath.__init__-219"><a href="#CsvPath.__init__-219"><span class="linenos">219</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_run_name</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPath.__init__-220"><a href="#CsvPath.__init__-220"><span class="linenos">220</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-221"><a href="#CsvPath.__init__-221"><span class="linenos">221</span></a>        <span class="c1"># metadata is collected from &quot;outer&quot; csvpath comments. outer comments</span>
</span><span id="CsvPath.__init__-222"><a href="#CsvPath.__init__-222"><span class="linenos">222</span></a>        <span class="c1"># separate from the comments within the match part of the csvpath.</span>
</span><span id="CsvPath.__init__-223"><a href="#CsvPath.__init__-223"><span class="linenos">223</span></a>        <span class="c1"># the keys are words with colons. e.g. ~ name: my new csvpath ~</span>
</span><span id="CsvPath.__init__-224"><a href="#CsvPath.__init__-224"><span class="linenos">224</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-225"><a href="#CsvPath.__init__-225"><span class="linenos">225</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="CsvPath.__init__-226"><a href="#CsvPath.__init__-226"><span class="linenos">226</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-227"><a href="#CsvPath.__init__-227"><span class="linenos">227</span></a>        <span class="c1"># holds the current match count while we&#39;re in the middle of a match</span>
</span><span id="CsvPath.__init__-228"><a href="#CsvPath.__init__-228"><span class="linenos">228</span></a>        <span class="c1"># so that anyone who wants to can increase the match count using</span>
</span><span id="CsvPath.__init__-229"><a href="#CsvPath.__init__-229"><span class="linenos">229</span></a>        <span class="c1"># raise_match_count_if(). it is important to do the raise asap so that</span>
</span><span id="CsvPath.__init__-230"><a href="#CsvPath.__init__-230"><span class="linenos">230</span></a>        <span class="c1"># components that are onmatched have the right match count available.</span>
</span><span id="CsvPath.__init__-231"><a href="#CsvPath.__init__-231"><span class="linenos">231</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-232"><a href="#CsvPath.__init__-232"><span class="linenos">232</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_current_match_count</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="CsvPath.__init__-233"><a href="#CsvPath.__init__-233"><span class="linenos">233</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-234"><a href="#CsvPath.__init__-234"><span class="linenos">234</span></a>        <span class="c1"># printers receive print lines from the print function. the default</span>
</span><span id="CsvPath.__init__-235"><a href="#CsvPath.__init__-235"><span class="linenos">235</span></a>        <span class="c1"># printer prints to standard out. a CsvPath that is managed by a</span>
</span><span id="CsvPath.__init__-236"><a href="#CsvPath.__init__-236"><span class="linenos">236</span></a>        <span class="c1"># CsvPaths has its Results as a printer, as well as having</span>
</span><span id="CsvPath.__init__-237"><a href="#CsvPath.__init__-237"><span class="linenos">237</span></a>        <span class="c1"># the default printer.</span>
</span><span id="CsvPath.__init__-238"><a href="#CsvPath.__init__-238"><span class="linenos">238</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-239"><a href="#CsvPath.__init__-239"><span class="linenos">239</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">printers</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CsvPath.__init__-240"><a href="#CsvPath.__init__-240"><span class="linenos">240</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="CsvPath.__init__-241"><a href="#CsvPath.__init__-241"><span class="linenos">241</span></a>        <span class="k">if</span> <span class="n">print_default</span><span class="p">:</span>
</span><span id="CsvPath.__init__-242"><a href="#CsvPath.__init__-242"><span class="linenos">242</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">printers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StdOutPrinter</span><span class="p">())</span>
</span><span id="CsvPath.__init__-243"><a href="#CsvPath.__init__-243"><span class="linenos">243</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-244"><a href="#CsvPath.__init__-244"><span class="linenos">244</span></a>        <span class="c1"># _function_times_match collects the time a function spends doing its matches()</span>
</span><span id="CsvPath.__init__-245"><a href="#CsvPath.__init__-245"><span class="linenos">245</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-246"><a href="#CsvPath.__init__-246"><span class="linenos">246</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_function_times_match</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="CsvPath.__init__-247"><a href="#CsvPath.__init__-247"><span class="linenos">247</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-248"><a href="#CsvPath.__init__-248"><span class="linenos">248</span></a>        <span class="c1"># _function_times_value collects the time a function spends doing its to_value()</span>
</span><span id="CsvPath.__init__-249"><a href="#CsvPath.__init__-249"><span class="linenos">249</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-250"><a href="#CsvPath.__init__-250"><span class="linenos">250</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_function_times_value</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="CsvPath.__init__-251"><a href="#CsvPath.__init__-251"><span class="linenos">251</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_created_at</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
</span><span id="CsvPath.__init__-252"><a href="#CsvPath.__init__-252"><span class="linenos">252</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_run_started_at</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPath.__init__-253"><a href="#CsvPath.__init__-253"><span class="linenos">253</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_collecting</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CsvPath.__init__-254"><a href="#CsvPath.__init__-254"><span class="linenos">254</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-255"><a href="#CsvPath.__init__-255"><span class="linenos">255</span></a>        <span class="c1"># holds the unmatched lines when lines are being collected and</span>
</span><span id="CsvPath.__init__-256"><a href="#CsvPath.__init__-256"><span class="linenos">256</span></a>        <span class="c1"># _unmatched_available is True. it is analogous to the lines returned</span>
</span><span id="CsvPath.__init__-257"><a href="#CsvPath.__init__-257"><span class="linenos">257</span></a>        <span class="c1"># by collect(), but is the lines not returned by collect().</span>
</span><span id="CsvPath.__init__-258"><a href="#CsvPath.__init__-258"><span class="linenos">258</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.__init__-259"><a href="#CsvPath.__init__-259"><span class="linenos">259</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched</span> <span class="o">=</span> <span class="kc">None</span>
</span></pre></div>


    

                            </div>
                            <div id="CsvPath.error_manager" class="classattr">
                                <div class="attr variable">
            <span class="name">error_manager</span>

        
    </div>
    <a class="headerlink" href="#CsvPath.error_manager"></a>
    
    

                            </div>
                            <div id="CsvPath.variables" class="classattr">
                                <div class="attr variable">
            <span class="name">variables</span><span class="annotation">: Dict[str, Any]</span>

        
    </div>
    <a class="headerlink" href="#CsvPath.variables"></a>
    
    

                            </div>
                            <div id="CsvPath.delimiter" class="classattr">
                                <div class="attr variable">
            <span class="name">delimiter</span>

        
    </div>
    <a class="headerlink" href="#CsvPath.delimiter"></a>
    
    

                            </div>
                            <div id="CsvPath.quotechar" class="classattr">
                                <div class="attr variable">
            <span class="name">quotechar</span>

        
    </div>
    <a class="headerlink" href="#CsvPath.quotechar"></a>
    
    

                            </div>
                            <div id="CsvPath.skip_blank_lines" class="classattr">
                                <div class="attr variable">
            <span class="name">skip_blank_lines</span>

        
    </div>
    <a class="headerlink" href="#CsvPath.skip_blank_lines"></a>
    
    

                            </div>
                            <div id="CsvPath.scan_count" class="classattr">
                                <div class="attr variable">
            <span class="name">scan_count</span>

        
    </div>
    <a class="headerlink" href="#CsvPath.scan_count"></a>
    
    

                            </div>
                            <div id="CsvPath.match_count" class="classattr">
                                <div class="attr variable">
            <span class="name">match_count</span>

        
    </div>
    <a class="headerlink" href="#CsvPath.match_count"></a>
    
    

                            </div>
                            <div id="CsvPath.stopped" class="classattr">
                                <div class="attr variable">
            <span class="name">stopped</span>

        
    </div>
    <a class="headerlink" href="#CsvPath.stopped"></a>
    
    

                            </div>
                            <div id="CsvPath.metadata" class="classattr">
                                <div class="attr variable">
            <span class="name">metadata</span><span class="annotation">: Dict[str, Any]</span>

        
    </div>
    <a class="headerlink" href="#CsvPath.metadata"></a>
    
    

                            </div>
                            <div id="CsvPath.AND" class="classattr">
                                        <input id="CsvPath.AND-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">AND</span><span class="annotation">: bool</span>

                <label class="view-source-button" for="CsvPath.AND-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPath.AND"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPath.AND-401"><a href="#CsvPath.AND-401"><span class="linenos">401</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath.AND-402"><a href="#CsvPath.AND-402"><span class="linenos">402</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">AND</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>  <span class="c1"># pylint: disable=C0103</span>
</span><span id="CsvPath.AND-403"><a href="#CsvPath.AND-403"><span class="linenos">403</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">modes</span><span class="o">.</span><span class="n">logic_mode</span><span class="o">.</span><span class="n">value</span>
</span></pre></div>


    

                            </div>
                            <div id="CsvPath.OR" class="classattr">
                                        <input id="CsvPath.OR-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">OR</span><span class="annotation">: bool</span>

                <label class="view-source-button" for="CsvPath.OR-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPath.OR"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPath.OR-409"><a href="#CsvPath.OR-409"><span class="linenos">409</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath.OR-410"><a href="#CsvPath.OR-410"><span class="linenos">410</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">OR</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>  <span class="c1"># pylint: disable=C0103</span>
</span><span id="CsvPath.OR-411"><a href="#CsvPath.OR-411"><span class="linenos">411</span></a>        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">modes</span><span class="o">.</span><span class="n">logic_mode</span><span class="o">.</span><span class="n">value</span>
</span></pre></div>


    

                            </div>
                            <div id="CsvPath.identity" class="classattr">
                                        <input id="CsvPath.identity-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">identity</span><span class="annotation">: str</span>

                <label class="view-source-button" for="CsvPath.identity-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPath.identity"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPath.identity-417"><a href="#CsvPath.identity-417"><span class="linenos">417</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath.identity-418"><a href="#CsvPath.identity-418"><span class="linenos">418</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">identity</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="CsvPath.identity-419"><a href="#CsvPath.identity-419"><span class="linenos">419</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;returns id or name if found in metadata.</span>
</span><span id="CsvPath.identity-420"><a href="#CsvPath.identity-420"><span class="linenos">420</span></a>
</span><span id="CsvPath.identity-421"><a href="#CsvPath.identity-421"><span class="linenos">421</span></a><span class="sd">        the id or name gets into metadata primarily if found</span>
</span><span id="CsvPath.identity-422"><a href="#CsvPath.identity-422"><span class="linenos">422</span></a><span class="sd">        in an &quot;external&quot; comment in the csvpath. &quot;external&quot;</span>
</span><span id="CsvPath.identity-423"><a href="#CsvPath.identity-423"><span class="linenos">423</span></a><span class="sd">        meaning outside the []s. comments are keyword:comment.</span>
</span><span id="CsvPath.identity-424"><a href="#CsvPath.identity-424"><span class="linenos">424</span></a><span class="sd">        we take id, Id, ID and name, Name, NAME.</span>
</span><span id="CsvPath.identity-425"><a href="#CsvPath.identity-425"><span class="linenos">425</span></a>
</span><span id="CsvPath.identity-426"><a href="#CsvPath.identity-426"><span class="linenos">426</span></a><span class="sd">        id is preferred over name. E.g. in:</span>
</span><span id="CsvPath.identity-427"><a href="#CsvPath.identity-427"><span class="linenos">427</span></a><span class="sd">        ~ name: my path description: an example id: this value wins ~</span>
</span><span id="CsvPath.identity-428"><a href="#CsvPath.identity-428"><span class="linenos">428</span></a><span class="sd">        the id becomes the identity of the instance.</span>
</span><span id="CsvPath.identity-429"><a href="#CsvPath.identity-429"><span class="linenos">429</span></a>
</span><span id="CsvPath.identity-430"><a href="#CsvPath.identity-430"><span class="linenos">430</span></a><span class="sd">        we prefer in this order: all-lower most, Initial-caps,</span>
</span><span id="CsvPath.identity-431"><a href="#CsvPath.identity-431"><span class="linenos">431</span></a><span class="sd">        ALL-CAPS least</span>
</span><span id="CsvPath.identity-432"><a href="#CsvPath.identity-432"><span class="linenos">432</span></a>
</span><span id="CsvPath.identity-433"><a href="#CsvPath.identity-433"><span class="linenos">433</span></a><span class="sd">        the ordering is relied on in Result and possibly</span>
</span><span id="CsvPath.identity-434"><a href="#CsvPath.identity-434"><span class="linenos">434</span></a><span class="sd">        elsewhere.</span>
</span><span id="CsvPath.identity-435"><a href="#CsvPath.identity-435"><span class="linenos">435</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CsvPath.identity-436"><a href="#CsvPath.identity-436"><span class="linenos">436</span></a>        <span class="n">ret</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPath.identity-437"><a href="#CsvPath.identity-437"><span class="linenos">437</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">:</span>
</span><span id="CsvPath.identity-438"><a href="#CsvPath.identity-438"><span class="linenos">438</span></a>            <span class="n">ret</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="CsvPath.identity-439"><a href="#CsvPath.identity-439"><span class="linenos">439</span></a>        <span class="k">if</span> <span class="s2">&quot;NAME&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">:</span>
</span><span id="CsvPath.identity-440"><a href="#CsvPath.identity-440"><span class="linenos">440</span></a>            <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;NAME&quot;</span><span class="p">]</span>
</span><span id="CsvPath.identity-441"><a href="#CsvPath.identity-441"><span class="linenos">441</span></a>        <span class="k">if</span> <span class="s2">&quot;Name&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">:</span>
</span><span id="CsvPath.identity-442"><a href="#CsvPath.identity-442"><span class="linenos">442</span></a>            <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]</span>
</span><span id="CsvPath.identity-443"><a href="#CsvPath.identity-443"><span class="linenos">443</span></a>        <span class="k">if</span> <span class="s2">&quot;name&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">:</span>
</span><span id="CsvPath.identity-444"><a href="#CsvPath.identity-444"><span class="linenos">444</span></a>            <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
</span><span id="CsvPath.identity-445"><a href="#CsvPath.identity-445"><span class="linenos">445</span></a>        <span class="k">if</span> <span class="s2">&quot;ID&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">:</span>
</span><span id="CsvPath.identity-446"><a href="#CsvPath.identity-446"><span class="linenos">446</span></a>            <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;ID&quot;</span><span class="p">]</span>
</span><span id="CsvPath.identity-447"><a href="#CsvPath.identity-447"><span class="linenos">447</span></a>        <span class="k">if</span> <span class="s2">&quot;Id&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">:</span>
</span><span id="CsvPath.identity-448"><a href="#CsvPath.identity-448"><span class="linenos">448</span></a>            <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;Id&quot;</span><span class="p">]</span>
</span><span id="CsvPath.identity-449"><a href="#CsvPath.identity-449"><span class="linenos">449</span></a>        <span class="k">if</span> <span class="s2">&quot;id&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">:</span>
</span><span id="CsvPath.identity-450"><a href="#CsvPath.identity-450"><span class="linenos">450</span></a>            <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
</span><span id="CsvPath.identity-451"><a href="#CsvPath.identity-451"><span class="linenos">451</span></a>        <span class="k">return</span> <span class="n">ret</span>
</span></pre></div>


            <div class="docstring"><p>returns id or name if found in metadata.</p>

<p>the id or name gets into metadata primarily if found
in an "external" comment in the csvpath. "external"
meaning outside the []s. comments are keyword:comment.
we take id, Id, ID and name, Name, NAME.</p>

<p>id is preferred over name. E.g. in:
~ name: my path description: an example id: this value wins ~
the id becomes the identity of the instance.</p>

<p>we prefer in this order: all-lower most, Initial-caps,
ALL-CAPS least</p>

<p>the ordering is relied on in Result and possibly
elsewhere.</p>
</div>


                            </div>
                            <div id="CsvPath.errors" class="classattr">
                                        <input id="CsvPath.errors-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">errors</span><span class="annotation">: List[csvpath.managers.errors.error.Error]</span>

                <label class="view-source-button" for="CsvPath.errors-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPath.errors"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPath.errors-472"><a href="#CsvPath.errors-472"><span class="linenos">472</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath.errors-473"><a href="#CsvPath.errors-473"><span class="linenos">473</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">errors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Error</span><span class="p">]:</span>  <span class="c1"># pylint: disable=C0116</span>
</span><span id="CsvPath.errors-474"><a href="#CsvPath.errors-474"><span class="linenos">474</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span>
</span></pre></div>


    

                            </div>
                            <div id="CsvPath.errors_count" class="classattr">
                                        <input id="CsvPath.errors_count-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">errors_count</span><span class="annotation">: int</span>

                <label class="view-source-button" for="CsvPath.errors_count-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPath.errors_count"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPath.errors_count-476"><a href="#CsvPath.errors_count-476"><span class="linenos">476</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath.errors_count-477"><a href="#CsvPath.errors_count-477"><span class="linenos">477</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">errors_count</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>  <span class="c1"># pylint: disable=C0116</span>
</span><span id="CsvPath.errors_count-478"><a href="#CsvPath.errors_count-478"><span class="linenos">478</span></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="CsvPath.has_errors" class="classattr">
                                        <input id="CsvPath.has_errors-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">has_errors</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="CsvPath.has_errors-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPath.has_errors"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPath.has_errors-484"><a href="#CsvPath.has_errors-484"><span class="linenos">484</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">has_errors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="CsvPath.has_errors-485"><a href="#CsvPath.has_errors-485"><span class="linenos">485</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">errors_count</span> <span class="o">&gt;</span> <span class="mi">0</span>
</span></pre></div>


    

                            </div>
                            <div id="CsvPath.is_valid" class="classattr">
                                        <input id="CsvPath.is_valid-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">is_valid</span><span class="annotation">: bool</span>

                <label class="view-source-button" for="CsvPath.is_valid-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPath.is_valid"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPath.is_valid-902"><a href="#CsvPath.is_valid-902"><span class="linenos">902</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath.is_valid-903"><a href="#CsvPath.is_valid-903"><span class="linenos">903</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
</span><span id="CsvPath.is_valid-904"><a href="#CsvPath.is_valid-904"><span class="linenos">904</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Csvpaths can flag a CSV file as invalid using the fail() function&quot;&quot;&quot;</span>
</span><span id="CsvPath.is_valid-905"><a href="#CsvPath.is_valid-905"><span class="linenos">905</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_valid</span>
</span></pre></div>


            <div class="docstring"><p>Csvpaths can flag a CSV file as invalid using the fail() function</p>
</div>


                            </div>
                            <div id="CsvPath.completed" class="classattr">
                                        <input id="CsvPath.completed-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">completed</span><span class="annotation">: bool</span>

                <label class="view-source-button" for="CsvPath.completed-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPath.completed"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPath.completed-911"><a href="#CsvPath.completed-911"><span class="linenos">911</span></a>    <span class="nd">@property</span>
</span><span id="CsvPath.completed-912"><a href="#CsvPath.completed-912"><span class="linenos">912</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">completed</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="CsvPath.completed-913"><a href="#CsvPath.completed-913"><span class="linenos">913</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanner</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_monitor</span><span class="p">:</span>
</span><span id="CsvPath.completed-914"><a href="#CsvPath.completed-914"><span class="linenos">914</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="CsvPath.completed-915"><a href="#CsvPath.completed-915"><span class="linenos">915</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanner</span><span class="o">.</span><span class="n">is_last</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">line_monitor</span><span class="o">.</span><span class="n">physical_line_number</span><span class="p">):</span>
</span><span id="CsvPath.completed-916"><a href="#CsvPath.completed-916"><span class="linenos">916</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="CsvPath.completed-917"><a href="#CsvPath.completed-917"><span class="linenos">917</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span></pre></div>


    

                            </div>
                            <div id="CsvPath.collect" class="classattr">
                                        <input id="CsvPath.collect-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">collect</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">csvpath</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">nexts</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>,</span><span class="param">	<span class="n">lines</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">) -> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]],</span> <span class="n">csvpath</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">line_spooler</span><span class="o">.</span><span class="n">LineSpooler</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="CsvPath.collect-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPath.collect"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPath.collect-981"><a href="#CsvPath.collect-981"><span class="linenos"> 981</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">collect</span><span class="p">(</span>
</span><span id="CsvPath.collect-982"><a href="#CsvPath.collect-982"><span class="linenos"> 982</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">csvpath</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">nexts</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">lines</span><span class="o">=</span><span class="kc">None</span>
</span><span id="CsvPath.collect-983"><a href="#CsvPath.collect-983"><span class="linenos"> 983</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]]</span> <span class="o">|</span> <span class="n">LineSpooler</span><span class="p">:</span>
</span><span id="CsvPath.collect-984"><a href="#CsvPath.collect-984"><span class="linenos"> 984</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Runs the csvpath forward and returns the matching lines seen as</span>
</span><span id="CsvPath.collect-985"><a href="#CsvPath.collect-985"><span class="linenos"> 985</span></a><span class="sd">        a list of lists. this method does not holds lines locally, not as</span>
</span><span id="CsvPath.collect-986"><a href="#CsvPath.collect-986"><span class="linenos"> 986</span></a><span class="sd">        accessible attributes. lines are not kept after the run completes</span>
</span><span id="CsvPath.collect-987"><a href="#CsvPath.collect-987"><span class="linenos"> 987</span></a><span class="sd">        and the collected lines are returned.</span>
</span><span id="CsvPath.collect-988"><a href="#CsvPath.collect-988"><span class="linenos"> 988</span></a>
</span><span id="CsvPath.collect-989"><a href="#CsvPath.collect-989"><span class="linenos"> 989</span></a><span class="sd">        the optional lines argument may be an instance of any class that has an append(obj)</span>
</span><span id="CsvPath.collect-990"><a href="#CsvPath.collect-990"><span class="linenos"> 990</span></a><span class="sd">        method. if lines is None, a list is returned.</span>
</span><span id="CsvPath.collect-991"><a href="#CsvPath.collect-991"><span class="linenos"> 991</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CsvPath.collect-992"><a href="#CsvPath.collect-992"><span class="linenos"> 992</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanner</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">csvpath</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath.collect-993"><a href="#CsvPath.collect-993"><span class="linenos"> 993</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">csvpath</span><span class="p">)</span>
</span><span id="CsvPath.collect-994"><a href="#CsvPath.collect-994"><span class="linenos"> 994</span></a>        <span class="k">if</span> <span class="n">nexts</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span><span id="CsvPath.collect-995"><a href="#CsvPath.collect-995"><span class="linenos"> 995</span></a>            <span class="k">raise</span> <span class="n">ProcessingException</span><span class="p">(</span>
</span><span id="CsvPath.collect-996"><a href="#CsvPath.collect-996"><span class="linenos"> 996</span></a>                <span class="s2">&quot;Input must be &gt;= -1. -1 means collect to the end of the file.&quot;</span>
</span><span id="CsvPath.collect-997"><a href="#CsvPath.collect-997"><span class="linenos"> 997</span></a>            <span class="p">)</span>
</span><span id="CsvPath.collect-998"><a href="#CsvPath.collect-998"><span class="linenos"> 998</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">collecting</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="CsvPath.collect-999"><a href="#CsvPath.collect-999"><span class="linenos"> 999</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.collect-1000"><a href="#CsvPath.collect-1000"><span class="linenos">1000</span></a>        <span class="c1"># we&#39;re going to use the passed in lines object. if it exists</span>
</span><span id="CsvPath.collect-1001"><a href="#CsvPath.collect-1001"><span class="linenos">1001</span></a>        <span class="c1"># it is a LineSpooler (we presume). we&#39;ll associate it with the</span>
</span><span id="CsvPath.collect-1002"><a href="#CsvPath.collect-1002"><span class="linenos">1002</span></a>        <span class="c1"># csvpath temporarily so anyone interested can get it. if it</span>
</span><span id="CsvPath.collect-1003"><a href="#CsvPath.collect-1003"><span class="linenos">1003</span></a>        <span class="c1"># doesn&#39;t exist we create a list for the lines var. we create a</span>
</span><span id="CsvPath.collect-1004"><a href="#CsvPath.collect-1004"><span class="linenos">1004</span></a>        <span class="c1"># list LinesSpooler to handle any inquiries during the run we</span>
</span><span id="CsvPath.collect-1005"><a href="#CsvPath.collect-1005"><span class="linenos">1005</span></a>        <span class="c1"># do all our line collecting busness with the local lines var</span>
</span><span id="CsvPath.collect-1006"><a href="#CsvPath.collect-1006"><span class="linenos">1006</span></a>        <span class="c1"># which has an append method regardless of if it is list or</span>
</span><span id="CsvPath.collect-1007"><a href="#CsvPath.collect-1007"><span class="linenos">1007</span></a>        <span class="c1"># LineSpooler. when we&#39;re done we break the link with the csvpath</span>
</span><span id="CsvPath.collect-1008"><a href="#CsvPath.collect-1008"><span class="linenos">1008</span></a>        <span class="c1"># and return the local variable. if it is a list it is going to</span>
</span><span id="CsvPath.collect-1009"><a href="#CsvPath.collect-1009"><span class="linenos">1009</span></a>        <span class="c1"># a csvpath user. if it is a LineSpooler it is going to a</span>
</span><span id="CsvPath.collect-1010"><a href="#CsvPath.collect-1010"><span class="linenos">1010</span></a>        <span class="c1"># CsvPaths instance.</span>
</span><span id="CsvPath.collect-1011"><a href="#CsvPath.collect-1011"><span class="linenos">1011</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.collect-1012"><a href="#CsvPath.collect-1012"><span class="linenos">1012</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">lines</span> <span class="o">=</span> <span class="n">lines</span>
</span><span id="CsvPath.collect-1013"><a href="#CsvPath.collect-1013"><span class="linenos">1013</span></a>        <span class="k">if</span> <span class="n">lines</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath.collect-1014"><a href="#CsvPath.collect-1014"><span class="linenos">1014</span></a>            <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CsvPath.collect-1015"><a href="#CsvPath.collect-1015"><span class="linenos">1015</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">lines</span> <span class="o">=</span> <span class="n">ListLineSpooler</span><span class="p">(</span><span class="n">lines</span><span class="o">=</span><span class="n">lines</span><span class="p">)</span>
</span><span id="CsvPath.collect-1016"><a href="#CsvPath.collect-1016"><span class="linenos">1016</span></a>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">():</span>
</span><span id="CsvPath.collect-1017"><a href="#CsvPath.collect-1017"><span class="linenos">1017</span></a>            <span class="n">_</span> <span class="o">=</span> <span class="n">_</span><span class="p">[:]</span>
</span><span id="CsvPath.collect-1018"><a href="#CsvPath.collect-1018"><span class="linenos">1018</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
</span><span id="CsvPath.collect-1019"><a href="#CsvPath.collect-1019"><span class="linenos">1019</span></a>            <span class="k">if</span> <span class="n">nexts</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span><span id="CsvPath.collect-1020"><a href="#CsvPath.collect-1020"><span class="linenos">1020</span></a>                <span class="k">continue</span>
</span><span id="CsvPath.collect-1021"><a href="#CsvPath.collect-1021"><span class="linenos">1021</span></a>            <span class="k">if</span> <span class="n">nexts</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="CsvPath.collect-1022"><a href="#CsvPath.collect-1022"><span class="linenos">1022</span></a>                <span class="n">nexts</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="CsvPath.collect-1023"><a href="#CsvPath.collect-1023"><span class="linenos">1023</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="CsvPath.collect-1024"><a href="#CsvPath.collect-1024"><span class="linenos">1024</span></a>                <span class="k">break</span>
</span><span id="CsvPath.collect-1025"><a href="#CsvPath.collect-1025"><span class="linenos">1025</span></a>        <span class="c1"># we don&#39;t want to hold on to data more than needed. but</span>
</span><span id="CsvPath.collect-1026"><a href="#CsvPath.collect-1026"><span class="linenos">1026</span></a>        <span class="c1"># we do want to return data if we&#39;re not spooling. the</span>
</span><span id="CsvPath.collect-1027"><a href="#CsvPath.collect-1027"><span class="linenos">1027</span></a>        <span class="c1"># way we do that is to keep the local var available with the</span>
</span><span id="CsvPath.collect-1028"><a href="#CsvPath.collect-1028"><span class="linenos">1028</span></a>        <span class="c1"># list and/or the spooler. the caller needs to be aware of</span>
</span><span id="CsvPath.collect-1029"><a href="#CsvPath.collect-1029"><span class="linenos">1029</span></a>        <span class="c1"># both possibilities, but both offer __len__ and append.</span>
</span><span id="CsvPath.collect-1030"><a href="#CsvPath.collect-1030"><span class="linenos">1030</span></a>        <span class="c1">#</span>
</span><span id="CsvPath.collect-1031"><a href="#CsvPath.collect-1031"><span class="linenos">1031</span></a>        <span class="c1"># we keep the self.lines if it is not a list because that</span>
</span><span id="CsvPath.collect-1032"><a href="#CsvPath.collect-1032"><span class="linenos">1032</span></a>        <span class="c1"># makes it available to the runtime data collector so we can</span>
</span><span id="CsvPath.collect-1033"><a href="#CsvPath.collect-1033"><span class="linenos">1033</span></a>        <span class="c1"># see the line count in the metadata, saving opening a</span>
</span><span id="CsvPath.collect-1034"><a href="#CsvPath.collect-1034"><span class="linenos">1034</span></a>        <span class="c1"># potentially large data.csv to find out how many lines.</span>
</span><span id="CsvPath.collect-1035"><a href="#CsvPath.collect-1035"><span class="linenos">1035</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="CsvPath.collect-1036"><a href="#CsvPath.collect-1036"><span class="linenos">1036</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">lines</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPath.collect-1037"><a href="#CsvPath.collect-1037"><span class="linenos">1037</span></a>        <span class="k">return</span> <span class="n">lines</span>
</span></pre></div>


            <div class="docstring"><p>Runs the csvpath forward and returns the matching lines seen as
a list of lists. this method does not holds lines locally, not as
accessible attributes. lines are not kept after the run completes
and the collected lines are returned.</p>

<p>the optional lines argument may be an instance of any class that has an append(obj)
method. if lines is None, a list is returned.</p>
</div>


                            </div>
                            <div id="CsvPath.fast_forward" class="classattr">
                                        <input id="CsvPath.fast_forward-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fast_forward</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">csvpath</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="CsvPath.fast_forward-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPath.fast_forward"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPath.fast_forward-1039"><a href="#CsvPath.fast_forward-1039"><span class="linenos">1039</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fast_forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">csvpath</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="CsvPath.fast_forward-1040"><a href="#CsvPath.fast_forward-1040"><span class="linenos">1040</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Scans to the end of the CSV file. All scanned rows will be</span>
</span><span id="CsvPath.fast_forward-1041"><a href="#CsvPath.fast_forward-1041"><span class="linenos">1041</span></a><span class="sd">        considered for match and variables and side effects will happen,</span>
</span><span id="CsvPath.fast_forward-1042"><a href="#CsvPath.fast_forward-1042"><span class="linenos">1042</span></a><span class="sd">        but no rows will be returned or stored. -1 means to the end of</span>
</span><span id="CsvPath.fast_forward-1043"><a href="#CsvPath.fast_forward-1043"><span class="linenos">1043</span></a><span class="sd">        the file. If you do not pass the csvpath string here you must first</span>
</span><span id="CsvPath.fast_forward-1044"><a href="#CsvPath.fast_forward-1044"><span class="linenos">1044</span></a><span class="sd">        use the parse method.&quot;&quot;&quot;</span>
</span><span id="CsvPath.fast_forward-1045"><a href="#CsvPath.fast_forward-1045"><span class="linenos">1045</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanner</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">csvpath</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath.fast_forward-1046"><a href="#CsvPath.fast_forward-1046"><span class="linenos">1046</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">csvpath</span><span class="p">)</span>
</span><span id="CsvPath.fast_forward-1047"><a href="#CsvPath.fast_forward-1047"><span class="linenos">1047</span></a>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">():</span>
</span><span id="CsvPath.fast_forward-1048"><a href="#CsvPath.fast_forward-1048"><span class="linenos">1048</span></a>            <span class="k">pass</span>
</span><span id="CsvPath.fast_forward-1049"><a href="#CsvPath.fast_forward-1049"><span class="linenos">1049</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Scans to the end of the CSV file. All scanned rows will be
considered for match and variables and side effects will happen,
but no rows will be returned or stored. -1 means to the end of
the file. If you do not pass the csvpath string here you must first
use the parse method.</p>
</div>


                            </div>
                            <div id="CsvPath.next" class="classattr">
                                        <input id="CsvPath.next-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">next</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">csvpath</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="CsvPath.next-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPath.next"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPath.next-1055"><a href="#CsvPath.next-1055"><span class="linenos">1055</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">next</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">csvpath</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="CsvPath.next-1056"><a href="#CsvPath.next-1056"><span class="linenos">1056</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;A generator function that steps through the CSV file returning</span>
</span><span id="CsvPath.next-1057"><a href="#CsvPath.next-1057"><span class="linenos">1057</span></a><span class="sd">        matching rows.&quot;&quot;&quot;</span>
</span><span id="CsvPath.next-1058"><a href="#CsvPath.next-1058"><span class="linenos">1058</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="CsvPath.next-1059"><a href="#CsvPath.next-1059"><span class="linenos">1059</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanner</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">csvpath</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath.next-1060"><a href="#CsvPath.next-1060"><span class="linenos">1060</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">csvpath</span><span class="p">)</span>
</span><span id="CsvPath.next-1061"><a href="#CsvPath.next-1061"><span class="linenos">1061</span></a>            <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="CsvPath.next-1062"><a href="#CsvPath.next-1062"><span class="linenos">1062</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">will_run</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="CsvPath.next-1063"><a href="#CsvPath.next-1063"><span class="linenos">1063</span></a>                <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_line</span><span class="p">():</span>
</span><span id="CsvPath.next-1064"><a href="#CsvPath.next-1064"><span class="linenos">1064</span></a>                    <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_consider_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="CsvPath.next-1065"><a href="#CsvPath.next-1065"><span class="linenos">1065</span></a>                    <span class="k">if</span> <span class="n">b</span><span class="p">:</span>
</span><span id="CsvPath.next-1066"><a href="#CsvPath.next-1066"><span class="linenos">1066</span></a>                        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">limit_collection</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="CsvPath.next-1067"><a href="#CsvPath.next-1067"><span class="linenos">1067</span></a>                        <span class="k">if</span> <span class="n">line</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath.next-1068"><a href="#CsvPath.next-1068"><span class="linenos">1068</span></a>                            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Line cannot be None&quot;</span>
</span><span id="CsvPath.next-1069"><a href="#CsvPath.next-1069"><span class="linenos">1069</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="CsvPath.next-1070"><a href="#CsvPath.next-1070"><span class="linenos">1070</span></a>                            <span class="k">raise</span> <span class="n">MatchException</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="CsvPath.next-1071"><a href="#CsvPath.next-1071"><span class="linenos">1071</span></a>                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CsvPath.next-1072"><a href="#CsvPath.next-1072"><span class="linenos">1072</span></a>                            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Line cannot be len() == 0&quot;</span>
</span><span id="CsvPath.next-1073"><a href="#CsvPath.next-1073"><span class="linenos">1073</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="CsvPath.next-1074"><a href="#CsvPath.next-1074"><span class="linenos">1074</span></a>                            <span class="k">raise</span> <span class="n">MatchException</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="CsvPath.next-1075"><a href="#CsvPath.next-1075"><span class="linenos">1075</span></a>                        <span class="k">yield</span> <span class="n">line</span>
</span><span id="CsvPath.next-1076"><a href="#CsvPath.next-1076"><span class="linenos">1076</span></a>                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">collecting</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">unmatched_available</span><span class="p">:</span>
</span><span id="CsvPath.next-1077"><a href="#CsvPath.next-1077"><span class="linenos">1077</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">unmatched</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPath.next-1078"><a href="#CsvPath.next-1078"><span class="linenos">1078</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">unmatched</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CsvPath.next-1079"><a href="#CsvPath.next-1079"><span class="linenos">1079</span></a>                        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">limit_collection</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="CsvPath.next-1080"><a href="#CsvPath.next-1080"><span class="linenos">1080</span></a>                        <span class="c1"># we aren&#39;t None and 0 checking as above. needed?</span>
</span><span id="CsvPath.next-1081"><a href="#CsvPath.next-1081"><span class="linenos">1081</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">unmatched</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="CsvPath.next-1082"><a href="#CsvPath.next-1082"><span class="linenos">1082</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stopped</span><span class="p">:</span>
</span><span id="CsvPath.next-1083"><a href="#CsvPath.next-1083"><span class="linenos">1083</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="CsvPath.next-1084"><a href="#CsvPath.next-1084"><span class="linenos">1084</span></a>                            <span class="s2">&quot;CsvPath has been stopped at line </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="CsvPath.next-1085"><a href="#CsvPath.next-1085"><span class="linenos">1085</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">line_monitor</span><span class="o">.</span><span class="n">physical_line_number</span><span class="p">,</span>
</span><span id="CsvPath.next-1086"><a href="#CsvPath.next-1086"><span class="linenos">1086</span></a>                        <span class="p">)</span>
</span><span id="CsvPath.next-1087"><a href="#CsvPath.next-1087"><span class="linenos">1087</span></a>                        <span class="k">break</span>
</span><span id="CsvPath.next-1088"><a href="#CsvPath.next-1088"><span class="linenos">1088</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="CsvPath.next-1089"><a href="#CsvPath.next-1089"><span class="linenos">1089</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="CsvPath.next-1090"><a href="#CsvPath.next-1090"><span class="linenos">1090</span></a>                    <span class="s2">&quot;Csvpath identified as </span><span class="si">{self.identity}</span><span class="s2"> is disabled by run-mode:no-run&quot;</span>
</span><span id="CsvPath.next-1091"><a href="#CsvPath.next-1091"><span class="linenos">1091</span></a>                <span class="p">)</span>
</span><span id="CsvPath.next-1092"><a href="#CsvPath.next-1092"><span class="linenos">1092</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>
</span><span id="CsvPath.next-1093"><a href="#CsvPath.next-1093"><span class="linenos">1093</span></a>            <span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="CsvPath.next-1094"><a href="#CsvPath.next-1094"><span class="linenos">1094</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">total_iteration_time</span> <span class="o">=</span> <span class="n">end</span> <span class="o">-</span> <span class="n">start</span>
</span><span id="CsvPath.next-1095"><a href="#CsvPath.next-1095"><span class="linenos">1095</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Run against </span><span class="si">%s</span><span class="s2"> is complete.&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanner</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
</span><span id="CsvPath.next-1096"><a href="#CsvPath.next-1096"><span class="linenos">1096</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="CsvPath.next-1097"><a href="#CsvPath.next-1097"><span class="linenos">1097</span></a>                <span class="s2">&quot;Iteration time was </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">total_iteration_time</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="CsvPath.next-1098"><a href="#CsvPath.next-1098"><span class="linenos">1098</span></a>            <span class="p">)</span>
</span><span id="CsvPath.next-1099"><a href="#CsvPath.next-1099"><span class="linenos">1099</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="CsvPath.next-1100"><a href="#CsvPath.next-1100"><span class="linenos">1100</span></a>                <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> per line&quot;</span><span class="p">,</span>
</span><span id="CsvPath.next-1101"><a href="#CsvPath.next-1101"><span class="linenos">1101</span></a>                <span class="nb">round</span><span class="p">(</span>
</span><span id="CsvPath.next-1102"><a href="#CsvPath.next-1102"><span class="linenos">1102</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">total_iteration_time</span>
</span><span id="CsvPath.next-1103"><a href="#CsvPath.next-1103"><span class="linenos">1103</span></a>                    <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_monitor</span><span class="o">.</span><span class="n">physical_end_line_count</span><span class="p">,</span>
</span><span id="CsvPath.next-1104"><a href="#CsvPath.next-1104"><span class="linenos">1104</span></a>                    <span class="mi">2</span><span class="p">,</span>
</span><span id="CsvPath.next-1105"><a href="#CsvPath.next-1105"><span class="linenos">1105</span></a>                <span class="p">),</span>
</span><span id="CsvPath.next-1106"><a href="#CsvPath.next-1106"><span class="linenos">1106</span></a>            <span class="p">)</span>
</span><span id="CsvPath.next-1107"><a href="#CsvPath.next-1107"><span class="linenos">1107</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="CsvPath.next-1108"><a href="#CsvPath.next-1108"><span class="linenos">1108</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ecoms</span><span class="o">.</span><span class="n">do_i_quiet</span><span class="p">():</span>
</span><span id="CsvPath.next-1109"><a href="#CsvPath.next-1109"><span class="linenos">1109</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">exc_info</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="CsvPath.next-1110"><a href="#CsvPath.next-1110"><span class="linenos">1110</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ecoms</span><span class="o">.</span><span class="n">do_i_raise</span><span class="p">():</span>
</span><span id="CsvPath.next-1111"><a href="#CsvPath.next-1111"><span class="linenos">1111</span></a>                <span class="k">raise</span>
</span></pre></div>


            <div class="docstring"><p>A generator function that steps through the CSV file returning
matching rows.</p>
</div>


                            </div>
                </section>
                <section id="CsvPaths">
                            <input id="CsvPaths-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">CsvPaths</span><wbr>(<span class="base">csvpath.csvpaths.CsvPathsCoordinator</span>, <span class="base">csvpath.managers.errors.error_collector.ErrorCollector</span>):

                <label class="view-source-button" for="CsvPaths-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPaths"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPaths-59"><a href="#CsvPaths-59"><span class="linenos">  59</span></a><span class="k">class</span><span class="w"> </span><span class="nc">CsvPaths</span><span class="p">(</span><span class="n">CsvPathsCoordinator</span><span class="p">,</span> <span class="n">ErrorCollector</span><span class="p">):</span>
</span><span id="CsvPaths-60"><a href="#CsvPaths-60"><span class="linenos">  60</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CsvPaths-61"><a href="#CsvPaths-61"><span class="linenos">  61</span></a><span class="sd">    a CsvPaths instance manages applying any number of csvpaths</span>
</span><span id="CsvPaths-62"><a href="#CsvPaths-62"><span class="linenos">  62</span></a><span class="sd">    to any number of files. CsvPaths applies sets of csvpaths</span>
</span><span id="CsvPaths-63"><a href="#CsvPaths-63"><span class="linenos">  63</span></a><span class="sd">    to a given file, on demand. Think of CsvPaths as a session</span>
</span><span id="CsvPaths-64"><a href="#CsvPaths-64"><span class="linenos">  64</span></a><span class="sd">    object. It gives you a way to manage files, csvpaths, and</span>
</span><span id="CsvPaths-65"><a href="#CsvPaths-65"><span class="linenos">  65</span></a><span class="sd">    the results generated by applying paths to files. It is not</span>
</span><span id="CsvPaths-66"><a href="#CsvPaths-66"><span class="linenos">  66</span></a><span class="sd">    intended for concurrent use. If you need multiple threads,</span>
</span><span id="CsvPaths-67"><a href="#CsvPaths-67"><span class="linenos">  67</span></a><span class="sd">    create multiple CsvPaths instances.</span>
</span><span id="CsvPaths-68"><a href="#CsvPaths-68"><span class="linenos">  68</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="CsvPaths-69"><a href="#CsvPaths-69"><span class="linenos">  69</span></a>
</span><span id="CsvPaths-70"><a href="#CsvPaths-70"><span class="linenos">  70</span></a>    <span class="c1"># pylint: disable=too-many-instance-attributes</span>
</span><span id="CsvPaths-71"><a href="#CsvPaths-71"><span class="linenos">  71</span></a>
</span><span id="CsvPaths-72"><a href="#CsvPaths-72"><span class="linenos">  72</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="CsvPaths-73"><a href="#CsvPaths-73"><span class="linenos">  73</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="CsvPaths-74"><a href="#CsvPaths-74"><span class="linenos">  74</span></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="CsvPaths-75"><a href="#CsvPaths-75"><span class="linenos">  75</span></a>        <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span>
</span><span id="CsvPaths-76"><a href="#CsvPaths-76"><span class="linenos">  76</span></a>        <span class="n">quotechar</span><span class="o">=</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span>
</span><span id="CsvPaths-77"><a href="#CsvPaths-77"><span class="linenos">  77</span></a>        <span class="n">skip_blank_lines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="CsvPaths-78"><a href="#CsvPaths-78"><span class="linenos">  78</span></a>        <span class="n">print_default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="CsvPaths-79"><a href="#CsvPaths-79"><span class="linenos">  79</span></a>        <span class="n">config</span><span class="p">:</span> <span class="n">Config</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="CsvPaths-80"><a href="#CsvPaths-80"><span class="linenos">  80</span></a>    <span class="p">):</span>
</span><span id="CsvPaths-81"><a href="#CsvPaths-81"><span class="linenos">  81</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">()</span> <span class="k">if</span> <span class="n">config</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">config</span>
</span><span id="CsvPaths-82"><a href="#CsvPaths-82"><span class="linenos">  82</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-83"><a href="#CsvPaths-83"><span class="linenos">  83</span></a>        <span class="c1"># managers centralize activities, offer async potential, and</span>
</span><span id="CsvPaths-84"><a href="#CsvPaths-84"><span class="linenos">  84</span></a>        <span class="c1"># are where integrations hook in. ErrorManager functionality</span>
</span><span id="CsvPaths-85"><a href="#CsvPaths-85"><span class="linenos">  85</span></a>        <span class="c1"># must be available in CsvPath too. The others are CsvPaths</span>
</span><span id="CsvPaths-86"><a href="#CsvPaths-86"><span class="linenos">  86</span></a>        <span class="c1"># only.</span>
</span><span id="CsvPaths-87"><a href="#CsvPaths-87"><span class="linenos">  87</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-88"><a href="#CsvPaths-88"><span class="linenos">  88</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_paths_manager</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPaths-89"><a href="#CsvPaths-89"><span class="linenos">  89</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_file_manager</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPaths-90"><a href="#CsvPaths-90"><span class="linenos">  90</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_results_manager</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPaths-91"><a href="#CsvPaths-91"><span class="linenos">  91</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_ecoms</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPaths-92"><a href="#CsvPaths-92"><span class="linenos">  92</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_error_manager</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPaths-93"><a href="#CsvPaths-93"><span class="linenos">  93</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_managers</span><span class="p">()</span>
</span><span id="CsvPaths-94"><a href="#CsvPaths-94"><span class="linenos">  94</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-95"><a href="#CsvPaths-95"><span class="linenos">  95</span></a>        <span class="c1"># TODO:</span>
</span><span id="CsvPaths-96"><a href="#CsvPaths-96"><span class="linenos">  96</span></a>        <span class="c1"># self.print_manager = ... &lt;&lt;&lt;=== should we do this?</span>
</span><span id="CsvPaths-97"><a href="#CsvPaths-97"><span class="linenos">  97</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-98"><a href="#CsvPaths-98"><span class="linenos">  98</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-99"><a href="#CsvPaths-99"><span class="linenos">  99</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">print_default</span> <span class="o">=</span> <span class="n">print_default</span>
</span><span id="CsvPaths-100"><a href="#CsvPaths-100"><span class="linenos"> 100</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="CsvPaths-101"><a href="#CsvPaths-101"><span class="linenos"> 101</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span> <span class="o">=</span> <span class="n">delimiter</span>
</span><span id="CsvPaths-102"><a href="#CsvPaths-102"><span class="linenos"> 102</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="CsvPaths-103"><a href="#CsvPaths-103"><span class="linenos"> 103</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">quotechar</span> <span class="o">=</span> <span class="n">quotechar</span>
</span><span id="CsvPaths-104"><a href="#CsvPaths-104"><span class="linenos"> 104</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="CsvPaths-105"><a href="#CsvPaths-105"><span class="linenos"> 105</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">skip_blank_lines</span> <span class="o">=</span> <span class="n">skip_blank_lines</span>
</span><span id="CsvPaths-106"><a href="#CsvPaths-106"><span class="linenos"> 106</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="CsvPaths-107"><a href="#CsvPaths-107"><span class="linenos"> 107</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="p">:</span> <span class="n">CsvPath</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPaths-108"><a href="#CsvPaths-108"><span class="linenos"> 108</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="CsvPaths-109"><a href="#CsvPaths-109"><span class="linenos"> 109</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">LogUtility</span><span class="o">.</span><span class="n">logger</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="CsvPaths-110"><a href="#CsvPaths-110"><span class="linenos"> 110</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="CsvPaths-111"><a href="#CsvPaths-111"><span class="linenos"> 111</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CsvPaths-112"><a href="#CsvPaths-112"><span class="linenos"> 112</span></a>        <span class="c1"># coordinator attributes</span>
</span><span id="CsvPaths-113"><a href="#CsvPaths-113"><span class="linenos"> 113</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_stop_all</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CsvPaths-114"><a href="#CsvPaths-114"><span class="linenos"> 114</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_fail_all</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CsvPaths-115"><a href="#CsvPaths-115"><span class="linenos"> 115</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_skip_all</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CsvPaths-116"><a href="#CsvPaths-116"><span class="linenos"> 116</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_advance_all</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="CsvPaths-117"><a href="#CsvPaths-117"><span class="linenos"> 117</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_current_run_time</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPaths-118"><a href="#CsvPaths-118"><span class="linenos"> 118</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_run_time_str</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPaths-119"><a href="#CsvPaths-119"><span class="linenos"> 119</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">named_paths_name</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPaths-120"><a href="#CsvPaths-120"><span class="linenos"> 120</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="CsvPaths-121"><a href="#CsvPaths-121"><span class="linenos"> 121</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">named_file_name</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPaths-122"><a href="#CsvPaths-122"><span class="linenos"> 122</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="CsvPaths-123"><a href="#CsvPaths-123"><span class="linenos"> 123</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-124"><a href="#CsvPaths-124"><span class="linenos"> 124</span></a>        <span class="c1"># metrics is for OTLP OpenTelemetry. it should only</span>
</span><span id="CsvPaths-125"><a href="#CsvPaths-125"><span class="linenos"> 125</span></a>        <span class="c1"># be used by the OTLP listener. it is here because</span>
</span><span id="CsvPaths-126"><a href="#CsvPaths-126"><span class="linenos"> 126</span></a>        <span class="c1"># the integration may need a long-lived presence. if</span>
</span><span id="CsvPaths-127"><a href="#CsvPaths-127"><span class="linenos"> 127</span></a>        <span class="c1"># needed, the first OTLP listener will set it up</span>
</span><span id="CsvPaths-128"><a href="#CsvPaths-128"><span class="linenos"> 128</span></a>        <span class="c1"># before spinning up a thread. any other OTLP</span>
</span><span id="CsvPaths-129"><a href="#CsvPaths-129"><span class="linenos"> 129</span></a>        <span class="c1"># listener threads that need to use a long-lived metric</span>
</span><span id="CsvPaths-130"><a href="#CsvPaths-130"><span class="linenos"> 130</span></a>        <span class="c1"># will work with this property.</span>
</span><span id="CsvPaths-131"><a href="#CsvPaths-131"><span class="linenos"> 131</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-132"><a href="#CsvPaths-132"><span class="linenos"> 132</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPaths-133"><a href="#CsvPaths-133"><span class="linenos"> 133</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="CsvPaths-134"><a href="#CsvPaths-134"><span class="linenos"> 134</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;initialized CsvPaths&quot;</span><span class="p">)</span>
</span><span id="CsvPaths-135"><a href="#CsvPaths-135"><span class="linenos"> 135</span></a>
</span><span id="CsvPaths-136"><a href="#CsvPaths-136"><span class="linenos"> 136</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_set_managers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPaths-137"><a href="#CsvPaths-137"><span class="linenos"> 137</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">paths_manager</span> <span class="o">=</span> <span class="n">PathsManager</span><span class="p">(</span><span class="n">csvpaths</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="CsvPaths-138"><a href="#CsvPaths-138"><span class="linenos"> 138</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">file_manager</span> <span class="o">=</span> <span class="n">FileManager</span><span class="p">(</span><span class="n">csvpaths</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="CsvPaths-139"><a href="#CsvPaths-139"><span class="linenos"> 139</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span> <span class="o">=</span> <span class="n">ResultsManager</span><span class="p">(</span><span class="n">csvpaths</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="CsvPaths-140"><a href="#CsvPaths-140"><span class="linenos"> 140</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ecoms</span> <span class="o">=</span> <span class="n">ErrorCommunications</span><span class="p">(</span><span class="n">csvpaths</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="CsvPaths-141"><a href="#CsvPaths-141"><span class="linenos"> 141</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">error_manager</span> <span class="o">=</span> <span class="n">ErrorManager</span><span class="p">(</span><span class="n">csvpaths</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="CsvPaths-142"><a href="#CsvPaths-142"><span class="linenos"> 142</span></a>
</span><span id="CsvPaths-143"><a href="#CsvPaths-143"><span class="linenos"> 143</span></a>    <span class="nd">@property</span>
</span><span id="CsvPaths-144"><a href="#CsvPaths-144"><span class="linenos"> 144</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">ecoms</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ErrorCommunications</span><span class="p">:</span>
</span><span id="CsvPaths-145"><a href="#CsvPaths-145"><span class="linenos"> 145</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPaths-146"><a href="#CsvPaths-146"><span class="linenos"> 146</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ecoms</span>
</span><span id="CsvPaths-147"><a href="#CsvPaths-147"><span class="linenos"> 147</span></a>
</span><span id="CsvPaths-148"><a href="#CsvPaths-148"><span class="linenos"> 148</span></a>    <span class="nd">@ecoms</span><span class="o">.</span><span class="n">setter</span>
</span><span id="CsvPaths-149"><a href="#CsvPaths-149"><span class="linenos"> 149</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">ecoms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ec</span><span class="p">:</span> <span class="n">ErrorCommunications</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPaths-150"><a href="#CsvPaths-150"><span class="linenos"> 150</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPaths-151"><a href="#CsvPaths-151"><span class="linenos"> 151</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_ecoms</span> <span class="o">=</span> <span class="n">ec</span>
</span><span id="CsvPaths-152"><a href="#CsvPaths-152"><span class="linenos"> 152</span></a>
</span><span id="CsvPaths-153"><a href="#CsvPaths-153"><span class="linenos"> 153</span></a>    <span class="nd">@property</span>
</span><span id="CsvPaths-154"><a href="#CsvPaths-154"><span class="linenos"> 154</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">file_manager</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FileManager</span><span class="p">:</span>
</span><span id="CsvPaths-155"><a href="#CsvPaths-155"><span class="linenos"> 155</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file_manager</span>
</span><span id="CsvPaths-156"><a href="#CsvPaths-156"><span class="linenos"> 156</span></a>
</span><span id="CsvPaths-157"><a href="#CsvPaths-157"><span class="linenos"> 157</span></a>    <span class="nd">@file_manager</span><span class="o">.</span><span class="n">setter</span>
</span><span id="CsvPaths-158"><a href="#CsvPaths-158"><span class="linenos"> 158</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">file_manager</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span> <span class="n">FileManager</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPaths-159"><a href="#CsvPaths-159"><span class="linenos"> 159</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_file_manager</span> <span class="o">=</span> <span class="n">m</span>
</span><span id="CsvPaths-160"><a href="#CsvPaths-160"><span class="linenos"> 160</span></a>
</span><span id="CsvPaths-161"><a href="#CsvPaths-161"><span class="linenos"> 161</span></a>    <span class="nd">@property</span>
</span><span id="CsvPaths-162"><a href="#CsvPaths-162"><span class="linenos"> 162</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">results_manager</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ResultsManager</span><span class="p">:</span>
</span><span id="CsvPaths-163"><a href="#CsvPaths-163"><span class="linenos"> 163</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_results_manager</span>
</span><span id="CsvPaths-164"><a href="#CsvPaths-164"><span class="linenos"> 164</span></a>
</span><span id="CsvPaths-165"><a href="#CsvPaths-165"><span class="linenos"> 165</span></a>    <span class="nd">@results_manager</span><span class="o">.</span><span class="n">setter</span>
</span><span id="CsvPaths-166"><a href="#CsvPaths-166"><span class="linenos"> 166</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">results_manager</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span> <span class="n">ResultsManager</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPaths-167"><a href="#CsvPaths-167"><span class="linenos"> 167</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_results_manager</span> <span class="o">=</span> <span class="n">m</span>
</span><span id="CsvPaths-168"><a href="#CsvPaths-168"><span class="linenos"> 168</span></a>
</span><span id="CsvPaths-169"><a href="#CsvPaths-169"><span class="linenos"> 169</span></a>    <span class="nd">@property</span>
</span><span id="CsvPaths-170"><a href="#CsvPaths-170"><span class="linenos"> 170</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">paths_manager</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PathsManager</span><span class="p">:</span>
</span><span id="CsvPaths-171"><a href="#CsvPaths-171"><span class="linenos"> 171</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_paths_manager</span>
</span><span id="CsvPaths-172"><a href="#CsvPaths-172"><span class="linenos"> 172</span></a>
</span><span id="CsvPaths-173"><a href="#CsvPaths-173"><span class="linenos"> 173</span></a>    <span class="nd">@paths_manager</span><span class="o">.</span><span class="n">setter</span>
</span><span id="CsvPaths-174"><a href="#CsvPaths-174"><span class="linenos"> 174</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">paths_manager</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span> <span class="n">PathsManager</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPaths-175"><a href="#CsvPaths-175"><span class="linenos"> 175</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_paths_manager</span> <span class="o">=</span> <span class="n">m</span>
</span><span id="CsvPaths-176"><a href="#CsvPaths-176"><span class="linenos"> 176</span></a>
</span><span id="CsvPaths-177"><a href="#CsvPaths-177"><span class="linenos"> 177</span></a>    <span class="nd">@property</span>
</span><span id="CsvPaths-178"><a href="#CsvPaths-178"><span class="linenos"> 178</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">error_manager</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ErrorManager</span><span class="p">:</span>
</span><span id="CsvPaths-179"><a href="#CsvPaths-179"><span class="linenos"> 179</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_error_manager</span>
</span><span id="CsvPaths-180"><a href="#CsvPaths-180"><span class="linenos"> 180</span></a>
</span><span id="CsvPaths-181"><a href="#CsvPaths-181"><span class="linenos"> 181</span></a>    <span class="nd">@error_manager</span><span class="o">.</span><span class="n">setter</span>
</span><span id="CsvPaths-182"><a href="#CsvPaths-182"><span class="linenos"> 182</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">error_manager</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">em</span><span class="p">:</span> <span class="n">ErrorManager</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPaths-183"><a href="#CsvPaths-183"><span class="linenos"> 183</span></a>        <span class="k">if</span> <span class="n">em</span><span class="o">.</span><span class="n">csvpaths</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPaths-184"><a href="#CsvPaths-184"><span class="linenos"> 184</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;CsvPaths cannot be None&quot;</span><span class="p">)</span>
</span><span id="CsvPaths-185"><a href="#CsvPaths-185"><span class="linenos"> 185</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_error_manager</span> <span class="o">=</span> <span class="n">em</span>
</span><span id="CsvPaths-186"><a href="#CsvPaths-186"><span class="linenos"> 186</span></a>
</span><span id="CsvPaths-187"><a href="#CsvPaths-187"><span class="linenos"> 187</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">run_time_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pathsname</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="CsvPaths-188"><a href="#CsvPaths-188"><span class="linenos"> 188</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private</span>
</span><span id="CsvPaths-189"><a href="#CsvPaths-189"><span class="linenos"> 189</span></a><span class="sd">        adds the stringified current run time to the named-paths</span>
</span><span id="CsvPaths-190"><a href="#CsvPaths-190"><span class="linenos"> 190</span></a><span class="sd">        group home_dir to create the run_dir&quot;&quot;&quot;</span>
</span><span id="CsvPaths-191"><a href="#CsvPaths-191"><span class="linenos"> 191</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_time_str</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">pathsname</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPaths-192"><a href="#CsvPaths-192"><span class="linenos"> 192</span></a>            <span class="k">raise</span> <span class="n">CsvPathsException</span><span class="p">(</span>
</span><span id="CsvPaths-193"><a href="#CsvPaths-193"><span class="linenos"> 193</span></a>                <span class="s2">&quot;Cannot have None in both run_time_str and pathsname&quot;</span>
</span><span id="CsvPaths-194"><a href="#CsvPaths-194"><span class="linenos"> 194</span></a>            <span class="p">)</span>
</span><span id="CsvPaths-195"><a href="#CsvPaths-195"><span class="linenos"> 195</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_time_str</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPaths-196"><a href="#CsvPaths-196"><span class="linenos"> 196</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_run_time_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">get_run_time_str</span><span class="p">(</span>
</span><span id="CsvPaths-197"><a href="#CsvPaths-197"><span class="linenos"> 197</span></a>                <span class="n">pathsname</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_run_time</span>
</span><span id="CsvPaths-198"><a href="#CsvPaths-198"><span class="linenos"> 198</span></a>            <span class="p">)</span>
</span><span id="CsvPaths-199"><a href="#CsvPaths-199"><span class="linenos"> 199</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_time_str</span>
</span><span id="CsvPaths-200"><a href="#CsvPaths-200"><span class="linenos"> 200</span></a>
</span><span id="CsvPaths-201"><a href="#CsvPaths-201"><span class="linenos"> 201</span></a>    <span class="nd">@property</span>
</span><span id="CsvPaths-202"><a href="#CsvPaths-202"><span class="linenos"> 202</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">current_run_time</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datetime</span><span class="p">:</span>
</span><span id="CsvPaths-203"><a href="#CsvPaths-203"><span class="linenos"> 203</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private</span>
</span><span id="CsvPaths-204"><a href="#CsvPaths-204"><span class="linenos"> 204</span></a><span class="sd">        gets the time marking the start of the run. used to create the run home directory.&quot;&quot;&quot;</span>
</span><span id="CsvPaths-205"><a href="#CsvPaths-205"><span class="linenos"> 205</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_run_time</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPaths-206"><a href="#CsvPaths-206"><span class="linenos"> 206</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_current_run_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
</span><span id="CsvPaths-207"><a href="#CsvPaths-207"><span class="linenos"> 207</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_run_time</span>
</span><span id="CsvPaths-208"><a href="#CsvPaths-208"><span class="linenos"> 208</span></a>
</span><span id="CsvPaths-209"><a href="#CsvPaths-209"><span class="linenos"> 209</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">clear_run_coordination</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPaths-210"><a href="#CsvPaths-210"><span class="linenos"> 210</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private</span>
</span><span id="CsvPaths-211"><a href="#CsvPaths-211"><span class="linenos"> 211</span></a><span class="sd">        run coordination is the set of signals that csvpaths send to affect</span>
</span><span id="CsvPaths-212"><a href="#CsvPaths-212"><span class="linenos"> 212</span></a><span class="sd">        one another through the CsvPaths instance&quot;&quot;&quot;</span>
</span><span id="CsvPaths-213"><a href="#CsvPaths-213"><span class="linenos"> 213</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_stop_all</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CsvPaths-214"><a href="#CsvPaths-214"><span class="linenos"> 214</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_fail_all</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CsvPaths-215"><a href="#CsvPaths-215"><span class="linenos"> 215</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_skip_all</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CsvPaths-216"><a href="#CsvPaths-216"><span class="linenos"> 216</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_advance_all</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="CsvPaths-217"><a href="#CsvPaths-217"><span class="linenos"> 217</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_current_run_time</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPaths-218"><a href="#CsvPaths-218"><span class="linenos"> 218</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_run_time_str</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPaths-219"><a href="#CsvPaths-219"><span class="linenos"> 219</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Cleared run coordination&quot;</span><span class="p">)</span>
</span><span id="CsvPaths-220"><a href="#CsvPaths-220"><span class="linenos"> 220</span></a>
</span><span id="CsvPaths-221"><a href="#CsvPaths-221"><span class="linenos"> 221</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">csvpath</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CsvPath</span><span class="p">:</span>
</span><span id="CsvPaths-222"><a href="#CsvPaths-222"><span class="linenos"> 222</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets a CsvPath object primed with a reference to this CsvPaths&quot;&quot;&quot;</span>
</span><span id="CsvPaths-223"><a href="#CsvPaths-223"><span class="linenos"> 223</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="n">CsvPath</span><span class="p">(</span>
</span><span id="CsvPaths-224"><a href="#CsvPaths-224"><span class="linenos"> 224</span></a>            <span class="n">csvpaths</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
</span><span id="CsvPaths-225"><a href="#CsvPaths-225"><span class="linenos"> 225</span></a>            <span class="n">delimiter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">,</span>
</span><span id="CsvPaths-226"><a href="#CsvPaths-226"><span class="linenos"> 226</span></a>            <span class="n">quotechar</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">quotechar</span><span class="p">,</span>
</span><span id="CsvPaths-227"><a href="#CsvPaths-227"><span class="linenos"> 227</span></a>            <span class="n">skip_blank_lines</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">skip_blank_lines</span><span class="p">,</span>
</span><span id="CsvPaths-228"><a href="#CsvPaths-228"><span class="linenos"> 228</span></a>            <span class="c1">#</span>
</span><span id="CsvPaths-229"><a href="#CsvPaths-229"><span class="linenos"> 229</span></a>            <span class="c1"># in the usual case we don&#39;t want csvpaths and its csvpath children</span>
</span><span id="CsvPaths-230"><a href="#CsvPaths-230"><span class="linenos"> 230</span></a>            <span class="c1"># to share the same config. sharing doesn&#39;t offer much. the flexibility</span>
</span><span id="CsvPaths-231"><a href="#CsvPaths-231"><span class="linenos"> 231</span></a>            <span class="c1"># of having separate configs is valuable.</span>
</span><span id="CsvPaths-232"><a href="#CsvPaths-232"><span class="linenos"> 232</span></a>            <span class="c1">#</span>
</span><span id="CsvPaths-233"><a href="#CsvPaths-233"><span class="linenos"> 233</span></a>            <span class="n">config</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="CsvPaths-234"><a href="#CsvPaths-234"><span class="linenos"> 234</span></a>            <span class="n">print_default</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">print_default</span><span class="p">,</span>
</span><span id="CsvPaths-235"><a href="#CsvPaths-235"><span class="linenos"> 235</span></a>            <span class="n">error_manager</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">error_manager</span><span class="p">,</span>
</span><span id="CsvPaths-236"><a href="#CsvPaths-236"><span class="linenos"> 236</span></a>        <span class="p">)</span>
</span><span id="CsvPaths-237"><a href="#CsvPaths-237"><span class="linenos"> 237</span></a>        <span class="k">return</span> <span class="n">path</span>
</span><span id="CsvPaths-238"><a href="#CsvPaths-238"><span class="linenos"> 238</span></a>
</span><span id="CsvPaths-239"><a href="#CsvPaths-239"><span class="linenos"> 239</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">stop_all</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
</span><span id="CsvPaths-240"><a href="#CsvPaths-240"><span class="linenos"> 240</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_stop_all</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="CsvPaths-241"><a href="#CsvPaths-241"><span class="linenos"> 241</span></a>
</span><span id="CsvPaths-242"><a href="#CsvPaths-242"><span class="linenos"> 242</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fail_all</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
</span><span id="CsvPaths-243"><a href="#CsvPaths-243"><span class="linenos"> 243</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_fail_all</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="CsvPaths-244"><a href="#CsvPaths-244"><span class="linenos"> 244</span></a>
</span><span id="CsvPaths-245"><a href="#CsvPaths-245"><span class="linenos"> 245</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">skip_all</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
</span><span id="CsvPaths-246"><a href="#CsvPaths-246"><span class="linenos"> 246</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_skip_all</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="CsvPaths-247"><a href="#CsvPaths-247"><span class="linenos"> 247</span></a>
</span><span id="CsvPaths-248"><a href="#CsvPaths-248"><span class="linenos"> 248</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">advance_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lines</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
</span><span id="CsvPaths-249"><a href="#CsvPaths-249"><span class="linenos"> 249</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_advance_all</span> <span class="o">=</span> <span class="n">lines</span>
</span><span id="CsvPaths-250"><a href="#CsvPaths-250"><span class="linenos"> 250</span></a>
</span><span id="CsvPaths-251"><a href="#CsvPaths-251"><span class="linenos"> 251</span></a>    <span class="nd">@property</span>
</span><span id="CsvPaths-252"><a href="#CsvPaths-252"><span class="linenos"> 252</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">errors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Error</span><span class="p">]:</span>  <span class="c1"># pylint: disable=C0116</span>
</span><span id="CsvPaths-253"><a href="#CsvPaths-253"><span class="linenos"> 253</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private</span>
</span><span id="CsvPaths-254"><a href="#CsvPaths-254"><span class="linenos"> 254</span></a><span class="sd">        generally you should be looking at results_manager or error_manager for errors.</span>
</span><span id="CsvPaths-255"><a href="#CsvPaths-255"><span class="linenos"> 255</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CsvPaths-256"><a href="#CsvPaths-256"><span class="linenos"> 256</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span>
</span><span id="CsvPaths-257"><a href="#CsvPaths-257"><span class="linenos"> 257</span></a>
</span><span id="CsvPaths-258"><a href="#CsvPaths-258"><span class="linenos"> 258</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">collect_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">error</span><span class="p">:</span> <span class="n">Error</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pylint: disable=C0116</span>
</span><span id="CsvPaths-259"><a href="#CsvPaths-259"><span class="linenos"> 259</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPaths-260"><a href="#CsvPaths-260"><span class="linenos"> 260</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
</span><span id="CsvPaths-261"><a href="#CsvPaths-261"><span class="linenos"> 261</span></a>
</span><span id="CsvPaths-262"><a href="#CsvPaths-262"><span class="linenos"> 262</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">has_errors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>  <span class="c1"># pylint: disable=C0116</span>
</span><span id="CsvPaths-263"><a href="#CsvPaths-263"><span class="linenos"> 263</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private</span>
</span><span id="CsvPaths-264"><a href="#CsvPaths-264"><span class="linenos"> 264</span></a><span class="sd">        generally you should be looking at results_manager or error_manager for errors.</span>
</span><span id="CsvPaths-265"><a href="#CsvPaths-265"><span class="linenos"> 265</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CsvPaths-266"><a href="#CsvPaths-266"><span class="linenos"> 266</span></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_errors</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
</span><span id="CsvPaths-267"><a href="#CsvPaths-267"><span class="linenos"> 267</span></a>
</span><span id="CsvPaths-268"><a href="#CsvPaths-268"><span class="linenos"> 268</span></a>    <span class="nd">@property</span>
</span><span id="CsvPaths-269"><a href="#CsvPaths-269"><span class="linenos"> 269</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Config</span><span class="p">:</span>  <span class="c1"># pylint: disable=C0116</span>
</span><span id="CsvPaths-270"><a href="#CsvPaths-270"><span class="linenos"> 270</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPaths-271"><a href="#CsvPaths-271"><span class="linenos"> 271</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">:</span>
</span><span id="CsvPaths-272"><a href="#CsvPaths-272"><span class="linenos"> 272</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">()</span>  <span class="c1"># pragma: no cover</span>
</span><span id="CsvPaths-273"><a href="#CsvPaths-273"><span class="linenos"> 273</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config</span>
</span><span id="CsvPaths-274"><a href="#CsvPaths-274"><span class="linenos"> 274</span></a>
</span><span id="CsvPaths-275"><a href="#CsvPaths-275"><span class="linenos"> 275</span></a>    <span class="c1">#</span>
</span><span id="CsvPaths-276"><a href="#CsvPaths-276"><span class="linenos"> 276</span></a>    <span class="c1"># this is the preferred way to update config. it is preferred because</span>
</span><span id="CsvPaths-277"><a href="#CsvPaths-277"><span class="linenos"> 277</span></a>    <span class="c1"># csvpath and csvpaths work off the same config file, even though they,</span>
</span><span id="CsvPaths-278"><a href="#CsvPaths-278"><span class="linenos"> 278</span></a>    <span class="c1"># in some cases, have separate keys. if you update the config directly</span>
</span><span id="CsvPaths-279"><a href="#CsvPaths-279"><span class="linenos"> 279</span></a>    <span class="c1"># before a run starts using the CsvPaths&#39;s Config you have to remember</span>
</span><span id="CsvPaths-280"><a href="#CsvPaths-280"><span class="linenos"> 280</span></a>    <span class="c1"># to save and reload for it to effect both CsvPaths and CsvPath. this</span>
</span><span id="CsvPaths-281"><a href="#CsvPaths-281"><span class="linenos"> 281</span></a>    <span class="c1"># method does the save and reload every time.</span>
</span><span id="CsvPaths-282"><a href="#CsvPaths-282"><span class="linenos"> 282</span></a>    <span class="c1">#</span>
</span><span id="CsvPaths-283"><a href="#CsvPaths-283"><span class="linenos"> 283</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">add_to_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">section</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPaths-284"><a href="#CsvPaths-284"><span class="linenos"> 284</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPaths-285"><a href="#CsvPaths-285"><span class="linenos"> 285</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">add_to_config</span><span class="p">(</span><span class="n">section</span><span class="o">=</span><span class="n">section</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>
</span><span id="CsvPaths-286"><a href="#CsvPaths-286"><span class="linenos"> 286</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">save_config</span><span class="p">()</span>
</span><span id="CsvPaths-287"><a href="#CsvPaths-287"><span class="linenos"> 287</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">reload</span><span class="p">()</span>
</span><span id="CsvPaths-288"><a href="#CsvPaths-288"><span class="linenos"> 288</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_managers</span><span class="p">()</span>
</span><span id="CsvPaths-289"><a href="#CsvPaths-289"><span class="linenos"> 289</span></a>
</span><span id="CsvPaths-290"><a href="#CsvPaths-290"><span class="linenos"> 290</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">clean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">paths</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPaths-291"><a href="#CsvPaths-291"><span class="linenos"> 291</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private</span>
</span><span id="CsvPaths-292"><a href="#CsvPaths-292"><span class="linenos"> 292</span></a><span class="sd">        at this time we do not recommend reusing CsvPaths, but it is doable</span>
</span><span id="CsvPaths-293"><a href="#CsvPaths-293"><span class="linenos"> 293</span></a><span class="sd">        you should clean before reuse unless you want to accumulate results.&quot;&quot;&quot;</span>
</span><span id="CsvPaths-294"><a href="#CsvPaths-294"><span class="linenos"> 294</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">clean_named_results</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span>
</span><span id="CsvPaths-295"><a href="#CsvPaths-295"><span class="linenos"> 295</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clear_run_coordination</span><span class="p">()</span>
</span><span id="CsvPaths-296"><a href="#CsvPaths-296"><span class="linenos"> 296</span></a>        <span class="c1"># self.error_manager.reset()</span>
</span><span id="CsvPaths-297"><a href="#CsvPaths-297"><span class="linenos"> 297</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CsvPaths-298"><a href="#CsvPaths-298"><span class="linenos"> 298</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">named_paths_name</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPaths-299"><a href="#CsvPaths-299"><span class="linenos"> 299</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">named_file_name</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPaths-300"><a href="#CsvPaths-300"><span class="linenos"> 300</span></a>
</span><span id="CsvPaths-301"><a href="#CsvPaths-301"><span class="linenos"> 301</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">collect_paths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPaths-302"><a href="#CsvPaths-302"><span class="linenos"> 302</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CsvPaths-303"><a href="#CsvPaths-303"><span class="linenos"> 303</span></a><span class="sd">        Sequentially does a CsvPath.collect() on filename for every named path. lines are collected into results.&quot;&quot;&quot;</span>
</span><span id="CsvPaths-304"><a href="#CsvPaths-304"><span class="linenos"> 304</span></a>        <span class="n">paths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">paths_manager</span><span class="o">.</span><span class="n">get_named_paths</span><span class="p">(</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths-305"><a href="#CsvPaths-305"><span class="linenos"> 305</span></a>        <span class="k">if</span> <span class="n">paths</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPaths-306"><a href="#CsvPaths-306"><span class="linenos"> 306</span></a>            <span class="k">raise</span> <span class="n">InputException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No named-paths found for </span><span class="si">{</span><span class="n">pathsname</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="CsvPaths-307"><a href="#CsvPaths-307"><span class="linenos"> 307</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CsvPaths-308"><a href="#CsvPaths-308"><span class="linenos"> 308</span></a>            <span class="k">raise</span> <span class="n">InputException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Named-paths group </span><span class="si">{</span><span class="n">pathsname</span><span class="si">}</span><span class="s2"> is empty&quot;</span><span class="p">)</span>
</span><span id="CsvPaths-309"><a href="#CsvPaths-309"><span class="linenos"> 309</span></a>        <span class="k">if</span> <span class="s2">&quot;&quot;</span> <span class="ow">in</span> <span class="n">paths</span><span class="p">:</span>
</span><span id="CsvPaths-310"><a href="#CsvPaths-310"><span class="linenos"> 310</span></a>            <span class="k">raise</span> <span class="n">InputException</span><span class="p">(</span>
</span><span id="CsvPaths-311"><a href="#CsvPaths-311"><span class="linenos"> 311</span></a>                <span class="sa">f</span><span class="s2">&quot;Named-paths group </span><span class="si">{</span><span class="n">pathsname</span><span class="si">}</span><span class="s2"> has one or more empty csvpaths&quot;</span>
</span><span id="CsvPaths-312"><a href="#CsvPaths-312"><span class="linenos"> 312</span></a>            <span class="p">)</span>
</span><span id="CsvPaths-313"><a href="#CsvPaths-313"><span class="linenos"> 313</span></a>        <span class="n">file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_manager</span><span class="o">.</span><span class="n">get_named_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span><span id="CsvPaths-314"><a href="#CsvPaths-314"><span class="linenos"> 314</span></a>        <span class="k">if</span> <span class="n">file</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPaths-315"><a href="#CsvPaths-315"><span class="linenos"> 315</span></a>            <span class="k">raise</span> <span class="n">InputException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No named-file found for </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="CsvPaths-316"><a href="#CsvPaths-316"><span class="linenos"> 316</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Prepping </span><span class="si">%s</span><span class="s2"> and </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths-317"><a href="#CsvPaths-317"><span class="linenos"> 317</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clean</span><span class="p">(</span><span class="n">paths</span><span class="o">=</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths-318"><a href="#CsvPaths-318"><span class="linenos"> 318</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="CsvPaths-319"><a href="#CsvPaths-319"><span class="linenos"> 319</span></a>            <span class="s2">&quot;Beginning collect_paths </span><span class="si">%s</span><span class="s2"> with </span><span class="si">%s</span><span class="s2"> paths&quot;</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span>
</span><span id="CsvPaths-320"><a href="#CsvPaths-320"><span class="linenos"> 320</span></a>        <span class="p">)</span>
</span><span id="CsvPaths-321"><a href="#CsvPaths-321"><span class="linenos"> 321</span></a>        <span class="n">crt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_time_str</span><span class="p">(</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths-322"><a href="#CsvPaths-322"><span class="linenos"> 322</span></a>        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CsvPaths-323"><a href="#CsvPaths-323"><span class="linenos"> 323</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-324"><a href="#CsvPaths-324"><span class="linenos"> 324</span></a>        <span class="c1"># run starts here</span>
</span><span id="CsvPaths-325"><a href="#CsvPaths-325"><span class="linenos"> 325</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-326"><a href="#CsvPaths-326"><span class="linenos"> 326</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">start_run</span><span class="p">(</span>
</span><span id="CsvPaths-327"><a href="#CsvPaths-327"><span class="linenos"> 327</span></a>            <span class="n">run_dir</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span> <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span>
</span><span id="CsvPaths-328"><a href="#CsvPaths-328"><span class="linenos"> 328</span></a>        <span class="p">)</span>
</span><span id="CsvPaths-329"><a href="#CsvPaths-329"><span class="linenos"> 329</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-330"><a href="#CsvPaths-330"><span class="linenos"> 330</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-331"><a href="#CsvPaths-331"><span class="linenos"> 331</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-332"><a href="#CsvPaths-332"><span class="linenos"> 332</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">path</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">paths</span><span class="p">):</span>
</span><span id="CsvPaths-333"><a href="#CsvPaths-333"><span class="linenos"> 333</span></a>            <span class="n">csvpath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">csvpath</span><span class="p">()</span>
</span><span id="CsvPaths-334"><a href="#CsvPaths-334"><span class="linenos"> 334</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">csvpath</span><span class="o">.</span><span class="n">will_run</span><span class="p">:</span>
</span><span id="CsvPaths-335"><a href="#CsvPaths-335"><span class="linenos"> 335</span></a>                <span class="k">continue</span>
</span><span id="CsvPaths-336"><a href="#CsvPaths-336"><span class="linenos"> 336</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">Result</span><span class="p">(</span>
</span><span id="CsvPaths-337"><a href="#CsvPaths-337"><span class="linenos"> 337</span></a>                <span class="n">csvpath</span><span class="o">=</span><span class="n">csvpath</span><span class="p">,</span>
</span><span id="CsvPaths-338"><a href="#CsvPaths-338"><span class="linenos"> 338</span></a>                <span class="n">file_name</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths-339"><a href="#CsvPaths-339"><span class="linenos"> 339</span></a>                <span class="n">paths_name</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths-340"><a href="#CsvPaths-340"><span class="linenos"> 340</span></a>                <span class="n">run_index</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>
</span><span id="CsvPaths-341"><a href="#CsvPaths-341"><span class="linenos"> 341</span></a>                <span class="n">run_time</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_run_time</span><span class="p">,</span>
</span><span id="CsvPaths-342"><a href="#CsvPaths-342"><span class="linenos"> 342</span></a>                <span class="n">run_dir</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span>
</span><span id="CsvPaths-343"><a href="#CsvPaths-343"><span class="linenos"> 343</span></a>            <span class="p">)</span>
</span><span id="CsvPaths-344"><a href="#CsvPaths-344"><span class="linenos"> 344</span></a>            <span class="c1"># casting a broad net because if &quot;raise&quot; not in the error policy we</span>
</span><span id="CsvPaths-345"><a href="#CsvPaths-345"><span class="linenos"> 345</span></a>            <span class="c1"># want to never fail during a run</span>
</span><span id="CsvPaths-346"><a href="#CsvPaths-346"><span class="linenos"> 346</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="CsvPaths-347"><a href="#CsvPaths-347"><span class="linenos"> 347</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_load_csvpath</span><span class="p">(</span>
</span><span id="CsvPaths-348"><a href="#CsvPaths-348"><span class="linenos"> 348</span></a>                    <span class="n">csvpath</span><span class="o">=</span><span class="n">csvpath</span><span class="p">,</span>
</span><span id="CsvPaths-349"><a href="#CsvPaths-349"><span class="linenos"> 349</span></a>                    <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>
</span><span id="CsvPaths-350"><a href="#CsvPaths-350"><span class="linenos"> 350</span></a>                    <span class="n">file</span><span class="o">=</span><span class="n">file</span><span class="p">,</span>
</span><span id="CsvPaths-351"><a href="#CsvPaths-351"><span class="linenos"> 351</span></a>                    <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths-352"><a href="#CsvPaths-352"><span class="linenos"> 352</span></a>                    <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths-353"><a href="#CsvPaths-353"><span class="linenos"> 353</span></a>                    <span class="n">crt</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span>
</span><span id="CsvPaths-354"><a href="#CsvPaths-354"><span class="linenos"> 354</span></a>                <span class="p">)</span>
</span><span id="CsvPaths-355"><a href="#CsvPaths-355"><span class="linenos"> 355</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths-356"><a href="#CsvPaths-356"><span class="linenos"> 356</span></a>                <span class="c1"># if run-mode: no-run we skip ahead without saving results</span>
</span><span id="CsvPaths-357"><a href="#CsvPaths-357"><span class="linenos"> 357</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths-358"><a href="#CsvPaths-358"><span class="linenos"> 358</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">csvpath</span><span class="o">.</span><span class="n">will_run</span><span class="p">:</span>
</span><span id="CsvPaths-359"><a href="#CsvPaths-359"><span class="linenos"> 359</span></a>                    <span class="k">continue</span>
</span><span id="CsvPaths-360"><a href="#CsvPaths-360"><span class="linenos"> 360</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths-361"><a href="#CsvPaths-361"><span class="linenos"> 361</span></a>                <span class="c1"># the add has to come after _load_csvpath because we need the identity or index</span>
</span><span id="CsvPaths-362"><a href="#CsvPaths-362"><span class="linenos"> 362</span></a>                <span class="c1"># to be stable and the identity is found in load, if it exists.</span>
</span><span id="CsvPaths-363"><a href="#CsvPaths-363"><span class="linenos"> 363</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths-364"><a href="#CsvPaths-364"><span class="linenos"> 364</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">add_named_result</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths-365"><a href="#CsvPaths-365"><span class="linenos"> 365</span></a>                <span class="n">lines</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">lines</span>
</span><span id="CsvPaths-366"><a href="#CsvPaths-366"><span class="linenos"> 366</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Collecting lines using a </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">lines</span><span class="p">))</span>
</span><span id="CsvPaths-367"><a href="#CsvPaths-367"><span class="linenos"> 367</span></a>                <span class="n">csvpath</span><span class="o">.</span><span class="n">collect</span><span class="p">(</span><span class="n">lines</span><span class="o">=</span><span class="n">lines</span><span class="p">)</span>
</span><span id="CsvPaths-368"><a href="#CsvPaths-368"><span class="linenos"> 368</span></a>                <span class="k">if</span> <span class="n">lines</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPaths-369"><a href="#CsvPaths-369"><span class="linenos"> 369</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>  <span class="c1"># pragma: no cover</span>
</span><span id="CsvPaths-370"><a href="#CsvPaths-370"><span class="linenos"> 370</span></a>                        <span class="s2">&quot;Unexpected None for lines after collect_paths: file: </span><span class="si">%s</span><span class="s2">, match: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="CsvPaths-371"><a href="#CsvPaths-371"><span class="linenos"> 371</span></a>                        <span class="n">file</span><span class="p">,</span>
</span><span id="CsvPaths-372"><a href="#CsvPaths-372"><span class="linenos"> 372</span></a>                        <span class="n">csvpath</span><span class="o">.</span><span class="n">match</span><span class="p">,</span>
</span><span id="CsvPaths-373"><a href="#CsvPaths-373"><span class="linenos"> 373</span></a>                    <span class="p">)</span>
</span><span id="CsvPaths-374"><a href="#CsvPaths-374"><span class="linenos"> 374</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths-375"><a href="#CsvPaths-375"><span class="linenos"> 375</span></a>                <span class="c1"># this is obviously not a good idea for very large files!</span>
</span><span id="CsvPaths-376"><a href="#CsvPaths-376"><span class="linenos"> 376</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths-377"><a href="#CsvPaths-377"><span class="linenos"> 377</span></a>                <span class="n">result</span><span class="o">.</span><span class="n">unmatched</span> <span class="o">=</span> <span class="n">csvpath</span><span class="o">.</span><span class="n">unmatched</span>
</span><span id="CsvPaths-378"><a href="#CsvPaths-378"><span class="linenos"> 378</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>  <span class="c1"># pylint: disable=W0718</span>
</span><span id="CsvPaths-379"><a href="#CsvPaths-379"><span class="linenos"> 379</span></a>                <span class="c1"># ex.trace = traceback.format_exc()</span>
</span><span id="CsvPaths-380"><a href="#CsvPaths-380"><span class="linenos"> 380</span></a>                <span class="c1"># ex.source = self</span>
</span><span id="CsvPaths-381"><a href="#CsvPaths-381"><span class="linenos"> 381</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">error_manager</span><span class="o">.</span><span class="n">csvpaths</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPaths-382"><a href="#CsvPaths-382"><span class="linenos"> 382</span></a>                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;ErrorManager&#39;s CsvPaths cannot be None&quot;</span><span class="p">)</span>
</span><span id="CsvPaths-383"><a href="#CsvPaths-383"><span class="linenos"> 383</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">error_manager</span><span class="o">.</span><span class="n">handle_error</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="CsvPaths-384"><a href="#CsvPaths-384"><span class="linenos"> 384</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ecoms</span><span class="o">.</span><span class="n">do_i_raise</span><span class="p">():</span>
</span><span id="CsvPaths-385"><a href="#CsvPaths-385"><span class="linenos"> 385</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths-386"><a href="#CsvPaths-386"><span class="linenos"> 386</span></a>                    <span class="k">raise</span>
</span><span id="CsvPaths-387"><a href="#CsvPaths-387"><span class="linenos"> 387</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths-388"><a href="#CsvPaths-388"><span class="linenos"> 388</span></a>            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths-389"><a href="#CsvPaths-389"><span class="linenos"> 389</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-390"><a href="#CsvPaths-390"><span class="linenos"> 390</span></a>        <span class="c1"># run ends here</span>
</span><span id="CsvPaths-391"><a href="#CsvPaths-391"><span class="linenos"> 391</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-392"><a href="#CsvPaths-392"><span class="linenos"> 392</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">complete_run</span><span class="p">(</span>
</span><span id="CsvPaths-393"><a href="#CsvPaths-393"><span class="linenos"> 393</span></a>            <span class="n">run_dir</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span> <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span>
</span><span id="CsvPaths-394"><a href="#CsvPaths-394"><span class="linenos"> 394</span></a>        <span class="p">)</span>
</span><span id="CsvPaths-395"><a href="#CsvPaths-395"><span class="linenos"> 395</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-396"><a href="#CsvPaths-396"><span class="linenos"> 396</span></a>        <span class="c1"># update/write run manifests here</span>
</span><span id="CsvPaths-397"><a href="#CsvPaths-397"><span class="linenos"> 397</span></a>        <span class="c1">#  - validity (are all paths valid)</span>
</span><span id="CsvPaths-398"><a href="#CsvPaths-398"><span class="linenos"> 398</span></a>        <span class="c1">#  - paths-completeness (did they all run and complete)</span>
</span><span id="CsvPaths-399"><a href="#CsvPaths-399"><span class="linenos"> 399</span></a>        <span class="c1">#  - method (collect, fast_forward, next)</span>
</span><span id="CsvPaths-400"><a href="#CsvPaths-400"><span class="linenos"> 400</span></a>        <span class="c1">#  - timestamp</span>
</span><span id="CsvPaths-401"><a href="#CsvPaths-401"><span class="linenos"> 401</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-402"><a href="#CsvPaths-402"><span class="linenos"> 402</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clear_run_coordination</span><span class="p">()</span>
</span><span id="CsvPaths-403"><a href="#CsvPaths-403"><span class="linenos"> 403</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="CsvPaths-404"><a href="#CsvPaths-404"><span class="linenos"> 404</span></a>            <span class="s2">&quot;Completed collect_paths </span><span class="si">%s</span><span class="s2"> with </span><span class="si">%s</span><span class="s2"> paths&quot;</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span>
</span><span id="CsvPaths-405"><a href="#CsvPaths-405"><span class="linenos"> 405</span></a>        <span class="p">)</span>
</span><span id="CsvPaths-406"><a href="#CsvPaths-406"><span class="linenos"> 406</span></a>
</span><span id="CsvPaths-407"><a href="#CsvPaths-407"><span class="linenos"> 407</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_load_csvpath</span><span class="p">(</span>
</span><span id="CsvPaths-408"><a href="#CsvPaths-408"><span class="linenos"> 408</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="CsvPaths-409"><a href="#CsvPaths-409"><span class="linenos"> 409</span></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="CsvPaths-410"><a href="#CsvPaths-410"><span class="linenos"> 410</span></a>        <span class="n">csvpath</span><span class="p">:</span> <span class="n">CsvPath</span><span class="p">,</span>
</span><span id="CsvPaths-411"><a href="#CsvPaths-411"><span class="linenos"> 411</span></a>        <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="CsvPaths-412"><a href="#CsvPaths-412"><span class="linenos"> 412</span></a>        <span class="n">file</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="CsvPaths-413"><a href="#CsvPaths-413"><span class="linenos"> 413</span></a>        <span class="n">pathsname</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="CsvPaths-414"><a href="#CsvPaths-414"><span class="linenos"> 414</span></a>        <span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths-415"><a href="#CsvPaths-415"><span class="linenos"> 415</span></a>        <span class="n">by_line</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="CsvPaths-416"><a href="#CsvPaths-416"><span class="linenos"> 416</span></a>        <span class="n">crt</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="CsvPaths-417"><a href="#CsvPaths-417"><span class="linenos"> 417</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPaths-418"><a href="#CsvPaths-418"><span class="linenos"> 418</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPaths-419"><a href="#CsvPaths-419"><span class="linenos"> 419</span></a>        <span class="c1"># file is the physical file (+/- if preceding mode) filename is the named-file name</span>
</span><span id="CsvPaths-420"><a href="#CsvPaths-420"><span class="linenos"> 420</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Beginning to load csvpath </span><span class="si">%s</span><span class="s2"> with file </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
</span><span id="CsvPaths-421"><a href="#CsvPaths-421"><span class="linenos"> 421</span></a>        <span class="n">csvpath</span><span class="o">.</span><span class="n">named_paths_name</span> <span class="o">=</span> <span class="n">pathsname</span>
</span><span id="CsvPaths-422"><a href="#CsvPaths-422"><span class="linenos"> 422</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">named_paths_name</span> <span class="o">=</span> <span class="n">pathsname</span>
</span><span id="CsvPaths-423"><a href="#CsvPaths-423"><span class="linenos"> 423</span></a>        <span class="n">csvpath</span><span class="o">.</span><span class="n">named_file_name</span> <span class="o">=</span> <span class="n">filename</span>
</span><span id="CsvPaths-424"><a href="#CsvPaths-424"><span class="linenos"> 424</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">named_file_name</span> <span class="o">=</span> <span class="n">filename</span>
</span><span id="CsvPaths-425"><a href="#CsvPaths-425"><span class="linenos"> 425</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-426"><a href="#CsvPaths-426"><span class="linenos"> 426</span></a>        <span class="c1"># by_line==True means we are starting a run that is breadth-first ultimately using</span>
</span><span id="CsvPaths-427"><a href="#CsvPaths-427"><span class="linenos"> 427</span></a>        <span class="c1"># next_by_line(). by_line runs cannot be source-mode preceding and have different</span>
</span><span id="CsvPaths-428"><a href="#CsvPaths-428"><span class="linenos"> 428</span></a>        <span class="c1"># semantics around csvpaths influencing one another.</span>
</span><span id="CsvPaths-429"><a href="#CsvPaths-429"><span class="linenos"> 429</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-430"><a href="#CsvPaths-430"><span class="linenos"> 430</span></a>        <span class="c1"># we strip comments from above the path so we need to extract them first</span>
</span><span id="CsvPaths-431"><a href="#CsvPaths-431"><span class="linenos"> 431</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="n">MetadataParser</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">extract_metadata</span><span class="p">(</span><span class="n">instance</span><span class="o">=</span><span class="n">csvpath</span><span class="p">,</span> <span class="n">csvpath</span><span class="o">=</span><span class="n">path</span><span class="p">)</span>
</span><span id="CsvPaths-432"><a href="#CsvPaths-432"><span class="linenos"> 432</span></a>        <span class="n">identity</span> <span class="o">=</span> <span class="n">csvpath</span><span class="o">.</span><span class="n">identity</span>
</span><span id="CsvPaths-433"><a href="#CsvPaths-433"><span class="linenos"> 433</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Csvpath </span><span class="si">%s</span><span class="s2"> after metadata extract: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">identity</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
</span><span id="CsvPaths-434"><a href="#CsvPaths-434"><span class="linenos"> 434</span></a>        <span class="c1"># update the settings using the metadata fields we just collected</span>
</span><span id="CsvPaths-435"><a href="#CsvPaths-435"><span class="linenos"> 435</span></a>        <span class="n">csvpath</span><span class="o">.</span><span class="n">update_settings_from_metadata</span><span class="p">()</span>
</span><span id="CsvPaths-436"><a href="#CsvPaths-436"><span class="linenos"> 436</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-437"><a href="#CsvPaths-437"><span class="linenos"> 437</span></a>        <span class="c1"># if we have a reference, resolve it. we may not actually use the file</span>
</span><span id="CsvPaths-438"><a href="#CsvPaths-438"><span class="linenos"> 438</span></a>        <span class="c1"># if we&#39;re in source-mode: preceding, but that doesn&#39;t matter from the</span>
</span><span id="CsvPaths-439"><a href="#CsvPaths-439"><span class="linenos"> 439</span></a>        <span class="c1"># pov of the reference.</span>
</span><span id="CsvPaths-440"><a href="#CsvPaths-440"><span class="linenos"> 440</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-441"><a href="#CsvPaths-441"><span class="linenos"> 441</span></a>        <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;$&quot;</span><span class="p">):</span>
</span><span id="CsvPaths-442"><a href="#CsvPaths-442"><span class="linenos"> 442</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="CsvPaths-443"><a href="#CsvPaths-443"><span class="linenos"> 443</span></a>                <span class="s2">&quot;File name is a reference: </span><span class="si">%s</span><span class="s2">. Replacing the path passed in with the reffed data file path.&quot;</span><span class="p">,</span>
</span><span id="CsvPaths-444"><a href="#CsvPaths-444"><span class="linenos"> 444</span></a>                <span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths-445"><a href="#CsvPaths-445"><span class="linenos"> 445</span></a>            <span class="p">)</span>
</span><span id="CsvPaths-446"><a href="#CsvPaths-446"><span class="linenos"> 446</span></a>            <span class="n">file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">data_file_for_reference</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">not_name</span><span class="o">=</span><span class="n">crt</span><span class="p">)</span>
</span><span id="CsvPaths-447"><a href="#CsvPaths-447"><span class="linenos"> 447</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-448"><a href="#CsvPaths-448"><span class="linenos"> 448</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-449"><a href="#CsvPaths-449"><span class="linenos"> 449</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-450"><a href="#CsvPaths-450"><span class="linenos"> 450</span></a>        <span class="k">if</span> <span class="n">csvpath</span><span class="o">.</span><span class="n">data_from_preceding</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="CsvPaths-451"><a href="#CsvPaths-451"><span class="linenos"> 451</span></a>            <span class="k">if</span> <span class="n">by_line</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="CsvPaths-452"><a href="#CsvPaths-452"><span class="linenos"> 452</span></a>                <span class="k">raise</span> <span class="n">CsvPathsException</span><span class="p">(</span>
</span><span id="CsvPaths-453"><a href="#CsvPaths-453"><span class="linenos"> 453</span></a>                    <span class="s2">&quot;Breadth-first runs do not support source-mode preceding because each line of data flows through each csvpath in order already&quot;</span>
</span><span id="CsvPaths-454"><a href="#CsvPaths-454"><span class="linenos"> 454</span></a>                <span class="p">)</span>
</span><span id="CsvPaths-455"><a href="#CsvPaths-455"><span class="linenos"> 455</span></a>            <span class="c1">#</span>
</span><span id="CsvPaths-456"><a href="#CsvPaths-456"><span class="linenos"> 456</span></a>            <span class="c1"># we are in source-mode: preceding</span>
</span><span id="CsvPaths-457"><a href="#CsvPaths-457"><span class="linenos"> 457</span></a>            <span class="c1"># that means we ignore the original data file path and</span>
</span><span id="CsvPaths-458"><a href="#CsvPaths-458"><span class="linenos"> 458</span></a>            <span class="c1"># instead use the data.csv from the preceding csvpath. that is,</span>
</span><span id="CsvPaths-459"><a href="#CsvPaths-459"><span class="linenos"> 459</span></a>            <span class="c1"># assuming there is a preceding csvpath and it created and</span>
</span><span id="CsvPaths-460"><a href="#CsvPaths-460"><span class="linenos"> 460</span></a>            <span class="c1"># saved data.</span>
</span><span id="CsvPaths-461"><a href="#CsvPaths-461"><span class="linenos"> 461</span></a>            <span class="c1">#</span>
</span><span id="CsvPaths-462"><a href="#CsvPaths-462"><span class="linenos"> 462</span></a>            <span class="c1"># find the preceding csvpath in the named-paths</span>
</span><span id="CsvPaths-463"><a href="#CsvPaths-463"><span class="linenos"> 463</span></a>            <span class="c1">#</span>
</span><span id="CsvPaths-464"><a href="#CsvPaths-464"><span class="linenos"> 464</span></a>            <span class="c1"># we may be in a file reference like: $sourcemode.csvpaths.source2:from. if so</span>
</span><span id="CsvPaths-465"><a href="#CsvPaths-465"><span class="linenos"> 465</span></a>            <span class="c1"># we just need the named-paths name.</span>
</span><span id="CsvPaths-466"><a href="#CsvPaths-466"><span class="linenos"> 466</span></a>            <span class="c1">#</span>
</span><span id="CsvPaths-467"><a href="#CsvPaths-467"><span class="linenos"> 467</span></a>            <span class="k">if</span> <span class="n">pathsname</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;$&quot;</span><span class="p">):</span>
</span><span id="CsvPaths-468"><a href="#CsvPaths-468"><span class="linenos"> 468</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="CsvPaths-469"><a href="#CsvPaths-469"><span class="linenos"> 469</span></a>                    <span class="s2">&quot;Named-paths name is a reference: </span><span class="si">%s</span><span class="s2">. Stripping it down to just the actual named-paths name.&quot;</span><span class="p">,</span>
</span><span id="CsvPaths-470"><a href="#CsvPaths-470"><span class="linenos"> 470</span></a>                    <span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths-471"><a href="#CsvPaths-471"><span class="linenos"> 471</span></a>                <span class="p">)</span>
</span><span id="CsvPaths-472"><a href="#CsvPaths-472"><span class="linenos"> 472</span></a>                <span class="n">pathsname</span> <span class="o">=</span> <span class="n">pathsname</span><span class="p">[</span><span class="mi">1</span> <span class="p">:</span> <span class="n">pathsname</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)]</span>
</span><span id="CsvPaths-473"><a href="#CsvPaths-473"><span class="linenos"> 473</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">get_last_named_result</span><span class="p">(</span>
</span><span id="CsvPaths-474"><a href="#CsvPaths-474"><span class="linenos"> 474</span></a>                <span class="n">name</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span> <span class="n">before</span><span class="o">=</span><span class="n">csvpath</span><span class="o">.</span><span class="n">identity</span>
</span><span id="CsvPaths-475"><a href="#CsvPaths-475"><span class="linenos"> 475</span></a>            <span class="p">)</span>
</span><span id="CsvPaths-476"><a href="#CsvPaths-476"><span class="linenos"> 476</span></a>            <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPaths-477"><a href="#CsvPaths-477"><span class="linenos"> 477</span></a>                <span class="c1"># get its data.csv path for this present run</span>
</span><span id="CsvPaths-478"><a href="#CsvPaths-478"><span class="linenos"> 478</span></a>                <span class="c1"># swap in that path for the regular origin path</span>
</span><span id="CsvPaths-479"><a href="#CsvPaths-479"><span class="linenos"> 479</span></a>                <span class="n">file</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">data_file_path</span>
</span><span id="CsvPaths-480"><a href="#CsvPaths-480"><span class="linenos"> 480</span></a>                <span class="n">csvpath</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;source-mode-source&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">file</span>
</span><span id="CsvPaths-481"><a href="#CsvPaths-481"><span class="linenos"> 481</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="CsvPaths-482"><a href="#CsvPaths-482"><span class="linenos"> 482</span></a>                    <span class="s2">&quot;Csvpath identified as </span><span class="si">%s</span><span class="s2"> uses last csvpath&#39;s data.csv at </span><span class="si">%s</span><span class="s2"> as source&quot;</span><span class="p">,</span>
</span><span id="CsvPaths-483"><a href="#CsvPaths-483"><span class="linenos"> 483</span></a>                    <span class="n">csvpath</span><span class="o">.</span><span class="n">identity</span><span class="p">,</span>
</span><span id="CsvPaths-484"><a href="#CsvPaths-484"><span class="linenos"> 484</span></a>                    <span class="n">file</span><span class="p">,</span>
</span><span id="CsvPaths-485"><a href="#CsvPaths-485"><span class="linenos"> 485</span></a>                <span class="p">)</span>
</span><span id="CsvPaths-486"><a href="#CsvPaths-486"><span class="linenos"> 486</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="CsvPaths-487"><a href="#CsvPaths-487"><span class="linenos"> 487</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="CsvPaths-488"><a href="#CsvPaths-488"><span class="linenos"> 488</span></a>                    <span class="s2">&quot;Cannot find a preceding data file to use for csvpath identified as </span><span class="si">%s</span><span class="s2"> running in source-mode&quot;</span><span class="p">,</span>
</span><span id="CsvPaths-489"><a href="#CsvPaths-489"><span class="linenos"> 489</span></a>                    <span class="n">csvpath</span><span class="o">.</span><span class="n">identity</span><span class="p">,</span>
</span><span id="CsvPaths-490"><a href="#CsvPaths-490"><span class="linenos"> 490</span></a>                <span class="p">)</span>
</span><span id="CsvPaths-491"><a href="#CsvPaths-491"><span class="linenos"> 491</span></a>        <span class="n">f</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">)</span>
</span><span id="CsvPaths-492"><a href="#CsvPaths-492"><span class="linenos"> 492</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Csvpath matching part starts at char # </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span><span id="CsvPaths-493"><a href="#CsvPaths-493"><span class="linenos"> 493</span></a>        <span class="n">apath</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;$</span><span class="si">{</span><span class="n">file</span><span class="si">}{</span><span class="n">path</span><span class="p">[</span><span class="n">f</span><span class="p">:]</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="CsvPaths-494"><a href="#CsvPaths-494"><span class="linenos"> 494</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Parsing csvpath </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">apath</span><span class="p">)</span>
</span><span id="CsvPaths-495"><a href="#CsvPaths-495"><span class="linenos"> 495</span></a>        <span class="n">csvpath</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">apath</span><span class="p">)</span>
</span><span id="CsvPaths-496"><a href="#CsvPaths-496"><span class="linenos"> 496</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-497"><a href="#CsvPaths-497"><span class="linenos"> 497</span></a>        <span class="c1"># ready to run. time to register the run. this is separate from</span>
</span><span id="CsvPaths-498"><a href="#CsvPaths-498"><span class="linenos"> 498</span></a>        <span class="c1"># the run_register.py (ResultsRegister) event</span>
</span><span id="CsvPaths-499"><a href="#CsvPaths-499"><span class="linenos"> 499</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-500"><a href="#CsvPaths-500"><span class="linenos"> 500</span></a>        <span class="c1"># crt = self.run_time_str(pathsname)</span>
</span><span id="CsvPaths-501"><a href="#CsvPaths-501"><span class="linenos"> 501</span></a>        <span class="c1"># fingerprint = self.file_manager.get_fingerprint_for_name(filename)</span>
</span><span id="CsvPaths-502"><a href="#CsvPaths-502"><span class="linenos"> 502</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-503"><a href="#CsvPaths-503"><span class="linenos"> 503</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Done loading csvpath&quot;</span><span class="p">)</span>
</span><span id="CsvPaths-504"><a href="#CsvPaths-504"><span class="linenos"> 504</span></a>
</span><span id="CsvPaths-505"><a href="#CsvPaths-505"><span class="linenos"> 505</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fast_forward_paths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
</span><span id="CsvPaths-506"><a href="#CsvPaths-506"><span class="linenos"> 506</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Sequentially does a CsvPath.fast_forward() on filename for every named path. No matches are collected.&quot;&quot;&quot;</span>
</span><span id="CsvPaths-507"><a href="#CsvPaths-507"><span class="linenos"> 507</span></a>        <span class="n">paths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">paths_manager</span><span class="o">.</span><span class="n">get_named_paths</span><span class="p">(</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths-508"><a href="#CsvPaths-508"><span class="linenos"> 508</span></a>        <span class="n">file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_manager</span><span class="o">.</span><span class="n">get_named_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span><span id="CsvPaths-509"><a href="#CsvPaths-509"><span class="linenos"> 509</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Prepping </span><span class="si">%s</span><span class="s2"> and </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths-510"><a href="#CsvPaths-510"><span class="linenos"> 510</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clean</span><span class="p">(</span><span class="n">paths</span><span class="o">=</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths-511"><a href="#CsvPaths-511"><span class="linenos"> 511</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="CsvPaths-512"><a href="#CsvPaths-512"><span class="linenos"> 512</span></a>            <span class="s2">&quot;Beginning FF </span><span class="si">%s</span><span class="s2"> with </span><span class="si">%s</span><span class="s2"> paths against file </span><span class="si">%s</span><span class="s2">. No match results will be held.&quot;</span><span class="p">,</span>
</span><span id="CsvPaths-513"><a href="#CsvPaths-513"><span class="linenos"> 513</span></a>            <span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths-514"><a href="#CsvPaths-514"><span class="linenos"> 514</span></a>            <span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">),</span>
</span><span id="CsvPaths-515"><a href="#CsvPaths-515"><span class="linenos"> 515</span></a>            <span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths-516"><a href="#CsvPaths-516"><span class="linenos"> 516</span></a>        <span class="p">)</span>
</span><span id="CsvPaths-517"><a href="#CsvPaths-517"><span class="linenos"> 517</span></a>        <span class="n">crt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_time_str</span><span class="p">(</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths-518"><a href="#CsvPaths-518"><span class="linenos"> 518</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-519"><a href="#CsvPaths-519"><span class="linenos"> 519</span></a>        <span class="c1"># run starts here</span>
</span><span id="CsvPaths-520"><a href="#CsvPaths-520"><span class="linenos"> 520</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-521"><a href="#CsvPaths-521"><span class="linenos"> 521</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">start_run</span><span class="p">(</span>
</span><span id="CsvPaths-522"><a href="#CsvPaths-522"><span class="linenos"> 522</span></a>            <span class="n">run_dir</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span> <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span>
</span><span id="CsvPaths-523"><a href="#CsvPaths-523"><span class="linenos"> 523</span></a>        <span class="p">)</span>
</span><span id="CsvPaths-524"><a href="#CsvPaths-524"><span class="linenos"> 524</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-525"><a href="#CsvPaths-525"><span class="linenos"> 525</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-526"><a href="#CsvPaths-526"><span class="linenos"> 526</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-527"><a href="#CsvPaths-527"><span class="linenos"> 527</span></a>        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CsvPaths-528"><a href="#CsvPaths-528"><span class="linenos"> 528</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">path</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">paths</span><span class="p">):</span>
</span><span id="CsvPaths-529"><a href="#CsvPaths-529"><span class="linenos"> 529</span></a>            <span class="n">csvpath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">csvpath</span><span class="p">()</span>
</span><span id="CsvPaths-530"><a href="#CsvPaths-530"><span class="linenos"> 530</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Beginning to FF CsvPath instance: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">csvpath</span><span class="p">)</span>
</span><span id="CsvPaths-531"><a href="#CsvPaths-531"><span class="linenos"> 531</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">Result</span><span class="p">(</span>
</span><span id="CsvPaths-532"><a href="#CsvPaths-532"><span class="linenos"> 532</span></a>                <span class="n">csvpath</span><span class="o">=</span><span class="n">csvpath</span><span class="p">,</span>
</span><span id="CsvPaths-533"><a href="#CsvPaths-533"><span class="linenos"> 533</span></a>                <span class="n">file_name</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths-534"><a href="#CsvPaths-534"><span class="linenos"> 534</span></a>                <span class="n">paths_name</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths-535"><a href="#CsvPaths-535"><span class="linenos"> 535</span></a>                <span class="n">run_index</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>
</span><span id="CsvPaths-536"><a href="#CsvPaths-536"><span class="linenos"> 536</span></a>                <span class="n">run_time</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_run_time</span><span class="p">,</span>
</span><span id="CsvPaths-537"><a href="#CsvPaths-537"><span class="linenos"> 537</span></a>                <span class="n">run_dir</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span>
</span><span id="CsvPaths-538"><a href="#CsvPaths-538"><span class="linenos"> 538</span></a>            <span class="p">)</span>
</span><span id="CsvPaths-539"><a href="#CsvPaths-539"><span class="linenos"> 539</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="CsvPaths-540"><a href="#CsvPaths-540"><span class="linenos"> 540</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_load_csvpath</span><span class="p">(</span>
</span><span id="CsvPaths-541"><a href="#CsvPaths-541"><span class="linenos"> 541</span></a>                    <span class="n">csvpath</span><span class="o">=</span><span class="n">csvpath</span><span class="p">,</span>
</span><span id="CsvPaths-542"><a href="#CsvPaths-542"><span class="linenos"> 542</span></a>                    <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>
</span><span id="CsvPaths-543"><a href="#CsvPaths-543"><span class="linenos"> 543</span></a>                    <span class="n">file</span><span class="o">=</span><span class="n">file</span><span class="p">,</span>
</span><span id="CsvPaths-544"><a href="#CsvPaths-544"><span class="linenos"> 544</span></a>                    <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths-545"><a href="#CsvPaths-545"><span class="linenos"> 545</span></a>                    <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths-546"><a href="#CsvPaths-546"><span class="linenos"> 546</span></a>                    <span class="n">crt</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span>
</span><span id="CsvPaths-547"><a href="#CsvPaths-547"><span class="linenos"> 547</span></a>                <span class="p">)</span>
</span><span id="CsvPaths-548"><a href="#CsvPaths-548"><span class="linenos"> 548</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths-549"><a href="#CsvPaths-549"><span class="linenos"> 549</span></a>                <span class="c1"># if run-mode: no-run we skip ahead without saving results</span>
</span><span id="CsvPaths-550"><a href="#CsvPaths-550"><span class="linenos"> 550</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths-551"><a href="#CsvPaths-551"><span class="linenos"> 551</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">csvpath</span><span class="o">.</span><span class="n">will_run</span><span class="p">:</span>
</span><span id="CsvPaths-552"><a href="#CsvPaths-552"><span class="linenos"> 552</span></a>                    <span class="k">continue</span>
</span><span id="CsvPaths-553"><a href="#CsvPaths-553"><span class="linenos"> 553</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths-554"><a href="#CsvPaths-554"><span class="linenos"> 554</span></a>                <span class="c1"># the add has to come after _load_csvpath because we need the identity or index</span>
</span><span id="CsvPaths-555"><a href="#CsvPaths-555"><span class="linenos"> 555</span></a>                <span class="c1"># to be stable and the identity is found in load, if it exists.</span>
</span><span id="CsvPaths-556"><a href="#CsvPaths-556"><span class="linenos"> 556</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths-557"><a href="#CsvPaths-557"><span class="linenos"> 557</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">add_named_result</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths-558"><a href="#CsvPaths-558"><span class="linenos"> 558</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="CsvPaths-559"><a href="#CsvPaths-559"><span class="linenos"> 559</span></a>                    <span class="s2">&quot;Parsed csvpath </span><span class="si">%s</span><span class="s2"> pointed at </span><span class="si">%s</span><span class="s2"> and starting to fast-forward&quot;</span><span class="p">,</span>
</span><span id="CsvPaths-560"><a href="#CsvPaths-560"><span class="linenos"> 560</span></a>                    <span class="n">i</span><span class="p">,</span>
</span><span id="CsvPaths-561"><a href="#CsvPaths-561"><span class="linenos"> 561</span></a>                    <span class="n">file</span><span class="p">,</span>
</span><span id="CsvPaths-562"><a href="#CsvPaths-562"><span class="linenos"> 562</span></a>                <span class="p">)</span>
</span><span id="CsvPaths-563"><a href="#CsvPaths-563"><span class="linenos"> 563</span></a>                <span class="n">csvpath</span><span class="o">.</span><span class="n">fast_forward</span><span class="p">()</span>
</span><span id="CsvPaths-564"><a href="#CsvPaths-564"><span class="linenos"> 564</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="CsvPaths-565"><a href="#CsvPaths-565"><span class="linenos"> 565</span></a>                    <span class="s2">&quot;Completed fast forward of csvpath </span><span class="si">%s</span><span class="s2"> against </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">file</span>
</span><span id="CsvPaths-566"><a href="#CsvPaths-566"><span class="linenos"> 566</span></a>                <span class="p">)</span>
</span><span id="CsvPaths-567"><a href="#CsvPaths-567"><span class="linenos"> 567</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>  <span class="c1"># pylint: disable=W0718</span>
</span><span id="CsvPaths-568"><a href="#CsvPaths-568"><span class="linenos"> 568</span></a>                <span class="c1"># ex.trace = traceback.format_exc()</span>
</span><span id="CsvPaths-569"><a href="#CsvPaths-569"><span class="linenos"> 569</span></a>                <span class="c1"># ex.source = self</span>
</span><span id="CsvPaths-570"><a href="#CsvPaths-570"><span class="linenos"> 570</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">error_manager</span><span class="o">.</span><span class="n">handle_error</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="CsvPaths-571"><a href="#CsvPaths-571"><span class="linenos"> 571</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ecoms</span><span class="o">.</span><span class="n">do_i_raise</span><span class="p">():</span>
</span><span id="CsvPaths-572"><a href="#CsvPaths-572"><span class="linenos"> 572</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths-573"><a href="#CsvPaths-573"><span class="linenos"> 573</span></a>                    <span class="k">raise</span>
</span><span id="CsvPaths-574"><a href="#CsvPaths-574"><span class="linenos"> 574</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths-575"><a href="#CsvPaths-575"><span class="linenos"> 575</span></a>            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths-576"><a href="#CsvPaths-576"><span class="linenos"> 576</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-577"><a href="#CsvPaths-577"><span class="linenos"> 577</span></a>        <span class="c1"># run ends here</span>
</span><span id="CsvPaths-578"><a href="#CsvPaths-578"><span class="linenos"> 578</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-579"><a href="#CsvPaths-579"><span class="linenos"> 579</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">complete_run</span><span class="p">(</span>
</span><span id="CsvPaths-580"><a href="#CsvPaths-580"><span class="linenos"> 580</span></a>            <span class="n">run_dir</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span> <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span>
</span><span id="CsvPaths-581"><a href="#CsvPaths-581"><span class="linenos"> 581</span></a>        <span class="p">)</span>
</span><span id="CsvPaths-582"><a href="#CsvPaths-582"><span class="linenos"> 582</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clear_run_coordination</span><span class="p">()</span>
</span><span id="CsvPaths-583"><a href="#CsvPaths-583"><span class="linenos"> 583</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="CsvPaths-584"><a href="#CsvPaths-584"><span class="linenos"> 584</span></a>            <span class="s2">&quot;Completed fast_forward_paths </span><span class="si">%s</span><span class="s2"> with </span><span class="si">%s</span><span class="s2"> paths&quot;</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span>
</span><span id="CsvPaths-585"><a href="#CsvPaths-585"><span class="linenos"> 585</span></a>        <span class="p">)</span>
</span><span id="CsvPaths-586"><a href="#CsvPaths-586"><span class="linenos"> 586</span></a>
</span><span id="CsvPaths-587"><a href="#CsvPaths-587"><span class="linenos"> 587</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">next_paths</span><span class="p">(</span>
</span><span id="CsvPaths-588"><a href="#CsvPaths-588"><span class="linenos"> 588</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">collect</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CsvPaths-589"><a href="#CsvPaths-589"><span class="linenos"> 589</span></a>    <span class="p">):</span>  <span class="c1"># pylint: disable=R0914</span>
</span><span id="CsvPaths-590"><a href="#CsvPaths-590"><span class="linenos"> 590</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Does a CsvPath.next() on filename for every line against every named path in sequence&quot;&quot;&quot;</span>
</span><span id="CsvPaths-591"><a href="#CsvPaths-591"><span class="linenos"> 591</span></a>        <span class="n">paths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">paths_manager</span><span class="o">.</span><span class="n">get_named_paths</span><span class="p">(</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths-592"><a href="#CsvPaths-592"><span class="linenos"> 592</span></a>        <span class="n">file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_manager</span><span class="o">.</span><span class="n">get_named_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span><span id="CsvPaths-593"><a href="#CsvPaths-593"><span class="linenos"> 593</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Prepping </span><span class="si">%s</span><span class="s2"> and </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths-594"><a href="#CsvPaths-594"><span class="linenos"> 594</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clean</span><span class="p">(</span><span class="n">paths</span><span class="o">=</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths-595"><a href="#CsvPaths-595"><span class="linenos"> 595</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Beginning next_paths with </span><span class="si">%s</span><span class="s2"> paths&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">))</span>
</span><span id="CsvPaths-596"><a href="#CsvPaths-596"><span class="linenos"> 596</span></a>        <span class="n">crt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_time_str</span><span class="p">(</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths-597"><a href="#CsvPaths-597"><span class="linenos"> 597</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-598"><a href="#CsvPaths-598"><span class="linenos"> 598</span></a>        <span class="c1"># run starts here</span>
</span><span id="CsvPaths-599"><a href="#CsvPaths-599"><span class="linenos"> 599</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-600"><a href="#CsvPaths-600"><span class="linenos"> 600</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">start_run</span><span class="p">(</span>
</span><span id="CsvPaths-601"><a href="#CsvPaths-601"><span class="linenos"> 601</span></a>            <span class="n">run_dir</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span> <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span>
</span><span id="CsvPaths-602"><a href="#CsvPaths-602"><span class="linenos"> 602</span></a>        <span class="p">)</span>
</span><span id="CsvPaths-603"><a href="#CsvPaths-603"><span class="linenos"> 603</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-604"><a href="#CsvPaths-604"><span class="linenos"> 604</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-605"><a href="#CsvPaths-605"><span class="linenos"> 605</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-606"><a href="#CsvPaths-606"><span class="linenos"> 606</span></a>        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CsvPaths-607"><a href="#CsvPaths-607"><span class="linenos"> 607</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">path</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">paths</span><span class="p">):</span>
</span><span id="CsvPaths-608"><a href="#CsvPaths-608"><span class="linenos"> 608</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_skip_all</span><span class="p">:</span>
</span><span id="CsvPaths-609"><a href="#CsvPaths-609"><span class="linenos"> 609</span></a>                <span class="n">skip_err</span> <span class="o">=</span> <span class="s2">&quot;Found the skip-all signal set. skip_all() is&quot;</span>
</span><span id="CsvPaths-610"><a href="#CsvPaths-610"><span class="linenos"> 610</span></a>                <span class="n">skip_err</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">skip_err</span><span class="si">}</span><span class="s2"> only for breadth-first runs using the&quot;</span>
</span><span id="CsvPaths-611"><a href="#CsvPaths-611"><span class="linenos"> 611</span></a>                <span class="n">skip_err</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">skip_err</span><span class="si">}</span><span class="s2"> &#39;_by_line&#39; methods. It has the same&quot;</span>
</span><span id="CsvPaths-612"><a href="#CsvPaths-612"><span class="linenos"> 612</span></a>                <span class="n">skip_err</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">skip_err</span><span class="si">}</span><span class="s2"> effect as skip() in a&quot;</span>
</span><span id="CsvPaths-613"><a href="#CsvPaths-613"><span class="linenos"> 613</span></a>                <span class="n">skip_err</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">skip_err</span><span class="si">}</span><span class="s2"> serial run like this one.&quot;</span>
</span><span id="CsvPaths-614"><a href="#CsvPaths-614"><span class="linenos"> 614</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">skip_err</span><span class="p">)</span>
</span><span id="CsvPaths-615"><a href="#CsvPaths-615"><span class="linenos"> 615</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stop_all</span><span class="p">:</span>
</span><span id="CsvPaths-616"><a href="#CsvPaths-616"><span class="linenos"> 616</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Stop-all set. Shutting down run.&quot;</span><span class="p">)</span>
</span><span id="CsvPaths-617"><a href="#CsvPaths-617"><span class="linenos"> 617</span></a>                <span class="k">break</span>
</span><span id="CsvPaths-618"><a href="#CsvPaths-618"><span class="linenos"> 618</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_advance_all</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CsvPaths-619"><a href="#CsvPaths-619"><span class="linenos"> 619</span></a>                <span class="n">advance_err</span> <span class="o">=</span> <span class="s2">&quot;Found the advance-all signal set. advance_all() is&quot;</span>
</span><span id="CsvPaths-620"><a href="#CsvPaths-620"><span class="linenos"> 620</span></a>                <span class="n">advance_err</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">advance_err</span><span class="si">}</span><span class="s2"> only for breadth-first runs using the&quot;</span>
</span><span id="CsvPaths-621"><a href="#CsvPaths-621"><span class="linenos"> 621</span></a>                <span class="n">advance_err</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">advance_err</span><span class="si">}</span><span class="s2"> &#39;_by_line&#39; methods. It has the same&quot;</span>
</span><span id="CsvPaths-622"><a href="#CsvPaths-622"><span class="linenos"> 622</span></a>                <span class="n">advance_err</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">advance_err</span><span class="si">}</span><span class="s2"> effect as advance() in a&quot;</span>
</span><span id="CsvPaths-623"><a href="#CsvPaths-623"><span class="linenos"> 623</span></a>                <span class="n">advance_err</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">advance_err</span><span class="si">}</span><span class="s2"> serial run like this one.&quot;</span>
</span><span id="CsvPaths-624"><a href="#CsvPaths-624"><span class="linenos"> 624</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">advance_err</span><span class="p">)</span>
</span><span id="CsvPaths-625"><a href="#CsvPaths-625"><span class="linenos"> 625</span></a>            <span class="n">csvpath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">csvpath</span><span class="p">()</span>
</span><span id="CsvPaths-626"><a href="#CsvPaths-626"><span class="linenos"> 626</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">Result</span><span class="p">(</span>
</span><span id="CsvPaths-627"><a href="#CsvPaths-627"><span class="linenos"> 627</span></a>                <span class="n">csvpath</span><span class="o">=</span><span class="n">csvpath</span><span class="p">,</span>
</span><span id="CsvPaths-628"><a href="#CsvPaths-628"><span class="linenos"> 628</span></a>                <span class="n">file_name</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths-629"><a href="#CsvPaths-629"><span class="linenos"> 629</span></a>                <span class="n">paths_name</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths-630"><a href="#CsvPaths-630"><span class="linenos"> 630</span></a>                <span class="n">run_index</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>
</span><span id="CsvPaths-631"><a href="#CsvPaths-631"><span class="linenos"> 631</span></a>                <span class="n">run_time</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_run_time</span><span class="p">,</span>
</span><span id="CsvPaths-632"><a href="#CsvPaths-632"><span class="linenos"> 632</span></a>                <span class="n">run_dir</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span>
</span><span id="CsvPaths-633"><a href="#CsvPaths-633"><span class="linenos"> 633</span></a>            <span class="p">)</span>
</span><span id="CsvPaths-634"><a href="#CsvPaths-634"><span class="linenos"> 634</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fail_all</span><span class="p">:</span>
</span><span id="CsvPaths-635"><a href="#CsvPaths-635"><span class="linenos"> 635</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="CsvPaths-636"><a href="#CsvPaths-636"><span class="linenos"> 636</span></a>                    <span class="s2">&quot;Fail-all set. Failing all remaining CsvPath instances in the run.&quot;</span>
</span><span id="CsvPaths-637"><a href="#CsvPaths-637"><span class="linenos"> 637</span></a>                <span class="p">)</span>
</span><span id="CsvPaths-638"><a href="#CsvPaths-638"><span class="linenos"> 638</span></a>                <span class="n">csvpath</span><span class="o">.</span><span class="n">is_valid</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CsvPaths-639"><a href="#CsvPaths-639"><span class="linenos"> 639</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="CsvPaths-640"><a href="#CsvPaths-640"><span class="linenos"> 640</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_load_csvpath</span><span class="p">(</span>
</span><span id="CsvPaths-641"><a href="#CsvPaths-641"><span class="linenos"> 641</span></a>                    <span class="n">csvpath</span><span class="o">=</span><span class="n">csvpath</span><span class="p">,</span>
</span><span id="CsvPaths-642"><a href="#CsvPaths-642"><span class="linenos"> 642</span></a>                    <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>
</span><span id="CsvPaths-643"><a href="#CsvPaths-643"><span class="linenos"> 643</span></a>                    <span class="n">file</span><span class="o">=</span><span class="n">file</span><span class="p">,</span>
</span><span id="CsvPaths-644"><a href="#CsvPaths-644"><span class="linenos"> 644</span></a>                    <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths-645"><a href="#CsvPaths-645"><span class="linenos"> 645</span></a>                    <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths-646"><a href="#CsvPaths-646"><span class="linenos"> 646</span></a>                    <span class="n">crt</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span>
</span><span id="CsvPaths-647"><a href="#CsvPaths-647"><span class="linenos"> 647</span></a>                <span class="p">)</span>
</span><span id="CsvPaths-648"><a href="#CsvPaths-648"><span class="linenos"> 648</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths-649"><a href="#CsvPaths-649"><span class="linenos"> 649</span></a>                <span class="c1"># if run-mode: no-run we skip ahead without saving results</span>
</span><span id="CsvPaths-650"><a href="#CsvPaths-650"><span class="linenos"> 650</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths-651"><a href="#CsvPaths-651"><span class="linenos"> 651</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">csvpath</span><span class="o">.</span><span class="n">will_run</span><span class="p">:</span>
</span><span id="CsvPaths-652"><a href="#CsvPaths-652"><span class="linenos"> 652</span></a>                    <span class="k">continue</span>
</span><span id="CsvPaths-653"><a href="#CsvPaths-653"><span class="linenos"> 653</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths-654"><a href="#CsvPaths-654"><span class="linenos"> 654</span></a>                <span class="c1"># the add has to come after _load_csvpath because we need the identity or index</span>
</span><span id="CsvPaths-655"><a href="#CsvPaths-655"><span class="linenos"> 655</span></a>                <span class="c1"># to be stable and the identity is found in load, if it exists.</span>
</span><span id="CsvPaths-656"><a href="#CsvPaths-656"><span class="linenos"> 656</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths-657"><a href="#CsvPaths-657"><span class="linenos"> 657</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">add_named_result</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths-658"><a href="#CsvPaths-658"><span class="linenos"> 658</span></a>                <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">csvpath</span><span class="o">.</span><span class="n">next</span><span class="p">():</span>
</span><span id="CsvPaths-659"><a href="#CsvPaths-659"><span class="linenos"> 659</span></a>                    <span class="c1">#</span>
</span><span id="CsvPaths-660"><a href="#CsvPaths-660"><span class="linenos"> 660</span></a>                    <span class="c1"># removed dec 1. why was this? it doesn&#39;t seem to make sense and</span>
</span><span id="CsvPaths-661"><a href="#CsvPaths-661"><span class="linenos"> 661</span></a>                    <span class="c1"># removing it doesn&#39;t break any unit tests. was it a mistake?</span>
</span><span id="CsvPaths-662"><a href="#CsvPaths-662"><span class="linenos"> 662</span></a>                    <span class="c1">#</span>
</span><span id="CsvPaths-663"><a href="#CsvPaths-663"><span class="linenos"> 663</span></a>                    <span class="c1"># line.append(result)</span>
</span><span id="CsvPaths-664"><a href="#CsvPaths-664"><span class="linenos"> 664</span></a>                    <span class="k">if</span> <span class="n">collect</span><span class="p">:</span>
</span><span id="CsvPaths-665"><a href="#CsvPaths-665"><span class="linenos"> 665</span></a>                        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="CsvPaths-666"><a href="#CsvPaths-666"><span class="linenos"> 666</span></a>                        <span class="n">result</span><span class="o">.</span><span class="n">unmatched</span> <span class="o">=</span> <span class="n">csvpath</span><span class="o">.</span><span class="n">unmatched</span>
</span><span id="CsvPaths-667"><a href="#CsvPaths-667"><span class="linenos"> 667</span></a>                    <span class="k">yield</span> <span class="n">line</span>
</span><span id="CsvPaths-668"><a href="#CsvPaths-668"><span class="linenos"> 668</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>  <span class="c1"># pylint: disable=W0718</span>
</span><span id="CsvPaths-669"><a href="#CsvPaths-669"><span class="linenos"> 669</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">error_manager</span><span class="o">.</span><span class="n">handle_error</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="CsvPaths-670"><a href="#CsvPaths-670"><span class="linenos"> 670</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ecoms</span><span class="o">.</span><span class="n">do_i_raise</span><span class="p">():</span>
</span><span id="CsvPaths-671"><a href="#CsvPaths-671"><span class="linenos"> 671</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths-672"><a href="#CsvPaths-672"><span class="linenos"> 672</span></a>                    <span class="k">raise</span>
</span><span id="CsvPaths-673"><a href="#CsvPaths-673"><span class="linenos"> 673</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths-674"><a href="#CsvPaths-674"><span class="linenos"> 674</span></a>            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths-675"><a href="#CsvPaths-675"><span class="linenos"> 675</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-676"><a href="#CsvPaths-676"><span class="linenos"> 676</span></a>        <span class="c1"># run ends here</span>
</span><span id="CsvPaths-677"><a href="#CsvPaths-677"><span class="linenos"> 677</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-678"><a href="#CsvPaths-678"><span class="linenos"> 678</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">complete_run</span><span class="p">(</span>
</span><span id="CsvPaths-679"><a href="#CsvPaths-679"><span class="linenos"> 679</span></a>            <span class="n">run_dir</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span> <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span>
</span><span id="CsvPaths-680"><a href="#CsvPaths-680"><span class="linenos"> 680</span></a>        <span class="p">)</span>
</span><span id="CsvPaths-681"><a href="#CsvPaths-681"><span class="linenos"> 681</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clear_run_coordination</span><span class="p">()</span>
</span><span id="CsvPaths-682"><a href="#CsvPaths-682"><span class="linenos"> 682</span></a>
</span><span id="CsvPaths-683"><a href="#CsvPaths-683"><span class="linenos"> 683</span></a>    <span class="c1"># =============== breadth first processing ================</span>
</span><span id="CsvPaths-684"><a href="#CsvPaths-684"><span class="linenos"> 684</span></a>
</span><span id="CsvPaths-685"><a href="#CsvPaths-685"><span class="linenos"> 685</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">collect_by_line</span><span class="p">(</span>
</span><span id="CsvPaths-686"><a href="#CsvPaths-686"><span class="linenos"> 686</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">if_all_agree</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">collect_when_not_matched</span><span class="o">=</span><span class="kc">False</span>
</span><span id="CsvPaths-687"><a href="#CsvPaths-687"><span class="linenos"> 687</span></a>    <span class="p">):</span>
</span><span id="CsvPaths-688"><a href="#CsvPaths-688"><span class="linenos"> 688</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Does a CsvPath.collect() on filename where each row is considered</span>
</span><span id="CsvPaths-689"><a href="#CsvPaths-689"><span class="linenos"> 689</span></a><span class="sd">        by every named path before the next row starts</span>
</span><span id="CsvPaths-690"><a href="#CsvPaths-690"><span class="linenos"> 690</span></a>
</span><span id="CsvPaths-691"><a href="#CsvPaths-691"><span class="linenos"> 691</span></a><span class="sd">        next_by_line for if_all_agree and collect_when_not_matched.</span>
</span><span id="CsvPaths-692"><a href="#CsvPaths-692"><span class="linenos"> 692</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CsvPaths-693"><a href="#CsvPaths-693"><span class="linenos"> 693</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="CsvPaths-694"><a href="#CsvPaths-694"><span class="linenos"> 694</span></a>            <span class="s2">&quot;Starting collect_by_line for paths: </span><span class="si">%s</span><span class="s2"> and file: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span>
</span><span id="CsvPaths-695"><a href="#CsvPaths-695"><span class="linenos"> 695</span></a>        <span class="p">)</span>
</span><span id="CsvPaths-696"><a href="#CsvPaths-696"><span class="linenos"> 696</span></a>        <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CsvPaths-697"><a href="#CsvPaths-697"><span class="linenos"> 697</span></a>        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">next_by_line</span><span class="p">(</span>  <span class="c1"># pylint: disable=W0612</span>
</span><span id="CsvPaths-698"><a href="#CsvPaths-698"><span class="linenos"> 698</span></a>            <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths-699"><a href="#CsvPaths-699"><span class="linenos"> 699</span></a>            <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths-700"><a href="#CsvPaths-700"><span class="linenos"> 700</span></a>            <span class="n">collect</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="CsvPaths-701"><a href="#CsvPaths-701"><span class="linenos"> 701</span></a>            <span class="n">if_all_agree</span><span class="o">=</span><span class="n">if_all_agree</span><span class="p">,</span>
</span><span id="CsvPaths-702"><a href="#CsvPaths-702"><span class="linenos"> 702</span></a>            <span class="n">collect_when_not_matched</span><span class="o">=</span><span class="n">collect_when_not_matched</span><span class="p">,</span>
</span><span id="CsvPaths-703"><a href="#CsvPaths-703"><span class="linenos"> 703</span></a>        <span class="p">):</span>
</span><span id="CsvPaths-704"><a href="#CsvPaths-704"><span class="linenos"> 704</span></a>            <span class="c1"># re: W0612: we need &#39;line&#39; in order to do the iteration. we have to iterate.</span>
</span><span id="CsvPaths-705"><a href="#CsvPaths-705"><span class="linenos"> 705</span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="CsvPaths-706"><a href="#CsvPaths-706"><span class="linenos"> 706</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="CsvPaths-707"><a href="#CsvPaths-707"><span class="linenos"> 707</span></a>            <span class="s2">&quot;Completed collect_by_line for paths: </span><span class="si">%s</span><span class="s2"> and file: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span>
</span><span id="CsvPaths-708"><a href="#CsvPaths-708"><span class="linenos"> 708</span></a>        <span class="p">)</span>
</span><span id="CsvPaths-709"><a href="#CsvPaths-709"><span class="linenos"> 709</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-710"><a href="#CsvPaths-710"><span class="linenos"> 710</span></a>        <span class="c1"># the results have all the lines according to what CsvPath captured them, but</span>
</span><span id="CsvPaths-711"><a href="#CsvPaths-711"><span class="linenos"> 711</span></a>        <span class="c1"># since we&#39;re doing if_all_agree T/F we should return the union here. for some</span>
</span><span id="CsvPaths-712"><a href="#CsvPaths-712"><span class="linenos"> 712</span></a>        <span class="c1"># files this obviously makes the data in memory problem even bigger, but it&#39;s</span>
</span><span id="CsvPaths-713"><a href="#CsvPaths-713"><span class="linenos"> 713</span></a>        <span class="c1"># operator&#39;s responsibility to know if that will be a problem for their use</span>
</span><span id="CsvPaths-714"><a href="#CsvPaths-714"><span class="linenos"> 714</span></a>        <span class="c1"># case.</span>
</span><span id="CsvPaths-715"><a href="#CsvPaths-715"><span class="linenos"> 715</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-716"><a href="#CsvPaths-716"><span class="linenos"> 716</span></a>        <span class="k">return</span> <span class="n">lines</span>
</span><span id="CsvPaths-717"><a href="#CsvPaths-717"><span class="linenos"> 717</span></a>
</span><span id="CsvPaths-718"><a href="#CsvPaths-718"><span class="linenos"> 718</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fast_forward_by_line</span><span class="p">(</span>
</span><span id="CsvPaths-719"><a href="#CsvPaths-719"><span class="linenos"> 719</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">if_all_agree</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">collect_when_not_matched</span><span class="o">=</span><span class="kc">False</span>
</span><span id="CsvPaths-720"><a href="#CsvPaths-720"><span class="linenos"> 720</span></a>    <span class="p">):</span>
</span><span id="CsvPaths-721"><a href="#CsvPaths-721"><span class="linenos"> 721</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Does a CsvPath.fast_forward() on filename where each row is</span>
</span><span id="CsvPaths-722"><a href="#CsvPaths-722"><span class="linenos"> 722</span></a><span class="sd">        considered by every named path before the next row starts</span>
</span><span id="CsvPaths-723"><a href="#CsvPaths-723"><span class="linenos"> 723</span></a>
</span><span id="CsvPaths-724"><a href="#CsvPaths-724"><span class="linenos"> 724</span></a><span class="sd">        next_by_line for if_all_agree and collect_when_not_matched.</span>
</span><span id="CsvPaths-725"><a href="#CsvPaths-725"><span class="linenos"> 725</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CsvPaths-726"><a href="#CsvPaths-726"><span class="linenos"> 726</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="CsvPaths-727"><a href="#CsvPaths-727"><span class="linenos"> 727</span></a>            <span class="s2">&quot;Starting fast_forward_by_line for paths: </span><span class="si">%s</span><span class="s2"> and file: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="CsvPaths-728"><a href="#CsvPaths-728"><span class="linenos"> 728</span></a>            <span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths-729"><a href="#CsvPaths-729"><span class="linenos"> 729</span></a>            <span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths-730"><a href="#CsvPaths-730"><span class="linenos"> 730</span></a>        <span class="p">)</span>
</span><span id="CsvPaths-731"><a href="#CsvPaths-731"><span class="linenos"> 731</span></a>        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">next_by_line</span><span class="p">(</span>  <span class="c1"># pylint: disable=W0612</span>
</span><span id="CsvPaths-732"><a href="#CsvPaths-732"><span class="linenos"> 732</span></a>            <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths-733"><a href="#CsvPaths-733"><span class="linenos"> 733</span></a>            <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths-734"><a href="#CsvPaths-734"><span class="linenos"> 734</span></a>            <span class="n">collect</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="CsvPaths-735"><a href="#CsvPaths-735"><span class="linenos"> 735</span></a>            <span class="n">if_all_agree</span><span class="o">=</span><span class="n">if_all_agree</span><span class="p">,</span>
</span><span id="CsvPaths-736"><a href="#CsvPaths-736"><span class="linenos"> 736</span></a>            <span class="n">collect_when_not_matched</span><span class="o">=</span><span class="n">collect_when_not_matched</span><span class="p">,</span>
</span><span id="CsvPaths-737"><a href="#CsvPaths-737"><span class="linenos"> 737</span></a>        <span class="p">):</span>
</span><span id="CsvPaths-738"><a href="#CsvPaths-738"><span class="linenos"> 738</span></a>            <span class="c1"># re: W0612: we need &#39;line&#39; in order to do the iteration. we have to iterate.</span>
</span><span id="CsvPaths-739"><a href="#CsvPaths-739"><span class="linenos"> 739</span></a>            <span class="k">pass</span>
</span><span id="CsvPaths-740"><a href="#CsvPaths-740"><span class="linenos"> 740</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="CsvPaths-741"><a href="#CsvPaths-741"><span class="linenos"> 741</span></a>            <span class="s2">&quot;Completed fast_forward_by_line for paths: </span><span class="si">%s</span><span class="s2"> and file: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="CsvPaths-742"><a href="#CsvPaths-742"><span class="linenos"> 742</span></a>            <span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths-743"><a href="#CsvPaths-743"><span class="linenos"> 743</span></a>            <span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths-744"><a href="#CsvPaths-744"><span class="linenos"> 744</span></a>        <span class="p">)</span>
</span><span id="CsvPaths-745"><a href="#CsvPaths-745"><span class="linenos"> 745</span></a>
</span><span id="CsvPaths-746"><a href="#CsvPaths-746"><span class="linenos"> 746</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">next_by_line</span><span class="p">(</span>  <span class="c1"># pylint: disable=R0912,R0915,R0914</span>
</span><span id="CsvPaths-747"><a href="#CsvPaths-747"><span class="linenos"> 747</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="CsvPaths-748"><a href="#CsvPaths-748"><span class="linenos"> 748</span></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="CsvPaths-749"><a href="#CsvPaths-749"><span class="linenos"> 749</span></a>        <span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths-750"><a href="#CsvPaths-750"><span class="linenos"> 750</span></a>        <span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths-751"><a href="#CsvPaths-751"><span class="linenos"> 751</span></a>        <span class="n">collect</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="CsvPaths-752"><a href="#CsvPaths-752"><span class="linenos"> 752</span></a>        <span class="n">if_all_agree</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="CsvPaths-753"><a href="#CsvPaths-753"><span class="linenos"> 753</span></a>        <span class="n">collect_when_not_matched</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="CsvPaths-754"><a href="#CsvPaths-754"><span class="linenos"> 754</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
</span><span id="CsvPaths-755"><a href="#CsvPaths-755"><span class="linenos"> 755</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Does a CsvPath.next() on filename where each row is considered</span>
</span><span id="CsvPaths-756"><a href="#CsvPaths-756"><span class="linenos"> 756</span></a><span class="sd">        by every named path before the next row starts.</span>
</span><span id="CsvPaths-757"><a href="#CsvPaths-757"><span class="linenos"> 757</span></a>
</span><span id="CsvPaths-758"><a href="#CsvPaths-758"><span class="linenos"> 758</span></a><span class="sd">        if_all_agree=True means all the CsvPath instances must match for</span>
</span><span id="CsvPaths-759"><a href="#CsvPaths-759"><span class="linenos"> 759</span></a><span class="sd">        the line to be kept. However, every CsvPath instance will keep its</span>
</span><span id="CsvPaths-760"><a href="#CsvPaths-760"><span class="linenos"> 760</span></a><span class="sd">        own matches in its results regardless of if every line kept was</span>
</span><span id="CsvPaths-761"><a href="#CsvPaths-761"><span class="linenos"> 761</span></a><span class="sd">        returned to the caller by CsvPaths.</span>
</span><span id="CsvPaths-762"><a href="#CsvPaths-762"><span class="linenos"> 762</span></a>
</span><span id="CsvPaths-763"><a href="#CsvPaths-763"><span class="linenos"> 763</span></a><span class="sd">        collect_when_not_matched=True inverts the match so that lines</span>
</span><span id="CsvPaths-764"><a href="#CsvPaths-764"><span class="linenos"> 764</span></a><span class="sd">        which did not match are returned, rather than the default behavior.</span>
</span><span id="CsvPaths-765"><a href="#CsvPaths-765"><span class="linenos"> 765</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CsvPaths-766"><a href="#CsvPaths-766"><span class="linenos"> 766</span></a>        <span class="c1"># re: R0912 -- absolutely. plan to refactor.</span>
</span><span id="CsvPaths-767"><a href="#CsvPaths-767"><span class="linenos"> 767</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Prepping </span><span class="si">%s</span><span class="s2"> and </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths-768"><a href="#CsvPaths-768"><span class="linenos"> 768</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clean</span><span class="p">(</span><span class="n">paths</span><span class="o">=</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths-769"><a href="#CsvPaths-769"><span class="linenos"> 769</span></a>        <span class="n">fn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_manager</span><span class="o">.</span><span class="n">get_named_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span><span id="CsvPaths-770"><a href="#CsvPaths-770"><span class="linenos"> 770</span></a>        <span class="n">paths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">paths_manager</span><span class="o">.</span><span class="n">get_named_paths</span><span class="p">(</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths-771"><a href="#CsvPaths-771"><span class="linenos"> 771</span></a>        <span class="k">if</span> <span class="p">(</span>
</span><span id="CsvPaths-772"><a href="#CsvPaths-772"><span class="linenos"> 772</span></a>            <span class="n">paths</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">paths</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
</span><span id="CsvPaths-773"><a href="#CsvPaths-773"><span class="linenos"> 773</span></a>        <span class="p">):</span>  <span class="c1"># pragma: no cover</span>
</span><span id="CsvPaths-774"><a href="#CsvPaths-774"><span class="linenos"> 774</span></a>            <span class="k">raise</span> <span class="n">InputException</span><span class="p">(</span>
</span><span id="CsvPaths-775"><a href="#CsvPaths-775"><span class="linenos"> 775</span></a>                <span class="sa">f</span><span class="s2">&quot;Pathsname &#39;</span><span class="si">{</span><span class="n">pathsname</span><span class="si">}</span><span class="s2">&#39; must name a list of csvpaths&quot;</span>
</span><span id="CsvPaths-776"><a href="#CsvPaths-776"><span class="linenos"> 776</span></a>            <span class="p">)</span>
</span><span id="CsvPaths-777"><a href="#CsvPaths-777"><span class="linenos"> 777</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-778"><a href="#CsvPaths-778"><span class="linenos"> 778</span></a>        <span class="c1"># experiment!</span>
</span><span id="CsvPaths-779"><a href="#CsvPaths-779"><span class="linenos"> 779</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-780"><a href="#CsvPaths-780"><span class="linenos"> 780</span></a>        <span class="n">crt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_time_str</span><span class="p">(</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths-781"><a href="#CsvPaths-781"><span class="linenos"> 781</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-782"><a href="#CsvPaths-782"><span class="linenos"> 782</span></a>        <span class="c1"># also use of crt below</span>
</span><span id="CsvPaths-783"><a href="#CsvPaths-783"><span class="linenos"> 783</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-784"><a href="#CsvPaths-784"><span class="linenos"> 784</span></a>        <span class="n">csvpath_objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_csvpath_objects</span><span class="p">(</span>
</span><span id="CsvPaths-785"><a href="#CsvPaths-785"><span class="linenos"> 785</span></a>            <span class="n">paths</span><span class="o">=</span><span class="n">paths</span><span class="p">,</span>
</span><span id="CsvPaths-786"><a href="#CsvPaths-786"><span class="linenos"> 786</span></a>            <span class="n">named_file</span><span class="o">=</span><span class="n">fn</span><span class="p">,</span>
</span><span id="CsvPaths-787"><a href="#CsvPaths-787"><span class="linenos"> 787</span></a>            <span class="n">collect_when_not_matched</span><span class="o">=</span><span class="n">collect_when_not_matched</span><span class="p">,</span>
</span><span id="CsvPaths-788"><a href="#CsvPaths-788"><span class="linenos"> 788</span></a>            <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths-789"><a href="#CsvPaths-789"><span class="linenos"> 789</span></a>            <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths-790"><a href="#CsvPaths-790"><span class="linenos"> 790</span></a>            <span class="n">crt</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span>
</span><span id="CsvPaths-791"><a href="#CsvPaths-791"><span class="linenos"> 791</span></a>        <span class="p">)</span>
</span><span id="CsvPaths-792"><a href="#CsvPaths-792"><span class="linenos"> 792</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-793"><a href="#CsvPaths-793"><span class="linenos"> 793</span></a>        <span class="c1"># prep has to come after _load_csvpath_objects because we need the identity or</span>
</span><span id="CsvPaths-794"><a href="#CsvPaths-794"><span class="linenos"> 794</span></a>        <span class="c1"># indexes to be stable and the identity is found in the load, if it exists.</span>
</span><span id="CsvPaths-795"><a href="#CsvPaths-795"><span class="linenos"> 795</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-796"><a href="#CsvPaths-796"><span class="linenos"> 796</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_prep_csvpath_results</span><span class="p">(</span>
</span><span id="CsvPaths-797"><a href="#CsvPaths-797"><span class="linenos"> 797</span></a>            <span class="n">csvpath_objects</span><span class="o">=</span><span class="n">csvpath_objects</span><span class="p">,</span>
</span><span id="CsvPaths-798"><a href="#CsvPaths-798"><span class="linenos"> 798</span></a>            <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths-799"><a href="#CsvPaths-799"><span class="linenos"> 799</span></a>            <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths-800"><a href="#CsvPaths-800"><span class="linenos"> 800</span></a>            <span class="n">crt</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span>
</span><span id="CsvPaths-801"><a href="#CsvPaths-801"><span class="linenos"> 801</span></a>        <span class="p">)</span>
</span><span id="CsvPaths-802"><a href="#CsvPaths-802"><span class="linenos"> 802</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-803"><a href="#CsvPaths-803"><span class="linenos"> 803</span></a>        <span class="c1"># setting fn into the csvpath is less obviously useful at CsvPaths</span>
</span><span id="CsvPaths-804"><a href="#CsvPaths-804"><span class="linenos"> 804</span></a>        <span class="c1"># but we&#39;ll do it for consistency.</span>
</span><span id="CsvPaths-805"><a href="#CsvPaths-805"><span class="linenos"> 805</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-806"><a href="#CsvPaths-806"><span class="linenos"> 806</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Beginning next_by_line with </span><span class="si">%s</span><span class="s2"> paths&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">csvpath_objects</span><span class="p">))</span>
</span><span id="CsvPaths-807"><a href="#CsvPaths-807"><span class="linenos"> 807</span></a>        <span class="n">reader</span> <span class="o">=</span> <span class="n">FileManager</span><span class="o">.</span><span class="n">get_reader</span><span class="p">(</span>
</span><span id="CsvPaths-808"><a href="#CsvPaths-808"><span class="linenos"> 808</span></a>            <span class="n">fn</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">,</span> <span class="n">quotechar</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">quotechar</span>
</span><span id="CsvPaths-809"><a href="#CsvPaths-809"><span class="linenos"> 809</span></a>        <span class="p">)</span>
</span><span id="CsvPaths-810"><a href="#CsvPaths-810"><span class="linenos"> 810</span></a>        <span class="n">stopped_count</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CsvPaths-811"><a href="#CsvPaths-811"><span class="linenos"> 811</span></a>        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">reader</span><span class="o">.</span><span class="n">next</span><span class="p">():</span>
</span><span id="CsvPaths-812"><a href="#CsvPaths-812"><span class="linenos"> 812</span></a>            <span class="c1"># for line in reader:  # pylint: disable=R1702</span>
</span><span id="CsvPaths-813"><a href="#CsvPaths-813"><span class="linenos"> 813</span></a>            <span class="c1"># question to self: should this default be in a central place</span>
</span><span id="CsvPaths-814"><a href="#CsvPaths-814"><span class="linenos"> 814</span></a>            <span class="c1"># so that we can switch to OR, in part by changing the default?</span>
</span><span id="CsvPaths-815"><a href="#CsvPaths-815"><span class="linenos"> 815</span></a>            <span class="n">keep</span> <span class="o">=</span> <span class="n">if_all_agree</span>
</span><span id="CsvPaths-816"><a href="#CsvPaths-816"><span class="linenos"> 816</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_skip_all</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CsvPaths-817"><a href="#CsvPaths-817"><span class="linenos"> 817</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_advance_all</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="CsvPaths-818"><a href="#CsvPaths-818"><span class="linenos"> 818</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="CsvPaths-819"><a href="#CsvPaths-819"><span class="linenos"> 819</span></a>                <span class="c1"># p is a (CsvPath, List[List[str]]) where the second item is</span>
</span><span id="CsvPaths-820"><a href="#CsvPaths-820"><span class="linenos"> 820</span></a>                <span class="c1"># the line-by-line results of the first item&#39;s matching</span>
</span><span id="CsvPaths-821"><a href="#CsvPaths-821"><span class="linenos"> 821</span></a>                <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">csvpath_objects</span><span class="p">:</span>
</span><span id="CsvPaths-822"><a href="#CsvPaths-822"><span class="linenos"> 822</span></a>                    <span class="c1">#</span>
</span><span id="CsvPaths-823"><a href="#CsvPaths-823"><span class="linenos"> 823</span></a>                    <span class="c1"># if run-mode: no-run we skip ahead without saving results</span>
</span><span id="CsvPaths-824"><a href="#CsvPaths-824"><span class="linenos"> 824</span></a>                    <span class="c1">#</span>
</span><span id="CsvPaths-825"><a href="#CsvPaths-825"><span class="linenos"> 825</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">will_run</span><span class="p">:</span>
</span><span id="CsvPaths-826"><a href="#CsvPaths-826"><span class="linenos"> 826</span></a>                        <span class="k">continue</span>
</span><span id="CsvPaths-827"><a href="#CsvPaths-827"><span class="linenos"> 827</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="CsvPaths-828"><a href="#CsvPaths-828"><span class="linenos"> 828</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fail_all</span><span class="p">:</span>
</span><span id="CsvPaths-829"><a href="#CsvPaths-829"><span class="linenos"> 829</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="CsvPaths-830"><a href="#CsvPaths-830"><span class="linenos"> 830</span></a>                            <span class="s2">&quot;Fail-all set. Setting CsvPath is_valid to False.&quot;</span>
</span><span id="CsvPaths-831"><a href="#CsvPaths-831"><span class="linenos"> 831</span></a>                        <span class="p">)</span>
</span><span id="CsvPaths-832"><a href="#CsvPaths-832"><span class="linenos"> 832</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">is_valid</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CsvPaths-833"><a href="#CsvPaths-833"><span class="linenos"> 833</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stop_all</span><span class="p">:</span>
</span><span id="CsvPaths-834"><a href="#CsvPaths-834"><span class="linenos"> 834</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Stop-all set. Shutting down run.&quot;</span><span class="p">)</span>
</span><span id="CsvPaths-835"><a href="#CsvPaths-835"><span class="linenos"> 835</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">stopped</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="CsvPaths-836"><a href="#CsvPaths-836"><span class="linenos"> 836</span></a>                        <span class="k">continue</span>
</span><span id="CsvPaths-837"><a href="#CsvPaths-837"><span class="linenos"> 837</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_skip_all</span><span class="p">:</span>
</span><span id="CsvPaths-838"><a href="#CsvPaths-838"><span class="linenos"> 838</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Skip-all set. Continuing to next.&quot;</span><span class="p">)</span>
</span><span id="CsvPaths-839"><a href="#CsvPaths-839"><span class="linenos"> 839</span></a>                        <span class="c1">#</span>
</span><span id="CsvPaths-840"><a href="#CsvPaths-840"><span class="linenos"> 840</span></a>                        <span class="c1"># all following CsvPaths must have their</span>
</span><span id="CsvPaths-841"><a href="#CsvPaths-841"><span class="linenos"> 841</span></a>                        <span class="c1"># line_monitors incremented</span>
</span><span id="CsvPaths-842"><a href="#CsvPaths-842"><span class="linenos"> 842</span></a>                        <span class="c1">#</span>
</span><span id="CsvPaths-843"><a href="#CsvPaths-843"><span class="linenos"> 843</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">track_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="CsvPaths-844"><a href="#CsvPaths-844"><span class="linenos"> 844</span></a>                        <span class="k">continue</span>
</span><span id="CsvPaths-845"><a href="#CsvPaths-845"><span class="linenos"> 845</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_advance_all</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CsvPaths-846"><a href="#CsvPaths-846"><span class="linenos"> 846</span></a>                        <span class="n">logtxt</span> <span class="o">=</span> <span class="s2">&quot;Advance-all set. Setting advance. &quot;</span>
</span><span id="CsvPaths-847"><a href="#CsvPaths-847"><span class="linenos"> 847</span></a>                        <span class="n">logtxt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">logtxt</span><span class="si">}</span><span class="s2">CsvPath and its Matcher will handle the advancing.&quot;</span>
</span><span id="CsvPaths-848"><a href="#CsvPaths-848"><span class="linenos"> 848</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">logtxt</span><span class="p">)</span>
</span><span id="CsvPaths-849"><a href="#CsvPaths-849"><span class="linenos"> 849</span></a>                        <span class="c1">#</span>
</span><span id="CsvPaths-850"><a href="#CsvPaths-850"><span class="linenos"> 850</span></a>                        <span class="c1"># CsvPath will handle advancing so we don&#39;t need to do</span>
</span><span id="CsvPaths-851"><a href="#CsvPaths-851"><span class="linenos"> 851</span></a>                        <span class="c1"># anything, including track_line(line). we just need to</span>
</span><span id="CsvPaths-852"><a href="#CsvPaths-852"><span class="linenos"> 852</span></a>                        <span class="c1"># see if we&#39;re setting advance or increasing it.</span>
</span><span id="CsvPaths-853"><a href="#CsvPaths-853"><span class="linenos"> 853</span></a>                        <span class="c1">#</span>
</span><span id="CsvPaths-854"><a href="#CsvPaths-854"><span class="linenos"> 854</span></a>                        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">advance_count</span>
</span><span id="CsvPaths-855"><a href="#CsvPaths-855"><span class="linenos"> 855</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_advance_all</span> <span class="o">&gt;</span> <span class="n">a</span><span class="p">:</span>
</span><span id="CsvPaths-856"><a href="#CsvPaths-856"><span class="linenos"> 856</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">advance_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_advance_all</span>
</span><span id="CsvPaths-857"><a href="#CsvPaths-857"><span class="linenos"> 857</span></a>                        <span class="c1">#</span>
</span><span id="CsvPaths-858"><a href="#CsvPaths-858"><span class="linenos"> 858</span></a>                        <span class="c1"># all following CsvPaths must have their</span>
</span><span id="CsvPaths-859"><a href="#CsvPaths-859"><span class="linenos"> 859</span></a>                        <span class="c1"># advance incremented -- with the advance not being simply</span>
</span><span id="CsvPaths-860"><a href="#CsvPaths-860"><span class="linenos"> 860</span></a>                        <span class="c1"># additive, have to be mindful of any existing advance</span>
</span><span id="CsvPaths-861"><a href="#CsvPaths-861"><span class="linenos"> 861</span></a>                        <span class="c1"># count!</span>
</span><span id="CsvPaths-862"><a href="#CsvPaths-862"><span class="linenos"> 862</span></a>                        <span class="c1">#</span>
</span><span id="CsvPaths-863"><a href="#CsvPaths-863"><span class="linenos"> 863</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">stopped</span><span class="p">:</span>  <span class="c1"># pylint: disable=R1724</span>
</span><span id="CsvPaths-864"><a href="#CsvPaths-864"><span class="linenos"> 864</span></a>                        <span class="k">continue</span>
</span><span id="CsvPaths-865"><a href="#CsvPaths-865"><span class="linenos"> 865</span></a>
</span><span id="CsvPaths-866"><a href="#CsvPaths-866"><span class="linenos"> 866</span></a>                    <span class="c1">#</span>
</span><span id="CsvPaths-867"><a href="#CsvPaths-867"><span class="linenos"> 867</span></a>                    <span class="c1"># allowing the match to happen regardless of keep</span>
</span><span id="CsvPaths-868"><a href="#CsvPaths-868"><span class="linenos"> 868</span></a>                    <span class="c1"># because we may want side-effects or to have different</span>
</span><span id="CsvPaths-869"><a href="#CsvPaths-869"><span class="linenos"> 869</span></a>                    <span class="c1"># results in different named-results, as well as the</span>
</span><span id="CsvPaths-870"><a href="#CsvPaths-870"><span class="linenos"> 870</span></a>                    <span class="c1"># union</span>
</span><span id="CsvPaths-871"><a href="#CsvPaths-871"><span class="linenos"> 871</span></a>                    <span class="c1">#</span>
</span><span id="CsvPaths-872"><a href="#CsvPaths-872"><span class="linenos"> 872</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="CsvPaths-873"><a href="#CsvPaths-873"><span class="linenos"> 873</span></a>                        <span class="s2">&quot;considering line with csvpath identified as: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="CsvPaths-874"><a href="#CsvPaths-874"><span class="linenos"> 874</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">identity</span><span class="p">,</span>
</span><span id="CsvPaths-875"><a href="#CsvPaths-875"><span class="linenos"> 875</span></a>                    <span class="p">)</span>
</span><span id="CsvPaths-876"><a href="#CsvPaths-876"><span class="linenos"> 876</span></a>                    <span class="n">matched</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CsvPaths-877"><a href="#CsvPaths-877"><span class="linenos"> 877</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">track_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="CsvPaths-878"><a href="#CsvPaths-878"><span class="linenos"> 878</span></a>                    <span class="c1">#</span>
</span><span id="CsvPaths-879"><a href="#CsvPaths-879"><span class="linenos"> 879</span></a>                    <span class="c1"># re: W0212: treating _consider_line something like package private</span>
</span><span id="CsvPaths-880"><a href="#CsvPaths-880"><span class="linenos"> 880</span></a>                    <span class="c1">#</span>
</span><span id="CsvPaths-881"><a href="#CsvPaths-881"><span class="linenos"> 881</span></a>                    <span class="n">matched</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="CsvPaths-882"><a href="#CsvPaths-882"><span class="linenos"> 882</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">_consider_line</span><span class="p">(</span>  <span class="c1"># pylint:disable=W0212</span>
</span><span id="CsvPaths-883"><a href="#CsvPaths-883"><span class="linenos"> 883</span></a>                            <span class="n">line</span>
</span><span id="CsvPaths-884"><a href="#CsvPaths-884"><span class="linenos"> 884</span></a>                        <span class="p">)</span>
</span><span id="CsvPaths-885"><a href="#CsvPaths-885"><span class="linenos"> 885</span></a>                    <span class="p">)</span>
</span><span id="CsvPaths-886"><a href="#CsvPaths-886"><span class="linenos"> 886</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">stopped</span><span class="p">:</span>
</span><span id="CsvPaths-887"><a href="#CsvPaths-887"><span class="linenos"> 887</span></a>                        <span class="n">stopped_count</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="CsvPaths-888"><a href="#CsvPaths-888"><span class="linenos"> 888</span></a>                    <span class="k">if</span> <span class="n">if_all_agree</span><span class="p">:</span>
</span><span id="CsvPaths-889"><a href="#CsvPaths-889"><span class="linenos"> 889</span></a>                        <span class="n">keep</span> <span class="o">=</span> <span class="n">keep</span> <span class="ow">and</span> <span class="n">matched</span>
</span><span id="CsvPaths-890"><a href="#CsvPaths-890"><span class="linenos"> 890</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="CsvPaths-891"><a href="#CsvPaths-891"><span class="linenos"> 891</span></a>                        <span class="n">keep</span> <span class="o">=</span> <span class="n">keep</span> <span class="ow">or</span> <span class="n">matched</span>
</span><span id="CsvPaths-892"><a href="#CsvPaths-892"><span class="linenos"> 892</span></a>                    <span class="c1">#</span>
</span><span id="CsvPaths-893"><a href="#CsvPaths-893"><span class="linenos"> 893</span></a>                    <span class="c1"># not doing continue if we have if_all_agree and not keep as we</span>
</span><span id="CsvPaths-894"><a href="#CsvPaths-894"><span class="linenos"> 894</span></a>                    <span class="c1"># used to do allows individual results to have lines that in</span>
</span><span id="CsvPaths-895"><a href="#CsvPaths-895"><span class="linenos"> 895</span></a>                    <span class="c1"># aggregate we do not keep.</span>
</span><span id="CsvPaths-896"><a href="#CsvPaths-896"><span class="linenos"> 896</span></a>                    <span class="c1">#</span>
</span><span id="CsvPaths-897"><a href="#CsvPaths-897"><span class="linenos"> 897</span></a>                    <span class="k">if</span> <span class="n">matched</span> <span class="ow">and</span> <span class="n">collect</span><span class="p">:</span>
</span><span id="CsvPaths-898"><a href="#CsvPaths-898"><span class="linenos"> 898</span></a>                        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">limit_collection</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="CsvPaths-899"><a href="#CsvPaths-899"><span class="linenos"> 899</span></a>                        <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="CsvPaths-900"><a href="#CsvPaths-900"><span class="linenos"> 900</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>  <span class="c1"># pylint: disable=W0718</span>
</span><span id="CsvPaths-901"><a href="#CsvPaths-901"><span class="linenos"> 901</span></a>                <span class="c1"># ex.trace = traceback.format_exc()</span>
</span><span id="CsvPaths-902"><a href="#CsvPaths-902"><span class="linenos"> 902</span></a>                <span class="c1"># ex.source = self</span>
</span><span id="CsvPaths-903"><a href="#CsvPaths-903"><span class="linenos"> 903</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">error_manager</span><span class="o">.</span><span class="n">handle_error</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="CsvPaths-904"><a href="#CsvPaths-904"><span class="linenos"> 904</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ecoms</span><span class="o">.</span><span class="n">do_i_raise</span><span class="p">():</span>
</span><span id="CsvPaths-905"><a href="#CsvPaths-905"><span class="linenos"> 905</span></a>                    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">csvpath_objects</span><span class="p">:</span>
</span><span id="CsvPaths-906"><a href="#CsvPaths-906"><span class="linenos"> 906</span></a>                        <span class="n">result</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="CsvPaths-907"><a href="#CsvPaths-907"><span class="linenos"> 907</span></a>                        <span class="n">result</span><span class="o">.</span><span class="n">unmatched</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">unmatched</span>
</span><span id="CsvPaths-908"><a href="#CsvPaths-908"><span class="linenos"> 908</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths-909"><a href="#CsvPaths-909"><span class="linenos"> 909</span></a>                    <span class="k">raise</span>
</span><span id="CsvPaths-910"><a href="#CsvPaths-910"><span class="linenos"> 910</span></a>            <span class="c1"># we yield even if we stopped in this iteration.</span>
</span><span id="CsvPaths-911"><a href="#CsvPaths-911"><span class="linenos"> 911</span></a>            <span class="c1"># caller needs to see what we stopped on.</span>
</span><span id="CsvPaths-912"><a href="#CsvPaths-912"><span class="linenos"> 912</span></a>            <span class="c1">#</span>
</span><span id="CsvPaths-913"><a href="#CsvPaths-913"><span class="linenos"> 913</span></a>            <span class="c1"># ! we only yield if keep is True</span>
</span><span id="CsvPaths-914"><a href="#CsvPaths-914"><span class="linenos"> 914</span></a>            <span class="c1">#</span>
</span><span id="CsvPaths-915"><a href="#CsvPaths-915"><span class="linenos"> 915</span></a>            <span class="k">if</span> <span class="n">keep</span><span class="p">:</span>
</span><span id="CsvPaths-916"><a href="#CsvPaths-916"><span class="linenos"> 916</span></a>                <span class="k">yield</span> <span class="n">line</span>
</span><span id="CsvPaths-917"><a href="#CsvPaths-917"><span class="linenos"> 917</span></a>            <span class="k">if</span> <span class="nb">sum</span><span class="p">(</span><span class="n">stopped_count</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">csvpath_objects</span><span class="p">):</span>
</span><span id="CsvPaths-918"><a href="#CsvPaths-918"><span class="linenos"> 918</span></a>                <span class="k">break</span>
</span><span id="CsvPaths-919"><a href="#CsvPaths-919"><span class="linenos"> 919</span></a>        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CsvPaths-920"><a href="#CsvPaths-920"><span class="linenos"> 920</span></a>        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">csvpath_objects</span><span class="p">:</span>
</span><span id="CsvPaths-921"><a href="#CsvPaths-921"><span class="linenos"> 921</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="CsvPaths-922"><a href="#CsvPaths-922"><span class="linenos"> 922</span></a>            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths-923"><a href="#CsvPaths-923"><span class="linenos"> 923</span></a>            <span class="n">result</span><span class="o">.</span><span class="n">unmatched</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">unmatched</span>
</span><span id="CsvPaths-924"><a href="#CsvPaths-924"><span class="linenos"> 924</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths-925"><a href="#CsvPaths-925"><span class="linenos"> 925</span></a>
</span><span id="CsvPaths-926"><a href="#CsvPaths-926"><span class="linenos"> 926</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-927"><a href="#CsvPaths-927"><span class="linenos"> 927</span></a>        <span class="c1"># run ends here</span>
</span><span id="CsvPaths-928"><a href="#CsvPaths-928"><span class="linenos"> 928</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-929"><a href="#CsvPaths-929"><span class="linenos"> 929</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">complete_run</span><span class="p">(</span>
</span><span id="CsvPaths-930"><a href="#CsvPaths-930"><span class="linenos"> 930</span></a>            <span class="n">run_dir</span><span class="o">=</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">run_dir</span><span class="p">,</span> <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span>
</span><span id="CsvPaths-931"><a href="#CsvPaths-931"><span class="linenos"> 931</span></a>        <span class="p">)</span>
</span><span id="CsvPaths-932"><a href="#CsvPaths-932"><span class="linenos"> 932</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clear_run_coordination</span><span class="p">()</span>
</span><span id="CsvPaths-933"><a href="#CsvPaths-933"><span class="linenos"> 933</span></a>
</span><span id="CsvPaths-934"><a href="#CsvPaths-934"><span class="linenos"> 934</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_load_csvpath_objects</span><span class="p">(</span>
</span><span id="CsvPaths-935"><a href="#CsvPaths-935"><span class="linenos"> 935</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="CsvPaths-936"><a href="#CsvPaths-936"><span class="linenos"> 936</span></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="CsvPaths-937"><a href="#CsvPaths-937"><span class="linenos"> 937</span></a>        <span class="n">paths</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="CsvPaths-938"><a href="#CsvPaths-938"><span class="linenos"> 938</span></a>        <span class="n">named_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="CsvPaths-939"><a href="#CsvPaths-939"><span class="linenos"> 939</span></a>        <span class="n">collect_when_not_matched</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="CsvPaths-940"><a href="#CsvPaths-940"><span class="linenos"> 940</span></a>        <span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths-941"><a href="#CsvPaths-941"><span class="linenos"> 941</span></a>        <span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths-942"><a href="#CsvPaths-942"><span class="linenos"> 942</span></a>        <span class="n">crt</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="CsvPaths-943"><a href="#CsvPaths-943"><span class="linenos"> 943</span></a>    <span class="p">):</span>
</span><span id="CsvPaths-944"><a href="#CsvPaths-944"><span class="linenos"> 944</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPaths-945"><a href="#CsvPaths-945"><span class="linenos"> 945</span></a>        <span class="n">csvpath_objects</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CsvPaths-946"><a href="#CsvPaths-946"><span class="linenos"> 946</span></a>        <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">paths</span><span class="p">:</span>
</span><span id="CsvPaths-947"><a href="#CsvPaths-947"><span class="linenos"> 947</span></a>            <span class="n">csvpath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">csvpath</span><span class="p">()</span>
</span><span id="CsvPaths-948"><a href="#CsvPaths-948"><span class="linenos"> 948</span></a>            <span class="n">csvpath</span><span class="o">.</span><span class="n">collect_when_not_matched</span> <span class="o">=</span> <span class="n">collect_when_not_matched</span>
</span><span id="CsvPaths-949"><a href="#CsvPaths-949"><span class="linenos"> 949</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="CsvPaths-950"><a href="#CsvPaths-950"><span class="linenos"> 950</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_load_csvpath</span><span class="p">(</span>
</span><span id="CsvPaths-951"><a href="#CsvPaths-951"><span class="linenos"> 951</span></a>                    <span class="n">csvpath</span><span class="o">=</span><span class="n">csvpath</span><span class="p">,</span>
</span><span id="CsvPaths-952"><a href="#CsvPaths-952"><span class="linenos"> 952</span></a>                    <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>
</span><span id="CsvPaths-953"><a href="#CsvPaths-953"><span class="linenos"> 953</span></a>                    <span class="n">file</span><span class="o">=</span><span class="n">named_file</span><span class="p">,</span>
</span><span id="CsvPaths-954"><a href="#CsvPaths-954"><span class="linenos"> 954</span></a>                    <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths-955"><a href="#CsvPaths-955"><span class="linenos"> 955</span></a>                    <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths-956"><a href="#CsvPaths-956"><span class="linenos"> 956</span></a>                    <span class="n">by_line</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="CsvPaths-957"><a href="#CsvPaths-957"><span class="linenos"> 957</span></a>                    <span class="n">crt</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span>
</span><span id="CsvPaths-958"><a href="#CsvPaths-958"><span class="linenos"> 958</span></a>                <span class="p">)</span>
</span><span id="CsvPaths-959"><a href="#CsvPaths-959"><span class="linenos"> 959</span></a>                <span class="k">if</span> <span class="n">csvpath</span><span class="o">.</span><span class="n">data_from_preceding</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="CsvPaths-960"><a href="#CsvPaths-960"><span class="linenos"> 960</span></a>                    <span class="c1"># this exception raise may be redundant, but I&#39;m leaving it for now for good measure.</span>
</span><span id="CsvPaths-961"><a href="#CsvPaths-961"><span class="linenos"> 961</span></a>                    <span class="k">raise</span> <span class="n">CsvPathsException</span><span class="p">(</span>
</span><span id="CsvPaths-962"><a href="#CsvPaths-962"><span class="linenos"> 962</span></a>                        <span class="s2">&quot;Csvpath identified as </span><span class="si">{csvpath.identity}</span><span class="s2"> is set to use preceding data, but CsvPaths&#39;s by_line methods do not permit that&quot;</span>
</span><span id="CsvPaths-963"><a href="#CsvPaths-963"><span class="linenos"> 963</span></a>                    <span class="p">)</span>
</span><span id="CsvPaths-964"><a href="#CsvPaths-964"><span class="linenos"> 964</span></a>                <span class="n">csvpath_objects</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">csvpath</span><span class="p">,</span> <span class="p">[]])</span>
</span><span id="CsvPaths-965"><a href="#CsvPaths-965"><span class="linenos"> 965</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>  <span class="c1"># pylint: disable=W0718</span>
</span><span id="CsvPaths-966"><a href="#CsvPaths-966"><span class="linenos"> 966</span></a>                <span class="n">ex</span><span class="o">.</span><span class="n">trace</span> <span class="o">=</span> <span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">()</span>
</span><span id="CsvPaths-967"><a href="#CsvPaths-967"><span class="linenos"> 967</span></a>                <span class="n">ex</span><span class="o">.</span><span class="n">source</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="CsvPaths-968"><a href="#CsvPaths-968"><span class="linenos"> 968</span></a>                <span class="c1"># the error collector is the Results. it registers itself with</span>
</span><span id="CsvPaths-969"><a href="#CsvPaths-969"><span class="linenos"> 969</span></a>                <span class="c1"># the csvpath as the error collector. not as straightforward but</span>
</span><span id="CsvPaths-970"><a href="#CsvPaths-970"><span class="linenos"> 970</span></a>                <span class="c1"># effectively same as we do above</span>
</span><span id="CsvPaths-971"><a href="#CsvPaths-971"><span class="linenos"> 971</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">error_manager</span><span class="o">.</span><span class="n">handle_error</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="CsvPaths-972"><a href="#CsvPaths-972"><span class="linenos"> 972</span></a>        <span class="k">return</span> <span class="n">csvpath_objects</span>
</span><span id="CsvPaths-973"><a href="#CsvPaths-973"><span class="linenos"> 973</span></a>
</span><span id="CsvPaths-974"><a href="#CsvPaths-974"><span class="linenos"> 974</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_prep_csvpath_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">csvpath_objects</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">crt</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="CsvPaths-975"><a href="#CsvPaths-975"><span class="linenos"> 975</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="CsvPaths-976"><a href="#CsvPaths-976"><span class="linenos"> 976</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-977"><a href="#CsvPaths-977"><span class="linenos"> 977</span></a>        <span class="c1"># run starts here</span>
</span><span id="CsvPaths-978"><a href="#CsvPaths-978"><span class="linenos"> 978</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-979"><a href="#CsvPaths-979"><span class="linenos"> 979</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">start_run</span><span class="p">(</span>
</span><span id="CsvPaths-980"><a href="#CsvPaths-980"><span class="linenos"> 980</span></a>            <span class="n">run_dir</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span> <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span>
</span><span id="CsvPaths-981"><a href="#CsvPaths-981"><span class="linenos"> 981</span></a>        <span class="p">)</span>
</span><span id="CsvPaths-982"><a href="#CsvPaths-982"><span class="linenos"> 982</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-983"><a href="#CsvPaths-983"><span class="linenos"> 983</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-984"><a href="#CsvPaths-984"><span class="linenos"> 984</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths-985"><a href="#CsvPaths-985"><span class="linenos"> 985</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">csvpath</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">csvpath_objects</span><span class="p">):</span>
</span><span id="CsvPaths-986"><a href="#CsvPaths-986"><span class="linenos"> 986</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="CsvPaths-987"><a href="#CsvPaths-987"><span class="linenos"> 987</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths-988"><a href="#CsvPaths-988"><span class="linenos"> 988</span></a>                <span class="c1"># Result will set itself into its CsvPath as error collector</span>
</span><span id="CsvPaths-989"><a href="#CsvPaths-989"><span class="linenos"> 989</span></a>                <span class="c1"># printer, etc.</span>
</span><span id="CsvPaths-990"><a href="#CsvPaths-990"><span class="linenos"> 990</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths-991"><a href="#CsvPaths-991"><span class="linenos"> 991</span></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">Result</span><span class="p">(</span>
</span><span id="CsvPaths-992"><a href="#CsvPaths-992"><span class="linenos"> 992</span></a>                    <span class="n">csvpath</span><span class="o">=</span><span class="n">csvpath</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="CsvPaths-993"><a href="#CsvPaths-993"><span class="linenos"> 993</span></a>                    <span class="n">file_name</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths-994"><a href="#CsvPaths-994"><span class="linenos"> 994</span></a>                    <span class="n">paths_name</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths-995"><a href="#CsvPaths-995"><span class="linenos"> 995</span></a>                    <span class="n">lines</span><span class="o">=</span><span class="n">csvpath</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
</span><span id="CsvPaths-996"><a href="#CsvPaths-996"><span class="linenos"> 996</span></a>                    <span class="n">run_index</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>
</span><span id="CsvPaths-997"><a href="#CsvPaths-997"><span class="linenos"> 997</span></a>                    <span class="n">run_time</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_run_time</span><span class="p">,</span>
</span><span id="CsvPaths-998"><a href="#CsvPaths-998"><span class="linenos"> 998</span></a>                    <span class="n">run_dir</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span>
</span><span id="CsvPaths-999"><a href="#CsvPaths-999"><span class="linenos"> 999</span></a>                    <span class="n">by_line</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="CsvPaths-1000"><a href="#CsvPaths-1000"><span class="linenos">1000</span></a>                <span class="p">)</span>
</span><span id="CsvPaths-1001"><a href="#CsvPaths-1001"><span class="linenos">1001</span></a>                <span class="n">csvpath</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span>
</span><span id="CsvPaths-1002"><a href="#CsvPaths-1002"><span class="linenos">1002</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths-1003"><a href="#CsvPaths-1003"><span class="linenos">1003</span></a>                <span class="c1"># the add has to come after _load_csvpath because we need the identity or index</span>
</span><span id="CsvPaths-1004"><a href="#CsvPaths-1004"><span class="linenos">1004</span></a>                <span class="c1"># to be stable and the identity is found in load, if it exists.</span>
</span><span id="CsvPaths-1005"><a href="#CsvPaths-1005"><span class="linenos">1005</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths-1006"><a href="#CsvPaths-1006"><span class="linenos">1006</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">add_named_result</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths-1007"><a href="#CsvPaths-1007"><span class="linenos">1007</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>  <span class="c1"># pylint: disable=W0718</span>
</span><span id="CsvPaths-1008"><a href="#CsvPaths-1008"><span class="linenos">1008</span></a><span class="w">                </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CsvPaths-1009"><a href="#CsvPaths-1009"><span class="linenos">1009</span></a><span class="sd">                ex.trace = traceback.format_exc()</span>
</span><span id="CsvPaths-1010"><a href="#CsvPaths-1010"><span class="linenos">1010</span></a><span class="sd">                ex.source = self</span>
</span><span id="CsvPaths-1011"><a href="#CsvPaths-1011"><span class="linenos">1011</span></a><span class="sd">                ErrorHandler(csvpaths=self, error_collector=csvpath).handle_error(ex)</span>
</span><span id="CsvPaths-1012"><a href="#CsvPaths-1012"><span class="linenos">1012</span></a><span class="sd">                &quot;&quot;&quot;</span>
</span><span id="CsvPaths-1013"><a href="#CsvPaths-1013"><span class="linenos">1013</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">error_manager</span><span class="o">.</span><span class="n">handle_error</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="CsvPaths-1014"><a href="#CsvPaths-1014"><span class="linenos">1014</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths-1015"><a href="#CsvPaths-1015"><span class="linenos">1015</span></a>                <span class="c1"># keep this comment for modelines avoidance</span>
</span><span id="CsvPaths-1016"><a href="#CsvPaths-1016"><span class="linenos">1016</span></a>                <span class="c1">#</span>
</span></pre></div>


            <div class="docstring"><p>a CsvPaths instance manages applying any number of csvpaths
to any number of files. CsvPaths applies sets of csvpaths
to a given file, on demand. Think of CsvPaths as a session
object. It gives you a way to manage files, csvpaths, and
the results generated by applying paths to files. It is not
intended for concurrent use. If you need multiple threads,
create multiple CsvPaths instances.</p>
</div>


                            <div id="CsvPaths.__init__" class="classattr">
                                        <input id="CsvPaths.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">CsvPaths</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span>,</span><span class="param">	<span class="n">quotechar</span><span class="o">=</span><span class="s1">&#39;&quot;&#39;</span>,</span><span class="param">	<span class="n">skip_blank_lines</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">print_default</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">config</span><span class="p">:</span> <span class="n">csvpath</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">Config</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="CsvPaths.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPaths.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPaths.__init__-72"><a href="#CsvPaths.__init__-72"><span class="linenos"> 72</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="CsvPaths.__init__-73"><a href="#CsvPaths.__init__-73"><span class="linenos"> 73</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="CsvPaths.__init__-74"><a href="#CsvPaths.__init__-74"><span class="linenos"> 74</span></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="CsvPaths.__init__-75"><a href="#CsvPaths.__init__-75"><span class="linenos"> 75</span></a>        <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span>
</span><span id="CsvPaths.__init__-76"><a href="#CsvPaths.__init__-76"><span class="linenos"> 76</span></a>        <span class="n">quotechar</span><span class="o">=</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span>
</span><span id="CsvPaths.__init__-77"><a href="#CsvPaths.__init__-77"><span class="linenos"> 77</span></a>        <span class="n">skip_blank_lines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="CsvPaths.__init__-78"><a href="#CsvPaths.__init__-78"><span class="linenos"> 78</span></a>        <span class="n">print_default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="CsvPaths.__init__-79"><a href="#CsvPaths.__init__-79"><span class="linenos"> 79</span></a>        <span class="n">config</span><span class="p">:</span> <span class="n">Config</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="CsvPaths.__init__-80"><a href="#CsvPaths.__init__-80"><span class="linenos"> 80</span></a>    <span class="p">):</span>
</span><span id="CsvPaths.__init__-81"><a href="#CsvPaths.__init__-81"><span class="linenos"> 81</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">()</span> <span class="k">if</span> <span class="n">config</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">config</span>
</span><span id="CsvPaths.__init__-82"><a href="#CsvPaths.__init__-82"><span class="linenos"> 82</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.__init__-83"><a href="#CsvPaths.__init__-83"><span class="linenos"> 83</span></a>        <span class="c1"># managers centralize activities, offer async potential, and</span>
</span><span id="CsvPaths.__init__-84"><a href="#CsvPaths.__init__-84"><span class="linenos"> 84</span></a>        <span class="c1"># are where integrations hook in. ErrorManager functionality</span>
</span><span id="CsvPaths.__init__-85"><a href="#CsvPaths.__init__-85"><span class="linenos"> 85</span></a>        <span class="c1"># must be available in CsvPath too. The others are CsvPaths</span>
</span><span id="CsvPaths.__init__-86"><a href="#CsvPaths.__init__-86"><span class="linenos"> 86</span></a>        <span class="c1"># only.</span>
</span><span id="CsvPaths.__init__-87"><a href="#CsvPaths.__init__-87"><span class="linenos"> 87</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.__init__-88"><a href="#CsvPaths.__init__-88"><span class="linenos"> 88</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_paths_manager</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPaths.__init__-89"><a href="#CsvPaths.__init__-89"><span class="linenos"> 89</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_file_manager</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPaths.__init__-90"><a href="#CsvPaths.__init__-90"><span class="linenos"> 90</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_results_manager</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPaths.__init__-91"><a href="#CsvPaths.__init__-91"><span class="linenos"> 91</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_ecoms</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPaths.__init__-92"><a href="#CsvPaths.__init__-92"><span class="linenos"> 92</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_error_manager</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPaths.__init__-93"><a href="#CsvPaths.__init__-93"><span class="linenos"> 93</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_managers</span><span class="p">()</span>
</span><span id="CsvPaths.__init__-94"><a href="#CsvPaths.__init__-94"><span class="linenos"> 94</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.__init__-95"><a href="#CsvPaths.__init__-95"><span class="linenos"> 95</span></a>        <span class="c1"># TODO:</span>
</span><span id="CsvPaths.__init__-96"><a href="#CsvPaths.__init__-96"><span class="linenos"> 96</span></a>        <span class="c1"># self.print_manager = ... &lt;&lt;&lt;=== should we do this?</span>
</span><span id="CsvPaths.__init__-97"><a href="#CsvPaths.__init__-97"><span class="linenos"> 97</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.__init__-98"><a href="#CsvPaths.__init__-98"><span class="linenos"> 98</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.__init__-99"><a href="#CsvPaths.__init__-99"><span class="linenos"> 99</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">print_default</span> <span class="o">=</span> <span class="n">print_default</span>
</span><span id="CsvPaths.__init__-100"><a href="#CsvPaths.__init__-100"><span class="linenos">100</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="CsvPaths.__init__-101"><a href="#CsvPaths.__init__-101"><span class="linenos">101</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span> <span class="o">=</span> <span class="n">delimiter</span>
</span><span id="CsvPaths.__init__-102"><a href="#CsvPaths.__init__-102"><span class="linenos">102</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="CsvPaths.__init__-103"><a href="#CsvPaths.__init__-103"><span class="linenos">103</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">quotechar</span> <span class="o">=</span> <span class="n">quotechar</span>
</span><span id="CsvPaths.__init__-104"><a href="#CsvPaths.__init__-104"><span class="linenos">104</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="CsvPaths.__init__-105"><a href="#CsvPaths.__init__-105"><span class="linenos">105</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">skip_blank_lines</span> <span class="o">=</span> <span class="n">skip_blank_lines</span>
</span><span id="CsvPaths.__init__-106"><a href="#CsvPaths.__init__-106"><span class="linenos">106</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="CsvPaths.__init__-107"><a href="#CsvPaths.__init__-107"><span class="linenos">107</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="p">:</span> <span class="n">CsvPath</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPaths.__init__-108"><a href="#CsvPaths.__init__-108"><span class="linenos">108</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="CsvPaths.__init__-109"><a href="#CsvPaths.__init__-109"><span class="linenos">109</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">LogUtility</span><span class="o">.</span><span class="n">logger</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="CsvPaths.__init__-110"><a href="#CsvPaths.__init__-110"><span class="linenos">110</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="CsvPaths.__init__-111"><a href="#CsvPaths.__init__-111"><span class="linenos">111</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CsvPaths.__init__-112"><a href="#CsvPaths.__init__-112"><span class="linenos">112</span></a>        <span class="c1"># coordinator attributes</span>
</span><span id="CsvPaths.__init__-113"><a href="#CsvPaths.__init__-113"><span class="linenos">113</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_stop_all</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CsvPaths.__init__-114"><a href="#CsvPaths.__init__-114"><span class="linenos">114</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_fail_all</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CsvPaths.__init__-115"><a href="#CsvPaths.__init__-115"><span class="linenos">115</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_skip_all</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CsvPaths.__init__-116"><a href="#CsvPaths.__init__-116"><span class="linenos">116</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_advance_all</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="CsvPaths.__init__-117"><a href="#CsvPaths.__init__-117"><span class="linenos">117</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_current_run_time</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPaths.__init__-118"><a href="#CsvPaths.__init__-118"><span class="linenos">118</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_run_time_str</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPaths.__init__-119"><a href="#CsvPaths.__init__-119"><span class="linenos">119</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">named_paths_name</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPaths.__init__-120"><a href="#CsvPaths.__init__-120"><span class="linenos">120</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="CsvPaths.__init__-121"><a href="#CsvPaths.__init__-121"><span class="linenos">121</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">named_file_name</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPaths.__init__-122"><a href="#CsvPaths.__init__-122"><span class="linenos">122</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="CsvPaths.__init__-123"><a href="#CsvPaths.__init__-123"><span class="linenos">123</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.__init__-124"><a href="#CsvPaths.__init__-124"><span class="linenos">124</span></a>        <span class="c1"># metrics is for OTLP OpenTelemetry. it should only</span>
</span><span id="CsvPaths.__init__-125"><a href="#CsvPaths.__init__-125"><span class="linenos">125</span></a>        <span class="c1"># be used by the OTLP listener. it is here because</span>
</span><span id="CsvPaths.__init__-126"><a href="#CsvPaths.__init__-126"><span class="linenos">126</span></a>        <span class="c1"># the integration may need a long-lived presence. if</span>
</span><span id="CsvPaths.__init__-127"><a href="#CsvPaths.__init__-127"><span class="linenos">127</span></a>        <span class="c1"># needed, the first OTLP listener will set it up</span>
</span><span id="CsvPaths.__init__-128"><a href="#CsvPaths.__init__-128"><span class="linenos">128</span></a>        <span class="c1"># before spinning up a thread. any other OTLP</span>
</span><span id="CsvPaths.__init__-129"><a href="#CsvPaths.__init__-129"><span class="linenos">129</span></a>        <span class="c1"># listener threads that need to use a long-lived metric</span>
</span><span id="CsvPaths.__init__-130"><a href="#CsvPaths.__init__-130"><span class="linenos">130</span></a>        <span class="c1"># will work with this property.</span>
</span><span id="CsvPaths.__init__-131"><a href="#CsvPaths.__init__-131"><span class="linenos">131</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.__init__-132"><a href="#CsvPaths.__init__-132"><span class="linenos">132</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CsvPaths.__init__-133"><a href="#CsvPaths.__init__-133"><span class="linenos">133</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="CsvPaths.__init__-134"><a href="#CsvPaths.__init__-134"><span class="linenos">134</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;initialized CsvPaths&quot;</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="CsvPaths.file_manager" class="classattr">
                                        <input id="CsvPaths.file_manager-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">file_manager</span><span class="annotation">: <a href="csvpath/managers/files/file_manager.html#FileManager">csvpath.managers.files.file_manager.FileManager</a></span>

                <label class="view-source-button" for="CsvPaths.file_manager-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPaths.file_manager"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPaths.file_manager-153"><a href="#CsvPaths.file_manager-153"><span class="linenos">153</span></a>    <span class="nd">@property</span>
</span><span id="CsvPaths.file_manager-154"><a href="#CsvPaths.file_manager-154"><span class="linenos">154</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">file_manager</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FileManager</span><span class="p">:</span>
</span><span id="CsvPaths.file_manager-155"><a href="#CsvPaths.file_manager-155"><span class="linenos">155</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file_manager</span>
</span></pre></div>


    

                            </div>
                            <div id="CsvPaths.results_manager" class="classattr">
                                        <input id="CsvPaths.results_manager-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">results_manager</span><span class="annotation">: <a href="csvpath/managers/results/results_manager.html#ResultsManager">csvpath.managers.results.results_manager.ResultsManager</a></span>

                <label class="view-source-button" for="CsvPaths.results_manager-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPaths.results_manager"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPaths.results_manager-161"><a href="#CsvPaths.results_manager-161"><span class="linenos">161</span></a>    <span class="nd">@property</span>
</span><span id="CsvPaths.results_manager-162"><a href="#CsvPaths.results_manager-162"><span class="linenos">162</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">results_manager</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ResultsManager</span><span class="p">:</span>
</span><span id="CsvPaths.results_manager-163"><a href="#CsvPaths.results_manager-163"><span class="linenos">163</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_results_manager</span>
</span></pre></div>


    

                            </div>
                            <div id="CsvPaths.paths_manager" class="classattr">
                                        <input id="CsvPaths.paths_manager-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">paths_manager</span><span class="annotation">: <a href="csvpath/managers/paths/paths_manager.html#PathsManager">csvpath.managers.paths.paths_manager.PathsManager</a></span>

                <label class="view-source-button" for="CsvPaths.paths_manager-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPaths.paths_manager"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPaths.paths_manager-169"><a href="#CsvPaths.paths_manager-169"><span class="linenos">169</span></a>    <span class="nd">@property</span>
</span><span id="CsvPaths.paths_manager-170"><a href="#CsvPaths.paths_manager-170"><span class="linenos">170</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">paths_manager</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PathsManager</span><span class="p">:</span>
</span><span id="CsvPaths.paths_manager-171"><a href="#CsvPaths.paths_manager-171"><span class="linenos">171</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_paths_manager</span>
</span></pre></div>


    

                            </div>
                            <div id="CsvPaths.error_manager" class="classattr">
                                        <input id="CsvPaths.error_manager-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">error_manager</span><span class="annotation">: csvpath.managers.errors.error_manager.ErrorManager</span>

                <label class="view-source-button" for="CsvPaths.error_manager-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPaths.error_manager"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPaths.error_manager-177"><a href="#CsvPaths.error_manager-177"><span class="linenos">177</span></a>    <span class="nd">@property</span>
</span><span id="CsvPaths.error_manager-178"><a href="#CsvPaths.error_manager-178"><span class="linenos">178</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">error_manager</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ErrorManager</span><span class="p">:</span>
</span><span id="CsvPaths.error_manager-179"><a href="#CsvPaths.error_manager-179"><span class="linenos">179</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_error_manager</span>
</span></pre></div>


    

                            </div>
                            <div id="CsvPaths.csvpath" class="classattr">
                                        <input id="CsvPaths.csvpath-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">csvpath</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n"><a href="#CsvPath">CsvPath</a></span>:</span></span>

                <label class="view-source-button" for="CsvPaths.csvpath-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPaths.csvpath"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPaths.csvpath-221"><a href="#CsvPaths.csvpath-221"><span class="linenos">221</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">csvpath</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CsvPath</span><span class="p">:</span>
</span><span id="CsvPaths.csvpath-222"><a href="#CsvPaths.csvpath-222"><span class="linenos">222</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets a CsvPath object primed with a reference to this CsvPaths&quot;&quot;&quot;</span>
</span><span id="CsvPaths.csvpath-223"><a href="#CsvPaths.csvpath-223"><span class="linenos">223</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="n">CsvPath</span><span class="p">(</span>
</span><span id="CsvPaths.csvpath-224"><a href="#CsvPaths.csvpath-224"><span class="linenos">224</span></a>            <span class="n">csvpaths</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
</span><span id="CsvPaths.csvpath-225"><a href="#CsvPaths.csvpath-225"><span class="linenos">225</span></a>            <span class="n">delimiter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">,</span>
</span><span id="CsvPaths.csvpath-226"><a href="#CsvPaths.csvpath-226"><span class="linenos">226</span></a>            <span class="n">quotechar</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">quotechar</span><span class="p">,</span>
</span><span id="CsvPaths.csvpath-227"><a href="#CsvPaths.csvpath-227"><span class="linenos">227</span></a>            <span class="n">skip_blank_lines</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">skip_blank_lines</span><span class="p">,</span>
</span><span id="CsvPaths.csvpath-228"><a href="#CsvPaths.csvpath-228"><span class="linenos">228</span></a>            <span class="c1">#</span>
</span><span id="CsvPaths.csvpath-229"><a href="#CsvPaths.csvpath-229"><span class="linenos">229</span></a>            <span class="c1"># in the usual case we don&#39;t want csvpaths and its csvpath children</span>
</span><span id="CsvPaths.csvpath-230"><a href="#CsvPaths.csvpath-230"><span class="linenos">230</span></a>            <span class="c1"># to share the same config. sharing doesn&#39;t offer much. the flexibility</span>
</span><span id="CsvPaths.csvpath-231"><a href="#CsvPaths.csvpath-231"><span class="linenos">231</span></a>            <span class="c1"># of having separate configs is valuable.</span>
</span><span id="CsvPaths.csvpath-232"><a href="#CsvPaths.csvpath-232"><span class="linenos">232</span></a>            <span class="c1">#</span>
</span><span id="CsvPaths.csvpath-233"><a href="#CsvPaths.csvpath-233"><span class="linenos">233</span></a>            <span class="n">config</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="CsvPaths.csvpath-234"><a href="#CsvPaths.csvpath-234"><span class="linenos">234</span></a>            <span class="n">print_default</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">print_default</span><span class="p">,</span>
</span><span id="CsvPaths.csvpath-235"><a href="#CsvPaths.csvpath-235"><span class="linenos">235</span></a>            <span class="n">error_manager</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">error_manager</span><span class="p">,</span>
</span><span id="CsvPaths.csvpath-236"><a href="#CsvPaths.csvpath-236"><span class="linenos">236</span></a>        <span class="p">)</span>
</span><span id="CsvPaths.csvpath-237"><a href="#CsvPaths.csvpath-237"><span class="linenos">237</span></a>        <span class="k">return</span> <span class="n">path</span>
</span></pre></div>


            <div class="docstring"><p>Gets a CsvPath object primed with a reference to this CsvPaths</p>
</div>


                            </div>
                            <div id="CsvPaths.collect_paths" class="classattr">
                                        <input id="CsvPaths.collect_paths-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">collect_paths</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span>, </span><span class="param"><span class="n">pathsname</span>, </span><span class="param"><span class="n">filename</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="CsvPaths.collect_paths-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPaths.collect_paths"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPaths.collect_paths-301"><a href="#CsvPaths.collect_paths-301"><span class="linenos">301</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">collect_paths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPaths.collect_paths-302"><a href="#CsvPaths.collect_paths-302"><span class="linenos">302</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CsvPaths.collect_paths-303"><a href="#CsvPaths.collect_paths-303"><span class="linenos">303</span></a><span class="sd">        Sequentially does a CsvPath.collect() on filename for every named path. lines are collected into results.&quot;&quot;&quot;</span>
</span><span id="CsvPaths.collect_paths-304"><a href="#CsvPaths.collect_paths-304"><span class="linenos">304</span></a>        <span class="n">paths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">paths_manager</span><span class="o">.</span><span class="n">get_named_paths</span><span class="p">(</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths.collect_paths-305"><a href="#CsvPaths.collect_paths-305"><span class="linenos">305</span></a>        <span class="k">if</span> <span class="n">paths</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPaths.collect_paths-306"><a href="#CsvPaths.collect_paths-306"><span class="linenos">306</span></a>            <span class="k">raise</span> <span class="n">InputException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No named-paths found for </span><span class="si">{</span><span class="n">pathsname</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="CsvPaths.collect_paths-307"><a href="#CsvPaths.collect_paths-307"><span class="linenos">307</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CsvPaths.collect_paths-308"><a href="#CsvPaths.collect_paths-308"><span class="linenos">308</span></a>            <span class="k">raise</span> <span class="n">InputException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Named-paths group </span><span class="si">{</span><span class="n">pathsname</span><span class="si">}</span><span class="s2"> is empty&quot;</span><span class="p">)</span>
</span><span id="CsvPaths.collect_paths-309"><a href="#CsvPaths.collect_paths-309"><span class="linenos">309</span></a>        <span class="k">if</span> <span class="s2">&quot;&quot;</span> <span class="ow">in</span> <span class="n">paths</span><span class="p">:</span>
</span><span id="CsvPaths.collect_paths-310"><a href="#CsvPaths.collect_paths-310"><span class="linenos">310</span></a>            <span class="k">raise</span> <span class="n">InputException</span><span class="p">(</span>
</span><span id="CsvPaths.collect_paths-311"><a href="#CsvPaths.collect_paths-311"><span class="linenos">311</span></a>                <span class="sa">f</span><span class="s2">&quot;Named-paths group </span><span class="si">{</span><span class="n">pathsname</span><span class="si">}</span><span class="s2"> has one or more empty csvpaths&quot;</span>
</span><span id="CsvPaths.collect_paths-312"><a href="#CsvPaths.collect_paths-312"><span class="linenos">312</span></a>            <span class="p">)</span>
</span><span id="CsvPaths.collect_paths-313"><a href="#CsvPaths.collect_paths-313"><span class="linenos">313</span></a>        <span class="n">file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_manager</span><span class="o">.</span><span class="n">get_named_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span><span id="CsvPaths.collect_paths-314"><a href="#CsvPaths.collect_paths-314"><span class="linenos">314</span></a>        <span class="k">if</span> <span class="n">file</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPaths.collect_paths-315"><a href="#CsvPaths.collect_paths-315"><span class="linenos">315</span></a>            <span class="k">raise</span> <span class="n">InputException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No named-file found for </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="CsvPaths.collect_paths-316"><a href="#CsvPaths.collect_paths-316"><span class="linenos">316</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Prepping </span><span class="si">%s</span><span class="s2"> and </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths.collect_paths-317"><a href="#CsvPaths.collect_paths-317"><span class="linenos">317</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clean</span><span class="p">(</span><span class="n">paths</span><span class="o">=</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths.collect_paths-318"><a href="#CsvPaths.collect_paths-318"><span class="linenos">318</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="CsvPaths.collect_paths-319"><a href="#CsvPaths.collect_paths-319"><span class="linenos">319</span></a>            <span class="s2">&quot;Beginning collect_paths </span><span class="si">%s</span><span class="s2"> with </span><span class="si">%s</span><span class="s2"> paths&quot;</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span>
</span><span id="CsvPaths.collect_paths-320"><a href="#CsvPaths.collect_paths-320"><span class="linenos">320</span></a>        <span class="p">)</span>
</span><span id="CsvPaths.collect_paths-321"><a href="#CsvPaths.collect_paths-321"><span class="linenos">321</span></a>        <span class="n">crt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_time_str</span><span class="p">(</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths.collect_paths-322"><a href="#CsvPaths.collect_paths-322"><span class="linenos">322</span></a>        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CsvPaths.collect_paths-323"><a href="#CsvPaths.collect_paths-323"><span class="linenos">323</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.collect_paths-324"><a href="#CsvPaths.collect_paths-324"><span class="linenos">324</span></a>        <span class="c1"># run starts here</span>
</span><span id="CsvPaths.collect_paths-325"><a href="#CsvPaths.collect_paths-325"><span class="linenos">325</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.collect_paths-326"><a href="#CsvPaths.collect_paths-326"><span class="linenos">326</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">start_run</span><span class="p">(</span>
</span><span id="CsvPaths.collect_paths-327"><a href="#CsvPaths.collect_paths-327"><span class="linenos">327</span></a>            <span class="n">run_dir</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span> <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span>
</span><span id="CsvPaths.collect_paths-328"><a href="#CsvPaths.collect_paths-328"><span class="linenos">328</span></a>        <span class="p">)</span>
</span><span id="CsvPaths.collect_paths-329"><a href="#CsvPaths.collect_paths-329"><span class="linenos">329</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.collect_paths-330"><a href="#CsvPaths.collect_paths-330"><span class="linenos">330</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.collect_paths-331"><a href="#CsvPaths.collect_paths-331"><span class="linenos">331</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.collect_paths-332"><a href="#CsvPaths.collect_paths-332"><span class="linenos">332</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">path</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">paths</span><span class="p">):</span>
</span><span id="CsvPaths.collect_paths-333"><a href="#CsvPaths.collect_paths-333"><span class="linenos">333</span></a>            <span class="n">csvpath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">csvpath</span><span class="p">()</span>
</span><span id="CsvPaths.collect_paths-334"><a href="#CsvPaths.collect_paths-334"><span class="linenos">334</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">csvpath</span><span class="o">.</span><span class="n">will_run</span><span class="p">:</span>
</span><span id="CsvPaths.collect_paths-335"><a href="#CsvPaths.collect_paths-335"><span class="linenos">335</span></a>                <span class="k">continue</span>
</span><span id="CsvPaths.collect_paths-336"><a href="#CsvPaths.collect_paths-336"><span class="linenos">336</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">Result</span><span class="p">(</span>
</span><span id="CsvPaths.collect_paths-337"><a href="#CsvPaths.collect_paths-337"><span class="linenos">337</span></a>                <span class="n">csvpath</span><span class="o">=</span><span class="n">csvpath</span><span class="p">,</span>
</span><span id="CsvPaths.collect_paths-338"><a href="#CsvPaths.collect_paths-338"><span class="linenos">338</span></a>                <span class="n">file_name</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths.collect_paths-339"><a href="#CsvPaths.collect_paths-339"><span class="linenos">339</span></a>                <span class="n">paths_name</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths.collect_paths-340"><a href="#CsvPaths.collect_paths-340"><span class="linenos">340</span></a>                <span class="n">run_index</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>
</span><span id="CsvPaths.collect_paths-341"><a href="#CsvPaths.collect_paths-341"><span class="linenos">341</span></a>                <span class="n">run_time</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_run_time</span><span class="p">,</span>
</span><span id="CsvPaths.collect_paths-342"><a href="#CsvPaths.collect_paths-342"><span class="linenos">342</span></a>                <span class="n">run_dir</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span>
</span><span id="CsvPaths.collect_paths-343"><a href="#CsvPaths.collect_paths-343"><span class="linenos">343</span></a>            <span class="p">)</span>
</span><span id="CsvPaths.collect_paths-344"><a href="#CsvPaths.collect_paths-344"><span class="linenos">344</span></a>            <span class="c1"># casting a broad net because if &quot;raise&quot; not in the error policy we</span>
</span><span id="CsvPaths.collect_paths-345"><a href="#CsvPaths.collect_paths-345"><span class="linenos">345</span></a>            <span class="c1"># want to never fail during a run</span>
</span><span id="CsvPaths.collect_paths-346"><a href="#CsvPaths.collect_paths-346"><span class="linenos">346</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="CsvPaths.collect_paths-347"><a href="#CsvPaths.collect_paths-347"><span class="linenos">347</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_load_csvpath</span><span class="p">(</span>
</span><span id="CsvPaths.collect_paths-348"><a href="#CsvPaths.collect_paths-348"><span class="linenos">348</span></a>                    <span class="n">csvpath</span><span class="o">=</span><span class="n">csvpath</span><span class="p">,</span>
</span><span id="CsvPaths.collect_paths-349"><a href="#CsvPaths.collect_paths-349"><span class="linenos">349</span></a>                    <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>
</span><span id="CsvPaths.collect_paths-350"><a href="#CsvPaths.collect_paths-350"><span class="linenos">350</span></a>                    <span class="n">file</span><span class="o">=</span><span class="n">file</span><span class="p">,</span>
</span><span id="CsvPaths.collect_paths-351"><a href="#CsvPaths.collect_paths-351"><span class="linenos">351</span></a>                    <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths.collect_paths-352"><a href="#CsvPaths.collect_paths-352"><span class="linenos">352</span></a>                    <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths.collect_paths-353"><a href="#CsvPaths.collect_paths-353"><span class="linenos">353</span></a>                    <span class="n">crt</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span>
</span><span id="CsvPaths.collect_paths-354"><a href="#CsvPaths.collect_paths-354"><span class="linenos">354</span></a>                <span class="p">)</span>
</span><span id="CsvPaths.collect_paths-355"><a href="#CsvPaths.collect_paths-355"><span class="linenos">355</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths.collect_paths-356"><a href="#CsvPaths.collect_paths-356"><span class="linenos">356</span></a>                <span class="c1"># if run-mode: no-run we skip ahead without saving results</span>
</span><span id="CsvPaths.collect_paths-357"><a href="#CsvPaths.collect_paths-357"><span class="linenos">357</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths.collect_paths-358"><a href="#CsvPaths.collect_paths-358"><span class="linenos">358</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">csvpath</span><span class="o">.</span><span class="n">will_run</span><span class="p">:</span>
</span><span id="CsvPaths.collect_paths-359"><a href="#CsvPaths.collect_paths-359"><span class="linenos">359</span></a>                    <span class="k">continue</span>
</span><span id="CsvPaths.collect_paths-360"><a href="#CsvPaths.collect_paths-360"><span class="linenos">360</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths.collect_paths-361"><a href="#CsvPaths.collect_paths-361"><span class="linenos">361</span></a>                <span class="c1"># the add has to come after _load_csvpath because we need the identity or index</span>
</span><span id="CsvPaths.collect_paths-362"><a href="#CsvPaths.collect_paths-362"><span class="linenos">362</span></a>                <span class="c1"># to be stable and the identity is found in load, if it exists.</span>
</span><span id="CsvPaths.collect_paths-363"><a href="#CsvPaths.collect_paths-363"><span class="linenos">363</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths.collect_paths-364"><a href="#CsvPaths.collect_paths-364"><span class="linenos">364</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">add_named_result</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths.collect_paths-365"><a href="#CsvPaths.collect_paths-365"><span class="linenos">365</span></a>                <span class="n">lines</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">lines</span>
</span><span id="CsvPaths.collect_paths-366"><a href="#CsvPaths.collect_paths-366"><span class="linenos">366</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Collecting lines using a </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">lines</span><span class="p">))</span>
</span><span id="CsvPaths.collect_paths-367"><a href="#CsvPaths.collect_paths-367"><span class="linenos">367</span></a>                <span class="n">csvpath</span><span class="o">.</span><span class="n">collect</span><span class="p">(</span><span class="n">lines</span><span class="o">=</span><span class="n">lines</span><span class="p">)</span>
</span><span id="CsvPaths.collect_paths-368"><a href="#CsvPaths.collect_paths-368"><span class="linenos">368</span></a>                <span class="k">if</span> <span class="n">lines</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPaths.collect_paths-369"><a href="#CsvPaths.collect_paths-369"><span class="linenos">369</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>  <span class="c1"># pragma: no cover</span>
</span><span id="CsvPaths.collect_paths-370"><a href="#CsvPaths.collect_paths-370"><span class="linenos">370</span></a>                        <span class="s2">&quot;Unexpected None for lines after collect_paths: file: </span><span class="si">%s</span><span class="s2">, match: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="CsvPaths.collect_paths-371"><a href="#CsvPaths.collect_paths-371"><span class="linenos">371</span></a>                        <span class="n">file</span><span class="p">,</span>
</span><span id="CsvPaths.collect_paths-372"><a href="#CsvPaths.collect_paths-372"><span class="linenos">372</span></a>                        <span class="n">csvpath</span><span class="o">.</span><span class="n">match</span><span class="p">,</span>
</span><span id="CsvPaths.collect_paths-373"><a href="#CsvPaths.collect_paths-373"><span class="linenos">373</span></a>                    <span class="p">)</span>
</span><span id="CsvPaths.collect_paths-374"><a href="#CsvPaths.collect_paths-374"><span class="linenos">374</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths.collect_paths-375"><a href="#CsvPaths.collect_paths-375"><span class="linenos">375</span></a>                <span class="c1"># this is obviously not a good idea for very large files!</span>
</span><span id="CsvPaths.collect_paths-376"><a href="#CsvPaths.collect_paths-376"><span class="linenos">376</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths.collect_paths-377"><a href="#CsvPaths.collect_paths-377"><span class="linenos">377</span></a>                <span class="n">result</span><span class="o">.</span><span class="n">unmatched</span> <span class="o">=</span> <span class="n">csvpath</span><span class="o">.</span><span class="n">unmatched</span>
</span><span id="CsvPaths.collect_paths-378"><a href="#CsvPaths.collect_paths-378"><span class="linenos">378</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>  <span class="c1"># pylint: disable=W0718</span>
</span><span id="CsvPaths.collect_paths-379"><a href="#CsvPaths.collect_paths-379"><span class="linenos">379</span></a>                <span class="c1"># ex.trace = traceback.format_exc()</span>
</span><span id="CsvPaths.collect_paths-380"><a href="#CsvPaths.collect_paths-380"><span class="linenos">380</span></a>                <span class="c1"># ex.source = self</span>
</span><span id="CsvPaths.collect_paths-381"><a href="#CsvPaths.collect_paths-381"><span class="linenos">381</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">error_manager</span><span class="o">.</span><span class="n">csvpaths</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CsvPaths.collect_paths-382"><a href="#CsvPaths.collect_paths-382"><span class="linenos">382</span></a>                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;ErrorManager&#39;s CsvPaths cannot be None&quot;</span><span class="p">)</span>
</span><span id="CsvPaths.collect_paths-383"><a href="#CsvPaths.collect_paths-383"><span class="linenos">383</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">error_manager</span><span class="o">.</span><span class="n">handle_error</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="CsvPaths.collect_paths-384"><a href="#CsvPaths.collect_paths-384"><span class="linenos">384</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ecoms</span><span class="o">.</span><span class="n">do_i_raise</span><span class="p">():</span>
</span><span id="CsvPaths.collect_paths-385"><a href="#CsvPaths.collect_paths-385"><span class="linenos">385</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths.collect_paths-386"><a href="#CsvPaths.collect_paths-386"><span class="linenos">386</span></a>                    <span class="k">raise</span>
</span><span id="CsvPaths.collect_paths-387"><a href="#CsvPaths.collect_paths-387"><span class="linenos">387</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths.collect_paths-388"><a href="#CsvPaths.collect_paths-388"><span class="linenos">388</span></a>            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths.collect_paths-389"><a href="#CsvPaths.collect_paths-389"><span class="linenos">389</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.collect_paths-390"><a href="#CsvPaths.collect_paths-390"><span class="linenos">390</span></a>        <span class="c1"># run ends here</span>
</span><span id="CsvPaths.collect_paths-391"><a href="#CsvPaths.collect_paths-391"><span class="linenos">391</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.collect_paths-392"><a href="#CsvPaths.collect_paths-392"><span class="linenos">392</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">complete_run</span><span class="p">(</span>
</span><span id="CsvPaths.collect_paths-393"><a href="#CsvPaths.collect_paths-393"><span class="linenos">393</span></a>            <span class="n">run_dir</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span> <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span>
</span><span id="CsvPaths.collect_paths-394"><a href="#CsvPaths.collect_paths-394"><span class="linenos">394</span></a>        <span class="p">)</span>
</span><span id="CsvPaths.collect_paths-395"><a href="#CsvPaths.collect_paths-395"><span class="linenos">395</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.collect_paths-396"><a href="#CsvPaths.collect_paths-396"><span class="linenos">396</span></a>        <span class="c1"># update/write run manifests here</span>
</span><span id="CsvPaths.collect_paths-397"><a href="#CsvPaths.collect_paths-397"><span class="linenos">397</span></a>        <span class="c1">#  - validity (are all paths valid)</span>
</span><span id="CsvPaths.collect_paths-398"><a href="#CsvPaths.collect_paths-398"><span class="linenos">398</span></a>        <span class="c1">#  - paths-completeness (did they all run and complete)</span>
</span><span id="CsvPaths.collect_paths-399"><a href="#CsvPaths.collect_paths-399"><span class="linenos">399</span></a>        <span class="c1">#  - method (collect, fast_forward, next)</span>
</span><span id="CsvPaths.collect_paths-400"><a href="#CsvPaths.collect_paths-400"><span class="linenos">400</span></a>        <span class="c1">#  - timestamp</span>
</span><span id="CsvPaths.collect_paths-401"><a href="#CsvPaths.collect_paths-401"><span class="linenos">401</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.collect_paths-402"><a href="#CsvPaths.collect_paths-402"><span class="linenos">402</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clear_run_coordination</span><span class="p">()</span>
</span><span id="CsvPaths.collect_paths-403"><a href="#CsvPaths.collect_paths-403"><span class="linenos">403</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="CsvPaths.collect_paths-404"><a href="#CsvPaths.collect_paths-404"><span class="linenos">404</span></a>            <span class="s2">&quot;Completed collect_paths </span><span class="si">%s</span><span class="s2"> with </span><span class="si">%s</span><span class="s2"> paths&quot;</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span>
</span><span id="CsvPaths.collect_paths-405"><a href="#CsvPaths.collect_paths-405"><span class="linenos">405</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Sequentially does a <a href="#CsvPath.collect">CsvPath.collect()</a> on filename for every named path. lines are collected into results.</p>
</div>


                            </div>
                            <div id="CsvPaths.fast_forward_paths" class="classattr">
                                        <input id="CsvPaths.fast_forward_paths-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fast_forward_paths</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span>, </span><span class="param"><span class="n">pathsname</span>, </span><span class="param"><span class="n">filename</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="CsvPaths.fast_forward_paths-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPaths.fast_forward_paths"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPaths.fast_forward_paths-505"><a href="#CsvPaths.fast_forward_paths-505"><span class="linenos">505</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fast_forward_paths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
</span><span id="CsvPaths.fast_forward_paths-506"><a href="#CsvPaths.fast_forward_paths-506"><span class="linenos">506</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Sequentially does a CsvPath.fast_forward() on filename for every named path. No matches are collected.&quot;&quot;&quot;</span>
</span><span id="CsvPaths.fast_forward_paths-507"><a href="#CsvPaths.fast_forward_paths-507"><span class="linenos">507</span></a>        <span class="n">paths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">paths_manager</span><span class="o">.</span><span class="n">get_named_paths</span><span class="p">(</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths.fast_forward_paths-508"><a href="#CsvPaths.fast_forward_paths-508"><span class="linenos">508</span></a>        <span class="n">file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_manager</span><span class="o">.</span><span class="n">get_named_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span><span id="CsvPaths.fast_forward_paths-509"><a href="#CsvPaths.fast_forward_paths-509"><span class="linenos">509</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Prepping </span><span class="si">%s</span><span class="s2"> and </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths.fast_forward_paths-510"><a href="#CsvPaths.fast_forward_paths-510"><span class="linenos">510</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clean</span><span class="p">(</span><span class="n">paths</span><span class="o">=</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths.fast_forward_paths-511"><a href="#CsvPaths.fast_forward_paths-511"><span class="linenos">511</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="CsvPaths.fast_forward_paths-512"><a href="#CsvPaths.fast_forward_paths-512"><span class="linenos">512</span></a>            <span class="s2">&quot;Beginning FF </span><span class="si">%s</span><span class="s2"> with </span><span class="si">%s</span><span class="s2"> paths against file </span><span class="si">%s</span><span class="s2">. No match results will be held.&quot;</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_paths-513"><a href="#CsvPaths.fast_forward_paths-513"><span class="linenos">513</span></a>            <span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_paths-514"><a href="#CsvPaths.fast_forward_paths-514"><span class="linenos">514</span></a>            <span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">),</span>
</span><span id="CsvPaths.fast_forward_paths-515"><a href="#CsvPaths.fast_forward_paths-515"><span class="linenos">515</span></a>            <span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_paths-516"><a href="#CsvPaths.fast_forward_paths-516"><span class="linenos">516</span></a>        <span class="p">)</span>
</span><span id="CsvPaths.fast_forward_paths-517"><a href="#CsvPaths.fast_forward_paths-517"><span class="linenos">517</span></a>        <span class="n">crt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_time_str</span><span class="p">(</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths.fast_forward_paths-518"><a href="#CsvPaths.fast_forward_paths-518"><span class="linenos">518</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.fast_forward_paths-519"><a href="#CsvPaths.fast_forward_paths-519"><span class="linenos">519</span></a>        <span class="c1"># run starts here</span>
</span><span id="CsvPaths.fast_forward_paths-520"><a href="#CsvPaths.fast_forward_paths-520"><span class="linenos">520</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.fast_forward_paths-521"><a href="#CsvPaths.fast_forward_paths-521"><span class="linenos">521</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">start_run</span><span class="p">(</span>
</span><span id="CsvPaths.fast_forward_paths-522"><a href="#CsvPaths.fast_forward_paths-522"><span class="linenos">522</span></a>            <span class="n">run_dir</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span> <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span>
</span><span id="CsvPaths.fast_forward_paths-523"><a href="#CsvPaths.fast_forward_paths-523"><span class="linenos">523</span></a>        <span class="p">)</span>
</span><span id="CsvPaths.fast_forward_paths-524"><a href="#CsvPaths.fast_forward_paths-524"><span class="linenos">524</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.fast_forward_paths-525"><a href="#CsvPaths.fast_forward_paths-525"><span class="linenos">525</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.fast_forward_paths-526"><a href="#CsvPaths.fast_forward_paths-526"><span class="linenos">526</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.fast_forward_paths-527"><a href="#CsvPaths.fast_forward_paths-527"><span class="linenos">527</span></a>        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CsvPaths.fast_forward_paths-528"><a href="#CsvPaths.fast_forward_paths-528"><span class="linenos">528</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">path</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">paths</span><span class="p">):</span>
</span><span id="CsvPaths.fast_forward_paths-529"><a href="#CsvPaths.fast_forward_paths-529"><span class="linenos">529</span></a>            <span class="n">csvpath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">csvpath</span><span class="p">()</span>
</span><span id="CsvPaths.fast_forward_paths-530"><a href="#CsvPaths.fast_forward_paths-530"><span class="linenos">530</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Beginning to FF CsvPath instance: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">csvpath</span><span class="p">)</span>
</span><span id="CsvPaths.fast_forward_paths-531"><a href="#CsvPaths.fast_forward_paths-531"><span class="linenos">531</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">Result</span><span class="p">(</span>
</span><span id="CsvPaths.fast_forward_paths-532"><a href="#CsvPaths.fast_forward_paths-532"><span class="linenos">532</span></a>                <span class="n">csvpath</span><span class="o">=</span><span class="n">csvpath</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_paths-533"><a href="#CsvPaths.fast_forward_paths-533"><span class="linenos">533</span></a>                <span class="n">file_name</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_paths-534"><a href="#CsvPaths.fast_forward_paths-534"><span class="linenos">534</span></a>                <span class="n">paths_name</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_paths-535"><a href="#CsvPaths.fast_forward_paths-535"><span class="linenos">535</span></a>                <span class="n">run_index</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_paths-536"><a href="#CsvPaths.fast_forward_paths-536"><span class="linenos">536</span></a>                <span class="n">run_time</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_run_time</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_paths-537"><a href="#CsvPaths.fast_forward_paths-537"><span class="linenos">537</span></a>                <span class="n">run_dir</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_paths-538"><a href="#CsvPaths.fast_forward_paths-538"><span class="linenos">538</span></a>            <span class="p">)</span>
</span><span id="CsvPaths.fast_forward_paths-539"><a href="#CsvPaths.fast_forward_paths-539"><span class="linenos">539</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="CsvPaths.fast_forward_paths-540"><a href="#CsvPaths.fast_forward_paths-540"><span class="linenos">540</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_load_csvpath</span><span class="p">(</span>
</span><span id="CsvPaths.fast_forward_paths-541"><a href="#CsvPaths.fast_forward_paths-541"><span class="linenos">541</span></a>                    <span class="n">csvpath</span><span class="o">=</span><span class="n">csvpath</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_paths-542"><a href="#CsvPaths.fast_forward_paths-542"><span class="linenos">542</span></a>                    <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_paths-543"><a href="#CsvPaths.fast_forward_paths-543"><span class="linenos">543</span></a>                    <span class="n">file</span><span class="o">=</span><span class="n">file</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_paths-544"><a href="#CsvPaths.fast_forward_paths-544"><span class="linenos">544</span></a>                    <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_paths-545"><a href="#CsvPaths.fast_forward_paths-545"><span class="linenos">545</span></a>                    <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_paths-546"><a href="#CsvPaths.fast_forward_paths-546"><span class="linenos">546</span></a>                    <span class="n">crt</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_paths-547"><a href="#CsvPaths.fast_forward_paths-547"><span class="linenos">547</span></a>                <span class="p">)</span>
</span><span id="CsvPaths.fast_forward_paths-548"><a href="#CsvPaths.fast_forward_paths-548"><span class="linenos">548</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths.fast_forward_paths-549"><a href="#CsvPaths.fast_forward_paths-549"><span class="linenos">549</span></a>                <span class="c1"># if run-mode: no-run we skip ahead without saving results</span>
</span><span id="CsvPaths.fast_forward_paths-550"><a href="#CsvPaths.fast_forward_paths-550"><span class="linenos">550</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths.fast_forward_paths-551"><a href="#CsvPaths.fast_forward_paths-551"><span class="linenos">551</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">csvpath</span><span class="o">.</span><span class="n">will_run</span><span class="p">:</span>
</span><span id="CsvPaths.fast_forward_paths-552"><a href="#CsvPaths.fast_forward_paths-552"><span class="linenos">552</span></a>                    <span class="k">continue</span>
</span><span id="CsvPaths.fast_forward_paths-553"><a href="#CsvPaths.fast_forward_paths-553"><span class="linenos">553</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths.fast_forward_paths-554"><a href="#CsvPaths.fast_forward_paths-554"><span class="linenos">554</span></a>                <span class="c1"># the add has to come after _load_csvpath because we need the identity or index</span>
</span><span id="CsvPaths.fast_forward_paths-555"><a href="#CsvPaths.fast_forward_paths-555"><span class="linenos">555</span></a>                <span class="c1"># to be stable and the identity is found in load, if it exists.</span>
</span><span id="CsvPaths.fast_forward_paths-556"><a href="#CsvPaths.fast_forward_paths-556"><span class="linenos">556</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths.fast_forward_paths-557"><a href="#CsvPaths.fast_forward_paths-557"><span class="linenos">557</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">add_named_result</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths.fast_forward_paths-558"><a href="#CsvPaths.fast_forward_paths-558"><span class="linenos">558</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="CsvPaths.fast_forward_paths-559"><a href="#CsvPaths.fast_forward_paths-559"><span class="linenos">559</span></a>                    <span class="s2">&quot;Parsed csvpath </span><span class="si">%s</span><span class="s2"> pointed at </span><span class="si">%s</span><span class="s2"> and starting to fast-forward&quot;</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_paths-560"><a href="#CsvPaths.fast_forward_paths-560"><span class="linenos">560</span></a>                    <span class="n">i</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_paths-561"><a href="#CsvPaths.fast_forward_paths-561"><span class="linenos">561</span></a>                    <span class="n">file</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_paths-562"><a href="#CsvPaths.fast_forward_paths-562"><span class="linenos">562</span></a>                <span class="p">)</span>
</span><span id="CsvPaths.fast_forward_paths-563"><a href="#CsvPaths.fast_forward_paths-563"><span class="linenos">563</span></a>                <span class="n">csvpath</span><span class="o">.</span><span class="n">fast_forward</span><span class="p">()</span>
</span><span id="CsvPaths.fast_forward_paths-564"><a href="#CsvPaths.fast_forward_paths-564"><span class="linenos">564</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="CsvPaths.fast_forward_paths-565"><a href="#CsvPaths.fast_forward_paths-565"><span class="linenos">565</span></a>                    <span class="s2">&quot;Completed fast forward of csvpath </span><span class="si">%s</span><span class="s2"> against </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">file</span>
</span><span id="CsvPaths.fast_forward_paths-566"><a href="#CsvPaths.fast_forward_paths-566"><span class="linenos">566</span></a>                <span class="p">)</span>
</span><span id="CsvPaths.fast_forward_paths-567"><a href="#CsvPaths.fast_forward_paths-567"><span class="linenos">567</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>  <span class="c1"># pylint: disable=W0718</span>
</span><span id="CsvPaths.fast_forward_paths-568"><a href="#CsvPaths.fast_forward_paths-568"><span class="linenos">568</span></a>                <span class="c1"># ex.trace = traceback.format_exc()</span>
</span><span id="CsvPaths.fast_forward_paths-569"><a href="#CsvPaths.fast_forward_paths-569"><span class="linenos">569</span></a>                <span class="c1"># ex.source = self</span>
</span><span id="CsvPaths.fast_forward_paths-570"><a href="#CsvPaths.fast_forward_paths-570"><span class="linenos">570</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">error_manager</span><span class="o">.</span><span class="n">handle_error</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="CsvPaths.fast_forward_paths-571"><a href="#CsvPaths.fast_forward_paths-571"><span class="linenos">571</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ecoms</span><span class="o">.</span><span class="n">do_i_raise</span><span class="p">():</span>
</span><span id="CsvPaths.fast_forward_paths-572"><a href="#CsvPaths.fast_forward_paths-572"><span class="linenos">572</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths.fast_forward_paths-573"><a href="#CsvPaths.fast_forward_paths-573"><span class="linenos">573</span></a>                    <span class="k">raise</span>
</span><span id="CsvPaths.fast_forward_paths-574"><a href="#CsvPaths.fast_forward_paths-574"><span class="linenos">574</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths.fast_forward_paths-575"><a href="#CsvPaths.fast_forward_paths-575"><span class="linenos">575</span></a>            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths.fast_forward_paths-576"><a href="#CsvPaths.fast_forward_paths-576"><span class="linenos">576</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.fast_forward_paths-577"><a href="#CsvPaths.fast_forward_paths-577"><span class="linenos">577</span></a>        <span class="c1"># run ends here</span>
</span><span id="CsvPaths.fast_forward_paths-578"><a href="#CsvPaths.fast_forward_paths-578"><span class="linenos">578</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.fast_forward_paths-579"><a href="#CsvPaths.fast_forward_paths-579"><span class="linenos">579</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">complete_run</span><span class="p">(</span>
</span><span id="CsvPaths.fast_forward_paths-580"><a href="#CsvPaths.fast_forward_paths-580"><span class="linenos">580</span></a>            <span class="n">run_dir</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span> <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span>
</span><span id="CsvPaths.fast_forward_paths-581"><a href="#CsvPaths.fast_forward_paths-581"><span class="linenos">581</span></a>        <span class="p">)</span>
</span><span id="CsvPaths.fast_forward_paths-582"><a href="#CsvPaths.fast_forward_paths-582"><span class="linenos">582</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clear_run_coordination</span><span class="p">()</span>
</span><span id="CsvPaths.fast_forward_paths-583"><a href="#CsvPaths.fast_forward_paths-583"><span class="linenos">583</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="CsvPaths.fast_forward_paths-584"><a href="#CsvPaths.fast_forward_paths-584"><span class="linenos">584</span></a>            <span class="s2">&quot;Completed fast_forward_paths </span><span class="si">%s</span><span class="s2"> with </span><span class="si">%s</span><span class="s2"> paths&quot;</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span>
</span><span id="CsvPaths.fast_forward_paths-585"><a href="#CsvPaths.fast_forward_paths-585"><span class="linenos">585</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Sequentially does a <a href="#CsvPath.fast_forward">CsvPath.fast_forward()</a> on filename for every named path. No matches are collected.</p>
</div>


                            </div>
                            <div id="CsvPaths.next_paths" class="classattr">
                                        <input id="CsvPaths.next_paths-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">next_paths</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span>, </span><span class="param"><span class="n">pathsname</span>, </span><span class="param"><span class="n">filename</span>, </span><span class="param"><span class="n">collect</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="CsvPaths.next_paths-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPaths.next_paths"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPaths.next_paths-587"><a href="#CsvPaths.next_paths-587"><span class="linenos">587</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">next_paths</span><span class="p">(</span>
</span><span id="CsvPaths.next_paths-588"><a href="#CsvPaths.next_paths-588"><span class="linenos">588</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">collect</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CsvPaths.next_paths-589"><a href="#CsvPaths.next_paths-589"><span class="linenos">589</span></a>    <span class="p">):</span>  <span class="c1"># pylint: disable=R0914</span>
</span><span id="CsvPaths.next_paths-590"><a href="#CsvPaths.next_paths-590"><span class="linenos">590</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Does a CsvPath.next() on filename for every line against every named path in sequence&quot;&quot;&quot;</span>
</span><span id="CsvPaths.next_paths-591"><a href="#CsvPaths.next_paths-591"><span class="linenos">591</span></a>        <span class="n">paths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">paths_manager</span><span class="o">.</span><span class="n">get_named_paths</span><span class="p">(</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths.next_paths-592"><a href="#CsvPaths.next_paths-592"><span class="linenos">592</span></a>        <span class="n">file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_manager</span><span class="o">.</span><span class="n">get_named_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span><span id="CsvPaths.next_paths-593"><a href="#CsvPaths.next_paths-593"><span class="linenos">593</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Prepping </span><span class="si">%s</span><span class="s2"> and </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths.next_paths-594"><a href="#CsvPaths.next_paths-594"><span class="linenos">594</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clean</span><span class="p">(</span><span class="n">paths</span><span class="o">=</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths.next_paths-595"><a href="#CsvPaths.next_paths-595"><span class="linenos">595</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Beginning next_paths with </span><span class="si">%s</span><span class="s2"> paths&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">))</span>
</span><span id="CsvPaths.next_paths-596"><a href="#CsvPaths.next_paths-596"><span class="linenos">596</span></a>        <span class="n">crt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_time_str</span><span class="p">(</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths.next_paths-597"><a href="#CsvPaths.next_paths-597"><span class="linenos">597</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.next_paths-598"><a href="#CsvPaths.next_paths-598"><span class="linenos">598</span></a>        <span class="c1"># run starts here</span>
</span><span id="CsvPaths.next_paths-599"><a href="#CsvPaths.next_paths-599"><span class="linenos">599</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.next_paths-600"><a href="#CsvPaths.next_paths-600"><span class="linenos">600</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">start_run</span><span class="p">(</span>
</span><span id="CsvPaths.next_paths-601"><a href="#CsvPaths.next_paths-601"><span class="linenos">601</span></a>            <span class="n">run_dir</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span> <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span>
</span><span id="CsvPaths.next_paths-602"><a href="#CsvPaths.next_paths-602"><span class="linenos">602</span></a>        <span class="p">)</span>
</span><span id="CsvPaths.next_paths-603"><a href="#CsvPaths.next_paths-603"><span class="linenos">603</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.next_paths-604"><a href="#CsvPaths.next_paths-604"><span class="linenos">604</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.next_paths-605"><a href="#CsvPaths.next_paths-605"><span class="linenos">605</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.next_paths-606"><a href="#CsvPaths.next_paths-606"><span class="linenos">606</span></a>        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CsvPaths.next_paths-607"><a href="#CsvPaths.next_paths-607"><span class="linenos">607</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">path</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">paths</span><span class="p">):</span>
</span><span id="CsvPaths.next_paths-608"><a href="#CsvPaths.next_paths-608"><span class="linenos">608</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_skip_all</span><span class="p">:</span>
</span><span id="CsvPaths.next_paths-609"><a href="#CsvPaths.next_paths-609"><span class="linenos">609</span></a>                <span class="n">skip_err</span> <span class="o">=</span> <span class="s2">&quot;Found the skip-all signal set. skip_all() is&quot;</span>
</span><span id="CsvPaths.next_paths-610"><a href="#CsvPaths.next_paths-610"><span class="linenos">610</span></a>                <span class="n">skip_err</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">skip_err</span><span class="si">}</span><span class="s2"> only for breadth-first runs using the&quot;</span>
</span><span id="CsvPaths.next_paths-611"><a href="#CsvPaths.next_paths-611"><span class="linenos">611</span></a>                <span class="n">skip_err</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">skip_err</span><span class="si">}</span><span class="s2"> &#39;_by_line&#39; methods. It has the same&quot;</span>
</span><span id="CsvPaths.next_paths-612"><a href="#CsvPaths.next_paths-612"><span class="linenos">612</span></a>                <span class="n">skip_err</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">skip_err</span><span class="si">}</span><span class="s2"> effect as skip() in a&quot;</span>
</span><span id="CsvPaths.next_paths-613"><a href="#CsvPaths.next_paths-613"><span class="linenos">613</span></a>                <span class="n">skip_err</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">skip_err</span><span class="si">}</span><span class="s2"> serial run like this one.&quot;</span>
</span><span id="CsvPaths.next_paths-614"><a href="#CsvPaths.next_paths-614"><span class="linenos">614</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">skip_err</span><span class="p">)</span>
</span><span id="CsvPaths.next_paths-615"><a href="#CsvPaths.next_paths-615"><span class="linenos">615</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stop_all</span><span class="p">:</span>
</span><span id="CsvPaths.next_paths-616"><a href="#CsvPaths.next_paths-616"><span class="linenos">616</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Stop-all set. Shutting down run.&quot;</span><span class="p">)</span>
</span><span id="CsvPaths.next_paths-617"><a href="#CsvPaths.next_paths-617"><span class="linenos">617</span></a>                <span class="k">break</span>
</span><span id="CsvPaths.next_paths-618"><a href="#CsvPaths.next_paths-618"><span class="linenos">618</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_advance_all</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CsvPaths.next_paths-619"><a href="#CsvPaths.next_paths-619"><span class="linenos">619</span></a>                <span class="n">advance_err</span> <span class="o">=</span> <span class="s2">&quot;Found the advance-all signal set. advance_all() is&quot;</span>
</span><span id="CsvPaths.next_paths-620"><a href="#CsvPaths.next_paths-620"><span class="linenos">620</span></a>                <span class="n">advance_err</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">advance_err</span><span class="si">}</span><span class="s2"> only for breadth-first runs using the&quot;</span>
</span><span id="CsvPaths.next_paths-621"><a href="#CsvPaths.next_paths-621"><span class="linenos">621</span></a>                <span class="n">advance_err</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">advance_err</span><span class="si">}</span><span class="s2"> &#39;_by_line&#39; methods. It has the same&quot;</span>
</span><span id="CsvPaths.next_paths-622"><a href="#CsvPaths.next_paths-622"><span class="linenos">622</span></a>                <span class="n">advance_err</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">advance_err</span><span class="si">}</span><span class="s2"> effect as advance() in a&quot;</span>
</span><span id="CsvPaths.next_paths-623"><a href="#CsvPaths.next_paths-623"><span class="linenos">623</span></a>                <span class="n">advance_err</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">advance_err</span><span class="si">}</span><span class="s2"> serial run like this one.&quot;</span>
</span><span id="CsvPaths.next_paths-624"><a href="#CsvPaths.next_paths-624"><span class="linenos">624</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">advance_err</span><span class="p">)</span>
</span><span id="CsvPaths.next_paths-625"><a href="#CsvPaths.next_paths-625"><span class="linenos">625</span></a>            <span class="n">csvpath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">csvpath</span><span class="p">()</span>
</span><span id="CsvPaths.next_paths-626"><a href="#CsvPaths.next_paths-626"><span class="linenos">626</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">Result</span><span class="p">(</span>
</span><span id="CsvPaths.next_paths-627"><a href="#CsvPaths.next_paths-627"><span class="linenos">627</span></a>                <span class="n">csvpath</span><span class="o">=</span><span class="n">csvpath</span><span class="p">,</span>
</span><span id="CsvPaths.next_paths-628"><a href="#CsvPaths.next_paths-628"><span class="linenos">628</span></a>                <span class="n">file_name</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths.next_paths-629"><a href="#CsvPaths.next_paths-629"><span class="linenos">629</span></a>                <span class="n">paths_name</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths.next_paths-630"><a href="#CsvPaths.next_paths-630"><span class="linenos">630</span></a>                <span class="n">run_index</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>
</span><span id="CsvPaths.next_paths-631"><a href="#CsvPaths.next_paths-631"><span class="linenos">631</span></a>                <span class="n">run_time</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_run_time</span><span class="p">,</span>
</span><span id="CsvPaths.next_paths-632"><a href="#CsvPaths.next_paths-632"><span class="linenos">632</span></a>                <span class="n">run_dir</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span>
</span><span id="CsvPaths.next_paths-633"><a href="#CsvPaths.next_paths-633"><span class="linenos">633</span></a>            <span class="p">)</span>
</span><span id="CsvPaths.next_paths-634"><a href="#CsvPaths.next_paths-634"><span class="linenos">634</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fail_all</span><span class="p">:</span>
</span><span id="CsvPaths.next_paths-635"><a href="#CsvPaths.next_paths-635"><span class="linenos">635</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="CsvPaths.next_paths-636"><a href="#CsvPaths.next_paths-636"><span class="linenos">636</span></a>                    <span class="s2">&quot;Fail-all set. Failing all remaining CsvPath instances in the run.&quot;</span>
</span><span id="CsvPaths.next_paths-637"><a href="#CsvPaths.next_paths-637"><span class="linenos">637</span></a>                <span class="p">)</span>
</span><span id="CsvPaths.next_paths-638"><a href="#CsvPaths.next_paths-638"><span class="linenos">638</span></a>                <span class="n">csvpath</span><span class="o">.</span><span class="n">is_valid</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CsvPaths.next_paths-639"><a href="#CsvPaths.next_paths-639"><span class="linenos">639</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="CsvPaths.next_paths-640"><a href="#CsvPaths.next_paths-640"><span class="linenos">640</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_load_csvpath</span><span class="p">(</span>
</span><span id="CsvPaths.next_paths-641"><a href="#CsvPaths.next_paths-641"><span class="linenos">641</span></a>                    <span class="n">csvpath</span><span class="o">=</span><span class="n">csvpath</span><span class="p">,</span>
</span><span id="CsvPaths.next_paths-642"><a href="#CsvPaths.next_paths-642"><span class="linenos">642</span></a>                    <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>
</span><span id="CsvPaths.next_paths-643"><a href="#CsvPaths.next_paths-643"><span class="linenos">643</span></a>                    <span class="n">file</span><span class="o">=</span><span class="n">file</span><span class="p">,</span>
</span><span id="CsvPaths.next_paths-644"><a href="#CsvPaths.next_paths-644"><span class="linenos">644</span></a>                    <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths.next_paths-645"><a href="#CsvPaths.next_paths-645"><span class="linenos">645</span></a>                    <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths.next_paths-646"><a href="#CsvPaths.next_paths-646"><span class="linenos">646</span></a>                    <span class="n">crt</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span>
</span><span id="CsvPaths.next_paths-647"><a href="#CsvPaths.next_paths-647"><span class="linenos">647</span></a>                <span class="p">)</span>
</span><span id="CsvPaths.next_paths-648"><a href="#CsvPaths.next_paths-648"><span class="linenos">648</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths.next_paths-649"><a href="#CsvPaths.next_paths-649"><span class="linenos">649</span></a>                <span class="c1"># if run-mode: no-run we skip ahead without saving results</span>
</span><span id="CsvPaths.next_paths-650"><a href="#CsvPaths.next_paths-650"><span class="linenos">650</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths.next_paths-651"><a href="#CsvPaths.next_paths-651"><span class="linenos">651</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">csvpath</span><span class="o">.</span><span class="n">will_run</span><span class="p">:</span>
</span><span id="CsvPaths.next_paths-652"><a href="#CsvPaths.next_paths-652"><span class="linenos">652</span></a>                    <span class="k">continue</span>
</span><span id="CsvPaths.next_paths-653"><a href="#CsvPaths.next_paths-653"><span class="linenos">653</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths.next_paths-654"><a href="#CsvPaths.next_paths-654"><span class="linenos">654</span></a>                <span class="c1"># the add has to come after _load_csvpath because we need the identity or index</span>
</span><span id="CsvPaths.next_paths-655"><a href="#CsvPaths.next_paths-655"><span class="linenos">655</span></a>                <span class="c1"># to be stable and the identity is found in load, if it exists.</span>
</span><span id="CsvPaths.next_paths-656"><a href="#CsvPaths.next_paths-656"><span class="linenos">656</span></a>                <span class="c1">#</span>
</span><span id="CsvPaths.next_paths-657"><a href="#CsvPaths.next_paths-657"><span class="linenos">657</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">add_named_result</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths.next_paths-658"><a href="#CsvPaths.next_paths-658"><span class="linenos">658</span></a>                <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">csvpath</span><span class="o">.</span><span class="n">next</span><span class="p">():</span>
</span><span id="CsvPaths.next_paths-659"><a href="#CsvPaths.next_paths-659"><span class="linenos">659</span></a>                    <span class="c1">#</span>
</span><span id="CsvPaths.next_paths-660"><a href="#CsvPaths.next_paths-660"><span class="linenos">660</span></a>                    <span class="c1"># removed dec 1. why was this? it doesn&#39;t seem to make sense and</span>
</span><span id="CsvPaths.next_paths-661"><a href="#CsvPaths.next_paths-661"><span class="linenos">661</span></a>                    <span class="c1"># removing it doesn&#39;t break any unit tests. was it a mistake?</span>
</span><span id="CsvPaths.next_paths-662"><a href="#CsvPaths.next_paths-662"><span class="linenos">662</span></a>                    <span class="c1">#</span>
</span><span id="CsvPaths.next_paths-663"><a href="#CsvPaths.next_paths-663"><span class="linenos">663</span></a>                    <span class="c1"># line.append(result)</span>
</span><span id="CsvPaths.next_paths-664"><a href="#CsvPaths.next_paths-664"><span class="linenos">664</span></a>                    <span class="k">if</span> <span class="n">collect</span><span class="p">:</span>
</span><span id="CsvPaths.next_paths-665"><a href="#CsvPaths.next_paths-665"><span class="linenos">665</span></a>                        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="CsvPaths.next_paths-666"><a href="#CsvPaths.next_paths-666"><span class="linenos">666</span></a>                        <span class="n">result</span><span class="o">.</span><span class="n">unmatched</span> <span class="o">=</span> <span class="n">csvpath</span><span class="o">.</span><span class="n">unmatched</span>
</span><span id="CsvPaths.next_paths-667"><a href="#CsvPaths.next_paths-667"><span class="linenos">667</span></a>                    <span class="k">yield</span> <span class="n">line</span>
</span><span id="CsvPaths.next_paths-668"><a href="#CsvPaths.next_paths-668"><span class="linenos">668</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>  <span class="c1"># pylint: disable=W0718</span>
</span><span id="CsvPaths.next_paths-669"><a href="#CsvPaths.next_paths-669"><span class="linenos">669</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">error_manager</span><span class="o">.</span><span class="n">handle_error</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="CsvPaths.next_paths-670"><a href="#CsvPaths.next_paths-670"><span class="linenos">670</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ecoms</span><span class="o">.</span><span class="n">do_i_raise</span><span class="p">():</span>
</span><span id="CsvPaths.next_paths-671"><a href="#CsvPaths.next_paths-671"><span class="linenos">671</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths.next_paths-672"><a href="#CsvPaths.next_paths-672"><span class="linenos">672</span></a>                    <span class="k">raise</span>
</span><span id="CsvPaths.next_paths-673"><a href="#CsvPaths.next_paths-673"><span class="linenos">673</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths.next_paths-674"><a href="#CsvPaths.next_paths-674"><span class="linenos">674</span></a>            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths.next_paths-675"><a href="#CsvPaths.next_paths-675"><span class="linenos">675</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.next_paths-676"><a href="#CsvPaths.next_paths-676"><span class="linenos">676</span></a>        <span class="c1"># run ends here</span>
</span><span id="CsvPaths.next_paths-677"><a href="#CsvPaths.next_paths-677"><span class="linenos">677</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.next_paths-678"><a href="#CsvPaths.next_paths-678"><span class="linenos">678</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">complete_run</span><span class="p">(</span>
</span><span id="CsvPaths.next_paths-679"><a href="#CsvPaths.next_paths-679"><span class="linenos">679</span></a>            <span class="n">run_dir</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span> <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span>
</span><span id="CsvPaths.next_paths-680"><a href="#CsvPaths.next_paths-680"><span class="linenos">680</span></a>        <span class="p">)</span>
</span><span id="CsvPaths.next_paths-681"><a href="#CsvPaths.next_paths-681"><span class="linenos">681</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clear_run_coordination</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Does a <a href="#CsvPath.next">CsvPath.next()</a> on filename for every line against every named path in sequence</p>
</div>


                            </div>
                            <div id="CsvPaths.collect_by_line" class="classattr">
                                        <input id="CsvPaths.collect_by_line-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">collect_by_line</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">pathsname</span>,</span><span class="param">	<span class="n">filename</span>,</span><span class="param">	<span class="n">if_all_agree</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">collect_when_not_matched</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="CsvPaths.collect_by_line-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPaths.collect_by_line"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPaths.collect_by_line-685"><a href="#CsvPaths.collect_by_line-685"><span class="linenos">685</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">collect_by_line</span><span class="p">(</span>
</span><span id="CsvPaths.collect_by_line-686"><a href="#CsvPaths.collect_by_line-686"><span class="linenos">686</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">if_all_agree</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">collect_when_not_matched</span><span class="o">=</span><span class="kc">False</span>
</span><span id="CsvPaths.collect_by_line-687"><a href="#CsvPaths.collect_by_line-687"><span class="linenos">687</span></a>    <span class="p">):</span>
</span><span id="CsvPaths.collect_by_line-688"><a href="#CsvPaths.collect_by_line-688"><span class="linenos">688</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Does a CsvPath.collect() on filename where each row is considered</span>
</span><span id="CsvPaths.collect_by_line-689"><a href="#CsvPaths.collect_by_line-689"><span class="linenos">689</span></a><span class="sd">        by every named path before the next row starts</span>
</span><span id="CsvPaths.collect_by_line-690"><a href="#CsvPaths.collect_by_line-690"><span class="linenos">690</span></a>
</span><span id="CsvPaths.collect_by_line-691"><a href="#CsvPaths.collect_by_line-691"><span class="linenos">691</span></a><span class="sd">        next_by_line for if_all_agree and collect_when_not_matched.</span>
</span><span id="CsvPaths.collect_by_line-692"><a href="#CsvPaths.collect_by_line-692"><span class="linenos">692</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CsvPaths.collect_by_line-693"><a href="#CsvPaths.collect_by_line-693"><span class="linenos">693</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="CsvPaths.collect_by_line-694"><a href="#CsvPaths.collect_by_line-694"><span class="linenos">694</span></a>            <span class="s2">&quot;Starting collect_by_line for paths: </span><span class="si">%s</span><span class="s2"> and file: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span>
</span><span id="CsvPaths.collect_by_line-695"><a href="#CsvPaths.collect_by_line-695"><span class="linenos">695</span></a>        <span class="p">)</span>
</span><span id="CsvPaths.collect_by_line-696"><a href="#CsvPaths.collect_by_line-696"><span class="linenos">696</span></a>        <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CsvPaths.collect_by_line-697"><a href="#CsvPaths.collect_by_line-697"><span class="linenos">697</span></a>        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">next_by_line</span><span class="p">(</span>  <span class="c1"># pylint: disable=W0612</span>
</span><span id="CsvPaths.collect_by_line-698"><a href="#CsvPaths.collect_by_line-698"><span class="linenos">698</span></a>            <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths.collect_by_line-699"><a href="#CsvPaths.collect_by_line-699"><span class="linenos">699</span></a>            <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths.collect_by_line-700"><a href="#CsvPaths.collect_by_line-700"><span class="linenos">700</span></a>            <span class="n">collect</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="CsvPaths.collect_by_line-701"><a href="#CsvPaths.collect_by_line-701"><span class="linenos">701</span></a>            <span class="n">if_all_agree</span><span class="o">=</span><span class="n">if_all_agree</span><span class="p">,</span>
</span><span id="CsvPaths.collect_by_line-702"><a href="#CsvPaths.collect_by_line-702"><span class="linenos">702</span></a>            <span class="n">collect_when_not_matched</span><span class="o">=</span><span class="n">collect_when_not_matched</span><span class="p">,</span>
</span><span id="CsvPaths.collect_by_line-703"><a href="#CsvPaths.collect_by_line-703"><span class="linenos">703</span></a>        <span class="p">):</span>
</span><span id="CsvPaths.collect_by_line-704"><a href="#CsvPaths.collect_by_line-704"><span class="linenos">704</span></a>            <span class="c1"># re: W0612: we need &#39;line&#39; in order to do the iteration. we have to iterate.</span>
</span><span id="CsvPaths.collect_by_line-705"><a href="#CsvPaths.collect_by_line-705"><span class="linenos">705</span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="CsvPaths.collect_by_line-706"><a href="#CsvPaths.collect_by_line-706"><span class="linenos">706</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="CsvPaths.collect_by_line-707"><a href="#CsvPaths.collect_by_line-707"><span class="linenos">707</span></a>            <span class="s2">&quot;Completed collect_by_line for paths: </span><span class="si">%s</span><span class="s2"> and file: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span>
</span><span id="CsvPaths.collect_by_line-708"><a href="#CsvPaths.collect_by_line-708"><span class="linenos">708</span></a>        <span class="p">)</span>
</span><span id="CsvPaths.collect_by_line-709"><a href="#CsvPaths.collect_by_line-709"><span class="linenos">709</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.collect_by_line-710"><a href="#CsvPaths.collect_by_line-710"><span class="linenos">710</span></a>        <span class="c1"># the results have all the lines according to what CsvPath captured them, but</span>
</span><span id="CsvPaths.collect_by_line-711"><a href="#CsvPaths.collect_by_line-711"><span class="linenos">711</span></a>        <span class="c1"># since we&#39;re doing if_all_agree T/F we should return the union here. for some</span>
</span><span id="CsvPaths.collect_by_line-712"><a href="#CsvPaths.collect_by_line-712"><span class="linenos">712</span></a>        <span class="c1"># files this obviously makes the data in memory problem even bigger, but it&#39;s</span>
</span><span id="CsvPaths.collect_by_line-713"><a href="#CsvPaths.collect_by_line-713"><span class="linenos">713</span></a>        <span class="c1"># operator&#39;s responsibility to know if that will be a problem for their use</span>
</span><span id="CsvPaths.collect_by_line-714"><a href="#CsvPaths.collect_by_line-714"><span class="linenos">714</span></a>        <span class="c1"># case.</span>
</span><span id="CsvPaths.collect_by_line-715"><a href="#CsvPaths.collect_by_line-715"><span class="linenos">715</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.collect_by_line-716"><a href="#CsvPaths.collect_by_line-716"><span class="linenos">716</span></a>        <span class="k">return</span> <span class="n">lines</span>
</span></pre></div>


            <div class="docstring"><p>Does a <a href="#CsvPath.collect">CsvPath.collect()</a> on filename where each row is considered
by every named path before the next row starts</p>

<p>next_by_line for if_all_agree and collect_when_not_matched.</p>
</div>


                            </div>
                            <div id="CsvPaths.fast_forward_by_line" class="classattr">
                                        <input id="CsvPaths.fast_forward_by_line-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fast_forward_by_line</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">pathsname</span>,</span><span class="param">	<span class="n">filename</span>,</span><span class="param">	<span class="n">if_all_agree</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">collect_when_not_matched</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="CsvPaths.fast_forward_by_line-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPaths.fast_forward_by_line"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPaths.fast_forward_by_line-718"><a href="#CsvPaths.fast_forward_by_line-718"><span class="linenos">718</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fast_forward_by_line</span><span class="p">(</span>
</span><span id="CsvPaths.fast_forward_by_line-719"><a href="#CsvPaths.fast_forward_by_line-719"><span class="linenos">719</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">if_all_agree</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">collect_when_not_matched</span><span class="o">=</span><span class="kc">False</span>
</span><span id="CsvPaths.fast_forward_by_line-720"><a href="#CsvPaths.fast_forward_by_line-720"><span class="linenos">720</span></a>    <span class="p">):</span>
</span><span id="CsvPaths.fast_forward_by_line-721"><a href="#CsvPaths.fast_forward_by_line-721"><span class="linenos">721</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Does a CsvPath.fast_forward() on filename where each row is</span>
</span><span id="CsvPaths.fast_forward_by_line-722"><a href="#CsvPaths.fast_forward_by_line-722"><span class="linenos">722</span></a><span class="sd">        considered by every named path before the next row starts</span>
</span><span id="CsvPaths.fast_forward_by_line-723"><a href="#CsvPaths.fast_forward_by_line-723"><span class="linenos">723</span></a>
</span><span id="CsvPaths.fast_forward_by_line-724"><a href="#CsvPaths.fast_forward_by_line-724"><span class="linenos">724</span></a><span class="sd">        next_by_line for if_all_agree and collect_when_not_matched.</span>
</span><span id="CsvPaths.fast_forward_by_line-725"><a href="#CsvPaths.fast_forward_by_line-725"><span class="linenos">725</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CsvPaths.fast_forward_by_line-726"><a href="#CsvPaths.fast_forward_by_line-726"><span class="linenos">726</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="CsvPaths.fast_forward_by_line-727"><a href="#CsvPaths.fast_forward_by_line-727"><span class="linenos">727</span></a>            <span class="s2">&quot;Starting fast_forward_by_line for paths: </span><span class="si">%s</span><span class="s2"> and file: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_by_line-728"><a href="#CsvPaths.fast_forward_by_line-728"><span class="linenos">728</span></a>            <span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_by_line-729"><a href="#CsvPaths.fast_forward_by_line-729"><span class="linenos">729</span></a>            <span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_by_line-730"><a href="#CsvPaths.fast_forward_by_line-730"><span class="linenos">730</span></a>        <span class="p">)</span>
</span><span id="CsvPaths.fast_forward_by_line-731"><a href="#CsvPaths.fast_forward_by_line-731"><span class="linenos">731</span></a>        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">next_by_line</span><span class="p">(</span>  <span class="c1"># pylint: disable=W0612</span>
</span><span id="CsvPaths.fast_forward_by_line-732"><a href="#CsvPaths.fast_forward_by_line-732"><span class="linenos">732</span></a>            <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_by_line-733"><a href="#CsvPaths.fast_forward_by_line-733"><span class="linenos">733</span></a>            <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_by_line-734"><a href="#CsvPaths.fast_forward_by_line-734"><span class="linenos">734</span></a>            <span class="n">collect</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_by_line-735"><a href="#CsvPaths.fast_forward_by_line-735"><span class="linenos">735</span></a>            <span class="n">if_all_agree</span><span class="o">=</span><span class="n">if_all_agree</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_by_line-736"><a href="#CsvPaths.fast_forward_by_line-736"><span class="linenos">736</span></a>            <span class="n">collect_when_not_matched</span><span class="o">=</span><span class="n">collect_when_not_matched</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_by_line-737"><a href="#CsvPaths.fast_forward_by_line-737"><span class="linenos">737</span></a>        <span class="p">):</span>
</span><span id="CsvPaths.fast_forward_by_line-738"><a href="#CsvPaths.fast_forward_by_line-738"><span class="linenos">738</span></a>            <span class="c1"># re: W0612: we need &#39;line&#39; in order to do the iteration. we have to iterate.</span>
</span><span id="CsvPaths.fast_forward_by_line-739"><a href="#CsvPaths.fast_forward_by_line-739"><span class="linenos">739</span></a>            <span class="k">pass</span>
</span><span id="CsvPaths.fast_forward_by_line-740"><a href="#CsvPaths.fast_forward_by_line-740"><span class="linenos">740</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="CsvPaths.fast_forward_by_line-741"><a href="#CsvPaths.fast_forward_by_line-741"><span class="linenos">741</span></a>            <span class="s2">&quot;Completed fast_forward_by_line for paths: </span><span class="si">%s</span><span class="s2"> and file: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_by_line-742"><a href="#CsvPaths.fast_forward_by_line-742"><span class="linenos">742</span></a>            <span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_by_line-743"><a href="#CsvPaths.fast_forward_by_line-743"><span class="linenos">743</span></a>            <span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths.fast_forward_by_line-744"><a href="#CsvPaths.fast_forward_by_line-744"><span class="linenos">744</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Does a <a href="#CsvPath.fast_forward">CsvPath.fast_forward()</a> on filename where each row is
considered by every named path before the next row starts</p>

<p>next_by_line for if_all_agree and collect_when_not_matched.</p>
</div>


                            </div>
                            <div id="CsvPaths.next_by_line" class="classattr">
                                        <input id="CsvPaths.next_by_line-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">next_by_line</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">pathsname</span>,</span><span class="param">	<span class="n">filename</span>,</span><span class="param">	<span class="n">collect</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">if_all_agree</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">collect_when_not_matched</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">) -> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="CsvPaths.next_by_line-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CsvPaths.next_by_line"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CsvPaths.next_by_line-746"><a href="#CsvPaths.next_by_line-746"><span class="linenos">746</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">next_by_line</span><span class="p">(</span>  <span class="c1"># pylint: disable=R0912,R0915,R0914</span>
</span><span id="CsvPaths.next_by_line-747"><a href="#CsvPaths.next_by_line-747"><span class="linenos">747</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="CsvPaths.next_by_line-748"><a href="#CsvPaths.next_by_line-748"><span class="linenos">748</span></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="CsvPaths.next_by_line-749"><a href="#CsvPaths.next_by_line-749"><span class="linenos">749</span></a>        <span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths.next_by_line-750"><a href="#CsvPaths.next_by_line-750"><span class="linenos">750</span></a>        <span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths.next_by_line-751"><a href="#CsvPaths.next_by_line-751"><span class="linenos">751</span></a>        <span class="n">collect</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="CsvPaths.next_by_line-752"><a href="#CsvPaths.next_by_line-752"><span class="linenos">752</span></a>        <span class="n">if_all_agree</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="CsvPaths.next_by_line-753"><a href="#CsvPaths.next_by_line-753"><span class="linenos">753</span></a>        <span class="n">collect_when_not_matched</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="CsvPaths.next_by_line-754"><a href="#CsvPaths.next_by_line-754"><span class="linenos">754</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
</span><span id="CsvPaths.next_by_line-755"><a href="#CsvPaths.next_by_line-755"><span class="linenos">755</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Does a CsvPath.next() on filename where each row is considered</span>
</span><span id="CsvPaths.next_by_line-756"><a href="#CsvPaths.next_by_line-756"><span class="linenos">756</span></a><span class="sd">        by every named path before the next row starts.</span>
</span><span id="CsvPaths.next_by_line-757"><a href="#CsvPaths.next_by_line-757"><span class="linenos">757</span></a>
</span><span id="CsvPaths.next_by_line-758"><a href="#CsvPaths.next_by_line-758"><span class="linenos">758</span></a><span class="sd">        if_all_agree=True means all the CsvPath instances must match for</span>
</span><span id="CsvPaths.next_by_line-759"><a href="#CsvPaths.next_by_line-759"><span class="linenos">759</span></a><span class="sd">        the line to be kept. However, every CsvPath instance will keep its</span>
</span><span id="CsvPaths.next_by_line-760"><a href="#CsvPaths.next_by_line-760"><span class="linenos">760</span></a><span class="sd">        own matches in its results regardless of if every line kept was</span>
</span><span id="CsvPaths.next_by_line-761"><a href="#CsvPaths.next_by_line-761"><span class="linenos">761</span></a><span class="sd">        returned to the caller by CsvPaths.</span>
</span><span id="CsvPaths.next_by_line-762"><a href="#CsvPaths.next_by_line-762"><span class="linenos">762</span></a>
</span><span id="CsvPaths.next_by_line-763"><a href="#CsvPaths.next_by_line-763"><span class="linenos">763</span></a><span class="sd">        collect_when_not_matched=True inverts the match so that lines</span>
</span><span id="CsvPaths.next_by_line-764"><a href="#CsvPaths.next_by_line-764"><span class="linenos">764</span></a><span class="sd">        which did not match are returned, rather than the default behavior.</span>
</span><span id="CsvPaths.next_by_line-765"><a href="#CsvPaths.next_by_line-765"><span class="linenos">765</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CsvPaths.next_by_line-766"><a href="#CsvPaths.next_by_line-766"><span class="linenos">766</span></a>        <span class="c1"># re: R0912 -- absolutely. plan to refactor.</span>
</span><span id="CsvPaths.next_by_line-767"><a href="#CsvPaths.next_by_line-767"><span class="linenos">767</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Prepping </span><span class="si">%s</span><span class="s2"> and </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths.next_by_line-768"><a href="#CsvPaths.next_by_line-768"><span class="linenos">768</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clean</span><span class="p">(</span><span class="n">paths</span><span class="o">=</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths.next_by_line-769"><a href="#CsvPaths.next_by_line-769"><span class="linenos">769</span></a>        <span class="n">fn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_manager</span><span class="o">.</span><span class="n">get_named_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span><span id="CsvPaths.next_by_line-770"><a href="#CsvPaths.next_by_line-770"><span class="linenos">770</span></a>        <span class="n">paths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">paths_manager</span><span class="o">.</span><span class="n">get_named_paths</span><span class="p">(</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths.next_by_line-771"><a href="#CsvPaths.next_by_line-771"><span class="linenos">771</span></a>        <span class="k">if</span> <span class="p">(</span>
</span><span id="CsvPaths.next_by_line-772"><a href="#CsvPaths.next_by_line-772"><span class="linenos">772</span></a>            <span class="n">paths</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">paths</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
</span><span id="CsvPaths.next_by_line-773"><a href="#CsvPaths.next_by_line-773"><span class="linenos">773</span></a>        <span class="p">):</span>  <span class="c1"># pragma: no cover</span>
</span><span id="CsvPaths.next_by_line-774"><a href="#CsvPaths.next_by_line-774"><span class="linenos">774</span></a>            <span class="k">raise</span> <span class="n">InputException</span><span class="p">(</span>
</span><span id="CsvPaths.next_by_line-775"><a href="#CsvPaths.next_by_line-775"><span class="linenos">775</span></a>                <span class="sa">f</span><span class="s2">&quot;Pathsname &#39;</span><span class="si">{</span><span class="n">pathsname</span><span class="si">}</span><span class="s2">&#39; must name a list of csvpaths&quot;</span>
</span><span id="CsvPaths.next_by_line-776"><a href="#CsvPaths.next_by_line-776"><span class="linenos">776</span></a>            <span class="p">)</span>
</span><span id="CsvPaths.next_by_line-777"><a href="#CsvPaths.next_by_line-777"><span class="linenos">777</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.next_by_line-778"><a href="#CsvPaths.next_by_line-778"><span class="linenos">778</span></a>        <span class="c1"># experiment!</span>
</span><span id="CsvPaths.next_by_line-779"><a href="#CsvPaths.next_by_line-779"><span class="linenos">779</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.next_by_line-780"><a href="#CsvPaths.next_by_line-780"><span class="linenos">780</span></a>        <span class="n">crt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_time_str</span><span class="p">(</span><span class="n">pathsname</span><span class="p">)</span>
</span><span id="CsvPaths.next_by_line-781"><a href="#CsvPaths.next_by_line-781"><span class="linenos">781</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.next_by_line-782"><a href="#CsvPaths.next_by_line-782"><span class="linenos">782</span></a>        <span class="c1"># also use of crt below</span>
</span><span id="CsvPaths.next_by_line-783"><a href="#CsvPaths.next_by_line-783"><span class="linenos">783</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.next_by_line-784"><a href="#CsvPaths.next_by_line-784"><span class="linenos">784</span></a>        <span class="n">csvpath_objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_csvpath_objects</span><span class="p">(</span>
</span><span id="CsvPaths.next_by_line-785"><a href="#CsvPaths.next_by_line-785"><span class="linenos">785</span></a>            <span class="n">paths</span><span class="o">=</span><span class="n">paths</span><span class="p">,</span>
</span><span id="CsvPaths.next_by_line-786"><a href="#CsvPaths.next_by_line-786"><span class="linenos">786</span></a>            <span class="n">named_file</span><span class="o">=</span><span class="n">fn</span><span class="p">,</span>
</span><span id="CsvPaths.next_by_line-787"><a href="#CsvPaths.next_by_line-787"><span class="linenos">787</span></a>            <span class="n">collect_when_not_matched</span><span class="o">=</span><span class="n">collect_when_not_matched</span><span class="p">,</span>
</span><span id="CsvPaths.next_by_line-788"><a href="#CsvPaths.next_by_line-788"><span class="linenos">788</span></a>            <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths.next_by_line-789"><a href="#CsvPaths.next_by_line-789"><span class="linenos">789</span></a>            <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths.next_by_line-790"><a href="#CsvPaths.next_by_line-790"><span class="linenos">790</span></a>            <span class="n">crt</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span>
</span><span id="CsvPaths.next_by_line-791"><a href="#CsvPaths.next_by_line-791"><span class="linenos">791</span></a>        <span class="p">)</span>
</span><span id="CsvPaths.next_by_line-792"><a href="#CsvPaths.next_by_line-792"><span class="linenos">792</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.next_by_line-793"><a href="#CsvPaths.next_by_line-793"><span class="linenos">793</span></a>        <span class="c1"># prep has to come after _load_csvpath_objects because we need the identity or</span>
</span><span id="CsvPaths.next_by_line-794"><a href="#CsvPaths.next_by_line-794"><span class="linenos">794</span></a>        <span class="c1"># indexes to be stable and the identity is found in the load, if it exists.</span>
</span><span id="CsvPaths.next_by_line-795"><a href="#CsvPaths.next_by_line-795"><span class="linenos">795</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.next_by_line-796"><a href="#CsvPaths.next_by_line-796"><span class="linenos">796</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_prep_csvpath_results</span><span class="p">(</span>
</span><span id="CsvPaths.next_by_line-797"><a href="#CsvPaths.next_by_line-797"><span class="linenos">797</span></a>            <span class="n">csvpath_objects</span><span class="o">=</span><span class="n">csvpath_objects</span><span class="p">,</span>
</span><span id="CsvPaths.next_by_line-798"><a href="#CsvPaths.next_by_line-798"><span class="linenos">798</span></a>            <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
</span><span id="CsvPaths.next_by_line-799"><a href="#CsvPaths.next_by_line-799"><span class="linenos">799</span></a>            <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span>
</span><span id="CsvPaths.next_by_line-800"><a href="#CsvPaths.next_by_line-800"><span class="linenos">800</span></a>            <span class="n">crt</span><span class="o">=</span><span class="n">crt</span><span class="p">,</span>
</span><span id="CsvPaths.next_by_line-801"><a href="#CsvPaths.next_by_line-801"><span class="linenos">801</span></a>        <span class="p">)</span>
</span><span id="CsvPaths.next_by_line-802"><a href="#CsvPaths.next_by_line-802"><span class="linenos">802</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.next_by_line-803"><a href="#CsvPaths.next_by_line-803"><span class="linenos">803</span></a>        <span class="c1"># setting fn into the csvpath is less obviously useful at CsvPaths</span>
</span><span id="CsvPaths.next_by_line-804"><a href="#CsvPaths.next_by_line-804"><span class="linenos">804</span></a>        <span class="c1"># but we&#39;ll do it for consistency.</span>
</span><span id="CsvPaths.next_by_line-805"><a href="#CsvPaths.next_by_line-805"><span class="linenos">805</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.next_by_line-806"><a href="#CsvPaths.next_by_line-806"><span class="linenos">806</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Beginning next_by_line with </span><span class="si">%s</span><span class="s2"> paths&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">csvpath_objects</span><span class="p">))</span>
</span><span id="CsvPaths.next_by_line-807"><a href="#CsvPaths.next_by_line-807"><span class="linenos">807</span></a>        <span class="n">reader</span> <span class="o">=</span> <span class="n">FileManager</span><span class="o">.</span><span class="n">get_reader</span><span class="p">(</span>
</span><span id="CsvPaths.next_by_line-808"><a href="#CsvPaths.next_by_line-808"><span class="linenos">808</span></a>            <span class="n">fn</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">,</span> <span class="n">quotechar</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">quotechar</span>
</span><span id="CsvPaths.next_by_line-809"><a href="#CsvPaths.next_by_line-809"><span class="linenos">809</span></a>        <span class="p">)</span>
</span><span id="CsvPaths.next_by_line-810"><a href="#CsvPaths.next_by_line-810"><span class="linenos">810</span></a>        <span class="n">stopped_count</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CsvPaths.next_by_line-811"><a href="#CsvPaths.next_by_line-811"><span class="linenos">811</span></a>        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">reader</span><span class="o">.</span><span class="n">next</span><span class="p">():</span>
</span><span id="CsvPaths.next_by_line-812"><a href="#CsvPaths.next_by_line-812"><span class="linenos">812</span></a>            <span class="c1"># for line in reader:  # pylint: disable=R1702</span>
</span><span id="CsvPaths.next_by_line-813"><a href="#CsvPaths.next_by_line-813"><span class="linenos">813</span></a>            <span class="c1"># question to self: should this default be in a central place</span>
</span><span id="CsvPaths.next_by_line-814"><a href="#CsvPaths.next_by_line-814"><span class="linenos">814</span></a>            <span class="c1"># so that we can switch to OR, in part by changing the default?</span>
</span><span id="CsvPaths.next_by_line-815"><a href="#CsvPaths.next_by_line-815"><span class="linenos">815</span></a>            <span class="n">keep</span> <span class="o">=</span> <span class="n">if_all_agree</span>
</span><span id="CsvPaths.next_by_line-816"><a href="#CsvPaths.next_by_line-816"><span class="linenos">816</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_skip_all</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CsvPaths.next_by_line-817"><a href="#CsvPaths.next_by_line-817"><span class="linenos">817</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_advance_all</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="CsvPaths.next_by_line-818"><a href="#CsvPaths.next_by_line-818"><span class="linenos">818</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="CsvPaths.next_by_line-819"><a href="#CsvPaths.next_by_line-819"><span class="linenos">819</span></a>                <span class="c1"># p is a (CsvPath, List[List[str]]) where the second item is</span>
</span><span id="CsvPaths.next_by_line-820"><a href="#CsvPaths.next_by_line-820"><span class="linenos">820</span></a>                <span class="c1"># the line-by-line results of the first item&#39;s matching</span>
</span><span id="CsvPaths.next_by_line-821"><a href="#CsvPaths.next_by_line-821"><span class="linenos">821</span></a>                <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">csvpath_objects</span><span class="p">:</span>
</span><span id="CsvPaths.next_by_line-822"><a href="#CsvPaths.next_by_line-822"><span class="linenos">822</span></a>                    <span class="c1">#</span>
</span><span id="CsvPaths.next_by_line-823"><a href="#CsvPaths.next_by_line-823"><span class="linenos">823</span></a>                    <span class="c1"># if run-mode: no-run we skip ahead without saving results</span>
</span><span id="CsvPaths.next_by_line-824"><a href="#CsvPaths.next_by_line-824"><span class="linenos">824</span></a>                    <span class="c1">#</span>
</span><span id="CsvPaths.next_by_line-825"><a href="#CsvPaths.next_by_line-825"><span class="linenos">825</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">will_run</span><span class="p">:</span>
</span><span id="CsvPaths.next_by_line-826"><a href="#CsvPaths.next_by_line-826"><span class="linenos">826</span></a>                        <span class="k">continue</span>
</span><span id="CsvPaths.next_by_line-827"><a href="#CsvPaths.next_by_line-827"><span class="linenos">827</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="CsvPaths.next_by_line-828"><a href="#CsvPaths.next_by_line-828"><span class="linenos">828</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fail_all</span><span class="p">:</span>
</span><span id="CsvPaths.next_by_line-829"><a href="#CsvPaths.next_by_line-829"><span class="linenos">829</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="CsvPaths.next_by_line-830"><a href="#CsvPaths.next_by_line-830"><span class="linenos">830</span></a>                            <span class="s2">&quot;Fail-all set. Setting CsvPath is_valid to False.&quot;</span>
</span><span id="CsvPaths.next_by_line-831"><a href="#CsvPaths.next_by_line-831"><span class="linenos">831</span></a>                        <span class="p">)</span>
</span><span id="CsvPaths.next_by_line-832"><a href="#CsvPaths.next_by_line-832"><span class="linenos">832</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">is_valid</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CsvPaths.next_by_line-833"><a href="#CsvPaths.next_by_line-833"><span class="linenos">833</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stop_all</span><span class="p">:</span>
</span><span id="CsvPaths.next_by_line-834"><a href="#CsvPaths.next_by_line-834"><span class="linenos">834</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Stop-all set. Shutting down run.&quot;</span><span class="p">)</span>
</span><span id="CsvPaths.next_by_line-835"><a href="#CsvPaths.next_by_line-835"><span class="linenos">835</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">stopped</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="CsvPaths.next_by_line-836"><a href="#CsvPaths.next_by_line-836"><span class="linenos">836</span></a>                        <span class="k">continue</span>
</span><span id="CsvPaths.next_by_line-837"><a href="#CsvPaths.next_by_line-837"><span class="linenos">837</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_skip_all</span><span class="p">:</span>
</span><span id="CsvPaths.next_by_line-838"><a href="#CsvPaths.next_by_line-838"><span class="linenos">838</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Skip-all set. Continuing to next.&quot;</span><span class="p">)</span>
</span><span id="CsvPaths.next_by_line-839"><a href="#CsvPaths.next_by_line-839"><span class="linenos">839</span></a>                        <span class="c1">#</span>
</span><span id="CsvPaths.next_by_line-840"><a href="#CsvPaths.next_by_line-840"><span class="linenos">840</span></a>                        <span class="c1"># all following CsvPaths must have their</span>
</span><span id="CsvPaths.next_by_line-841"><a href="#CsvPaths.next_by_line-841"><span class="linenos">841</span></a>                        <span class="c1"># line_monitors incremented</span>
</span><span id="CsvPaths.next_by_line-842"><a href="#CsvPaths.next_by_line-842"><span class="linenos">842</span></a>                        <span class="c1">#</span>
</span><span id="CsvPaths.next_by_line-843"><a href="#CsvPaths.next_by_line-843"><span class="linenos">843</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">track_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="CsvPaths.next_by_line-844"><a href="#CsvPaths.next_by_line-844"><span class="linenos">844</span></a>                        <span class="k">continue</span>
</span><span id="CsvPaths.next_by_line-845"><a href="#CsvPaths.next_by_line-845"><span class="linenos">845</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_advance_all</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CsvPaths.next_by_line-846"><a href="#CsvPaths.next_by_line-846"><span class="linenos">846</span></a>                        <span class="n">logtxt</span> <span class="o">=</span> <span class="s2">&quot;Advance-all set. Setting advance. &quot;</span>
</span><span id="CsvPaths.next_by_line-847"><a href="#CsvPaths.next_by_line-847"><span class="linenos">847</span></a>                        <span class="n">logtxt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">logtxt</span><span class="si">}</span><span class="s2">CsvPath and its Matcher will handle the advancing.&quot;</span>
</span><span id="CsvPaths.next_by_line-848"><a href="#CsvPaths.next_by_line-848"><span class="linenos">848</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">logtxt</span><span class="p">)</span>
</span><span id="CsvPaths.next_by_line-849"><a href="#CsvPaths.next_by_line-849"><span class="linenos">849</span></a>                        <span class="c1">#</span>
</span><span id="CsvPaths.next_by_line-850"><a href="#CsvPaths.next_by_line-850"><span class="linenos">850</span></a>                        <span class="c1"># CsvPath will handle advancing so we don&#39;t need to do</span>
</span><span id="CsvPaths.next_by_line-851"><a href="#CsvPaths.next_by_line-851"><span class="linenos">851</span></a>                        <span class="c1"># anything, including track_line(line). we just need to</span>
</span><span id="CsvPaths.next_by_line-852"><a href="#CsvPaths.next_by_line-852"><span class="linenos">852</span></a>                        <span class="c1"># see if we&#39;re setting advance or increasing it.</span>
</span><span id="CsvPaths.next_by_line-853"><a href="#CsvPaths.next_by_line-853"><span class="linenos">853</span></a>                        <span class="c1">#</span>
</span><span id="CsvPaths.next_by_line-854"><a href="#CsvPaths.next_by_line-854"><span class="linenos">854</span></a>                        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">advance_count</span>
</span><span id="CsvPaths.next_by_line-855"><a href="#CsvPaths.next_by_line-855"><span class="linenos">855</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_advance_all</span> <span class="o">&gt;</span> <span class="n">a</span><span class="p">:</span>
</span><span id="CsvPaths.next_by_line-856"><a href="#CsvPaths.next_by_line-856"><span class="linenos">856</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">advance_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_advance_all</span>
</span><span id="CsvPaths.next_by_line-857"><a href="#CsvPaths.next_by_line-857"><span class="linenos">857</span></a>                        <span class="c1">#</span>
</span><span id="CsvPaths.next_by_line-858"><a href="#CsvPaths.next_by_line-858"><span class="linenos">858</span></a>                        <span class="c1"># all following CsvPaths must have their</span>
</span><span id="CsvPaths.next_by_line-859"><a href="#CsvPaths.next_by_line-859"><span class="linenos">859</span></a>                        <span class="c1"># advance incremented -- with the advance not being simply</span>
</span><span id="CsvPaths.next_by_line-860"><a href="#CsvPaths.next_by_line-860"><span class="linenos">860</span></a>                        <span class="c1"># additive, have to be mindful of any existing advance</span>
</span><span id="CsvPaths.next_by_line-861"><a href="#CsvPaths.next_by_line-861"><span class="linenos">861</span></a>                        <span class="c1"># count!</span>
</span><span id="CsvPaths.next_by_line-862"><a href="#CsvPaths.next_by_line-862"><span class="linenos">862</span></a>                        <span class="c1">#</span>
</span><span id="CsvPaths.next_by_line-863"><a href="#CsvPaths.next_by_line-863"><span class="linenos">863</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">stopped</span><span class="p">:</span>  <span class="c1"># pylint: disable=R1724</span>
</span><span id="CsvPaths.next_by_line-864"><a href="#CsvPaths.next_by_line-864"><span class="linenos">864</span></a>                        <span class="k">continue</span>
</span><span id="CsvPaths.next_by_line-865"><a href="#CsvPaths.next_by_line-865"><span class="linenos">865</span></a>
</span><span id="CsvPaths.next_by_line-866"><a href="#CsvPaths.next_by_line-866"><span class="linenos">866</span></a>                    <span class="c1">#</span>
</span><span id="CsvPaths.next_by_line-867"><a href="#CsvPaths.next_by_line-867"><span class="linenos">867</span></a>                    <span class="c1"># allowing the match to happen regardless of keep</span>
</span><span id="CsvPaths.next_by_line-868"><a href="#CsvPaths.next_by_line-868"><span class="linenos">868</span></a>                    <span class="c1"># because we may want side-effects or to have different</span>
</span><span id="CsvPaths.next_by_line-869"><a href="#CsvPaths.next_by_line-869"><span class="linenos">869</span></a>                    <span class="c1"># results in different named-results, as well as the</span>
</span><span id="CsvPaths.next_by_line-870"><a href="#CsvPaths.next_by_line-870"><span class="linenos">870</span></a>                    <span class="c1"># union</span>
</span><span id="CsvPaths.next_by_line-871"><a href="#CsvPaths.next_by_line-871"><span class="linenos">871</span></a>                    <span class="c1">#</span>
</span><span id="CsvPaths.next_by_line-872"><a href="#CsvPaths.next_by_line-872"><span class="linenos">872</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="CsvPaths.next_by_line-873"><a href="#CsvPaths.next_by_line-873"><span class="linenos">873</span></a>                        <span class="s2">&quot;considering line with csvpath identified as: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="CsvPaths.next_by_line-874"><a href="#CsvPaths.next_by_line-874"><span class="linenos">874</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">identity</span><span class="p">,</span>
</span><span id="CsvPaths.next_by_line-875"><a href="#CsvPaths.next_by_line-875"><span class="linenos">875</span></a>                    <span class="p">)</span>
</span><span id="CsvPaths.next_by_line-876"><a href="#CsvPaths.next_by_line-876"><span class="linenos">876</span></a>                    <span class="n">matched</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CsvPaths.next_by_line-877"><a href="#CsvPaths.next_by_line-877"><span class="linenos">877</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">track_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="CsvPaths.next_by_line-878"><a href="#CsvPaths.next_by_line-878"><span class="linenos">878</span></a>                    <span class="c1">#</span>
</span><span id="CsvPaths.next_by_line-879"><a href="#CsvPaths.next_by_line-879"><span class="linenos">879</span></a>                    <span class="c1"># re: W0212: treating _consider_line something like package private</span>
</span><span id="CsvPaths.next_by_line-880"><a href="#CsvPaths.next_by_line-880"><span class="linenos">880</span></a>                    <span class="c1">#</span>
</span><span id="CsvPaths.next_by_line-881"><a href="#CsvPaths.next_by_line-881"><span class="linenos">881</span></a>                    <span class="n">matched</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="CsvPaths.next_by_line-882"><a href="#CsvPaths.next_by_line-882"><span class="linenos">882</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">_consider_line</span><span class="p">(</span>  <span class="c1"># pylint:disable=W0212</span>
</span><span id="CsvPaths.next_by_line-883"><a href="#CsvPaths.next_by_line-883"><span class="linenos">883</span></a>                            <span class="n">line</span>
</span><span id="CsvPaths.next_by_line-884"><a href="#CsvPaths.next_by_line-884"><span class="linenos">884</span></a>                        <span class="p">)</span>
</span><span id="CsvPaths.next_by_line-885"><a href="#CsvPaths.next_by_line-885"><span class="linenos">885</span></a>                    <span class="p">)</span>
</span><span id="CsvPaths.next_by_line-886"><a href="#CsvPaths.next_by_line-886"><span class="linenos">886</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">stopped</span><span class="p">:</span>
</span><span id="CsvPaths.next_by_line-887"><a href="#CsvPaths.next_by_line-887"><span class="linenos">887</span></a>                        <span class="n">stopped_count</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="CsvPaths.next_by_line-888"><a href="#CsvPaths.next_by_line-888"><span class="linenos">888</span></a>                    <span class="k">if</span> <span class="n">if_all_agree</span><span class="p">:</span>
</span><span id="CsvPaths.next_by_line-889"><a href="#CsvPaths.next_by_line-889"><span class="linenos">889</span></a>                        <span class="n">keep</span> <span class="o">=</span> <span class="n">keep</span> <span class="ow">and</span> <span class="n">matched</span>
</span><span id="CsvPaths.next_by_line-890"><a href="#CsvPaths.next_by_line-890"><span class="linenos">890</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="CsvPaths.next_by_line-891"><a href="#CsvPaths.next_by_line-891"><span class="linenos">891</span></a>                        <span class="n">keep</span> <span class="o">=</span> <span class="n">keep</span> <span class="ow">or</span> <span class="n">matched</span>
</span><span id="CsvPaths.next_by_line-892"><a href="#CsvPaths.next_by_line-892"><span class="linenos">892</span></a>                    <span class="c1">#</span>
</span><span id="CsvPaths.next_by_line-893"><a href="#CsvPaths.next_by_line-893"><span class="linenos">893</span></a>                    <span class="c1"># not doing continue if we have if_all_agree and not keep as we</span>
</span><span id="CsvPaths.next_by_line-894"><a href="#CsvPaths.next_by_line-894"><span class="linenos">894</span></a>                    <span class="c1"># used to do allows individual results to have lines that in</span>
</span><span id="CsvPaths.next_by_line-895"><a href="#CsvPaths.next_by_line-895"><span class="linenos">895</span></a>                    <span class="c1"># aggregate we do not keep.</span>
</span><span id="CsvPaths.next_by_line-896"><a href="#CsvPaths.next_by_line-896"><span class="linenos">896</span></a>                    <span class="c1">#</span>
</span><span id="CsvPaths.next_by_line-897"><a href="#CsvPaths.next_by_line-897"><span class="linenos">897</span></a>                    <span class="k">if</span> <span class="n">matched</span> <span class="ow">and</span> <span class="n">collect</span><span class="p">:</span>
</span><span id="CsvPaths.next_by_line-898"><a href="#CsvPaths.next_by_line-898"><span class="linenos">898</span></a>                        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_matcher</span><span class="o">.</span><span class="n">limit_collection</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="CsvPaths.next_by_line-899"><a href="#CsvPaths.next_by_line-899"><span class="linenos">899</span></a>                        <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="CsvPaths.next_by_line-900"><a href="#CsvPaths.next_by_line-900"><span class="linenos">900</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>  <span class="c1"># pylint: disable=W0718</span>
</span><span id="CsvPaths.next_by_line-901"><a href="#CsvPaths.next_by_line-901"><span class="linenos">901</span></a>                <span class="c1"># ex.trace = traceback.format_exc()</span>
</span><span id="CsvPaths.next_by_line-902"><a href="#CsvPaths.next_by_line-902"><span class="linenos">902</span></a>                <span class="c1"># ex.source = self</span>
</span><span id="CsvPaths.next_by_line-903"><a href="#CsvPaths.next_by_line-903"><span class="linenos">903</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">error_manager</span><span class="o">.</span><span class="n">handle_error</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="CsvPaths.next_by_line-904"><a href="#CsvPaths.next_by_line-904"><span class="linenos">904</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ecoms</span><span class="o">.</span><span class="n">do_i_raise</span><span class="p">():</span>
</span><span id="CsvPaths.next_by_line-905"><a href="#CsvPaths.next_by_line-905"><span class="linenos">905</span></a>                    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">csvpath_objects</span><span class="p">:</span>
</span><span id="CsvPaths.next_by_line-906"><a href="#CsvPaths.next_by_line-906"><span class="linenos">906</span></a>                        <span class="n">result</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="CsvPaths.next_by_line-907"><a href="#CsvPaths.next_by_line-907"><span class="linenos">907</span></a>                        <span class="n">result</span><span class="o">.</span><span class="n">unmatched</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">unmatched</span>
</span><span id="CsvPaths.next_by_line-908"><a href="#CsvPaths.next_by_line-908"><span class="linenos">908</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths.next_by_line-909"><a href="#CsvPaths.next_by_line-909"><span class="linenos">909</span></a>                    <span class="k">raise</span>
</span><span id="CsvPaths.next_by_line-910"><a href="#CsvPaths.next_by_line-910"><span class="linenos">910</span></a>            <span class="c1"># we yield even if we stopped in this iteration.</span>
</span><span id="CsvPaths.next_by_line-911"><a href="#CsvPaths.next_by_line-911"><span class="linenos">911</span></a>            <span class="c1"># caller needs to see what we stopped on.</span>
</span><span id="CsvPaths.next_by_line-912"><a href="#CsvPaths.next_by_line-912"><span class="linenos">912</span></a>            <span class="c1">#</span>
</span><span id="CsvPaths.next_by_line-913"><a href="#CsvPaths.next_by_line-913"><span class="linenos">913</span></a>            <span class="c1"># ! we only yield if keep is True</span>
</span><span id="CsvPaths.next_by_line-914"><a href="#CsvPaths.next_by_line-914"><span class="linenos">914</span></a>            <span class="c1">#</span>
</span><span id="CsvPaths.next_by_line-915"><a href="#CsvPaths.next_by_line-915"><span class="linenos">915</span></a>            <span class="k">if</span> <span class="n">keep</span><span class="p">:</span>
</span><span id="CsvPaths.next_by_line-916"><a href="#CsvPaths.next_by_line-916"><span class="linenos">916</span></a>                <span class="k">yield</span> <span class="n">line</span>
</span><span id="CsvPaths.next_by_line-917"><a href="#CsvPaths.next_by_line-917"><span class="linenos">917</span></a>            <span class="k">if</span> <span class="nb">sum</span><span class="p">(</span><span class="n">stopped_count</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">csvpath_objects</span><span class="p">):</span>
</span><span id="CsvPaths.next_by_line-918"><a href="#CsvPaths.next_by_line-918"><span class="linenos">918</span></a>                <span class="k">break</span>
</span><span id="CsvPaths.next_by_line-919"><a href="#CsvPaths.next_by_line-919"><span class="linenos">919</span></a>        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CsvPaths.next_by_line-920"><a href="#CsvPaths.next_by_line-920"><span class="linenos">920</span></a>        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">csvpath_objects</span><span class="p">:</span>
</span><span id="CsvPaths.next_by_line-921"><a href="#CsvPaths.next_by_line-921"><span class="linenos">921</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="CsvPaths.next_by_line-922"><a href="#CsvPaths.next_by_line-922"><span class="linenos">922</span></a>            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths.next_by_line-923"><a href="#CsvPaths.next_by_line-923"><span class="linenos">923</span></a>            <span class="n">result</span><span class="o">.</span><span class="n">unmatched</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">unmatched</span>
</span><span id="CsvPaths.next_by_line-924"><a href="#CsvPaths.next_by_line-924"><span class="linenos">924</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="CsvPaths.next_by_line-925"><a href="#CsvPaths.next_by_line-925"><span class="linenos">925</span></a>
</span><span id="CsvPaths.next_by_line-926"><a href="#CsvPaths.next_by_line-926"><span class="linenos">926</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.next_by_line-927"><a href="#CsvPaths.next_by_line-927"><span class="linenos">927</span></a>        <span class="c1"># run ends here</span>
</span><span id="CsvPaths.next_by_line-928"><a href="#CsvPaths.next_by_line-928"><span class="linenos">928</span></a>        <span class="c1">#</span>
</span><span id="CsvPaths.next_by_line-929"><a href="#CsvPaths.next_by_line-929"><span class="linenos">929</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">results_manager</span><span class="o">.</span><span class="n">complete_run</span><span class="p">(</span>
</span><span id="CsvPaths.next_by_line-930"><a href="#CsvPaths.next_by_line-930"><span class="linenos">930</span></a>            <span class="n">run_dir</span><span class="o">=</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">run_dir</span><span class="p">,</span> <span class="n">pathsname</span><span class="o">=</span><span class="n">pathsname</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span>
</span><span id="CsvPaths.next_by_line-931"><a href="#CsvPaths.next_by_line-931"><span class="linenos">931</span></a>        <span class="p">)</span>
</span><span id="CsvPaths.next_by_line-932"><a href="#CsvPaths.next_by_line-932"><span class="linenos">932</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clear_run_coordination</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Does a <a href="#CsvPath.next">CsvPath.next()</a> on filename where each row is considered
by every named path before the next row starts.</p>

<p>if_all_agree=True means all the CsvPath instances must match for
the line to be kept. However, every CsvPath instance will keep its
own matches in its results regardless of if every line kept was
returned to the caller by CsvPaths.</p>

<p>collect_when_not_matched=True inverts the match so that lines
which did not match are returned, rather than the default behavior.</p>
</div>


                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>